Power <- function(a,b) return(a^b)

pBD  <- function(b, c, p, sel, mut, m, g, n, d, Idself, Ieself){
## Arguments:
#  b   benefit of interaction
#  c   cost of interaction
#  p   mutation bias
#  sel intensity of selection
#  mut mutation probability
#  m   emigration probability
#  g   proportion of interactions out of the group (interaction equivalent of m)
#  n   deme size
#  d   number of demes
#  Idself whether reproduction in site where the parent is
#  Ieself whether interactions with oneself
return(
(p*((b - c)*mut*(m + Idself*(-1 + m)*(-1 + mut) + mut - m*mut - n)*(-1 + p)*sel + Power(d,2)*(Idself*mut - Idself*m*mut - Idself*Power(mut,2) + Idself*m*Power(mut,2) - mut*n + 2*m*mut*n + 2*Power(mut,2)*n - 2*m*Power(mut,2)*n - m*mut*Power(n,2) - Power(mut,2)*Power(n,2) + m*Power(mut,2)*Power(n,2) + 2*c*Idself*mut*sel - 2*c*Idself*m*mut*sel - c*Idself*Power(mut,2)*sel + c*Idself*m*Power(mut,2)*sel - c*Idself*m*n*sel - c*Power(m,2)*n*sel + c*Idself*Power(m,2)*n*sel - 2*c*mut*n*sel - c*Idself*mut*n*sel + 2*c*m*mut*n*sel + 2*c*Idself*m*mut*n*sel + c*Power(m,2)*mut*n*sel - c*Idself*Power(m,2)*mut*n*sel + 2*c*Power(mut,2)*n*sel - 2*c*m*Power(mut,2)*n*sel + c*m*Power(n,2)*sel + c*mut*Power(n,2)*sel - 2*c*m*mut*Power(n,2)*sel - c*Power(mut,2)*Power(n,2)*sel + c*m*Power(mut,2)*Power(n,2)*sel + b*(-1 + g)*(Idself*(-1 + m)*(Ieself*(m*(-1 + mut) - mut) - (-2 + mut)*mut) + (-1 + m)*(-2 + mut)*mut*n - Ieself*(m*(-1 + mut) - mut)*(m - mut + (-1 + mut)*n))*(-1 + p)*sel - 2*c*Idself*mut*p*sel + 2*c*Idself*m*mut*p*sel + c*Idself*Power(mut,2)*p*sel - c*Idself*m*Power(mut,2)*p*sel + c*Idself*m*n*p*sel + c*Power(m,2)*n*p*sel - c*Idself*Power(m,2)*n*p*sel + 2*c*mut*n*p*sel + c*Idself*mut*n*p*sel - 2*c*m*mut*n*p*sel - 2*c*Idself*m*mut*n*p*sel - c*Power(m,2)*mut*n*p*sel + c*Idself*Power(m,2)*mut*n*p*sel - 2*c*Power(mut,2)*n*p*sel + 2*c*m*Power(mut,2)*n*p*sel - c*m*Power(n,2)*p*sel - c*mut*Power(n,2)*p*sel + 2*c*m*mut*Power(n,2)*p*sel + c*Power(mut,2)*Power(n,2)*p*sel - c*m*Power(mut,2)*Power(n,2)*p*sel) + d*(Power(m,2)*(-1 + mut)*(-1 + mut + c*(-1 + p)*sel + b*(sel - p*sel)) + mut*((c + b*(-1 + (-1 + g)*Ieself))*mut*(-1 + p)*sel + n*(1 - 2*mut + 3*c*sel - 2*c*mut*sel - b*(-3 + Ieself + g*(2 + Ieself*(-1 + mut) - mut) + mut - Ieself*mut)*(-1 + p)*sel - 3*c*p*sel + 2*c*mut*p*sel) + Power(n,2)*(mut + c*(-1 + mut + p - mut*p)*sel)) + m*(-(mut*(2*c*(-1 + mut) + b*(2 - Ieself - 2*mut + g*(-2 + Ieself + mut)))*(-1 + p)*sel) + n*(-((-1 + mut)*(-1 + c*(-1 + p)*sel)) + b*(sel - p*sel))) + Idself*(-1 + m)*(mut*(1 - mut + b*(3 - Ieself - 2*mut + g*(-2 + Ieself + mut))*(-1 + p)*sel + c*(-3 + 2*mut + n)*(-1 + p)*sel) + m*(-1 + mut)*(1 - mut + b*(-1 + p)*sel + c*(sel - p*sel))))))/(d*(Power(m,2)*Power(-1 + mut,2) - Idself*(-1 + m)*(-1 + mut)*(m*(-1 + mut) + mut - d*mut) - (-1 + d)*mut*(1 + mut*(-2 + n))*n + m*(-1 + mut)*(1 + d*mut*(-2 + n))*n)))
}

pDB  <- function(b, c, p, sel, mut, m, g, n, d, Idself, Ieself){
## Arguments:
#  b   benefit of interaction
#  c   cost of interaction
#  p   mutation bias
#  sel intensity of selection
#  mut mutation probability
#  m   emigration probability
#  g   proportion of interactions out of the group (interaction equivalent of m)
#  n   deme size
#  d   number of demes
#  Idself whether reproduction in site where the parent is
#  Ieself whether interactions with oneself
return(
(p*((-1 + n)*Power(n - d*n,3)*(-(Power(m,2)*Power(-1 + mut,2)) + Idself*(-1 + m)*(-1 + mut)*(m*(-1 + mut) + mut - d*mut) + (-1 + d)*mut*(1 + mut*(-2 + n))*n - m*(-1 + mut)*(1 + d*mut*(-2 + n))*n) + Power(-1 + d,2)*(-1 + mut)*Power(n,3)*(c*(-1 + d)*(-1 + n)*(-(Power(Idself,2)*Power(-1 + m,2)*(d*(m*(-1 + mut) - mut) + mut)) + Idself*(-1 + m)*(d*Power(m,2)*(-1 + mut) + 2*(-1 + d)*mut + m*(2 - 2*d*mut)) - (-1 + d)*mut*(-2 + n)*n + Power(m,2)*(-2 + mut + d*n) + m*n*(2 + d*(-2*mut + (-1 + mut)*n))) + b*(2*Power(m,2) - 2*d*Power(m,2) - 2*d*Ieself*Power(m,2) + 2*Power(d,2)*Ieself*Power(m,2) + 2*d*g*Ieself*Power(m,2) - 2*Power(d,2)*g*Ieself*Power(m,2) + d*g*Power(m,3) + d*Ieself*Power(m,3) - Power(d,2)*Ieself*Power(m,3) - d*g*Ieself*Power(m,3) + Power(d,2)*g*Ieself*Power(m,3) + 2*g*m*mut - 2*d*g*m*mut + 2*Ieself*m*mut - 4*d*Ieself*m*mut + 2*Power(d,2)*Ieself*m*mut - 2*g*Ieself*m*mut + 4*d*g*Ieself*m*mut - 2*Power(d,2)*g*Ieself*m*mut - Power(m,2)*mut + d*Power(m,2)*mut - g*Power(m,2)*mut + 2*d*g*Power(m,2)*mut - Ieself*Power(m,2)*mut + 4*d*Ieself*Power(m,2)*mut - 3*Power(d,2)*Ieself*Power(m,2)*mut + g*Ieself*Power(m,2)*mut - 4*d*g*Ieself*Power(m,2)*mut + 3*Power(d,2)*g*Ieself*Power(m,2)*mut - d*g*Power(m,3)*mut - d*Ieself*Power(m,3)*mut + Power(d,2)*Ieself*Power(m,3)*mut + d*g*Ieself*Power(m,3)*mut - Power(d,2)*g*Ieself*Power(m,3)*mut - (-1 + d)*(-1 + g)*Power(Idself,2)*(-1 + Ieself)*Power(-1 + m,2)*(d*(m*(-1 + mut) - mut) + mut) - 2*m*n + 2*d*m*n + 2*d*Ieself*m*n - 2*Power(d,2)*Ieself*m*n - 2*d*g*Ieself*m*n + 2*Power(d,2)*g*Ieself*m*n - 2*Power(m,2)*n + 3*d*Power(m,2)*n - Power(d,2)*Power(m,2)*n - 2*d*g*Power(m,2)*n + Power(d,2)*g*Power(m,2)*n - d*Power(m,3)*n + Power(d,2)*Power(m,3)*n - Power(d,2)*g*Power(m,3)*n + 2*mut*n - 4*d*mut*n + 2*Power(d,2)*mut*n - 2*g*mut*n + 4*d*g*mut*n - 2*Power(d,2)*g*mut*n - 2*Ieself*mut*n + 4*d*Ieself*mut*n - 2*Power(d,2)*Ieself*mut*n + 2*g*Ieself*mut*n - 4*d*g*Ieself*mut*n + 2*Power(d,2)*g*Ieself*mut*n - 2*m*mut*n + 6*d*m*mut*n - 4*Power(d,2)*m*mut*n - 4*d*g*m*mut*n + 4*Power(d,2)*g*m*mut*n - 2*d*Ieself*m*mut*n + 2*Power(d,2)*Ieself*m*mut*n + 2*d*g*Ieself*m*mut*n - 2*Power(d,2)*g*Ieself*m*mut*n + 2*Power(m,2)*mut*n - 5*d*Power(m,2)*mut*n + 3*Power(d,2)*Power(m,2)*mut*n + 2*d*g*Power(m,2)*mut*n - 3*Power(d,2)*g*Power(m,2)*mut*n + d*Power(m,3)*mut*n - Power(d,2)*Power(m,3)*mut*n + Power(d,2)*g*Power(m,3)*mut*n + 2*m*Power(n,2) - 3*d*m*Power(n,2) + Power(d,2)*m*Power(n,2) + d*g*m*Power(n,2) - Power(d,2)*g*m*Power(n,2) - d*Ieself*m*Power(n,2) + Power(d,2)*Ieself*m*Power(n,2) + d*g*Ieself*m*Power(n,2) - Power(d,2)*g*Ieself*m*Power(n,2) + d*Power(m,2)*Power(n,2) - Power(d,2)*Power(m,2)*Power(n,2) + Power(d,2)*g*Power(m,2)*Power(n,2) - mut*Power(n,2) + 2*d*mut*Power(n,2) - Power(d,2)*mut*Power(n,2) + g*mut*Power(n,2) - 2*d*g*mut*Power(n,2) + Power(d,2)*g*mut*Power(n,2) + Ieself*mut*Power(n,2) - 2*d*Ieself*mut*Power(n,2) + Power(d,2)*Ieself*mut*Power(n,2) - g*Ieself*mut*Power(n,2) + 2*d*g*Ieself*mut*Power(n,2) - Power(d,2)*g*Ieself*mut*Power(n,2) - d*m*mut*Power(n,2) + Power(d,2)*m*mut*Power(n,2) + d*g*m*mut*Power(n,2) - Power(d,2)*g*m*mut*Power(n,2) + d*Ieself*m*mut*Power(n,2) - Power(d,2)*Ieself*m*mut*Power(n,2) - d*g*Ieself*m*mut*Power(n,2) + Power(d,2)*g*Ieself*m*mut*Power(n,2) + Idself*(-1 + m)*(2*Power(-1 + d,2)*(-1 + g)*(-1 + Ieself)*mut + d*Power(m,2)*(-1 + mut)*(-1 - 2*g*(-1 + Ieself) + 2*Ieself + d*(-1 + g)*(-1 + 2*Ieself - n) - n) - 2*(-1 + d)*m*(-1 + g*mut + Ieself*mut - g*Ieself*mut + n - mut*n - d*(-1 + g)*(Ieself + mut - 2*Ieself*mut + (-1 + mut)*n)))))*(1 - p)*sel))/((-1 + n)*Power(n - d*n,3)*(-(Power(m,2)*Power(-1 + mut,2)) + Idself*(-1 + m)*(-1 + mut)*(m*(-1 + mut) + mut - d*mut) + (-1 + d)*mut*(1 + mut*(-2 + n))*n - m*(-1 + mut)*(1 + d*mut*(-2 + n))*n)))
}

pWF  <- function(b, c, p, sel, mut, m, g, n, d, Idself, Ieself){
## Arguments:
#  b   benefit of interaction
#  c   cost of interaction
#  p   mutation bias
#  sel intensity of selection
#  mut mutation probability
#  m   emigration probability
#  g   proportion of interactions out of the group (interaction equivalent of m)
#  n   deme size
#  d   number of demes
#  Idself whether reproduction in site where the parent is
#  Ieself whether interactions with oneself
return(
p + ((-(c*(1 - mut - (1 - mut)*(-(((2 + d*(-2 + m))*m*(-(1/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2))) + 1/(2*mut - Power(mut,2))))/((-1 + d)*((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) + (d*(-1 + n))/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2))))) + (Power(Idself,2)*Power(-1 + m,2))/Power(n,2) + (Power(-1 + m,2)*Power(Idself - n,2))/((-1 + n)*Power(n,2)) + Power(m,2)/((-1 + d)*n) + (((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) - d/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2)))*(2*(-1 + d)*Idself*Power(-1 + m,2) - (-1 + d)*Power(Idself,2)*Power(-1 + m,2) + (-1 + d)*(-2 + n)*n - 2*(-1 + d)*m*(-2 + n)*n + Power(m,2)*(1 + d*(-2 + n)*n)))/((-1 + d)*((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) + (d*(-1 + n))/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2)))*(-1 + n)*n)))) + b*(1 - mut)*((g*(-(1/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2))) + 1/(2*mut - Power(mut,2))))/((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) + (d*(-1 + n))/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2))) - (Power(Idself - Idself*m,2)*((g*(-(1/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2))) + 1/(2*mut - Power(mut,2))))/((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) + (d*(-1 + n))/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2))) + (Ieself - g*Ieself)/n - ((1 - g)*((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) - d/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2)))*(Ieself - n))/(((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) + (d*(-1 + n))/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2)))*n)))/Power(n,2) + (Ieself - g*Ieself)/n - ((1 - g)*((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) - d/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2)))*(Ieself - n))/(((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) + (d*(-1 + n))/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2)))*n) - (Power(m,2)*((-1 + d - g)*(1 + (((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) - d/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2)))*(-1 + n))/((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) + (d*(-1 + n))/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2)))) + ((2 - 3*d + Power(d,2) + g)*(-(1/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2))) + 1/(2*mut - Power(mut,2)))*n)/((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) + (d*(-1 + n))/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2)))))/(Power(-1 + d,2)*n) - (2*Idself*(1 - m)*m*(((1 - g)*(-(1/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2))) + 1/(2*mut - Power(mut,2))))/((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) + (d*(-1 + n))/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2))) + (g*(1 + (((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) - d/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2)))*(-1 + n))/((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) + (d*(-1 + n))/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2))) + ((-2 + d)*(-(1/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2))) + 1/(2*mut - Power(mut,2)))*n)/((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) + (d*(-1 + n))/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2)))))/((-1 + d)*n)))/n - (Power(-1 + m,2)*Power(Idself - n,2)*((g*(-(1/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2))) + 1/(2*mut - Power(mut,2)))*(-1 + n))/((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) + (d*(-1 + n))/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2))) + (Ieself - g*Ieself)/n + ((1 - g)*Ieself*((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) - d/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2)))*(-2 + n))/(((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) + (d*(-1 + n))/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2)))*n) + ((1 - g)*(Ieself - n)*(-2 + n + (((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) - d/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2)))*(3 + (-3 + n)*n))/((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) + (d*(-1 + n))/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2)))))/(n - Power(n,2))))/((-1 + n)*Power(n,2)) + (2*(1 - m)*(Idself - n)*((m*(((-1 + d - g)*(-(1/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2))) + 1/(2*mut - Power(mut,2))))/((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) + (d*(-1 + n))/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2))) + g/n + (g*((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) - d/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2)))*(-1 + n))/(((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) + (d*(-1 + n))/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2)))*n)))/(-1 + d) + (Idself*(1 - m)*((g*(-(1/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2))) + 1/(2*mut - Power(mut,2))))/((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) + (d*(-1 + n))/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2))) + ((1 - g)*Ieself*((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) - d/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2))))/(((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) + (d*(-1 + n))/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2)))*n) + ((-1 + g)*(Ieself - n))/((-1 + n)*n) + ((1 - g)*((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) - d/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2)))*(Ieself - n)*(-2 + n))/(((-1 + d)/(1 - (Power(1 + d*(-1 + m),2)*Power(-1 + mut,2))/Power(-1 + d,2)) + 1/(2*mut - Power(mut,2)) + (d*(-1 + n))/(1 - (Power(-1 + Idself,2)*Power(-1 + m,2)*Power(-1 + mut,2))/Power(-1 + n,2)))*(n - Power(n,2)))))/n))/n))*(1 - p)*p*sel)/mut)
}