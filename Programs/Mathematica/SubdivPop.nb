(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    228192,       7118]
NotebookOptionsPosition[    213316,       6619]
NotebookOutlinePosition[    213655,       6634]
CellTagsIndexPosition[    213612,       6631]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"Evaluate", "[", 
   RowBox[{
    RowBox[{"Context", "[", "]"}], "<>", "\"\<*\>\""}], "]"}], "]"}]], "Input",\

 CellChangeTimes->{{3.699768620256393*^9, 3.69976863906523*^9}}],

Cell[CellGroupData[{

Cell["IDB - Finding Q", "Title",
 CellChangeTimes->{{3.6997615711578712`*^9, 3.6997615782063017`*^9}}],

Cell[CellGroupData[{

Cell["Generic", "Section",
 CellChangeTimes->{{3.699707400698104*^9, 3.699707402905987*^9}}],

Cell[CellGroupData[{

Cell["Functions", "Subsection",
 CellChangeTimes->{{3.69976195851033*^9, 3.6997619606822844`*^9}}],

Cell["Function to turn P into Q", "Text",
 CellChangeTimes->{{3.699761638267042*^9, 3.699761643190976*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PtoQ", "[", "P_", "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"P", "-", 
      SuperscriptBox["p", "2"]}], 
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}]}]], "//", "FullSimplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6997074055269413`*^9, 3.699707418282507*^9}}],

Cell["Delta function", "Text",
 CellChangeTimes->{{3.699761981659233*^9, 3.699761983664853*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Delta", "[", "x_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"x", "\[Equal]", "0"}], ",", "1", ",", "0"}], "]"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Define graphs", "Subsection",
 CellChangeTimes->{{3.668999943448367*^9, 3.668999951062648*^9}, {
  3.669090333143214*^9, 3.6690903447306433`*^9}, {3.6690903789232073`*^9, 
  3.6690903841955957`*^9}, {3.6702349799301558`*^9, 3.670234987354018*^9}, {
  3.699761597799471*^9, 3.699761603112997*^9}}],

Cell[CellGroupData[{

Cell["Island model, dispersal graph with self replacement", "Subsubsection",
 CellChangeTimes->{{3.6702357682102127`*^9, 3.6702357769730186`*^9}, {
  3.6997616053042727`*^9, 3.699761610197031*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"G12IM", "=", 
   RowBox[{"(", GridBox[{
      {
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"]}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nin", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ndemes", "=", "4"}], ";"}]}], "Input",
 CellChangeTimes->{{3.668999966108613*^9, 3.668999984048553*^9}, {
  3.669000027438491*^9, 3.669000197449211*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Island model, dispersal graph without self replacement", "Subsubsection",
 CellChangeTimes->{{3.699710891317618*^9, 3.69971090161314*^9}, {
  3.699761612495682*^9, 3.6997616135675087`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"G12IMnoself", "=", 
   RowBox[{"(", GridBox[{
      {"0", 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], "0", 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], "0", 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], "0", 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], "0", 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], "0", 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], "0", 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], "0", 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], "0", 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], "0", 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], "0", 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], "0"}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.668999966108613*^9, 3.668999984048553*^9}, {
  3.669000027438491*^9, 3.669000197449211*^9}, {3.699710904345536*^9, 
  3.699710932759603*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Island model, dispersal graph, generic", "Subsubsection",
 CellChangeTimes->{{3.6702357682102127`*^9, 3.6702357769730186`*^9}, {
  3.6997616053042727`*^9, 3.699761610197031*^9}, {3.699779221556974*^9, 
  3.6997792225091047`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"G12IMgeneric", "=", 
   RowBox[{"(", GridBox[{
      {"dself", "din", "din", "dout", "dout", "dout", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"din", "dself", "din", "dout", "dout", "dout", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"din", "din", "dself", "dout", "dout", "dout", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "dself", "din", "din", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "din", "dself", "din", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "din", "din", "dself", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "dself", "din", "din", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "din", "dself", "din", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "din", "din", "dself", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout",
        "dself", "din", "din"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout",
        "din", "dself", "din"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout",
        "din", "din", "dself"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nin", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ndemes", "=", "4"}], ";"}]}], "Input",
 CellChangeTimes->{{3.668999966108613*^9, 3.668999984048553*^9}, {
  3.669000027438491*^9, 3.669000197449211*^9}, {3.699779227001737*^9, 
  3.699779365815967*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Island model, interaction graph : only within demes, with self interactions\
\>", "Subsubsection",
 CellChangeTimes->{{3.6702357682102127`*^9, 3.670235798983179*^9}, {
  3.6793921183521442`*^9, 3.679392124586197*^9}, {3.6997619962380238`*^9, 
  3.699761996587916*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GEIM", "=", 
   RowBox[{"(", GridBox[{
      {
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
      {
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
      {
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"]},
      {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"]},
      {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"]}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.669006462140751*^9, 3.6690065637333603`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Island model, interaction graph without self interactions", \
"Subsubsection",
 CellChangeTimes->{{3.699761622641583*^9, 3.699761631727844*^9}, {
  3.699762000382402*^9, 3.699762003637082*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GEIMnoself", "=", 
   RowBox[{"(", GridBox[{
      {"0", 
       FractionBox["1", "2"], 
       FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
      {
       FractionBox["1", "2"], "0", 
       FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
      {
       FractionBox["1", "2"], 
       FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
       "0"},
      {"0", "0", "0", "0", 
       FractionBox["1", "2"], 
       FractionBox["1", "2"], "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", 
       FractionBox["1", "2"], "0", 
       FractionBox["1", "2"], "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", 
       FractionBox["1", "2"], 
       FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", "0", 
       FractionBox["1", "2"], 
       FractionBox["1", "2"], "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", 
       FractionBox["1", "2"], "0", 
       FractionBox["1", "2"], "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", 
       FractionBox["1", "2"], 
       FractionBox["1", "2"], "0", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
       FractionBox["1", "2"], 
       FractionBox["1", "2"]},
      {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
       FractionBox["1", "2"], "0", 
       FractionBox["1", "2"]},
      {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
       FractionBox["1", "2"], 
       FractionBox["1", "2"], "0"}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.679392136687027*^9, 3.679392176855454*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Island model, interaction graph, generic", "Subsubsection",
 CellChangeTimes->{{3.699761622641583*^9, 3.699761631727844*^9}, {
  3.699762000382402*^9, 3.699762003637082*^9}, {3.6997793522666693`*^9, 
  3.699779354892267*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GE12IMgeneric", "=", 
   RowBox[{"(", GridBox[{
      {"eself", "ein", "ein", "eout", "eout", "eout", "eout", "eout", "eout", 
       "eout", "eout", "eout"},
      {"ein", "eself", "ein", "eout", "eout", "eout", "eout", "eout", "eout", 
       "eout", "eout", "eout"},
      {"ein", "ein", "eself", "eout", "eout", "eout", "eout", "eout", "eout", 
       "eout", "eout", "eout"},
      {"eout", "eout", "eout", "eself", "ein", "ein", "eout", "eout", "eout", 
       "eout", "eout", "eout"},
      {"eout", "eout", "eout", "ein", "eself", "ein", "eout", "eout", "eout", 
       "eout", "eout", "eout"},
      {"eout", "eout", "eout", "ein", "ein", "eself", "eout", "eout", "eout", 
       "eout", "eout", "eout"},
      {"eout", "eout", "eout", "eout", "eout", "eout", "eself", "ein", "ein", 
       "eout", "eout", "eout"},
      {"eout", "eout", "eout", "eout", "eout", "eout", "ein", "eself", "ein", 
       "eout", "eout", "eout"},
      {"eout", "eout", "eout", "eout", "eout", "eout", "ein", "ein", "eself", 
       "eout", "eout", "eout"},
      {"eout", "eout", "eout", "eout", "eout", "eout", "eout", "eout", "eout",
        "eself", "ein", "ein"},
      {"eout", "eout", "eout", "eout", "eout", "eout", "eout", "eout", "eout",
        "ein", "eself", "ein"},
      {"eout", "eout", "eout", "eout", "eout", "eout", "eout", "eout", "eout",
        "ein", "ein", "eself"}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.679392136687027*^9, 3.679392176855454*^9}, {
  3.699779361234367*^9, 3.699779471181334*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generic Q matrix", "Subsubsection",
 CellChangeTimes->{{3.699780083079438*^9, 3.699780089064321*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q12generic", "=", 
   RowBox[{"(", GridBox[{
      {"1", "Qin", "Qin", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qin", "1", "Qin", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qin", "Qin", "1", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "1", "Qin", "Qin", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qin", "1", "Qin", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qin", "Qin", "1", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "1", "Qin", "Qin", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "1", "Qin", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "Qin", "1", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout",
        "1", "Qin", "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout",
        "Qin", "1", "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout",
        "Qin", "Qin", "1"}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699780094260882*^9, 3.699780213049553*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Other", "Subsection",
 CellChangeTimes->{{3.699792101147925*^9, 3.699792103187426*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"G10generic", "=", 
   RowBox[{"(", GridBox[{
      {"dself", "din", "din", "din", "din", "dout", "dout", "dout", "dout", 
       "dout"},
      {"din", "dself", "din", "din", "din", "dout", "dout", "dout", "dout", 
       "dout"},
      {"din", "din", "dself", "din", "din", "dout", "dout", "dout", "dout", 
       "dout"},
      {"din", "din", "din", "dself", "din", "dout", "dout", "dout", "dout", 
       "dout"},
      {"din", "din", "din", "din", "dself", "dout", "dout", "dout", "dout", 
       "dout"},
      {"dout", "dout", "dout", "dout", "dout", "dself", "din", "din", "din", 
       "din"},
      {"dout", "dout", "dout", "dout", "dout", "din", "dself", "din", "din", 
       "din"},
      {"dout", "dout", "dout", "dout", "dout", "din", "din", "dself", "din", 
       "din"},
      {"dout", "dout", "dout", "dout", "dout", "din", "din", "din", "dself", 
       "din"},
      {"dout", "dout", "dout", "dout", "dout", "din", "din", "din", "din", 
       "dself"}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699791998945838*^9, 3.699792091903751*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q10generic", "=", 
   RowBox[{"(", GridBox[{
      {"1", "Qin", "Qin", "Qin", "Qin", "Qout", "Qout", "Qout", "Qout", 
       "Qout"},
      {"Qin", "1", "Qin", "Qin", "Qin", "Qout", "Qout", "Qout", "Qout", 
       "Qout"},
      {"Qin", "Qin", "1", "Qin", "Qin", "Qout", "Qout", "Qout", "Qout", 
       "Qout"},
      {"Qin", "Qin", "Qin", "1", "Qin", "Qout", "Qout", "Qout", "Qout", 
       "Qout"},
      {"Qin", "Qin", "Qin", "Qin", "1", "Qout", "Qout", "Qout", "Qout", 
       "Qout"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "1", "Qin", "Qin", "Qin", 
       "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "1", "Qin", "Qin", 
       "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "Qin", "1", "Qin", 
       "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "Qin", "Qin", "1", 
       "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "Qin", "Qin", "Qin", "1"}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6997921117034817`*^9, 3.699792160751687*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GE10generic", "=", 
   RowBox[{"G10generic", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dself", "\[Rule]", "eself"}], ",", 
      RowBox[{"dout", "\[Rule]", "eout"}], ",", 
      RowBox[{"din", "\[Rule]", "ein"}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699792170991769*^9, 3.699792193679142*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moran", "Section",
 CellChangeTimes->{{3.699707345527932*^9, 3.699707348878216*^9}}],

Cell[CellGroupData[{

Cell["Previous results", "Subsection",
 CellChangeTimes->{{3.699707476217271*^9, 3.6997074792828503`*^9}}],

Cell[CellGroupData[{

Cell["Calculations", "Subsubsection",
 CellChangeTimes->{{3.6997619291720753`*^9, 3.699761931802175*^9}}],

Cell["Formula", "Text",
 CellChangeTimes->{{3.66909044558764*^9, 3.669090448806027*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PIM", "[", 
   RowBox[{"r1_", ",", "r2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["CC", 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "\[Mu]"], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "m", "-", 
            FractionBox["m", 
             RowBox[{"d", "-", "1"}]]}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Delta", "[", "r2", "]"}], "d"}], "-", "1"}], ")"}]}], "+", 
      
      RowBox[{
       RowBox[{"Delta", "[", "r2", "]"}], "d", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Delta", "[", "r1", "]"}], "n"}], "-", "1"}], ")"}]}]}], 
     ")"}]}], "+", 
   SuperscriptBox["p", "2"]}]}]], "Input",
 CellChangeTimes->{{3.668998515980857*^9, 3.668998612353025*^9}, {
   3.668998700641614*^9, 3.668998703464724*^9}, 3.668999011355136*^9}],

Cell["Find the constant term", "Text",
 CellChangeTimes->{{3.668999868188258*^9, 3.668999872252976*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solCC", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PIM", "[", 
       RowBox[{"0", ",", "0"}], "]"}], "\[Equal]", "p"}], ",", "CC"}], "]"}], 
   "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.668998614920752*^9, 3.668998628272805*^9}, {
  3.6689987116668997`*^9, 3.6689987160583563`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"CC", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "d"}], " ", "m"}], "+", "\[Mu]", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
      
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}],
        "+", 
       RowBox[{"m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
         ")"}]}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.668998617190145*^9, 3.668998619755321*^9}, 
   3.668998716648732*^9, 3.668999018185816*^9, 3.669030137415769*^9, 
   3.669111530218768*^9, 3.669557858841135*^9, 3.6695623937620564`*^9, 
   3.669723661690803*^9, 3.670240163921278*^9, 3.670310041945553*^9, 
   3.67031894465689*^9, 3.6739641932458467`*^9, 3.6766971901224537`*^9, 
   3.67800615149545*^9, 3.67851170423204*^9, 3.6785209976638002`*^9, 
   3.679036300589634*^9, 3.6791426837986183`*^9, 3.6791961201747713`*^9, 
   3.6791961520649652`*^9, 3.679397534429119*^9, 3.679400653206706*^9, 
   3.679636666736599*^9, 3.679654001167485*^9, 3.679891741228135*^9, 
   3.699707374159047*^9, 3.699768643225999*^9, 3.699787642886128*^9}]
}, Open  ]],

Cell["Formula with explicit constant term", "Text",
 CellChangeTimes->{{3.669090454337757*^9, 3.669090464364923*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PPIM", "[", 
   RowBox[{"r1_", ",", "r2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"PIM", "[", 
    RowBox[{"r1", ",", "r2"}], "]"}], "/.", 
   RowBox[{
   "solCC", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}]}]], "Input",
 CellChangeTimes->{{3.668998728377359*^9, 3.66899874667542*^9}}],

Cell["Define Pin and Pout", "Text",
 CellChangeTimes->{{3.669090470381428*^9, 3.669090477716969*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"PPIM", "[", 
   RowBox[{"0", ",", "0"}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"PinM", "=", 
  RowBox[{
   RowBox[{"PPIM", "[", 
    RowBox[{"2", ",", "0"}], "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"PoutM", "=", 
  RowBox[{
   RowBox[{"PPIM", "[", 
    RowBox[{"2", ",", "1"}], "]"}], "//", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.668998751104868*^9, 3.668998786789109*^9}, {
  3.668999042576312*^9, 3.668999047138834*^9}, {3.66899989338525*^9, 
  3.6689998946412086`*^9}}],

Cell[BoxData["p"], "Output",
 CellChangeTimes->{3.699768643249238*^9, 3.699787642919997*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"n", " ", "p"}]}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"n", " ", "p"}]}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}], 
    ")"}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{3.699768643249238*^9, 3.699787643031554*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "p", " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
     "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "p", " ", "\[Mu]"}]}], 
       ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{3.699768643249238*^9, 3.699787643081633*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Results", "Subsubsection",
 CellChangeTimes->{{3.6997619291720753`*^9, 3.6997619380050793`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PinM", "=", 
   FractionBox[
    RowBox[{"p", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"n", " ", "p"}]}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
       RowBox[{"m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"n", " ", "p"}]}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}], 
      ")"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
     "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.699707431583239*^9, 3.699707448097393*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PoutM", "=", 
   FractionBox[
    RowBox[{"p", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "p", " ", "\[Mu]", 
        " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}],
        "+", 
       RowBox[{"m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "p", " ", 
           "\[Mu]"}]}], ")"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
     "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.69970744016848*^9, 3.699707446737241*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"QinM", "=", 
   RowBox[{
    RowBox[{"PtoQ", "[", "PinM", "]"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QoutM", "=", 
   RowBox[{
    RowBox[{"PtoQ", "[", "PoutM", "]"}], "//", "FullSimplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.699707453085848*^9, 3.6997074718086863`*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["New results", "Subsection",
 CellChangeTimes->{{3.699707491660097*^9, 3.699707495419426*^9}, {
  3.699761653527134*^9, 3.6997616578147993`*^9}}],

Cell[CellGroupData[{

Cell["Generic equations", "Subsubsection",
 CellChangeTimes->{{3.699707497377432*^9, 3.699707499684057*^9}, {
  3.699761661334985*^9, 3.699761663732913*^9}}],

Cell["\<\
Replacements for dispersal probabilities, depending on whether there is \
self-replacement or not\
\>", "Text",
 CellChangeTimes->{{3.6997616658203783`*^9, 3.699761687567214*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"noselfreplacement", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dself", "\[Rule]", "0"}], ",", 
     RowBox[{"din", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "m"}], 
       RowBox[{"n", "-", "1"}]]}], ",", 
     RowBox[{"dout", "\[Rule]", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"d", " ", "n"}], " ", "-", " ", "n"}]]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"withselfreplacement", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dself", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "m"}], "n"]}], ",", 
     RowBox[{"din", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "m"}], "n"]}], ",", 
     RowBox[{"dout", "\[Rule]", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"d", " ", "n"}], " ", "-", " ", "n"}]]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6997075039255657`*^9, 3.699707552648037*^9}}],

Cell["Generic equations for Q using the results on 2D graphs", "Text",
 CellChangeTimes->{{3.699761690705806*^9, 3.69976172794276*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QselfM2", "=", 
  RowBox[{
   FractionBox[
    RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
    RowBox[{"n", " ", "d"}]], 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "\[Mu]"], " ", "+", " ", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}]}], "+", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", "m", "-", 
           FractionBox["m", 
            RowBox[{"d", "-", "1"}]]}], ")"}]}]}]], 
      RowBox[{"(", 
       RowBox[{"d", "-", "1"}], ")"}]}], "+", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
      RowBox[{"(", 
       RowBox[{"d", "-", "1"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.699707557939262*^9, 3.69970763486366*^9}, {
  3.6997106026698093`*^9, 3.6997106056848392`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[Lambda]", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "din"}], "+", "dself"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Mu]"}], ")"}]}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "din"}], "+", "dself"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Mu]"}], ")"}]}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "m", "-", 
          FractionBox["m", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Mu]"}], ")"}]}]}]], "+", 
     FractionBox["1", "\[Mu]"]}], ")"}], " ", "\[Mu]"}], 
  RowBox[{"d", " ", "n"}]]], "Output",
 CellChangeTimes->{3.69970764026941*^9, 3.699710621307968*^9, 
  3.69976171187523*^9, 3.699768643470192*^9, 3.699787643154744*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"QinM2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "\[Mu]"], " ", "+", " ", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "m", "-", 
            FractionBox["m", 
             RowBox[{"d", "-", "1"}]]}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QoutM2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "\[Mu]"], " ", "+", " ", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "m", "-", 
            FractionBox["m", 
             RowBox[{"d", "-", "1"}]]}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}], "+", 
      FractionBox["1", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"dself", "-", "din"}], ")"}]}]}]]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.699707683180396*^9, 3.699707713960421*^9}, {
  3.699710614334208*^9, 3.699710618463037*^9}}],

Cell["Find \[Lambda] using Qself == 1", "Text",
 CellChangeTimes->{{3.6997617343192577`*^9, 3.699761741343073*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"the\[Lambda]M", "=", 
  RowBox[{
   RowBox[{"\[Lambda]", "/.", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"QselfM2", "\[Equal]", "1"}], ",", "\[Lambda]"}], "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699707717272316*^9, 3.699707738311771*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"n", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "din", "+", 
      RowBox[{"dself", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
      RowBox[{"din", " ", "\[Mu]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "d"}], " ", "m"}], "+", "\[Mu]", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "din", "-", "dself", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "din"}], "+", "dself", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
        "\[Mu]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "dself", "+", 
       RowBox[{"din", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"dself", "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.69970772408389*^9, 3.699707738698215*^9}, 
   3.699710621593836*^9, 3.6997686437904377`*^9, 3.699787643568434*^9}]
}, Open  ]],

Cell["Replace \[Lambda] in the equations for Qin and Qout", "Text",
 CellChangeTimes->{{3.699761747312605*^9, 3.699761756389374*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QinM3", "=", 
  RowBox[{
   RowBox[{"QinM2", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", " ", "the\[Lambda]M"}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"QoutM3", "=", 
  RowBox[{
   RowBox[{"QoutM2", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", " ", "the\[Lambda]M"}]}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.6997077421873693`*^9, 3.699707784984331*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "din", "-", "dself"}], ")"}], " ", "\[Mu]"}], "+", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "din", "-", "dself", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d", "+", "din", "-", "dself"}], ")"}], " ", "\[Mu]"}]}], 
        ")"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "din", "-", "dself", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "din"}], "+", "dself", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
        "\[Mu]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "dself", "+", 
       RowBox[{"din", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"dself", "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.6997077647180653`*^9, 3.6997077855738363`*^9}, 
   3.699710621747601*^9, 3.699768643934836*^9, 3.699787643727768*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "din", "+", 
      RowBox[{"dself", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
      RowBox[{"din", " ", "\[Mu]"}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "din", "-", "dself", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "din"}], "+", "dself", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
        "\[Mu]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "dself", "+", 
       RowBox[{"din", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"dself", "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.6997077647180653`*^9, 3.6997077855738363`*^9}, 
   3.699710621747601*^9, 3.699768643934836*^9, 3.6997876437998753`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations with self replacement", "Subsubsection",
 CellChangeTimes->{{3.699707797145195*^9, 3.699707800750886*^9}, {
  3.699761769703529*^9, 3.699761771556242*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QinMs", "=", 
  RowBox[{
   RowBox[{"QinM3", "/.", "withselfreplacement"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"QoutMs", "=", 
  RowBox[{
   RowBox[{"QoutM3", "/.", "withselfreplacement"}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.699707806640571*^9, 3.699707829687098*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Mu]", "-", 
      RowBox[{"d", " ", "\[Mu]"}], "+", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}]}], ")"}]}], 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
    "+", 
    RowBox[{"m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
      ")"}]}]}]]}]], "Output",
 CellChangeTimes->{{3.699707822487941*^9, 3.6997078300797243`*^9}, 
   3.699710623036839*^9, 3.699711328310384*^9, 3.699768644054297*^9, 
   3.6997876439009438`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.699707822487941*^9, 3.6997078300797243`*^9}, 
   3.699710623036839*^9, 3.699711328310384*^9, 3.699768644054297*^9, 
   3.69978764390203*^9}]
}, Open  ]],

Cell["\<\
Simplify the way the equations are written (human - firendly versions)\
\>", "Text",
 CellChangeTimes->{{3.699761775008071*^9, 3.69976179237366*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QinMs", "-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", "\[Mu]", 
        RowBox[{"(", 
         RowBox[{"1", "-", "m"}], ")"}]}], "-", "\[Mu]", "+", "m"}], " ", 
      ")"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d", "-", "1"}], ")"}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}]]}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6997113031664057`*^9, 3.699711312567246*^9}, {
  3.699711368217142*^9, 3.69971148194987*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699711306964435*^9, 3.699711330449128*^9}, {
   3.699711405295108*^9, 3.699711501403634*^9}, 3.699768644077819*^9, 
   3.699787643923314*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QoutMs", "-", 
   FractionBox[
    RowBox[{"m", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Mu]"}], ")"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d", "-", "1"}], ")"}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}]]}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.69971150684383*^9, 3.699711545927258*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699711511809864*^9, 3.699711546280471*^9}, 
   3.699768644102571*^9, 3.6997876439352217`*^9}]
}, Open  ]],

Cell["Check that this is the same as previously found", "Text",
 CellChangeTimes->{{3.6997106515492773`*^9, 3.699710655871216*^9}, {
  3.6997617967342*^9, 3.699761797372596*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QinMs", "-", "QinM"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699710636543291*^9, 3.699710639824566*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.6997106401846457`*^9, 3.699768644106393*^9, 
  3.699787643963718*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QoutMs", "-", "QoutM"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699710636543291*^9, 3.699710647275017*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.699710647693612*^9, 3.699768644128989*^9, 
  3.699787643990034*^9}]
}, Open  ]],

Cell["Check limit behaviour", "Text",
 CellChangeTimes->{{3.699761804937606*^9, 3.699761810525722*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QoutMs", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699708994901635*^9, 3.699709018760296*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6997090038532143`*^9, 3.699709012966531*^9}, 
   3.699710624218858*^9, 3.69976864421404*^9, 3.699787644053496*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QinMs", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.699709024470386*^9, 3.699709032489929*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "1"}], "+", "m", "+", "\[Mu]", "-", 
   RowBox[{"m", " ", "\[Mu]"}]}], 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
   RowBox[{"n", " ", "\[Mu]"}]}]]], "Output",
 CellChangeTimes->{{3.6997090210092278`*^9, 3.69970903277978*^9}, 
   3.69971062653979*^9, 3.6997686442727537`*^9, 3.6997876441319523`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "-", "m"}], 
  RowBox[{"1", "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.6997090210092278`*^9, 3.69970903277978*^9}, 
   3.69971062653979*^9, 3.6997686442727537`*^9, 3.699787644144854*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QinMs", ",", 
    RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699709434403644*^9, 3.6997094359320993`*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.6997094362553997`*^9, 3.69971062819491*^9, 
  3.699768644316224*^9, 3.699787644191502*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{"QinMs", ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.699709522250888*^9, 3.6997095278721046`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "-", 
   RowBox[{"d", " ", "n", " ", "\[Mu]"}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
    SeriesData[$CellContext`\[Mu], 0, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Mu], 0, {1, -$CellContext`d $CellContext`n}, 0, 2,
    1],
  Editable->False]], "Output",
 CellChangeTimes->{3.699709528137528*^9, 3.699710628816844*^9, 
  3.699768644340559*^9, 3.6997876442139177`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations without Self - replacement", "Subsubsection",
 CellChangeTimes->{{3.699711579833871*^9, 3.699711584927043*^9}, {
  3.699761821670733*^9, 3.699761827557994*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QinMw", "=", 
  RowBox[{
   RowBox[{"QinM3", "/.", "noselfreplacement"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"QoutMw", "=", 
  RowBox[{
   RowBox[{"QoutM3", "/.", "noselfreplacement"}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.699711592836095*^9, 3.699711601325761*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["m", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]"}], "+", 
     
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{"n", "-", 
        RowBox[{"d", " ", "n", " ", "\[Mu]"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["m", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   RowBox[{"m", " ", "n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{3.6997116019468412`*^9, 3.699768644533671*^9, 
  3.699787644417185*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{"n", "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", "\[Mu]"}], ")"}], 
   " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["m", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   RowBox[{"m", " ", "n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{3.6997116019468412`*^9, 3.699768644533671*^9, 
  3.699787644439809*^9}]
}, Open  ]],

Cell["Simplify the way they are written", "Text",
 CellChangeTimes->{{3.699761833396513*^9, 3.6997618399413424`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QinMw", "-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", "n", " ", "\[Mu]", 
        RowBox[{"(", 
         RowBox[{"1", "-", "m"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "\[Mu]"}], ")"}], " ", "n"}], "-", 
       RowBox[{
        SuperscriptBox["m", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Mu]"}], ")"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"+", 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}], " ", "n", " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "2"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
     RowBox[{"m", " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"n", "-", "2"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["m", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]}]]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699711609067724*^9, 3.699711686309361*^9}, {
  3.699711723919117*^9, 3.699711751542611*^9}, {3.699711797895731*^9, 
  3.699711864734956*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.699711686662211*^9, 3.699711751870494*^9, {3.699711816592347*^9, 
   3.699711865845346*^9}, 3.699768644600362*^9, 3.699787644466792*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QoutMw", "-", 
   FractionBox[
    RowBox[{"m", " ", 
     RowBox[{"(", 
      RowBox[{"n", "+", 
       RowBox[{"m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", "\[Mu]"}], ")"}], 
     " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Mu]"}], ")"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"+", 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}], " ", "n", " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "2"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
     RowBox[{"m", " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"n", "-", "2"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["m", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]}]]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699711882991263*^9, 3.6997119306666183`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699711887715342*^9, 3.699711931186315*^9}, 
   3.6997119658647413`*^9, 3.6997686446717653`*^9, 3.699787644491955*^9}]
}, Open  ]],

Cell["Limit behavior", "Text",
 CellChangeTimes->{{3.699761843004692*^9, 3.699761846775701*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QinMw", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699712140320222*^9, 3.699712144381168*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "1"}], "+", "m", "+", "\[Mu]", "-", 
   RowBox[{"m", " ", "\[Mu]"}]}], 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}]]], "Output",
 CellChangeTimes->{{3.699712141760172*^9, 3.6997121446551123`*^9}, 
   3.69976864475666*^9, 3.6997876445813713`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{"QoutMw", ",", 
   RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.699712130826983*^9, 3.699712135993896*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.699712136340899*^9, 3.6997686447847843`*^9, 
  3.699787644605831*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerical version", "Subsection",
 CellChangeTimes->{{3.699709707187845*^9, 3.699709711187148*^9}}],

Cell[CellGroupData[{

Cell["Function to find Q numerically", "Subsubsection",
 CellChangeTimes->{{3.699761872538252*^9, 3.699761879638611*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NGetQM", "[", 
   RowBox[{"G_", ",", "\[CapitalNu]_", ",", "n_", ",", "p_", ",", "\[Mu]_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"QT", ",", "eqs", ",", "vars", ",", "sols", ",", "QTs"}], "}"}], 
    ",", 
    RowBox[{"(*", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", " ", "is", " ", "the", " ", "dispersal", " ", "graph"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
      "\[CapitalNu]", " ", "is", " ", "the", " ", "size", " ", "of", " ", 
       "the", " ", "population"}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "n", " ", "is", " ", "the", " ", "degree", " ", "of", " ", "the", " ", 
       "graph"}], ",", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "is", " ", "the", " ", "mutation", " ", "biais"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]", " ", "is", " ", "the", " ", "mutation", " ", 
       RowBox[{"probability", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Initialize", " ", "the", " ", "PT", " ", "matrix"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], "=", "0"}], ";", 
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], "=."}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"QT", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        SubscriptBox["Q", 
         RowBox[{"i", ",", "j"}]], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QT", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], "=", "1"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       SubscriptBox["Q", 
        RowBox[{"i", ",", "i"}]], "=", " ", "1"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QT", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
        SubscriptBox["Q", 
         RowBox[{"j", ",", "i"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"j", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Because", " ", "Q", " ", "is", " ", "symmetric"}], " ", "*)"}],
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["Q", 
           RowBox[{"i", ",", "j"}]], "\[Equal]", 
          RowBox[{
           FractionBox[
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Mu]"}], ")"}], 
            RowBox[{"2", " ", "n"}]], 
           RowBox[{"(", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"G", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "j"}], "\[RightDoubleBracket]"}], 
                RowBox[{"QT", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "i"}], "\[RightDoubleBracket]"}]}], "+", 
               RowBox[{
                RowBox[{"G", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "i"}], "\[RightDoubleBracket]"}], 
                RowBox[{"QT", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "j"}], "\[RightDoubleBracket]"}]}]}], ",", 
              
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
            ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sols", "=", 
      RowBox[{"NSolve", "[", 
       RowBox[{"eqs", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"QTs", "=", 
      RowBox[{"QT", "/.", 
       RowBox[{
       "sols", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", "QTs"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.665746344148189*^9, 3.665746357499515*^9}, {
  3.667629110150731*^9, 3.667629117546748*^9}, {3.667629254770275*^9, 
  3.667629258225225*^9}, {3.667630603278612*^9, 3.667630605327855*^9}, {
  3.6676306528447523`*^9, 3.6676306545659657`*^9}, {3.69970971562999*^9, 
  3.6997097787966833`*^9}, {3.699709809338958*^9, 3.6997098138847713`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Parameters", "Subsubsection",
 CellChangeTimes->{{3.699761862474738*^9, 3.6997618659182568`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"them", "=", "0.3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thep", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"the\[Mu]", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"prms", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"d", "\[Rule]", "4"}], ",", 
    RowBox[{"n", "\[Rule]", "3"}], ",", 
    RowBox[{"p", "\[Rule]", "thep"}], ",", 
    RowBox[{"\[Mu]", "\[Rule]", "the\[Mu]"}], ",", 
    RowBox[{"m", "\[Rule]", "them"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.699709863130365*^9, 3.699709902352488*^9}, {
   3.699709935026679*^9, 3.699710076151829*^9}, {3.699710952534171*^9, 
   3.6997109529524317`*^9}, 3.699761882452038*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"d", "\[Rule]", "4"}], ",", 
   RowBox[{"n", "\[Rule]", "3"}], ",", 
   RowBox[{"p", "\[Rule]", "0.2`"}], ",", 
   RowBox[{"\[Mu]", "\[Rule]", "0.1`"}], ",", 
   RowBox[{"m", "\[Rule]", "0.3`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.699768644813479*^9, 3.6997876446363173`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["With self replacement", "Subsubsection",
 CellChangeTimes->{{3.699761886293581*^9, 3.699761892242996*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q12M", "=", 
   RowBox[{"NGetQM", "[", 
    RowBox[{
     RowBox[{"G12IM", "/.", 
      RowBox[{"m", "\[Rule]", "them"}]}], ",", "12", ",", "1", ",", "thep", 
     ",", "the\[Mu]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Q12inM", "=", 
  RowBox[{"Q12M", "\[LeftDoubleBracket]", 
   RowBox[{"1", ",", "2"}], 
   "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QinM3", "/.", "withselfreplacement"}], "/.", 
  "prms"}], "\[IndentingNewLine]", 
 RowBox[{"QinM", "/.", "prms"}]}], "Input",
 CellChangeTimes->{{3.699709863130365*^9, 3.699709902352488*^9}, {
   3.699709935026679*^9, 3.699710076151829*^9}, {3.699710952534171*^9, 
   3.6997109529524317`*^9}, 3.699761882452038*^9}],

Cell[BoxData["0.5106382978723403`"], "Output",
 CellChangeTimes->{{3.699710014756632*^9, 3.6997100201625223`*^9}, {
   3.6997100524247713`*^9, 3.699710076554229*^9}, 3.69971095384976*^9, 
   3.699768644889846*^9, 3.6997876446821623`*^9}],

Cell[BoxData["0.5106382978723405`"], "Output",
 CellChangeTimes->{{3.699710014756632*^9, 3.6997100201625223`*^9}, {
   3.6997100524247713`*^9, 3.699710076554229*^9}, 3.69971095384976*^9, 
   3.699768644889846*^9, 3.6997876446832933`*^9}],

Cell[BoxData["0.5106382978723405`"], "Output",
 CellChangeTimes->{{3.699710014756632*^9, 3.6997100201625223`*^9}, {
   3.6997100524247713`*^9, 3.699710076554229*^9}, 3.69971095384976*^9, 
   3.699768644889846*^9, 3.699787644684388*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Without self replacement", "Subsubsection",
 CellChangeTimes->{{3.699761886293581*^9, 3.6997619005172367`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q12Mns", "=", 
   RowBox[{"NGetQM", "[", 
    RowBox[{
     RowBox[{"G12IMnoself", "/.", 
      RowBox[{"m", "\[Rule]", "them"}]}], ",", "12", ",", "1", ",", "thep", 
     ",", "the\[Mu]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Q12inMns", "=", 
  RowBox[{"Q12Mns", "\[LeftDoubleBracket]", 
   RowBox[{"1", ",", "2"}], 
   "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QinM3", "/.", "noselfreplacement"}], "/.", "prms"}]}], "Input",
 CellChangeTimes->{{3.699710966632681*^9, 3.6997109821283484`*^9}}],

Cell[BoxData["0.5963141728828432`"], "Output",
 CellChangeTimes->{3.69971098261451*^9, 3.699768644932221*^9, 
  3.699787644728093*^9}],

Cell[BoxData["0.5963141728828435`"], "Output",
 CellChangeTimes->{3.69971098261451*^9, 3.699768644932221*^9, 
  3.699787644729916*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wright - Fisher", "Section",
 CellChangeTimes->{{3.698755041677388*^9, 3.698755047045236*^9}}],

Cell[CellGroupData[{

Cell["Does not work", "Subsection",
 CellChangeTimes->{{3.699762046072733*^9, 3.699762048584957*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eQinWF", "=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "din", " ", "dself"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "2"}], ")"}], " ", 
        SuperscriptBox["din", "2"]}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[CapitalNu]", "-", "n"}], ")"}], " ", 
        SuperscriptBox["dout", "2"]}]}], ")"}], "+", 
     RowBox[{"(*", "\[IndentingNewLine]", "*)"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["dself", "2"], "+", 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{"n", "-", "2"}], ")"}], " ", "dself", " ", "din"}], " ", 
        "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["n", "2"], "-", 
           RowBox[{"3", "n"}], "+", "3"}], ")"}], " ", 
         SuperscriptBox["din", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[CapitalNu]", "-", "n"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], 
         SuperscriptBox["dout", "2"]}]}], ")"}], "Qin"}], "+", 
     RowBox[{"(*", "\[IndentingNewLine]", "*)"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[CapitalNu]", "-", "n"}], ")"}], "dout", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "dself"}], " ", "+", " ", 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], " ", "din"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[CapitalNu]", "-", 
           RowBox[{"2", "n"}]}], ")"}], " ", "dout"}]}], ")"}], "Qout"}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.698755051308588*^9, 3.698755185411098*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "din", " ", "dself"}], "+", 
    RowBox[{
     SuperscriptBox["din", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "n"}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["dout", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "n"}], "+", "\[CapitalNu]"}], ")"}]}], "+", 
    RowBox[{"dout", " ", "Qout", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "n"}], "+", "\[CapitalNu]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "dself"}], "+", 
       RowBox[{"2", " ", "din", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
       RowBox[{"dout", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "n"}], "+", "\[CapitalNu]"}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{"Qin", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["dself", "2"], "+", 
       RowBox[{"2", " ", "din", " ", "dself", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "n"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["din", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{"3", " ", "n"}], "+", 
          SuperscriptBox["n", "2"]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["dout", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "n"}], "+", "\[CapitalNu]"}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.698755188454566*^9, 3.699768644969303*^9, 
  3.69978764475106*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eQoutWF", "=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "dself", " ", "dout"}], " ", "+", " ", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "din", " ", "dout"}], " ", "+", " ", 
       
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[CapitalNu]", "-", 
          RowBox[{"2", "n"}]}], ")"}], 
        SuperscriptBox["dout", "2"]}]}], ")"}], "+", 
     RowBox[{"(*", "\[IndentingNewLine]", "*)"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], " ", "dself", " ", "dout"}], " ", 
        "+", " ", 
        RowBox[{"2", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "2"], "din", " ", "dout"}], " ", 
        "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[CapitalNu]", "-", 
           RowBox[{"2", "n"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], 
         SuperscriptBox["dout", "2"]}]}], ")"}], "Qin"}], "+", 
     RowBox[{"(*", "\[IndentingNewLine]", "*)"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["dself", "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], "dself", " ", "din"}], " ", "+", 
        " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[CapitalNu]", "-", 
           RowBox[{"2", "n"}]}], ")"}], "dself", " ", "dout"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], "din", 
         RowBox[{"(", 
          RowBox[{"dself", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}], "din"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[CapitalNu]", "-", 
              RowBox[{"2", "n"}]}], ")"}], "dout"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[CapitalNu]", "-", "n"}], ")"}], "dout", 
         RowBox[{"(", 
          RowBox[{"dself", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}], "din"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[CapitalNu]", "-", 
              RowBox[{"2", "n"}]}], ")"}], "dout"}]}], ")"}]}]}], ")"}], 
      "Qout"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.698755193348115*^9, 3.6987553463232613`*^9}, {
  3.6987554879948587`*^9, 3.6987554884111757`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "dout", " ", "dself"}], "+", 
    RowBox[{"2", " ", "din", " ", "dout", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["dout", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "n"}], "+", "\[CapitalNu]"}], ")"}]}], "+", 
    RowBox[{"Qin", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "dout", " ", "dself", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
       RowBox[{"2", " ", "din", " ", "dout", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox["dout", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "n"}], "+", "\[CapitalNu]"}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{"Qout", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["dself", "2"], "+", 
       RowBox[{"din", " ", "dself", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
       RowBox[{"dout", " ", "dself", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "n"}], "+", "\[CapitalNu]"}], ")"}]}], 
       "+", 
       RowBox[{"din", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"dself", "+", 
          RowBox[{"din", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
          RowBox[{"dout", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "n"}], "+", "\[CapitalNu]"}], 
            ")"}]}]}], ")"}]}], "+", 
       RowBox[{"dout", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "n"}], "+", "\[CapitalNu]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"dself", "+", 
          RowBox[{"din", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
          RowBox[{"dout", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "n"}], "+", "\[CapitalNu]"}], 
            ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.698755353263668*^9, 3.698755492527285*^9, 
  3.699768645069572*^9, 3.699787644772503*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sols", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Qin", "\[Equal]", "eQinWF"}], ",", " ", 
         RowBox[{"Qout", "\[Equal]", "eQoutWF"}]}], "}"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"dself", "\[Rule]", 
          FractionBox[
           RowBox[{"1", "-", "m"}], "n"]}], ",", 
         RowBox[{"din", "\[Rule]", 
          FractionBox[
           RowBox[{"1", "-", "m"}], "n"]}], ",", " ", 
         RowBox[{"dout", "\[Rule]", 
          FractionBox["m", 
           RowBox[{"\[CapitalNu]", "-", "n"}]]}]}], "}"}]}], "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", 
       RowBox[{"n", " ", "d"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"Qin", ",", "Qout"}], "}"}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.69875535996423*^9, 3.698755431691368*^9}, {
  3.6987554999604397`*^9, 3.698755500925955*^9}, {3.6987558404733562`*^9, 
  3.698755850078169*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Qin", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "d", " ", 
             SuperscriptBox["m", "3"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["m", "4"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}], ")"}], "3"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
             SuperscriptBox["m", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}],
               ")"}]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", "m", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"2", " ", "d"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}],
               ")"}]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"d", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
           
           SuperscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "4"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"m", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
            ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "m", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}], 
             "+", 
             RowBox[{"d", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "-", 
                RowBox[{"2", " ", "m", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
                RowBox[{
                 SuperscriptBox["m", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", 
                 "\[Mu]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], ",", 
    RowBox[{"Qout", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "m"}], ")"}]}]}], ")"}], " ", "m", " ", 
        
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "d", " ", 
         SuperscriptBox["m", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "4"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SuperscriptBox["m", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "4"]}], "-", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
         SuperscriptBox["m", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
          ")"}]}], "-", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
          ")"}]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", "m", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"2", " ", "d"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
          ")"}]}]}], ")"}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.69875542080507*^9, 3.698755438178865*^9}, {
   3.69875549505556*^9, 3.6987555018348503`*^9}, 3.698755863763846*^9, 
   3.6997686491133623`*^9, 3.6997876480398808`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sols", "/.", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6987555030723124`*^9, 3.698755516485056*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Qin", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "m"}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           RowBox[{"m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "4"}], "+", 
              RowBox[{"3", " ", "m"}]}], ")"}]}], "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "m"}]}], 
             ")"}]}]}], ")"}]}]}], 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{"m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "4"}], "+", 
              RowBox[{"3", " ", "m"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"2", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}]]}]}], ",", 
    RowBox[{"Qout", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "m"}], ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "4"}], "+", 
             RowBox[{"3", " ", "m"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"2", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}]]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.698755513214713*^9, 3.69875551736067*^9}, 
   3.699768649260591*^9, 3.6997876482684593`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Previous version", "Subsection",
 CellChangeTimes->{{3.698755690202565*^9, 3.698755693965942*^9}}],

Cell[CellGroupData[{

Cell["Results", "Subsubsection",
 CellChangeTimes->{{3.699762061290184*^9, 3.6997620631445427`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PinWF", "=", 
   RowBox[{"p", " ", 
    RowBox[{"(", 
     RowBox[{"p", "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d"}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"d", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
              " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
          FractionBox["1", 
           RowBox[{
            RowBox[{"2", " ", "\[Mu]"}], "-", 
            SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
       RowBox[{
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"d", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"2", " ", "\[Mu]"}], "-", 
          SuperscriptBox["\[Mu]", "2"]}]]}]]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.69875569512002*^9, 3.698755708744803*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PoutWF", "=", 
   RowBox[{"p", " ", 
    RowBox[{"(", 
     RowBox[{"p", "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", 
            RowBox[{"1", "-", 
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
               " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
          FractionBox["1", 
           RowBox[{
            RowBox[{"2", " ", "\[Mu]"}], "-", 
            SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
       RowBox[{
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"d", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"2", " ", "\[Mu]"}], "-", 
          SuperscriptBox["\[Mu]", "2"]}]]}]]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6987557014113092`*^9, 3.6987557070560427`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.698755704749275*^9, 3.6987557047575502`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"QinWF0", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"PinWF", "-", 
      SuperscriptBox["p", "2"]}], 
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}]}]], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QoutWF0", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"PoutWF", "-", 
      SuperscriptBox["p", "2"]}], 
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}]}]], "//", "FullSimplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.698755717808531*^9, 3.6987557206215754`*^9}, {
  3.6987557598450203`*^9, 3.698755780828889*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["New results", "Subsection",
 CellChangeTimes->{{3.6997620773053217`*^9, 3.699762080008998*^9}}],

Cell[CellGroupData[{

Cell["Generic", "Subsubsection",
 CellChangeTimes->{{3.699768547104185*^9, 3.6997685500223627`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"QselfWF", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", " ", "-", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"dself", "-", "din"}], ")"}], "2"]}]}]], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "d"}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "m", "-", 
             FractionBox["m", 
              RowBox[{"d", "-", "1"}]]}], ")"}], "2"]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QinWF", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", " ", "-", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]], "-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"dself", "-", "din"}], ")"}], "2"]}]}]], "d"}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "m", "-", 
             FractionBox["m", 
              RowBox[{"d", "-", "1"}]]}], ")"}], "2"]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QoutWF", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", " ", "-", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]], "-", 
      FractionBox["1", 
       RowBox[{"1", "-", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "m", "-", 
            FractionBox["m", 
             RowBox[{"d", "-", "1"}]]}], ")"}], "2"]}]}]]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6997135185821047`*^9, 3.699713651029313*^9}}],

Cell["Find \[Lambda] using Qself == 1", "Text",
 CellChangeTimes->{{3.699768554735057*^9, 3.699768560789783*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Lambda]WF", "=", 
  RowBox[{"\[Lambda]", "/.", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"QselfWF", "\[Equal]", "1"}], ",", "\[Lambda]"}], "]"}], 
    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}]], "Input",
 CellChangeTimes->{{3.6997136534525347`*^9, 3.699713667340845*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"d", " ", "n"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"1", "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]], "+", 
     FractionBox[
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
      RowBox[{"1", "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "din"}], "+", "dself"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], 
      RowBox[{"1", "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "m", "-", 
           FractionBox["m", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "d"}]]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]}]]}], ")"}], " ", 
   "\[Mu]"}]]], "Output",
 CellChangeTimes->{{3.699713663992773*^9, 3.699713667644438*^9}, 
   3.6997686498867693`*^9, 3.699787648892887*^9}]
}, Open  ]],

Cell["Replace \[Lambda] in the equations", "Text",
 CellChangeTimes->{{3.699768563135151*^9, 3.699768568700657*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QinWF2", "=", 
  RowBox[{
   RowBox[{"QinWF", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", "\[Lambda]WF"}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"QoutWF2", "=", 
  RowBox[{
   RowBox[{"QoutWF", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", "\[Lambda]WF"}]}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.699713671535714*^9, 3.699713691587577*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox["d", 
     RowBox[{"1", "-", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"din", "-", "dself"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}]}]]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
    RowBox[{"1", "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"din", "-", "dself"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.699713678348674*^9, 3.699713692055463*^9}, 
   3.6997686513293247`*^9, 3.699787650296679*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
    RowBox[{"1", "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"din", "-", "dself"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.699713678348674*^9, 3.699713692055463*^9}, 
   3.6997686513293247`*^9, 3.699787650546925*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["With Self Replacement", "Subsubsection",
 CellChangeTimes->{{3.699713697718473*^9, 3.699713702474758*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QinWFs", "=", 
  RowBox[{
   RowBox[{"QinWF2", "/.", "withselfreplacement"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699713715219798*^9, 3.699713729121462*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "d"}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.6997137205942917`*^9, 3.6997137296346273`*^9}, 
   3.6997686517538443`*^9, 3.6997876505973454`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QinWFs", "-", "QinWF0"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6997137321950417`*^9, 3.699713746573717*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699713749692712*^9, 3.699713762515503*^9}, 
   3.69976865177567*^9, 3.69978765063245*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QoutWFs", "=", 
  RowBox[{
   RowBox[{"QoutWF2", "/.", "withselfreplacement"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.69971376959558*^9, 3.699713781778393*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{3.699713782107119*^9, 3.6997686518296843`*^9, 
  3.699787650721113*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QoutWFs", "-", "QoutWF0"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699713783474031*^9, 3.6997137923236094`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.699713792659212*^9, 3.699768651849345*^9, 
  3.699787650742317*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Without Self Replacement", "Subsubsection",
 CellChangeTimes->{{3.699713697718473*^9, 3.699713702474758*^9}, {
  3.6997140344242887`*^9, 3.6997140345381327`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QinWFw", "=", 
  RowBox[{
   RowBox[{"QinWF2", "/.", "noselfreplacement"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699713715219798*^9, 3.699713729121462*^9}, {
  3.699714032451695*^9, 3.699714037934367*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
   FractionBox["d", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox[
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.6997137205942917`*^9, 3.6997137296346273`*^9}, 
   3.699714039975412*^9, 3.699768653054854*^9, 3.699787652032732*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QoutWFw", "=", 
  RowBox[{
   RowBox[{"QoutWF2", "/.", "noselfreplacement"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.69971376959558*^9, 3.699713781778393*^9}, {
  3.699714043938485*^9, 3.699714047373885*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox[
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{3.699713782107119*^9, 3.699714048290897*^9, 
  3.6997686532808933`*^9, 3.699787652287928*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check numerically", "Subsection",
 CellChangeTimes->{{3.699713892190802*^9, 3.699713895150977*^9}, {
  3.699768591158269*^9, 3.699768593126699*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NGetQWF", "[", 
   RowBox[{"G_", ",", "\[CapitalNu]_", ",", "n_", ",", "p_", ",", "\[Mu]_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"QT", ",", "eqs", ",", "vars", ",", "sols", ",", "QTs"}], "}"}], 
    ",", 
    RowBox[{"(*", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", " ", "is", " ", "the", " ", "dispersal", " ", "graph"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
      "\[CapitalNu]", " ", "is", " ", "the", " ", "size", " ", "of", " ", 
       "the", " ", "population"}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "n", " ", "is", " ", "the", " ", "degree", " ", "of", " ", "the", " ", 
       "graph"}], ",", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "is", " ", "the", " ", "mutation", " ", "biais"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]", " ", "is", " ", "the", " ", "mutation", " ", 
       RowBox[{"probability", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Initialize", " ", "the", " ", "QT", " ", "matrix"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], "=", "0"}], ";", 
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], "=."}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"QT", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        SubscriptBox["Q", 
         RowBox[{"i", ",", "j"}]], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QT", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], "=", "1"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       SubscriptBox["Q", 
        RowBox[{"i", ",", "i"}]], "=", "1"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QT", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
        SubscriptBox["Q", 
         RowBox[{"j", ",", "i"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"j", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Because", " ", "Q", " ", "is", " ", "symmetric"}], " ", "*)"}],
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["Q", 
           RowBox[{"i", ",", "j"}]], "\[Equal]", 
          RowBox[{
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
            SuperscriptBox["n", "2"]], 
           RowBox[{"(", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"G", "\[LeftDoubleBracket]", 
                RowBox[{"l", ",", "j"}], "\[RightDoubleBracket]"}], 
               RowBox[{"G", "\[LeftDoubleBracket]", 
                RowBox[{"k", ",", "i"}], "\[RightDoubleBracket]"}], 
               RowBox[{"QT", "\[LeftDoubleBracket]", 
                RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
            ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sols", "=", 
      RowBox[{"NSolve", "[", 
       RowBox[{"eqs", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"QTs", "=", 
      RowBox[{"QT", "/.", 
       RowBox[{
       "sols", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", "QTs"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.665746344148189*^9, 3.665746357499515*^9}, {
  3.667629110150731*^9, 3.667629117546748*^9}, {3.667629254770275*^9, 
  3.667629258225225*^9}, {3.667630603278612*^9, 3.667630605327855*^9}, {
  3.6676306528447523`*^9, 3.6676306545659657`*^9}, {3.667828419196966*^9, 
  3.6678284340957117`*^9}, {3.699713899117086*^9, 3.699713956988244*^9}}],

Cell["With self replacement", "Text",
 CellChangeTimes->{{3.69971396939288*^9, 3.699713974576749*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tmp", "=", 
   RowBox[{"NGetQWF", "[", 
    RowBox[{
     RowBox[{"G12IM", "/.", 
      RowBox[{"m", "\[Rule]", "them"}]}], ",", "12", ",", "1", ",", "thep", 
     ",", "the\[Mu]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699713964899124*^9, 3.699714004604657*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp", "\[LeftDoubleBracket]", 
  RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]], "Input",
 CellChangeTimes->{{3.699714006344316*^9, 3.699714009515492*^9}}],

Cell[BoxData["0.314209432193372`"], "Output",
 CellChangeTimes->{3.699714010822144*^9, 3.699768653382098*^9, 
  3.699787652454734*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QinWFs", "/.", "prms"}]], "Input",
 CellChangeTimes->{{3.699714014395958*^9, 3.6997140179382963`*^9}, {
  3.699714052836297*^9, 3.699714060069831*^9}}],

Cell[BoxData["0.31420943219337216`"], "Output",
 CellChangeTimes->{{3.699714055548519*^9, 3.699714060895534*^9}, 
   3.699768653402247*^9, 3.699787652479629*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"tmp", "\[LeftDoubleBracket]", 
  RowBox[{"1", ",", "10"}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"QoutWFs", "/.", "prms"}]}], "Input",
 CellChangeTimes->{{3.6997140657829027`*^9, 3.699714076421811*^9}}],

Cell[BoxData["0.22011168630008535`"], "Output",
 CellChangeTimes->{3.699714076693431*^9, 3.6997686534209337`*^9, 
  3.699787652507264*^9}],

Cell[BoxData["0.22011168630008562`"], "Output",
 CellChangeTimes->{3.699714076693431*^9, 3.6997686534209337`*^9, 
  3.699787652508751*^9}]
}, Open  ]],

Cell["Without self replacement", "Text",
 CellChangeTimes->{{3.6997140797332783`*^9, 3.699714085800799*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tmp2", "=", 
   RowBox[{"NGetQWF", "[", 
    RowBox[{
     RowBox[{"G12IMnoself", "/.", 
      RowBox[{"m", "\[Rule]", "them"}]}], ",", "12", ",", "1", ",", "thep", 
     ",", "the\[Mu]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699713964899124*^9, 3.699714004604657*^9}, {
  3.699714094130377*^9, 3.699714099787663*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp2", "\[LeftDoubleBracket]", 
  RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]], "Input",
 CellChangeTimes->{{3.699714006344316*^9, 3.699714009515492*^9}, 
   3.6997141020180492`*^9}],

Cell[BoxData["0.27517012871174684`"], "Output",
 CellChangeTimes->{3.699714010822144*^9, 3.699714104694887*^9, 
  3.699768653511786*^9, 3.6997876527026987`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QinWFw", "/.", "prms"}]], "Input",
 CellChangeTimes->{{3.699714014395958*^9, 3.6997140179382963`*^9}, {
  3.699714052836297*^9, 3.699714060069831*^9}, {3.6997141065142517`*^9, 
  3.699714106658258*^9}}],

Cell[BoxData["0.2751701287117468`"], "Output",
 CellChangeTimes->{{3.699714055548519*^9, 3.699714060895534*^9}, 
   3.699714106896331*^9, 3.699768653531437*^9, 3.6997876527285433`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"tmp2", "\[LeftDoubleBracket]", 
  RowBox[{"1", ",", "10"}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"QoutWFw", "/.", "prms"}]}], "Input",
 CellChangeTimes->{{3.6997140657829027`*^9, 3.699714076421811*^9}, {
  3.6997141101412897`*^9, 3.699714112193549*^9}}],

Cell[BoxData["0.20955788210480272`"], "Output",
 CellChangeTimes->{3.699714076693431*^9, 3.69971411245328*^9, 
  3.699768653550085*^9, 3.699787652755425*^9}],

Cell[BoxData["0.20955788210480267`"], "Output",
 CellChangeTimes->{3.699714076693431*^9, 3.69971411245328*^9, 
  3.699768653550085*^9, 3.6997876527566137`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Expected Frequency Equations", "Title",
 CellChangeTimes->{{3.699768851984043*^9, 3.699768858124469*^9}}],

Cell[CellGroupData[{

Cell["Numerical - previous results", "Section",
 CellChangeTimes->{{3.69976960096646*^9, 3.699769610384227*^9}}],

Cell[CellGroupData[{

Cell["Full functions, any life-cycle", "Subsection",
 CellChangeTimes->{{3.667805530329844*^9, 3.667805533236369*^9}, {
   3.667817240550598*^9, 3.6678172439254503`*^9}, 3.6703187116345387`*^9}],

Cell["\[Beta] and \[Gamma] were calculated by hand (see main text and \
Appendix)", "Text",
 CellChangeTimes->{{3.679394260451545*^9, 3.679394277503475*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetBeta", "[", 
    RowBox[{
    "sBf_", ",", "Df_", ",", "G_", ",", "GE_", ",", "Qmat_", ",", 
     "\[CapitalNu]_", ",", "\[Nu]_", ",", "Bstar_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"part1", ",", "part2", ",", "factor"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"factor", "=", 
       FractionBox[
        RowBox[{"p", 
         RowBox[{"(", 
          RowBox[{"1", "-", "p"}], ")"}]}], 
        RowBox[{"\[Mu]", " ", "\[CapitalNu]", " ", "Bstar"}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"part1", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Mu]"}], ")"}], 
             RowBox[{"sBf", "[", 
              RowBox[{
              "G", ",", "\[CapitalNu]", ",", "\[Nu]", ",", "j", ",", "l"}], 
              "]"}]}], "-", 
            RowBox[{"Df", "[", 
             RowBox[{
             "G", ",", "\[CapitalNu]", ",", "\[Nu]", ",", "j", ",", "l"}], 
             "]"}]}], ")"}], "*", 
          RowBox[{"GE", "\[LeftDoubleBracket]", 
           RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}], "*", 
          RowBox[{"Qmat", "\[LeftDoubleBracket]", 
           RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"factor", "*", "part1"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetGamma", "[", 
   RowBox[{
   "sBf_", ",", "Df_", ",", "G_", ",", "GE_", ",", "Qmat_", ",", 
    "\[CapitalNu]_", ",", "\[Nu]_", ",", "Bstar_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"part1", ",", "part2", ",", "factor"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"factor", "=", 
      FractionBox[
       RowBox[{"p", 
        RowBox[{"(", 
         RowBox[{"1", "-", "p"}], ")"}]}], 
       RowBox[{"\[Mu]", " ", "\[CapitalNu]", " ", "Bstar"}]]}], ";", 
     RowBox[{"part1", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Mu]"}], ")"}], 
            RowBox[{"sBf", "[", 
             RowBox[{
             "G", ",", "\[CapitalNu]", ",", "\[Nu]", ",", "j", ",", "k"}], 
             "]"}]}], "-", 
           RowBox[{"Df", "[", 
            RowBox[{
            "G", ",", "\[CapitalNu]", ",", "\[Nu]", ",", "j", ",", "k"}], 
            "]"}]}], ")"}], "*", 
         RowBox[{"Qmat", "\[LeftDoubleBracket]", 
          RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"factor", "*", "part1"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6767809663714542`*^9, 3.676781023510331*^9}, {
  3.676804537681356*^9, 3.676804544825398*^9}, {3.679396412220232*^9, 
  3.679396413286743*^9}, {3.699769980839834*^9, 3.699769997947857*^9}, {
  3.699778646203886*^9, 3.6997786598998013`*^9}, {3.699778713529934*^9, 
  3.6997788466070232`*^9}, {3.6997814408909063`*^9, 3.699781470396274*^9}, {
  3.6997873888540173`*^9, 3.69978742458986*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moran DB", "Subsection",
 CellChangeTimes->{{3.667817266049498*^9, 3.667817267641507*^9}, {
  3.667829361694632*^9, 3.667829362862344*^9}, {3.670318555363709*^9, 
  3.67031856010742*^9}, {3.679394287560162*^9, 3.6793942988890533`*^9}}],

Cell[CellGroupData[{

Cell["Define \[Delta]B and \[Delta]D", "Subsubsection",
 CellChangeTimes->{{3.667817270639081*^9, 3.667817303563981*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sBfDB", "[", 
    RowBox[{"G_", ",", "\[CapitalNu]_", ",", "\[Nu]_", ",", "j_", ",", "k_"}],
     "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"Delta", "[", 
       RowBox[{"k", "-", "j"}], "]"}], 
      SuperscriptBox["\[Nu]", "2"]}], "-", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"G", "\[LeftDoubleBracket]", 
         RowBox[{"j", ",", "i"}], "\[RightDoubleBracket]"}], 
        RowBox[{"G", "\[LeftDoubleBracket]", 
         RowBox[{"k", ",", "i"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], 
    RowBox[{"\[CapitalNu]", " ", 
     SuperscriptBox["\[Nu]", "2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DfDB", "[", 
    RowBox[{"G_", ",", "\[CapitalNu]_", ",", "\[Nu]_", ",", "j_", ",", "k_"}],
     "]"}], ":=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BstarDB", "=", 
   FractionBox["1", "\[CapitalNu]"]}], ";"}]}], "Input",
 CellChangeTimes->{{3.667805794031062*^9, 3.6678058049416933`*^9}, {
   3.667805883047532*^9, 3.667806013751638*^9}, {3.667806064496217*^9, 
   3.667806108193321*^9}, {3.6678067367929573`*^9, 3.667806737538381*^9}, {
   3.667806855132804*^9, 3.667806855241205*^9}, 3.6678069002815533`*^9, {
   3.6678178907809553`*^9, 3.6678178913089523`*^9}, {3.699778852523326*^9, 
   3.699778862434937*^9}, {3.6997874275513897`*^9, 3.699787463278324*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations", "Subsubsection",
 CellChangeTimes->{{3.69978004306563*^9, 3.6997800470396347`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]DBexemple", "=", 
  RowBox[{
   RowBox[{"GetBeta", "[", 
    RowBox[{
    "sBfDB", ",", "DfDB", ",", "G12IMgeneric", ",", "GE12IMgeneric", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarDB", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997800509176693`*^9, 3.6997800766118813`*^9}, {
  3.699780227296484*^9, 3.699780254043705*^9}, {3.699781039145463*^9, 
  3.699781043696348*^9}, {3.6997811552598333`*^9, 3.699781156248343*^9}, {
  3.699791766659071*^9, 3.699791790258472*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["dself", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"eself", "+", 
         RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
         RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["din", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"ein", "+", "eself", "+", 
         RowBox[{"3", " ", "ein", " ", "Qin"}], "+", 
         RowBox[{"eself", " ", "Qin"}], "+", 
         RowBox[{"18", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"18", " ", "dout", " ", "dself", " ", 
       RowBox[{"(", 
        RowBox[{"eout", "+", 
         RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
         RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
         RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
         RowBox[{"eself", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"9", " ", 
       SuperscriptBox["dout", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "ein"}], "+", 
            RowBox[{"6", " ", "eout"}], "+", "eself"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "Qin"}]}], ")"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "ein"}], "+", 
            RowBox[{"21", " ", "eout"}], "+", 
            RowBox[{"2", " ", "eself"}]}], ")"}], " ", "Qout"}]}], ")"}]}], 
      "+", 
      RowBox[{"4", " ", "din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", 
          RowBox[{"(", 
           RowBox[{"ein", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ein", "+", "eself"}], ")"}], " ", "Qin"}], "+", 
            RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
         RowBox[{"9", " ", "dout", " ", 
          RowBox[{"(", 
           RowBox[{"eout", "+", 
            RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
            RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
            RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
            RowBox[{"eself", " ", "Qout"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.69978024638573*^9, 3.699780256098102*^9}, 
   3.699781045273366*^9, 3.699781157642991*^9, 3.699781474913704*^9, 
   3.699783922853292*^9, 3.699787598717938*^9, {3.6997917699729023`*^9, 
   3.699791791253379*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]DBexemple", "-", "\[Beta]DB"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699791793075905*^9, 3.6997918142667027`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699791804334284*^9, 3.699791815023748*^9}, 
   3.699791940967175*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]DBexemple2", "=", 
  RowBox[{
   RowBox[{"GetBeta", "[", 
    RowBox[{
    "sBfDB", ",", "DfDB", ",", "G10generic", ",", "GE10generic", ",", 
     "Q10generic", ",", "10", ",", "1", ",", 
     RowBox[{"BstarDB", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "10"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997922176034184`*^9, 3.6997922333025217`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["dself", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"eself", "+", 
         RowBox[{"4", " ", "ein", " ", "Qin"}], "+", 
         RowBox[{"5", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["din", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"eself", "+", 
         RowBox[{"3", " ", "eself", " ", "Qin"}], "+", 
         RowBox[{"ein", " ", 
          RowBox[{"(", 
           RowBox[{"3", "+", 
            RowBox[{"13", " ", "Qin"}]}], ")"}]}], "+", 
         RowBox[{"20", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"5", " ", 
       SuperscriptBox["dout", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "ein"}], "+", "eself"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"4", " ", "Qin"}]}], ")"}]}], "+", 
         RowBox[{"25", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"10", " ", "dout", " ", "dself", " ", 
       RowBox[{"(", 
        RowBox[{"eout", "+", 
         RowBox[{"4", " ", "eout", " ", "Qin"}], "+", 
         RowBox[{"4", " ", "ein", " ", "Qout"}], "+", 
         RowBox[{"eself", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"8", " ", "din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", 
          RowBox[{"(", 
           RowBox[{"ein", "+", 
            RowBox[{"3", " ", "ein", " ", "Qin"}], "+", 
            RowBox[{"eself", " ", "Qin"}], "+", 
            RowBox[{"5", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
         RowBox[{"5", " ", "dout", " ", 
          RowBox[{"(", 
           RowBox[{"eout", "+", 
            RowBox[{"4", " ", "eout", " ", "Qin"}], "+", 
            RowBox[{"4", " ", "ein", " ", "Qout"}], "+", 
            RowBox[{"eself", " ", "Qout"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.6997922351725397`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]DBexemple2", "-", "\[Beta]DB"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "5"}], ",", 
     RowBox[{"d", "\[Rule]", "2"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699792241182529*^9, 3.699792249407493*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699792244617155*^9, 3.699792249502091*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moran BD", "Subsection",
 CellChangeTimes->{{3.667817266049498*^9, 3.667817267641507*^9}, {
   3.66782181858403*^9, 3.667821819675145*^9}, {3.66782936574275*^9, 
   3.667829366991437*^9}, 3.670318572988695*^9, {3.6793943239760017`*^9, 
   3.67939432588864*^9}}],

Cell[CellGroupData[{

Cell["Define \[Delta]B and \[Delta]D", "Subsubsection",
 CellChangeTimes->{{3.667817270639081*^9, 3.667817303563981*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sBfBD", "[", 
    RowBox[{"G_", ",", "\[CapitalNu]_", ",", "\[Nu]_", ",", "j_", ",", "k_"}],
     "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"Delta", "[", 
       RowBox[{"k", "-", "j"}], "]"}], "\[CapitalNu]"}], "-", "1"}], 
    SuperscriptBox["\[CapitalNu]", "2"]]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DfBD", "[", 
    RowBox[{"G_", ",", "\[CapitalNu]_", ",", "\[Nu]_", ",", "j_", ",", "k_"}],
     "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"G", "\[LeftDoubleBracket]", 
      RowBox[{"k", ",", "j"}], "\[RightDoubleBracket]"}], 
     RowBox[{"\[CapitalNu]", " ", "\[Nu]"}]], "-", 
    FractionBox["1", 
     SuperscriptBox["\[CapitalNu]", "2"]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BstarBD", "=", 
   FractionBox["1", "\[CapitalNu]"]}], ";"}]}], "Input",
 CellChangeTimes->{{3.667805794031062*^9, 3.6678058049416933`*^9}, {
   3.667805883047532*^9, 3.667806013751638*^9}, {3.667806064496217*^9, 
   3.667806108193321*^9}, {3.6678067367929573`*^9, 3.667806737538381*^9}, {
   3.667806855132804*^9, 3.667806855241205*^9}, 3.6678069002815533`*^9, {
   3.6678178907809553`*^9, 3.6678178913089523`*^9}, {3.6678218224839478`*^9, 
   3.667821926596066*^9}, {3.69977903377708*^9, 3.699779037288487*^9}, {
   3.699787474076399*^9, 3.699787478013597*^9}, {3.6997875245164633`*^9, 
   3.699787524675749*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations \[Beta]", "Subsubsection",
 CellChangeTimes->{{3.69978004306563*^9, 3.6997800470396347`*^9}, {
  3.699788019288118*^9, 3.699788020367642*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]BDexemple", "=", 
  RowBox[{
   RowBox[{"GetBeta", "[", 
    RowBox[{
    "sBfBD", ",", "DfBD", ",", "G12IMgeneric", ",", "GE12IMgeneric", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarBD", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997800509176693`*^9, 3.6997800766118813`*^9}, {
   3.699780227296484*^9, 3.699780254043705*^9}, {3.699781039145463*^9, 
   3.699781043696348*^9}, {3.6997811552598333`*^9, 3.699781176230454*^9}, {
   3.6997814599873953`*^9, 3.699781463270492*^9}, 3.699787561723735*^9, {
   3.699787605440502*^9, 3.6997876067381372`*^9}, {3.6997876630669823`*^9, 
   3.699787667730566*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"12", " ", "\[Mu]"}]], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"12", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "dself"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"eself", "+", 
           RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
           RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", "din", " ", 
         RowBox[{"(", 
          RowBox[{"ein", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ein", "+", "eself"}], ")"}], " ", "Qin"}], "+", 
           RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
        RowBox[{"9", " ", "dout", " ", 
         RowBox[{"(", 
          RowBox[{"eout", "+", 
           RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
           RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
           RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
           RowBox[{"eself", " ", "Qout"}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "9"}], " ", "eout"}], "+", 
        RowBox[{"11", " ", "eself"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"ein", "-", 
           RowBox[{"10", " ", "ein", " ", "Qin"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"9", " ", "eout"}], "+", "eself"}], ")"}], " ", 
            "Qin"}]}], ")"}]}], "-", 
        RowBox[{"9", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "ein"}], "-", 
           RowBox[{"3", " ", "eout"}], "+", "eself"}], ")"}], " ", "Qout"}]}],
        ")"}], " ", "\[Mu]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.699781180204089*^9, {3.699781446797988*^9, 3.699781479785037*^9}, 
   3.699787527248124*^9, {3.699787559397271*^9, 3.699787562336577*^9}, 
   3.6997876019039497`*^9, {3.699787663714706*^9, 3.6997876695101843`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]IBDtest", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["\[Mu]", 
          SuperscriptBox["\[CapitalNu]", "2"]], "-", 
         FractionBox[
          RowBox[{"G", "\[LeftDoubleBracket]", 
           RowBox[{"l", ",", "j"}], "\[RightDoubleBracket]"}], 
          "\[CapitalNu]"]}], ")"}], 
       RowBox[{"GE", "\[LeftDoubleBracket]", 
        RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}], 
       RowBox[{"Q", "\[LeftDoubleBracket]", 
        RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"G", "\[Rule]", "G12IMgeneric"}], ",", 
      RowBox[{"GE", "\[Rule]", "GE12IMgeneric"}], ",", 
      RowBox[{"Q", "\[Rule]", "Q12generic"}], ",", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}], "}"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699782870840354*^9, 3.699783001047284*^9}, {
  3.699783945553492*^9, 3.699783947090015*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Part","pkspec1",
   "\"The expression \\!\\(\\*RowBox[{\\\"l\\\"}]\\) cannot be used as a part \
specification.\"",2,103,1,25645961093805294600,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.6997876903707848`*^9}],

Cell[BoxData[
 TemplateBox[{
  "Part","pkspec1",
   "\"The expression \\!\\(\\*RowBox[{\\\"k\\\"}]\\) cannot be used as a part \
specification.\"",2,103,2,25645961093805294600,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.6997876903941708`*^9}],

Cell[BoxData[
 TemplateBox[{
  "Part","pkspec1",
   "\"The expression \\!\\(\\*RowBox[{\\\"j\\\"}]\\) cannot be used as a part \
specification.\"",2,103,3,25645961093805294600,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.699787690419957*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"pkspec1\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,103,4,25645961093805294600,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.69978769043326*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "dself"}], " ", 
   RowBox[{"(", 
    RowBox[{"eself", "+", 
     RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
     RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "-", 
  RowBox[{"2", " ", "din", " ", 
   RowBox[{"(", 
    RowBox[{"ein", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ein", "+", "eself"}], ")"}], " ", "Qin"}], "+", 
     RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "-", 
  RowBox[{"9", " ", "dout", " ", 
   RowBox[{"(", 
    RowBox[{"eout", "+", 
     RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
     RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
     RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
     RowBox[{"eself", " ", "Qout"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "12"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "ein"}], "+", 
     RowBox[{"9", " ", "eout"}], "+", "eself"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"2", " ", "Qin"}], "+", 
     RowBox[{"9", " ", "Qout"}]}], ")"}], " ", "\[Mu]"}]}]], "Output",
 CellChangeTimes->{
  3.699782962246019*^9, {3.699782996001308*^9, 3.699783002116426*^9}, 
   3.699783568003317*^9, 3.699783948221375*^9, 3.699787697688373*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]IBDtest", "+", "\[Beta]BDI"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699783020789446*^9, 3.699783038546137*^9}, 
   3.699783089340975*^9, {3.699783957941577*^9, 3.699783963099947*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699783026270259*^9, 3.699783039204505*^9}, 
   3.699783090301508*^9, 3.699783569034895*^9, {3.6997839494167013`*^9, 
   3.69978396360054*^9}, {3.699787700318171*^9, 3.699787726454076*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]DBDtest", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Mu]"}], ")"}], "\[CapitalNu]"], 
       RowBox[{"GE", "\[LeftDoubleBracket]", 
        RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}], 
       RowBox[{"Q", "\[LeftDoubleBracket]", 
        RowBox[{"l", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"G", "\[Rule]", "G12IMgeneric"}], ",", 
      RowBox[{"GE", "\[Rule]", "GE12IMgeneric"}], ",", 
      RowBox[{"Q", "\[Rule]", "Q12generic"}], ",", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}], "}"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699783999036151*^9, 3.699784026470895*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{"eself", "+", 
     RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
     RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]], "Output",
 CellChangeTimes->{3.699784037424552*^9, 3.699787735289548*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]DBDtest", "-", "\[Beta]BDD"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699784038835702*^9, 3.69978404413303*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.699784045088913*^9, 3.6997877353512278`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]BDtest", "=", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}]}], "\[Mu]"], 
    RowBox[{"(", 
     RowBox[{"\[Beta]DBDtest", "+", "\[Beta]IBDtest"}], ")"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997840516560383`*^9, 3.699784066994879*^9}, {
  3.699784124706222*^9, 3.699784180324698*^9}, {3.699784434476344*^9, 
  3.699784438938961*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "\[Mu]"], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "dself"}], " ", 
      RowBox[{"(", 
       RowBox[{"eself", "+", 
        RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
        RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", "din", " ", 
      RowBox[{"(", 
       RowBox[{"ein", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ein", "+", "eself"}], ")"}], " ", "Qin"}], "+", 
        RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "-", 
     RowBox[{"9", " ", "dout", " ", 
      RowBox[{"(", 
       RowBox[{"eout", "+", 
        RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
        RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
        RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
        RowBox[{"eself", " ", "Qout"}]}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"eself", "+", 
        RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
        RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
     RowBox[{
      FractionBox["1", "12"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "ein"}], "+", 
        RowBox[{"9", " ", "eout"}], "+", "eself"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "Qin"}], "+", 
        RowBox[{"9", " ", "Qout"}]}], ")"}], " ", "\[Mu]"}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.699784135505018*^9, {3.699784167377666*^9, 3.699784182712098*^9}, 
   3.6997844423873653`*^9, 3.699787736887267*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]BDtest", "-", "\[Beta]BD"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6997841387119617`*^9, 3.699784144916231*^9}, {
  3.6997841825084257`*^9, 3.699784184642168*^9}, {3.699784448322966*^9, 
  3.699784451265874*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699784145255732*^9, 3.699784186958892*^9}, 
   3.699784452682255*^9, 3.699787736958263*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]BDD", "-", "\[Beta]DBDtest"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699784301329733*^9, 3.699784327843625*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699784315772072*^9, 3.699784328285502*^9}, 
   3.699787737025803*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]BDI", "+", "\[Beta]IBDtest"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699784332794595*^9, 3.6997843402035503`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6997843371632423`*^9, 3.699784340651658*^9}, 
   3.6997877370675783`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]BDD", "-", "\[Beta]BDI", "-", 
    RowBox[{"(", 
     RowBox[{"\[Beta]DBDtest", "+", "\[Beta]IBDtest"}], ")"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699784354710429*^9, 3.699784377214487*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.699784377606586*^9, 3.6997877371213493`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]BD", "-", 
  RowBox[{"p", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}], "/", "\[Mu]"}], 
   RowBox[{"(", 
    RowBox[{"\[Beta]BDD", "-", "\[Beta]BDI"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.699784385669067*^9, 3.6997844086001043`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699784394858046*^9, 3.699784409192609*^9}, 
   3.69978773717702*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Beta]BDexemple", "-", "\[Beta]BDtest"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", "withselfreplacement"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.699784483827916*^9, 3.699784493527356*^9}, {
  3.6997846715548487`*^9, 3.6997847088434153`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699784489385581*^9, 3.6997844939420958`*^9}, {
   3.699784701556155*^9, 3.699784709274663*^9}, 3.6997877372369337`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699784489385581*^9, 3.6997844939420958`*^9}, {
   3.699784701556155*^9, 3.699784709274663*^9}, 3.699787737239546*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Equations \[Gamma]", "Subsubsection",
 CellChangeTimes->{{3.69978004306563*^9, 3.6997800470396347`*^9}, {
  3.699788019288118*^9, 3.699788039145166*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]BDexemple", "=", 
  RowBox[{
   RowBox[{"GetGamma", "[", 
    RowBox[{
    "sBfBD", ",", "DfBD", ",", "G12IMgeneric", ",", "GE12IMgeneric", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarBD", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997800509176693`*^9, 3.6997800766118813`*^9}, {
   3.699780227296484*^9, 3.699780254043705*^9}, {3.699781039145463*^9, 
   3.699781043696348*^9}, {3.6997811552598333`*^9, 3.699781176230454*^9}, {
   3.6997814599873953`*^9, 3.699781463270492*^9}, 3.699787561723735*^9, {
   3.699787605440502*^9, 3.6997876067381372`*^9}, {3.6997876630669823`*^9, 
   3.699787667730566*^9}, {3.699788044392364*^9, 3.699788048476987*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"12", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "dself", "+", 
        RowBox[{"2", " ", "din", " ", "Qin"}], "+", 
        RowBox[{"9", " ", "dout", " ", "Qout"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"11", "-", 
        RowBox[{"2", " ", "Qin"}], "-", 
        RowBox[{"9", " ", "Qout"}]}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
  RowBox[{"12", " ", "\[Mu]"}]]], "Output",
 CellChangeTimes->{
  3.699781180204089*^9, {3.699781446797988*^9, 3.699781479785037*^9}, 
   3.699787527248124*^9, {3.699787559397271*^9, 3.699787562336577*^9}, 
   3.6997876019039497`*^9, {3.699787663714706*^9, 3.6997876695101843`*^9}, 
   3.699788051319792*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]BDexemple", "-", "\[Gamma]BD"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.6997880588652267`*^9, 3.699788076656334*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699788066511174*^9, 3.6997880771213427`*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wright-Fisher", "Subsection",
 CellChangeTimes->{{3.667817266049498*^9, 3.667817267641507*^9}, {
   3.66782181858403*^9, 3.667821819675145*^9}, {3.66782936574275*^9, 
   3.6678293897729073`*^9}, 3.670318583924882*^9, {3.679394331716178*^9, 
   3.67939433186239*^9}}],

Cell[CellGroupData[{

Cell["Define \[Delta]B and \[Delta]D", "Subsubsection",
 CellChangeTimes->{{3.667817270639081*^9, 3.667817303563981*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sBfWF", "[", 
    RowBox[{"G_", ",", "\[CapitalNu]_", ",", "\[Nu]_", ",", "j_", ",", "k_"}],
     "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"Delta", "[", 
       RowBox[{"k", "-", "j"}], "]"}], 
      SuperscriptBox["\[Nu]", "2"]}], "-", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"G", "\[LeftDoubleBracket]", 
         RowBox[{"j", ",", "i"}], "\[RightDoubleBracket]"}], 
        RowBox[{"G", "\[LeftDoubleBracket]", 
         RowBox[{"k", ",", "i"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], 
    SuperscriptBox["\[Nu]", "2"]]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DfWF", "[", 
    RowBox[{"G_", ",", "\[CapitalNu]_", ",", "\[Nu]_", ",", "j_", ",", "k_"}],
     "]"}], ":=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BstarWF", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.667805794031062*^9, 3.6678058049416933`*^9}, {
   3.667805883047532*^9, 3.667806013751638*^9}, {3.667806064496217*^9, 
   3.667806108193321*^9}, {3.6678067367929573`*^9, 3.667806737538381*^9}, {
   3.667806855132804*^9, 3.667806855241205*^9}, 3.6678069002815533`*^9, {
   3.6678178907809553`*^9, 3.6678178913089523`*^9}, {3.6678218224839478`*^9, 
   3.667821926596066*^9}, {3.667829392668222*^9, 3.667829444078204*^9}, {
   3.699779079313068*^9, 3.699779084984041*^9}, {3.699787483271895*^9, 
   3.699787499548053*^9}, 3.6997875336757717`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moran, Birth - Death", "Section",
 CellChangeTimes->{{3.699768859805334*^9, 3.699768867744869*^9}}],

Cell[CellGroupData[{

Cell["Generic equations", "Subsection",
 CellChangeTimes->{{3.699788303462345*^9, 3.699788307241809*^9}}],

Cell[CellGroupData[{

Cell["\[Beta]", "Subsubsection",
 CellChangeTimes->{{3.699768872084917*^9, 3.699768873677112*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]BDD", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"eself", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "ein", " ", "Qin"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "eout", " ", "Qout"}]}], 
     ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699768876066028*^9, 3.699768891232036*^9}, {
  3.699768961189538*^9, 3.699768983541917*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]BDI", "=", 
   RowBox[{
    RowBox[{"dself", " ", "eself"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], "din", " ", "ein"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", "d"}], " ", "-", "n"}], " ", ")"}], "dout", " ", 
     "eout"}], 
    RowBox[{"(*", "\[IndentingNewLine]", "*)"}], "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"din", " ", "eself"}], " ", "+", " ", 
       RowBox[{"dself", " ", "ein"}], " ", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "2"}], ")"}], "din", " ", "ein"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], "dout", " ", 
        "eout"}]}], ")"}], "Qin"}], " ", 
    RowBox[{"(*", "\[IndentingNewLine]", "*)"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", "d"}], " ", "-", " ", "n"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dself", " ", "eout"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "din", " ", "eout"}], " ", "+", " ", 
       
       RowBox[{"dout", " ", "eself"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "ein"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "d"}], " ", "-", 
          RowBox[{"2", "n"}]}], ")"}], "dout", " ", "eout"}]}], ")"}], 
     "Qout"}], 
    RowBox[{"(*", "\[IndentingNewLine]", "*)"}], "-", 
    RowBox[{
     FractionBox["\[Mu]", 
      RowBox[{"n", " ", "d"}]], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "Qin"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], "Qout"}]}], ")"}], 
     
     RowBox[{"(", 
      RowBox[{"eself", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "ein"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "eout"}]}], ")"}]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.69976898989773*^9, 3.699769149062419*^9}, {
  3.699783552293282*^9, 3.699783562281807*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"factorBD", "=", 
  FractionBox[
   RowBox[{"p", 
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}]}], "\[Mu]"]}]], "Input",
 CellChangeTimes->{{3.6997810044037027`*^9, 3.699781013324629*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], " ", "p"}], "\[Mu]"]], "Output",
 CellChangeTimes->{3.699781014738659*^9, 3.6997838030770693`*^9, 
  3.699784269757339*^9, 3.6997877195844793`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]BD", "=", 
   RowBox[{"factorBD", 
    RowBox[{"(", 
     RowBox[{"\[Beta]BDD", "-", "\[Beta]BDI"}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699781018565494*^9, 3.699781031469839*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Gamma]", "Subsubsection",
 CellChangeTimes->{{3.699787927626891*^9, 3.699787929439444*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]BDD", "=", 
   RowBox[{"1", "-", "\[Mu]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699787932024872*^9, 3.699787942256565*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]BDI", "=", 
   RowBox[{"dself", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], "din", " ", "Qin"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", "Qout"}], "-", 
    RowBox[{
     FractionBox["\[Mu]", 
      RowBox[{"n", " ", "d"}]], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "Qin"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "Qout"}]}], ")"}]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.6997879444913797`*^9, 3.6997879865015497`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]BD", "=", 
  RowBox[{
   RowBox[{"factorBD", 
    RowBox[{"(", 
     RowBox[{"\[Gamma]BDD", "-", "\[Gamma]BDI"}], ")"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699787990021633*^9, 3.699788004937168*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"d", " ", "n", " ", "\[Mu]"}]], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "dself", "+", 
        RowBox[{"din", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "dout", " ", "n", " ", 
         "Qout"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "Qin", "+", 
        RowBox[{"n", " ", 
         RowBox[{"(", 
          RowBox[{"d", "-", "Qin", "+", "Qout", "-", 
           RowBox[{"d", " ", "Qout"}]}], ")"}]}]}], ")"}], " ", "\[Mu]"}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.6997880018981028`*^9, 3.699788005307209*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moran, Death-Birth", "Section",
 CellChangeTimes->{{3.6997882937760963`*^9, 3.699788365013695*^9}}],

Cell[CellGroupData[{

Cell["Generic equations", "Subsection",
 CellChangeTimes->{{3.6997883407053957`*^9, 3.6997883464817038`*^9}}],

Cell[CellGroupData[{

Cell["\[Beta]", "Subsubsection",
 CellChangeTimes->{{3.6997883477895412`*^9, 3.69978834940098*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]DBD", "=", "\[Beta]BDD"}]], "Input",
 CellChangeTimes->{{3.699788350622011*^9, 3.699788367592432*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"eself", "+", 
    RowBox[{"ein", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
    RowBox[{"eout", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "n"}], "+", 
       RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", "\[Mu]"}], ")"}]}]], "Output",
 CellChangeTimes->{3.699788368875032*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]DBI", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1", "*", "dself", " ", "dself", " ", "eself", "*", "1"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "02", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dself", " ", "din", " ", "ein", " ", 
       "*", "1"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "03", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dself", " ", "dout", 
       " ", "eout", " ", "*", "1"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "04", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dself", " ", "dself", " ", "ein", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "05", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "dself", " ", "din", " ", 
       "eself", " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "06", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "dself", " ", "din", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "07", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], " ", "dself", " ", 
       "dout", " ", "eout", " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "08", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], "dself", " ", 
       "dself", " ", "eout", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "09", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "dself", " ", "din", " ", "eout",
        " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "10", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], "dself", " ", 
       "dout", " ", "eself", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "11", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "dself", " ", "dout", " ", "ein",
        " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "12", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], " ", "dself", " ", "dout", " ", "eout", 
       " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "13", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "din", " ", "dself", " ", "eself", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "14", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "din", " ", "din", " ", "ein", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "15", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "din", " ", "din", " ", "ein", " ", 
       "Qin"}], " ", 
      RowBox[{"(*", "\[IndentingNewLine]", "16", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], "din", " ", "dout", 
       " ", "eout", " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "17", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "din", " ", "dself", " ", "ein"}], 
      " ", 
      RowBox[{"(*", "\[IndentingNewLine]", "18", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "din", " ", "din", " ", "eself"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "19", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "din", " ", "din", " ", "ein"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "20", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "din", " ", "dout", " ", 
       "eout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "21", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "din", " ", "dself", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "22", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "din", " ", "din", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "23", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], " ", "din", " ", "din", " ", "eself", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "24", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "3"}], ")"}], "din", " ", "din", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "25", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "din", " ", "dout", " ", 
       "eout", " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "26", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "din", " ", "dself", " ",
        "eout", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "27", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "din", " ", "din", " ", 
       "eout", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "28", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "din", " ", "din", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "29", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "din", " ", "dout", " ", 
       "eself", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "30", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "din", " ", "dout", " ", "ein", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "31", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], " ", "din", " ", "dout", " ", "eout", 
       " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "32", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", "dself", 
       " ", "eself", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "33", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din", " ", "ein", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "34", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", "dout", " ",
        "eout", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "35", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "dout", " ", "dout", " ", "eout",
        " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "36", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "37", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dself", " ", "ein", " ",
        "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "38", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din", " ", "eself", " ",
        "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "39", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "dout", " ", "din", " ", "ein", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "40", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "eout", " ",
        "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "41", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "eout", " ",
        "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "42", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "43", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", "dself", 
       " ", "eout"}], " ", 
      RowBox[{"(*", "\[IndentingNewLine]", "44", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din", " ", "eout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "45", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", "dout", " ",
        "eself"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "46", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "ein"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "47", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "48", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dself", " ", "eout", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "49", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din", " ", "eout", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "50", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "51", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "eself", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "52", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "dout", " ", "dout", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "53", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "54", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dself", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "55", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "56", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "57", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "eout", " ",
        "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "58", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eself", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "59", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "ein", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "60", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"3", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout", " ", 
       "Qout"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699788370828354*^9, 3.6997883737861567`*^9}, {
  3.6997885910757103`*^9, 3.6997887279414787`*^9}, {3.699788766452323*^9, 
  3.69978887959624*^9}, {3.699789587279212*^9, 3.699789590128297*^9}, {
  3.6997897035456047`*^9, 3.699790157751882*^9}, {3.699790248805749*^9, 
  3.6997904719344053`*^9}, {3.6997909127859507`*^9, 3.699791106760395*^9}, {
  3.699791559504848*^9, 3.699791710511548*^9}, {3.69979191446669*^9, 
  3.6997919239386578`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"factorDB", "=", "factorBD"}]], "Input",
 CellChangeTimes->{{3.699791725220916*^9, 3.699791732023768*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], " ", "p"}], "\[Mu]"]], "Output",
 CellChangeTimes->{{3.699791726790472*^9, 3.699791732340192*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]DB", "=", 
  RowBox[{"factorDB", 
   RowBox[{"(", 
    RowBox[{"\[Beta]DBD", "-", "\[Beta]DBI"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.699791734393208*^9, 3.6997917476423197`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "\[Mu]"], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"eself", "+", 
        RowBox[{"ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
        RowBox[{"eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["dself", "2"], " ", "eself"}], "+", 
        RowBox[{"2", " ", "din", " ", "dself", " ", "ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["din", "2"], " ", "eself", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["din", "2"], " ", "ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
        RowBox[{"2", " ", "dout", " ", "dself", " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["dout", "2"], " ", "eself", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["dout", "2"], " ", "ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", "din", " ", "dout", " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["dout", "2"], " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["din", "2"], " ", "ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
        RowBox[{
         SuperscriptBox["dself", "2"], " ", "ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
        RowBox[{"2", " ", "din", " ", "dself", " ", "eself", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["din", "2"], " ", "ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
        RowBox[{"2", " ", "din", " ", "dself", " ", "ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
        RowBox[{
         SuperscriptBox["din", "2"], " ", "eself", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
        RowBox[{
         SuperscriptBox["din", "2"], " ", "ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
        RowBox[{
         SuperscriptBox["dout", "2"], " ", "ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qin"}], "+", 
        RowBox[{"din", " ", "dout", " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qin"}], "+", 
        RowBox[{"2", " ", "dout", " ", "dself", " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qin"}], "+", 
        RowBox[{
         SuperscriptBox["dout", "2"], " ", "eself", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qin"}], "+", 
        RowBox[{
         SuperscriptBox["dout", "2"], " ", "ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qin"}], "+", 
        RowBox[{"din", " ", "dout", " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qin"}], "+", 
        RowBox[{"din", " ", "dout", " ", "eout", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qin"}], "+", 
        RowBox[{
         SuperscriptBox["dout", "2"], " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qin"}], "+", 
        RowBox[{
         SuperscriptBox["dout", "2"], " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}], "+", 
        RowBox[{
         SuperscriptBox["dself", "2"], " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}], "+", 
        RowBox[{"2", " ", "dout", " ", "dself", " ", "eself", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}], "+", 
        RowBox[{"din", " ", "dout", " ", "ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}], "+", 
        RowBox[{"2", " ", "dout", " ", "dself", " ", "ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}], "+", 
        RowBox[{
         SuperscriptBox["din", "2"], " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["dout", "2"], " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}], "+", 
        RowBox[{"2", " ", "din", " ", "dself", " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}], "+", 
        RowBox[{"2", " ", "din", " ", "dout", " ", "eself", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}], "+", 
        RowBox[{"din", " ", "dout", " ", "ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}], "+", 
        RowBox[{
         SuperscriptBox["din", "2"], " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}], "+", 
        RowBox[{"din", " ", "dout", " ", "ein", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}], "+", 
        RowBox[{
         SuperscriptBox["dout", "2"], " ", "eout", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["dout", "2"], " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}], "+", 
        RowBox[{"2", " ", "dout", " ", "dself", " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}], "+", 
        RowBox[{
         SuperscriptBox["dout", "2"], " ", "eself", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}], "+", 
        RowBox[{
         SuperscriptBox["dout", "2"], " ", "ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}], "+", 
        RowBox[{"2", " ", "din", " ", "dout", " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["dout", "2"], " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}], "+", 
        RowBox[{
         SuperscriptBox["dout", "2"], " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], " ", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.699791749004755*^9, 3.699791928140911*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{881, 911},
WindowMargins->{{22, Automatic}, {Automatic, 46}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 224, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[807, 30, 102, 1, 93, "Title"],
Cell[CellGroupData[{
Cell[934, 35, 92, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[1051, 40, 98, 1, 44, "Subsection"],
Cell[1152, 43, 107, 1, 33, "Text"],
Cell[1262, 46, 361, 12, 61, "Input"],
Cell[1626, 60, 96, 1, 33, "Text"],
Cell[1725, 63, 178, 5, 34, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1940, 73, 302, 4, 37, "Subsection"],
Cell[CellGroupData[{
Cell[2267, 81, 197, 2, 35, "Subsubsection"],
Cell[2467, 85, 5972, 202, 433, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[8476, 292, 195, 2, 29, "Subsubsection"],
Cell[8674, 296, 5222, 175, 372, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[13933, 476, 235, 3, 29, "Subsubsection"],
Cell[14171, 481, 1756, 35, 324, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15964, 521, 278, 5, 35, "Subsubsection"],
Cell[16245, 528, 1927, 53, 372, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[18209, 586, 199, 3, 29, "Subsubsection"],
Cell[18411, 591, 1627, 42, 372, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[20075, 638, 231, 3, 29, "Subsubsection"],
Cell[20309, 643, 1563, 30, 264, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21909, 678, 107, 1, 35, "Subsubsection"],
Cell[22019, 681, 1463, 29, 228, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23531, 716, 93, 1, 44, "Subsection"],
Cell[23627, 719, 1109, 25, 192, "Input"],
Cell[24739, 746, 1063, 24, 192, "Input"],
Cell[25805, 772, 355, 9, 91, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[26209, 787, 90, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[26324, 792, 106, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[26455, 797, 105, 1, 35, "Subsubsection"],
Cell[26563, 800, 88, 1, 33, "Text"],
Cell[26654, 803, 1084, 35, 101, "Input"],
Cell[27741, 840, 104, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[27870, 845, 365, 10, 34, "Input"],
Cell[28238, 857, 1979, 52, 70, "Output"]
}, Open  ]],
Cell[30232, 912, 117, 1, 33, "Text"],
Cell[30352, 915, 337, 10, 34, "Input"],
Cell[30692, 927, 101, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[30818, 932, 581, 16, 80, "Input"],
Cell[31402, 950, 92, 1, 70, "Output"],
Cell[31497, 953, 1494, 53, 70, "Output"],
Cell[32994, 1008, 1459, 52, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[34502, 1066, 102, 1, 29, "Subsubsection"],
Cell[34607, 1069, 1642, 55, 57, "Input"],
Cell[36252, 1126, 1616, 55, 57, "Input"],
Cell[37871, 1183, 363, 11, 57, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[38283, 1200, 150, 2, 44, "Subsection"],
Cell[CellGroupData[{
Cell[38458, 1206, 157, 2, 35, "Subsubsection"],
Cell[38618, 1210, 189, 4, 33, "Text"],
Cell[38810, 1216, 944, 30, 96, "Input"],
Cell[39757, 1248, 135, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[39917, 1253, 1364, 44, 168, "Input"],
Cell[41284, 1299, 1401, 45, 71, "Output"]
}, Open  ]],
Cell[42700, 1347, 2563, 85, 261, "Input"],
Cell[45266, 1434, 115, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[45406, 1439, 385, 10, 34, "Input"],
Cell[45794, 1451, 1664, 53, 77, "Output"]
}, Open  ]],
Cell[47473, 1507, 133, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[47631, 1512, 427, 11, 55, "Input"],
Cell[48061, 1525, 1748, 55, 77, "Output"],
Cell[49812, 1582, 1504, 47, 77, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51365, 1635, 171, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[51561, 1641, 349, 9, 55, "Input"],
Cell[51913, 1652, 1212, 41, 53, "Output"],
Cell[53128, 1695, 924, 32, 52, "Output"]
}, Open  ]],
Cell[54067, 1730, 159, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[54251, 1737, 1009, 32, 57, "Input"],
Cell[55263, 1771, 192, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55492, 1779, 784, 25, 56, "Input"],
Cell[56279, 1806, 144, 2, 32, "Output"]
}, Open  ]],
Cell[56438, 1811, 178, 2, 33, "Text"],
Cell[CellGroupData[{
Cell[56641, 1817, 157, 3, 32, "Input"],
Cell[56801, 1822, 119, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56957, 1829, 159, 3, 32, "Input"],
Cell[57119, 1834, 117, 2, 32, "Output"]
}, Open  ]],
Cell[57251, 1839, 103, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[57379, 1844, 232, 6, 34, "Input"],
Cell[57614, 1852, 165, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57816, 1859, 353, 9, 56, "Input"],
Cell[58172, 1870, 560, 16, 52, "Output"],
Cell[58735, 1888, 329, 9, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59101, 1902, 227, 6, 34, "Input"],
Cell[59331, 1910, 140, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59508, 1917, 217, 5, 34, "Input"],
Cell[59728, 1924, 496, 13, 34, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60273, 1943, 176, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[60474, 1949, 345, 9, 55, "Input"],
Cell[60822, 1960, 1460, 52, 60, "Output"],
Cell[62285, 2014, 1201, 43, 52, "Output"]
}, Open  ]],
Cell[63501, 2060, 117, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[63643, 2065, 1460, 45, 63, "Input"],
Cell[65106, 2112, 189, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65332, 2120, 1184, 38, 57, "Input"],
Cell[66519, 2160, 168, 2, 32, "Output"]
}, Open  ]],
Cell[66702, 2165, 96, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[66823, 2170, 231, 6, 34, "Input"],
Cell[67057, 2178, 596, 19, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67690, 2202, 192, 4, 34, "Input"],
Cell[67885, 2208, 119, 2, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[68065, 2217, 105, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[68195, 2222, 121, 1, 35, "Subsubsection"],
Cell[68319, 2225, 5834, 147, 585, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[74190, 2377, 103, 1, 29, "Subsubsection"],
Cell[CellGroupData[{
Cell[74318, 2382, 716, 17, 103, "Input"],
Cell[75037, 2401, 332, 8, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[75418, 2415, 112, 1, 29, "Subsubsection"],
Cell[CellGroupData[{
Cell[75555, 2420, 748, 18, 101, "Input"],
Cell[76306, 2440, 237, 3, 70, "Output"],
Cell[76546, 2445, 237, 3, 70, "Output"],
Cell[76786, 2450, 235, 3, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[77070, 2459, 117, 1, 29, "Subsubsection"],
Cell[CellGroupData[{
Cell[77212, 2464, 576, 14, 79, "Input"],
Cell[77791, 2480, 134, 2, 70, "Output"],
Cell[77928, 2484, 134, 2, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[78135, 2494, 100, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[78260, 2499, 101, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[78386, 2504, 1861, 55, 101, "Input"],
Cell[80250, 2561, 1849, 59, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82136, 2625, 2673, 79, 177, "Input"],
Cell[84812, 2706, 2836, 87, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87685, 2798, 1036, 29, 106, "Input"],
Cell[88724, 2829, 9375, 271, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98136, 3105, 190, 4, 32, "Input"],
Cell[98329, 3111, 3437, 107, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[101815, 3224, 104, 1, 36, "Subsection"],
Cell[CellGroupData[{
Cell[101944, 3229, 100, 1, 35, "Subsubsection"],
Cell[102047, 3232, 2300, 70, 145, "Input"],
Cell[104350, 3304, 2255, 68, 145, "Input"],
Cell[106608, 3374, 94, 1, 32, "Input"],
Cell[106705, 3377, 660, 22, 114, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[107414, 3405, 101, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[107540, 3410, 100, 1, 35, "Subsubsection"],
Cell[107643, 3413, 3148, 104, 222, "Input"],
Cell[110794, 3519, 113, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[110932, 3524, 340, 8, 34, "Input"],
Cell[111275, 3534, 1244, 41, 76, "Output"]
}, Open  ]],
Cell[112534, 3578, 116, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[112675, 3583, 413, 11, 55, "Input"],
Cell[113091, 3596, 2302, 80, 104, "Output"],
Cell[115396, 3678, 1977, 68, 104, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[117422, 3752, 112, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[117559, 3757, 207, 5, 32, "Input"],
Cell[117769, 3764, 1738, 60, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119544, 3829, 162, 3, 32, "Input"],
Cell[119709, 3834, 140, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119886, 3841, 208, 5, 32, "Input"],
Cell[120097, 3848, 1670, 58, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121804, 3911, 164, 3, 32, "Input"],
Cell[121971, 3916, 117, 2, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[122137, 3924, 168, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[122330, 3930, 254, 6, 32, "Input"],
Cell[122587, 3938, 2621, 91, 104, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125245, 4034, 255, 6, 32, "Input"],
Cell[125503, 4042, 2136, 74, 104, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[127700, 4123, 154, 2, 45, "Subsection"],
Cell[127857, 4127, 5765, 145, 571, "Input"],
Cell[133625, 4274, 102, 1, 33, "Text"],
Cell[133730, 4277, 309, 8, 34, "Input"],
Cell[CellGroupData[{
Cell[134064, 4289, 184, 3, 34, "Input"],
Cell[134251, 4294, 134, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134422, 4301, 175, 3, 32, "Input"],
Cell[134600, 4306, 161, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134798, 4313, 252, 5, 56, "Input"],
Cell[135053, 4320, 138, 2, 32, "Output"],
Cell[135194, 4324, 138, 2, 32, "Output"]
}, Open  ]],
Cell[135347, 4329, 108, 1, 33, "Text"],
Cell[135458, 4332, 365, 9, 34, "Input"],
Cell[CellGroupData[{
Cell[135848, 4345, 213, 4, 34, "Input"],
Cell[136064, 4351, 160, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136261, 4358, 226, 4, 32, "Input"],
Cell[136490, 4364, 184, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136711, 4371, 304, 6, 56, "Input"],
Cell[137018, 4379, 157, 2, 32, "Output"],
Cell[137178, 4383, 159, 2, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[137410, 4393, 111, 1, 67, "Title"],
Cell[CellGroupData[{
Cell[137546, 4398, 112, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[137683, 4403, 194, 2, 45, "Subsection"],
Cell[137880, 4407, 157, 2, 33, "Text"],
Cell[138040, 4411, 3758, 97, 338, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141835, 4513, 241, 3, 44, "Subsection"],
Cell[CellGroupData[{
Cell[142101, 4520, 121, 1, 35, "Subsubsection"],
Cell[142225, 4523, 1511, 36, 125, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[143773, 4564, 101, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[143899, 4569, 617, 13, 78, "Input"],
Cell[144519, 4584, 2837, 76, 168, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147393, 4665, 316, 9, 34, "Input"],
Cell[147712, 4676, 120, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147869, 4683, 419, 10, 78, "Input"],
Cell[148291, 4695, 2371, 66, 168, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150699, 4766, 315, 9, 34, "Input"],
Cell[151017, 4777, 94, 1, 65, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[151172, 4785, 267, 4, 44, "Subsection"],
Cell[CellGroupData[{
Cell[151464, 4793, 121, 1, 35, "Subsubsection"],
Cell[151588, 4796, 1445, 34, 145, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153070, 4835, 158, 2, 36, "Subsubsection"],
Cell[CellGroupData[{
Cell[153253, 4841, 748, 15, 78, "Input"],
Cell[154004, 4858, 2149, 59, 119, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[156190, 4922, 1314, 33, 103, "Input"],
Cell[157507, 4957, 270, 6, 23, "Message"],
Cell[157780, 4965, 270, 6, 23, "Message"],
Cell[158053, 4973, 268, 6, 23, "Message"],
Cell[158324, 4981, 339, 7, 23, "Message"],
Cell[158666, 4990, 1230, 34, 92, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159933, 5029, 385, 10, 34, "Input"],
Cell[160321, 5041, 239, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160597, 5049, 990, 25, 99, "Input"],
Cell[161590, 5076, 348, 10, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161975, 5091, 312, 9, 34, "Input"],
Cell[162290, 5102, 94, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162421, 5108, 465, 13, 55, "Input"],
Cell[162889, 5123, 1732, 49, 112, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[164658, 5177, 413, 11, 34, "Input"],
Cell[165074, 5190, 142, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[165253, 5197, 313, 9, 34, "Input"],
Cell[165569, 5208, 120, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[165726, 5215, 315, 9, 34, "Input"],
Cell[166044, 5226, 124, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166205, 5233, 396, 11, 34, "Input"],
Cell[166604, 5246, 94, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166735, 5252, 294, 8, 32, "Input"],
Cell[167032, 5262, 119, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167188, 5269, 342, 8, 55, "Input"],
Cell[167533, 5279, 170, 2, 32, "Output"],
Cell[167706, 5283, 168, 2, 32, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[167923, 5291, 159, 2, 30, "Subsubsection"],
Cell[CellGroupData[{
Cell[168107, 5297, 796, 15, 78, "Input"],
Cell[168906, 5314, 870, 24, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169813, 5343, 311, 8, 34, "Input"],
Cell[170127, 5353, 96, 1, 32, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[170284, 5361, 272, 4, 45, "Subsection"],
Cell[CellGroupData[{
Cell[170581, 5369, 121, 1, 35, "Subsubsection"],
Cell[170705, 5372, 1570, 36, 107, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[172336, 5415, 105, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[172466, 5420, 105, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[172596, 5425, 98, 1, 36, "Subsubsection"],
Cell[172697, 5428, 564, 17, 34, "Input"],
Cell[173264, 5447, 2446, 76, 160, "Input"],
Cell[CellGroupData[{
Cell[175735, 5527, 219, 6, 55, "Input"],
Cell[175957, 5535, 239, 6, 51, "Output"]
}, Open  ]],
Cell[176211, 5544, 236, 6, 34, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[176484, 5555, 99, 1, 36, "Subsubsection"],
Cell[176586, 5558, 171, 4, 34, "Input"],
Cell[176760, 5564, 740, 24, 50, "Input"],
Cell[CellGroupData[{
Cell[177525, 5592, 260, 7, 32, "Input"],
Cell[177788, 5601, 1023, 32, 75, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[178884, 5641, 105, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[179014, 5646, 109, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[179148, 5651, 99, 1, 36, "Subsubsection"],
Cell[CellGroupData[{
Cell[179272, 5656, 133, 2, 32, "Input"],
Cell[179408, 5660, 464, 15, 32, "Output"]
}, Open  ]],
Cell[179887, 5678, 18085, 498, 1332, "Input"],
Cell[CellGroupData[{
Cell[197997, 6180, 129, 2, 32, InheritFromParent],
Cell[198129, 6184, 190, 5, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[198356, 6194, 217, 5, 32, "Input"],
Cell[198576, 6201, 14676, 411, 517, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

