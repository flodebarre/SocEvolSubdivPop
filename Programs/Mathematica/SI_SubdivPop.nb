(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    486164,      13774]
NotebookOptionsPosition[    458900,      12902]
NotebookOutlinePosition[    459239,      12917]
CellTagsIndexPosition[    459196,      12914]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "Supplementary Mathematica file. \n",
 StyleBox["September 2017",
  FontWeight->"Plain"]
}], "Text",
 CellChangeTimes->{{3.7053817047370768`*^9, 3.705381712931221*^9}, {
  3.709989523473722*^9, 3.7099895240254107`*^9}, {3.710053640860198*^9, 
  3.710053650141354*^9}, {3.714231818022501*^9, 3.714231819080662*^9}},
 FontWeight->"Bold"],

Cell[TextData[{
 StyleBox["CONTENTS: \n\nPart 0",
  FontWeight->"Bold"],
 ": \[OpenCurlyDoubleQuote]Housekeeping\[CloseCurlyDoubleQuote], definitions \
of functions, matrices and replacement rules that will be used throughout the \
file. \n\n",
 StyleBox["Part 1",
  FontWeight->"Bold"],
 ": Probabilities of identity by descent (related to Appendix B). \n          \
  We compare the formulas calculated by hand to the ones obtained numerically \
for special structures, to check that the formulas are correct (they are).\n\n\
",
 StyleBox["Part 2",
  FontWeight->"Bold"],
 ": Expected Frequencies Functions (related to Appendix A and formulas in the \
main text)\n            - Computation of E[X] for each life-cycle, written as \
factor * (R B - C),\n            - Signs of the B term, and of the \
competition terms,\n            - Effects of m on E[X] for each life-cycle,\n \
           - Qualitative effects of m for Moran DB.\n            \n",
 StyleBox["Part 3",
  FontWeight->"Bold"],
 ": Expected Frequencies Functions, generic method (i.e. not restricted to \
the type of subdivided population that we consider in the main text) -> \
related to the Supplementary Figures\n             - We simplify the formulas \
obtained by hand by replacing the dispersal (d) and interaction (e) graphs by \
their formulas in subdivided populations. \n             - We compare the \
formulas calculated by hand to the ones obtained numerically for special \
structures, to check that the formulas are correct (they are).\n             \
- We export the formulas to R for further use. \n\n                           "
}], "Text",
 CellChangeTimes->{{3.7100486122993307`*^9, 3.7100486691530867`*^9}, {
  3.710048701304635*^9, 3.7100487152290573`*^9}, {3.7100487622241507`*^9, 
  3.710048897825068*^9}, {3.71004916081533*^9, 3.710049303512838*^9}, {
  3.7142256106892233`*^9, 3.7142256188600473`*^9}, {3.714225675269268*^9, 
  3.714225773199293*^9}, {3.7142309042902517`*^9, 3.714230990419134*^9}},
 Background->GrayLevel[0.85]],

Cell[TextData[{
 StyleBox["Please note:\n",
  FontWeight->"Bold"],
 "-  In this file, the mutation bias is sometimes denoted by p (as in Tarnita \
and Taylor 2014 and Debarre 2017), instead of \[Nu] as in the manuscript. \n  \
 The letter \[Nu] was chosen in the manuscript because p was sometimes \
mistaken by others as average frequency of altruists in the population (",
 Cell[BoxData[
  FormBox[
   OverscriptBox["X", "_"], TraditionalForm]]],
 " in the manuscript)... But this file was written before the change, and it \
is too complicated to change every instance of \[OpenCurlyDoubleQuote]p\
\[CloseCurlyDoubleQuote].\n   \n-  In this file, the number of demes is \
denoted by d instead of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["N", "D"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " in the article. \n   \n-  Make sure to change `pathtosave` with the path \
to the folder containing the codes. "
}], "Text",
 CellChangeTimes->{{3.709989667224828*^9, 3.7099897100888243`*^9}, {
   3.7099900953347473`*^9, 3.7099901568227654`*^9}, 3.7100445466381598`*^9, {
   3.710044653324129*^9, 3.710044653923409*^9}, {3.71004470069179*^9, 
   3.710044776161139*^9}, {3.710048561933441*^9, 3.710048606698984*^9}, {
   3.7100492887766237`*^9, 3.7100493957508297`*^9}, {3.714226249887731*^9, 
   3.7142262739693403`*^9}, {3.714231715321127*^9, 3.714231724584405*^9}},
 Background->GrayLevel[0.85]],

Cell["Before doing anything, clean the memory", "Text",
 CellChangeTimes->{{3.7099894867598257`*^9, 3.709989496506331*^9}, {
  3.7100493755278254`*^9, 3.710049379170722*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"Evaluate", "[", 
   RowBox[{
    RowBox[{"Context", "[", "]"}], "<>", "\"\<*\>\""}], "]"}], "]"}]], "Input",\

 CellChangeTimes->{{3.699768620256393*^9, 3.69976863906523*^9}}],

Cell["\<\
Set path to folder where outputs should be saved (otherwise it is the default \
Mathematica one)\
\>", "Text",
 CellChangeTimes->{{3.709989499062375*^9, 3.70998951336238*^9}, {
  3.71004479279252*^9, 3.71004481852061*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "pathtosave", "=", 
   "\"\<~/Documents/Work/Projects/2016_SocEvolSubdivPop/Programs/\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.705387996764245*^9, 3.7053879984325037`*^9}, {
  3.705388032144833*^9, 3.705388039805272*^9}, {3.709990745446624*^9, 
  3.7099907457090263`*^9}}],

Cell[CellGroupData[{

Cell["0) Generalities - Initializations", "Title",
 CellChangeTimes->{{3.6998481203326683`*^9, 3.699848124351286*^9}, {
  3.70538498351235*^9, 3.705384986975419*^9}, {3.710048447708098*^9, 
  3.710048448254251*^9}}],

Cell[CellGroupData[{

Cell["Some functions", "Section",
 CellChangeTimes->{{3.69976195851033*^9, 3.6997619606822844`*^9}, {
  3.705381692643553*^9, 3.705381694507731*^9}}],

Cell["\<\
Function to turn P (expected state of pairs of sites) into Q (probabilities \
of identity by descent)\
\>", "Text",
 CellChangeTimes->{{3.699761638267042*^9, 3.699761643190976*^9}, {
  3.710044987970128*^9, 3.710045000889764*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PtoQ", "[", "P_", "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"P", "-", 
      SuperscriptBox["p", "2"]}], 
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}]}]], "//", "FullSimplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6997074055269413`*^9, 3.699707418282507*^9}}],

Cell["Delta function", "Text",
 CellChangeTimes->{{3.699761981659233*^9, 3.699761983664853*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Delta", "[", "x_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"x", "\[Equal]", "0"}], ",", "1", ",", "0"}], "]"}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define graphs for numerical evaluation", "Section",
 CellChangeTimes->{{3.668999943448367*^9, 3.668999951062648*^9}, {
  3.669090333143214*^9, 3.6690903447306433`*^9}, {3.6690903789232073`*^9, 
  3.6690903841955957`*^9}, {3.6702349799301558`*^9, 3.670234987354018*^9}, {
  3.699761597799471*^9, 3.699761603112997*^9}, {3.705381823275504*^9, 
  3.705381826586681*^9}}],

Cell[CellGroupData[{

Cell["Dispersal and Interaction Graphs", "Subsection",
 CellChangeTimes->{{3.710045015347454*^9, 3.710045025005965*^9}}],

Cell[CellGroupData[{

Cell["Island model, dispersal graph, generic", "Subsubsection",
 CellChangeTimes->{{3.6702357682102127`*^9, 3.6702357769730186`*^9}, {
  3.6997616053042727`*^9, 3.699761610197031*^9}, {3.699779221556974*^9, 
  3.6997792225091047`*^9}}],

Cell["N = 12, 4 demes of 3 individuals", "Text",
 CellChangeTimes->{{3.7053816073690863`*^9, 3.705381610787718*^9}, {
  3.7100450872081947`*^9, 3.7100450924090233`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"G12generic", "=", 
   RowBox[{"(", GridBox[{
      {"dself", "din", "din", "dout", "dout", "dout", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"din", "dself", "din", "dout", "dout", "dout", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"din", "din", "dself", "dout", "dout", "dout", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "dself", "din", "din", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "din", "dself", "din", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "din", "din", "dself", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "dself", "din", "din", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "din", "dself", "din", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "din", "din", "dself", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout",
        "dself", "din", "din"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout",
        "din", "dself", "din"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout",
        "din", "din", "dself"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nin", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ndemes", "=", "4"}], ";"}]}], "Input",
 CellChangeTimes->{{3.668999966108613*^9, 3.668999984048553*^9}, {
  3.669000027438491*^9, 3.669000197449211*^9}, {3.699779227001737*^9, 
  3.699779365815967*^9}, {3.705382335922227*^9, 3.7053823360656347`*^9}}],

Cell["N = 10, 2 demes of 5 individuals", "Text",
 CellChangeTimes->{{3.7053816073690863`*^9, 3.705381617268631*^9}, {
  3.710045094361265*^9, 3.710045098800516*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"G10generic", "=", 
   RowBox[{"(", GridBox[{
      {"dself", "din", "din", "din", "din", "dout", "dout", "dout", "dout", 
       "dout"},
      {"din", "dself", "din", "din", "din", "dout", "dout", "dout", "dout", 
       "dout"},
      {"din", "din", "dself", "din", "din", "dout", "dout", "dout", "dout", 
       "dout"},
      {"din", "din", "din", "dself", "din", "dout", "dout", "dout", "dout", 
       "dout"},
      {"din", "din", "din", "din", "dself", "dout", "dout", "dout", "dout", 
       "dout"},
      {"dout", "dout", "dout", "dout", "dout", "dself", "din", "din", "din", 
       "din"},
      {"dout", "dout", "dout", "dout", "dout", "din", "dself", "din", "din", 
       "din"},
      {"dout", "dout", "dout", "dout", "dout", "din", "din", "dself", "din", 
       "din"},
      {"dout", "dout", "dout", "dout", "dout", "din", "din", "din", "dself", 
       "din"},
      {"dout", "dout", "dout", "dout", "dout", "din", "din", "din", "din", 
       "dself"}
     }], ")"}]}], ";"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Island model, interaction graph, generic", "Subsubsection",
 CellChangeTimes->{{3.699761622641583*^9, 3.699761631727844*^9}, {
  3.699762000382402*^9, 3.699762003637082*^9}, {3.6997793522666693`*^9, 
  3.699779354892267*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GE12generic", "=", 
   RowBox[{"G12generic", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dself", "\[Rule]", "eself"}], ",", 
      RowBox[{"dout", "\[Rule]", "eout"}], ",", 
      RowBox[{"din", "\[Rule]", "ein"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GE10generic", "=", 
   RowBox[{"G10generic", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dself", "\[Rule]", "eself"}], ",", 
      RowBox[{"dout", "\[Rule]", "eout"}], ",", 
      RowBox[{"din", "\[Rule]", "ein"}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.679392136687027*^9, 3.679392176855454*^9}, {
  3.699779361234367*^9, 3.699779471181334*^9}, {3.705381642158368*^9, 
  3.705381650694024*^9}, {3.7053823499146967`*^9, 3.705382353401075*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Formulas for d and e", "Subsubsection",
 CellChangeTimes->{{3.7053847971199408`*^9, 3.705384811375741*^9}, {
  3.705386643590569*^9, 3.705386651654303*^9}}],

Cell["\<\
Replacements for the generic dispersal probabilities, depending on whether \
there is self-replacement or not\
\>", "Text",
 CellChangeTimes->{{3.6997616658203783`*^9, 3.699761687567214*^9}, {
  3.705384783688675*^9, 3.7053847850708513`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"noselfreplacement", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dself", "\[Rule]", "0"}], ",", 
     RowBox[{"din", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "m"}], 
       RowBox[{"n", "-", "1"}]]}], ",", 
     RowBox[{"dout", "\[Rule]", 
      FractionBox["m", 
       RowBox[{
        RowBox[{"d", " ", "n"}], " ", "-", " ", "n"}]]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"withselfreplacement", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dself", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "m"}], "n"]}], ",", 
     RowBox[{"din", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "m"}], "n"]}], ",", 
     RowBox[{"dout", "\[Rule]", 
      FractionBox["m", 
       RowBox[{
        RowBox[{"d", " ", "n"}], " ", "-", " ", "n"}]]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6997075039255657`*^9, 3.699707552648037*^9}, {
  3.699794949387794*^9, 3.699794952038497*^9}}],

Cell["\<\
Replacements for the generic interaction probabilities, depending on whether \
there is self - interaction or not\
\>", "Text",
 CellChangeTimes->{{3.7053866725645*^9, 3.7053866854887857`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"groupnoself", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"eself", "\[Rule]", "0"}], ",", 
     RowBox[{"ein", "\[Rule]", 
      FractionBox["1", 
       RowBox[{"n", "-", "1"}]]}], ",", 
     RowBox[{"eout", "\[Rule]", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"groupwithself", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"eself", "\[Rule]", 
      FractionBox["1", "n"]}], ",", 
     RowBox[{"ein", "\[Rule]", 
      FractionBox["1", "n"]}], ",", 
     RowBox[{"eout", "\[Rule]", "0"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.699794001410203*^9, 3.6997940825421743`*^9}, 
   3.705386614026968*^9, 3.705386696609133*^9}],

Cell["\<\
We can even assume that there are a proportion g of interactions outside of \
the group\
\>", "Text",
 CellChangeTimes->{{3.7053866988119307`*^9, 3.7053867171153393`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"widewithself", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"eself", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "g"}], "n"]}], ",", 
     RowBox[{"ein", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "g"}], "n"]}], ",", 
     RowBox[{"eout", "\[Rule]", 
      FractionBox["g", 
       RowBox[{
        RowBox[{"n", " ", "d"}], "-", "n"}]]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"widenoself", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"eself", "\[Rule]", "0"}], ",", 
     RowBox[{"ein", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "g"}], 
       RowBox[{"n", "-", "1"}]]}], ",", 
     RowBox[{"eout", "\[Rule]", 
      FractionBox["g", 
       RowBox[{
        RowBox[{"n", " ", "d"}], "-", "n"}]]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.699794001410203*^9, 3.6997940825421743`*^9}, 
   3.705386614026968*^9, 3.705386696609133*^9}],

Cell["\<\
Combine these using Idself and Ieself, indicator variables for whether there \
is dispersal/interaction with self\
\>", "Text",
 CellChangeTimes->{{3.705386722588567*^9, 3.7053867328708897`*^9}, {
  3.705386774295669*^9, 3.705386796017934*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"genericde", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dself", "\[Rule]", 
      RowBox[{"Idself", " ", 
       FractionBox[
        RowBox[{"1", "-", "m"}], "n"]}]}], ",", 
     RowBox[{"din", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "m"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"n", "-", "1"}]], "-", 
         RowBox[{"Idself", " ", 
          FractionBox["1", 
           RowBox[{"n", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}]]}]}], ")"}]}]}], ",", 
     RowBox[{"dout", "\[Rule]", 
      FractionBox["m", 
       RowBox[{
        RowBox[{"n", " ", "d"}], "-", "n"}]]}], ",", 
     RowBox[{"(*", "\[IndentingNewLine]", "*)"}], 
     RowBox[{"eself", "\[Rule]", 
      RowBox[{"Ieself", " ", 
       FractionBox[
        RowBox[{"1", "-", "g"}], "n"]}]}], ",", 
     RowBox[{"ein", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "g"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"n", "-", "1"}]], "-", 
         RowBox[{"Ieself", " ", 
          FractionBox["1", 
           RowBox[{"n", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}]]}]}], ")"}]}]}], ",", 
     RowBox[{"eout", "\[Rule]", 
      FractionBox["g", 
       RowBox[{
        RowBox[{"n", " ", "d"}], "-", "n"}]]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699847700264285*^9, 3.699847847432616*^9}}],

Cell["Quick check", "Text",
 CellChangeTimes->{{3.710045112069128*^9, 3.710045114517186*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"eself", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], "ein"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "eout"}]}], "/.", 
   "genericde"}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dself", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], "din"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout"}]}], "/.", 
   "genericde"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.6998478529415617`*^9, 3.6998478741336203`*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.705386835798964*^9, 3.7099895977242107`*^9, 3.709990547431911*^9, 
   3.710045154959765*^9, 3.710049683670619*^9, {3.7100540128343143`*^9, 
   3.71005401875179*^9}, 3.7100544959334183`*^9, 3.710156937313199*^9, 
   3.713407332357637*^9, 3.714227890121348*^9, 3.714231871163528*^9, {
   3.7195522744595747`*^9, 3.719552279136121*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.705386835798964*^9, 3.7099895977242107`*^9, 3.709990547431911*^9, 
   3.710045154959765*^9, 3.710049683670619*^9, {3.7100540128343143`*^9, 
   3.71005401875179*^9}, 3.7100544959334183`*^9, 3.710156937313199*^9, 
   3.713407332357637*^9, 3.714227890121348*^9, 3.714231871163528*^9, {
   3.7195522744595747`*^9, 3.71955227913754*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Probabilities of identity by descent matrices", "Subsection",
 CellChangeTimes->{{3.710045034592218*^9, 3.710045049896731*^9}}],

Cell[CellGroupData[{

Cell["\<\
Generic Q matrix corresponding to the populations defined above\
\>", "Subsubsection",
 CellChangeTimes->{{3.699780083079438*^9, 3.699780089064321*^9}, {
  3.710045053816822*^9, 3.7100450723451557`*^9}}],

Cell["N = 12", "Text",
 CellChangeTimes->{{3.7053816637626743`*^9, 3.705381672787184*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q12generic", "=", 
   RowBox[{"(", GridBox[{
      {"1", "Qin", "Qin", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qin", "1", "Qin", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qin", "Qin", "1", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "1", "Qin", "Qin", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qin", "1", "Qin", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qin", "Qin", "1", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "1", "Qin", "Qin", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "1", "Qin", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "Qin", "1", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout",
        "1", "Qin", "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout",
        "Qin", "1", "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout",
        "Qin", "Qin", "1"}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699780094260882*^9, 3.699780213049553*^9}}],

Cell["N = 10", "Text",
 CellChangeTimes->{{3.7053816637626743`*^9, 3.705381667315893*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q10generic", "=", 
   RowBox[{"(", GridBox[{
      {"1", "Qin", "Qin", "Qin", "Qin", "Qout", "Qout", "Qout", "Qout", 
       "Qout"},
      {"Qin", "1", "Qin", "Qin", "Qin", "Qout", "Qout", "Qout", "Qout", 
       "Qout"},
      {"Qin", "Qin", "1", "Qin", "Qin", "Qout", "Qout", "Qout", "Qout", 
       "Qout"},
      {"Qin", "Qin", "Qin", "1", "Qin", "Qout", "Qout", "Qout", "Qout", 
       "Qout"},
      {"Qin", "Qin", "Qin", "Qin", "1", "Qout", "Qout", "Qout", "Qout", 
       "Qout"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "1", "Qin", "Qin", "Qin", 
       "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "1", "Qin", "Qin", 
       "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "Qin", "1", "Qin", 
       "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "Qin", "Qin", "1", 
       "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "Qin", "Qin", "Qin", "1"}
     }], ")"}]}], ";"}]], "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["1) Probabilities of identity by descent (Q)", "Title",
 CellChangeTimes->{{3.6997615711578712`*^9, 3.6997615782063017`*^9}, 
   3.705381722579816*^9, {3.705384972132237*^9, 3.7053849776404448`*^9}, {
   3.7100484523695393`*^9, 3.710048452937963*^9}}],

Cell[CellGroupData[{

Cell["Moran", "Section",
 CellChangeTimes->{{3.699707345527932*^9, 3.699707348878216*^9}}],

Cell[CellGroupData[{

Cell["Simplify QinM and QoutM", "Subsection",
 CellChangeTimes->{{3.705384837006383*^9, 3.7053848450598097`*^9}, {
  3.705384918344077*^9, 3.705384919135845*^9}}],

Cell["\<\
See Appendix B2 for calculation details on how Qself, Qin and Qout were \
obtained using a formula presented in the appendix of Debarre 2017 JTB for \
\[OpenCurlyDoubleQuote]2D graphs\[CloseCurlyDoubleQuote]. Here we just copy \
these formulas. \
\>", "Text",
 CellChangeTimes->{{3.705384701614676*^9, 3.705384767903507*^9}, {
  3.710045185256304*^9, 3.710045212024458*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"QselfM2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "\[Mu]"], " ", "+", " ", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "m", "-", 
            FractionBox["m", 
             RowBox[{"d", "-", "1"}]]}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699707557939262*^9, 3.69970763486366*^9}, {
   3.6997106026698093`*^9, 3.6997106056848392`*^9}, 3.705381789237061*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"QinM2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "\[Mu]"], " ", "+", " ", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "m", "-", 
            FractionBox["m", 
             RowBox[{"d", "-", "1"}]]}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QoutM2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "\[Mu]"], " ", "+", " ", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "m", "-", 
            FractionBox["m", 
             RowBox[{"d", "-", "1"}]]}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}], "+", 
      FractionBox["1", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"dself", "-", "din"}], ")"}]}]}]]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.699707683180396*^9, 3.699707713960421*^9}, {
  3.699710614334208*^9, 3.699710618463037*^9}}],

Cell["Find \[Lambda] using Qself == 1", "Text",
 CellChangeTimes->{{3.6997617343192577`*^9, 3.699761741343073*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"the\[Lambda]M", "=", 
  RowBox[{
   RowBox[{"\[Lambda]", "/.", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"QselfM2", "\[Equal]", "1"}], ",", "\[Lambda]"}], "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699707717272316*^9, 3.699707738311771*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"n", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "din", "+", 
     RowBox[{"dself", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
     RowBox[{"din", " ", "\[Mu]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "d"}], " ", "m"}], "+", "\[Mu]", "+", 
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
  RowBox[{
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "din", "-", "dself", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "din"}], "+", "dself", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
       "\[Mu]"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "dself", "+", 
      RowBox[{"din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"dself", "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.69970772408389*^9, 3.699707738698215*^9}, 
   3.699710621593836*^9, 3.6997686437904377`*^9, 3.699787643568434*^9, 
   3.699793830771269*^9, 3.6998474518868103`*^9, 3.699848116000793*^9, 
   3.699848919108547*^9, 3.6998537361374397`*^9, 3.699955345715513*^9, 
   3.70220130432386*^9, 3.702289662990987*^9, 3.704178947628963*^9, 
   3.70451770389784*^9, 3.705381803222721*^9, 3.7053871868134527`*^9, 
   3.7099896361553926`*^9, {3.709990550342622*^9, 3.709990558553536*^9}, 
   3.7100452223244133`*^9, 3.710049684287039*^9, 3.7100540244959297`*^9, 
   3.7100544967705727`*^9, 3.710156941308593*^9, 3.713407333063487*^9, 
   3.714227893978518*^9, 3.7142318730588284`*^9, 3.71955228359838*^9}]
}, Open  ]],

Cell["Replace \[Lambda] in the equations for Qin and Qout", "Text",
 CellChangeTimes->{{3.699761747312605*^9, 3.699761756389374*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QinM", "=", 
  RowBox[{
   RowBox[{"QinM2", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", " ", "the\[Lambda]M"}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"QoutM", "=", 
  RowBox[{
   RowBox[{"QoutM2", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", " ", "the\[Lambda]M"}]}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.6997077421873693`*^9, 3.699707784984331*^9}, {
  3.699793746074094*^9, 3.699793747396491*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "din", "-", "dself"}], ")"}], " ", "\[Mu]"}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "din", "-", "dself", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d", "+", "din", "-", "dself"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "din", "-", "dself", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "din"}], "+", "dself", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
       "\[Mu]"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "dself", "+", 
      RowBox[{"din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"dself", "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.6997077647180653`*^9, 3.6997077855738363`*^9}, 
   3.699710621747601*^9, 3.699768643934836*^9, 3.699787643727768*^9, 
   3.699793748652389*^9, 3.699793831243638*^9, 3.6998474522920237`*^9, 
   3.699848116415012*^9, 3.6998489194040213`*^9, 3.699853736523282*^9, 
   3.699955346045332*^9, 3.702201304718186*^9, 3.702289663254939*^9, 
   3.7041789478680773`*^9, 3.704517704162591*^9, 3.705381804447599*^9, 
   3.705387187037231*^9, 3.709989638164032*^9, {3.709990550674816*^9, 
   3.7099905588175917`*^9}, 3.710045224036543*^9, 3.710049684677297*^9, 
   3.710054024680799*^9, 3.710054497021096*^9, 3.710156941540985*^9, 
   3.7134073333554697`*^9, 3.7142278942139053`*^9, 3.71423187487844*^9, 
   3.719552283883185*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "din", "+", 
     RowBox[{"dself", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
     RowBox[{"din", " ", "\[Mu]"}]}], ")"}]}], 
  RowBox[{
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "din", "-", "dself", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "din"}], "+", "dself", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
       "\[Mu]"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "dself", "+", 
      RowBox[{"din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"dself", "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.6997077647180653`*^9, 3.6997077855738363`*^9}, 
   3.699710621747601*^9, 3.699768643934836*^9, 3.699787643727768*^9, 
   3.699793748652389*^9, 3.699793831243638*^9, 3.6998474522920237`*^9, 
   3.699848116415012*^9, 3.6998489194040213`*^9, 3.699853736523282*^9, 
   3.699955346045332*^9, 3.702201304718186*^9, 3.702289663254939*^9, 
   3.7041789478680773`*^9, 3.704517704162591*^9, 3.705381804447599*^9, 
   3.705387187037231*^9, 3.709989638164032*^9, {3.709990550674816*^9, 
   3.7099905588175917`*^9}, 3.710045224036543*^9, 3.710049684677297*^9, 
   3.710054024680799*^9, 3.710054497021096*^9, 3.710156941540985*^9, 
   3.7134073333554697`*^9, 3.7142278942139053`*^9, 3.71423187487844*^9, 
   3.7195522839265213`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check numerically", "Subsection",
 CellChangeTimes->{{3.705382410622026*^9, 3.7053824143751183`*^9}}],

Cell["\<\
Here we evaluate the probabilities of identity by descent numerically, using \
the recursion formula (\[OpenCurlyDoubleQuote]eqs\[CloseCurlyDoubleQuote] in \
the function below), with specific graphs. \
\>", "Text",
 CellChangeTimes->{{3.710045361619101*^9, 3.710045403286997*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NGetQM", "[", 
   RowBox[{
   "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "p_", ",", 
    "\[Mu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"QT", ",", "eqs", ",", "vars", ",", "sols", ",", "QTs"}], "}"}], 
    ",", 
    RowBox[{"(*", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", " ", "is", " ", "the", " ", "dispersal", " ", "graph"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
      "\[CapitalNu]", " ", "is", " ", "the", " ", "size", " ", "of", " ", 
       "the", " ", "population"}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "graphdegree", " ", "is", " ", "the", " ", "degree", " ", "of", " ", 
       "the", " ", "graph", " ", 
       RowBox[{"(", 
        RowBox[{"=", 
         RowBox[{
         "1", " ", "in", " ", "a", " ", "subdivided", " ", "population"}]}], 
        ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "is", " ", "the", " ", "mutation", " ", "biais"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]", " ", "is", " ", "the", " ", "mutation", " ", 
       RowBox[{"probability", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Initialize", " ", "the", " ", "QT", " ", "matrix"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], "=", "0"}], ";", 
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], "=."}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"QT", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        SubscriptBox["Q", 
         RowBox[{"i", ",", "j"}]], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QT", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], "=", "1"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       SubscriptBox["Q", 
        RowBox[{"i", ",", "i"}]], "=", " ", "1"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QT", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
        SubscriptBox["Q", 
         RowBox[{"j", ",", "i"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"j", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Because", " ", "Q", " ", "is", " ", "symmetric"}], " ", "*)"}],
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["Q", 
           RowBox[{"i", ",", "j"}]], "\[Equal]", 
          RowBox[{
           FractionBox[
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Mu]"}], ")"}], 
            RowBox[{"2", " ", "graphdegree"}]], 
           RowBox[{"(", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"G", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "j"}], "\[RightDoubleBracket]"}], 
                RowBox[{"QT", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "i"}], "\[RightDoubleBracket]"}]}], "+", 
               RowBox[{
                RowBox[{"G", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "i"}], "\[RightDoubleBracket]"}], 
                RowBox[{"QT", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "j"}], "\[RightDoubleBracket]"}]}]}], ",", 
              
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
            ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sols", "=", 
      RowBox[{"NSolve", "[", 
       RowBox[{"eqs", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"QTs", "=", 
      RowBox[{"QT", "/.", 
       RowBox[{
       "sols", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", "QTs"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7053848697994337`*^9, 3.7053848780155973`*^9}, {
   3.710046771770358*^9, 3.7100467772587967`*^9}, 3.710046826103231*^9}],

Cell["\<\
This function compares the numerical version to the analytical one, for \
specific graph structures. If the numerical values are the same, we are fine! \
(and we are, otherwise there would not be a paper)\
\>", "Text",
 CellChangeTimes->{{3.7100454323796387`*^9, 3.710045461466309*^9}, {
  3.710045859794882*^9, 3.710045869034852*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"prs", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CheckQM", "[", 
   RowBox[{"prs_", ",", "dvalues_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NG", ",", "NQin", ",", "NQout", ",", "NQinMatrix"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NG", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<G\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"d", " ", "n"}], "/.", "prs"}], "]"}], "<>", 
          "\"\<generic\>\""}], "]"}], "/.", "dvalues"}], "/.", "prs"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"NQinMatrix", "=", 
      RowBox[{"NGetQM", "[", 
       RowBox[{"NG", ",", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "/.", "prs"}], ",", "1", ",", "0.5", ",", 
        RowBox[{"\[Mu]", "/.", "prs"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NQin", "=", 
      RowBox[{"NQinMatrix", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NQout", "=", 
      RowBox[{"NQinMatrix", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "/.", "prs"}]}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Qin\>\"", ",", "NQin", ",", 
            RowBox[{
             RowBox[{"QinM", "/.", "dvalues"}], "/.", "prs"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Qout\>\"", ",", "NQout", ",", 
            RowBox[{
             RowBox[{"QoutM", "/.", "dvalues"}], "/.", "prs"}]}], "}"}]}], 
         "}"}], "//", "Transpose"}], "//", "MatrixForm"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.705382415477868*^9, 3.7053825416943493`*^9}, {
  3.705382574036092*^9, 3.705382818529418*^9}, {3.710045481283993*^9, 
  3.710045543949483*^9}, {3.710045661117234*^9, 3.710045848195723*^9}}],

Cell["Check for the population of size 12", "Text",
 CellChangeTimes->{{3.710045770824685*^9, 3.710045778810508*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"CheckQM", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}], ",", 
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", 
   "withselfreplacement"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"CheckQM", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}], ",", 
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", "noselfreplacement"}],
   "]"}]}], "Input",
 CellChangeTimes->{{3.705382415477868*^9, 3.7053825416943493`*^9}, {
  3.705382574036092*^9, 3.705382818529418*^9}, {3.710045481283993*^9, 
  3.710045543949483*^9}, {3.710045661117234*^9, 3.71004578309207*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.4076433121019112`", "0.12738853503184724`"},
     {"0.40764331210191085`", "0.12738853503184713`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.71004580185327*^9, 3.710045818527726*^9}, {
   3.7100458496621733`*^9, 3.710045872175068*^9}, {3.710046804979011*^9, 
   3.7100468303769608`*^9}, 3.710049684959083*^9, 3.7100540248957777`*^9, 
   3.710054497393442*^9, 3.710156942151408*^9, 3.7134073335485477`*^9, 
   3.714227894515362*^9, 3.714231875885293*^9, 3.719552284367371*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.5037353255069373`", "0.14087513340448243`"},
     {"0.5037353255069368`", "0.14087513340448238`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.71004580185327*^9, 3.710045818527726*^9}, {
   3.7100458496621733`*^9, 3.710045872175068*^9}, {3.710046804979011*^9, 
   3.7100468303769608`*^9}, 3.710049684959083*^9, 3.7100540248957777`*^9, 
   3.710054497393442*^9, 3.710156942151408*^9, 3.7134073335485477`*^9, 
   3.714227894515362*^9, 3.714231875885293*^9, 3.719552284427292*^9}]
}, Open  ]]
}, Open  ]],

Cell["Check for the population of size 10", "Text",
 CellChangeTimes->{{3.7100457840799427`*^9, 3.710045789765402*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"CheckQM", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "2"}], ",", 
     RowBox[{"n", "\[Rule]", "5"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", 
   "withselfreplacement"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"CheckQM", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "2"}], ",", 
     RowBox[{"n", "\[Rule]", "5"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", "noselfreplacement"}],
   "]"}]}], "Input",
 CellChangeTimes->{{3.705382415477868*^9, 3.7053825416943493`*^9}, {
  3.705382574036092*^9, 3.705382818529418*^9}, {3.710045481283993*^9, 
  3.710045543949483*^9}, {3.710045661117234*^9, 3.71004578309207*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.329896907216495`", "0.20618556701030943`"},
     {"0.32989690721649484`", "0.2061855670103093`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.710045737188779*^9, 3.710045790980493*^9}, {
   3.710045822282939*^9, 3.710045873189179*^9}, 3.7100468323201847`*^9, 
   3.710049685041671*^9, 3.71005402499269*^9, 3.710054497489567*^9, 
   3.7101569423007517`*^9, 3.7134073336129847`*^9, 3.7142278946305103`*^9, 
   3.714231876134884*^9, 3.719552284589007*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.3761996161228409`", "0.2226487523992325`"},
     {"0.3761996161228407`", "0.2226487523992322`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.710045737188779*^9, 3.710045790980493*^9}, {
   3.710045822282939*^9, 3.710045873189179*^9}, 3.7100468323201847`*^9, 
   3.710049685041671*^9, 3.71005402499269*^9, 3.710054497489567*^9, 
   3.7101569423007517`*^9, 3.7134073336129847`*^9, 3.7142278946305103`*^9, 
   3.714231876134884*^9, 3.7195522845902557`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Particular cases", "Subsection",
 CellChangeTimes->{{3.7099899437833014`*^9, 3.70998994895147*^9}}],

Cell[CellGroupData[{

Cell["Equations with self replacement (dself = din)", "Subsubsection",
 CellChangeTimes->{{3.699707797145195*^9, 3.699707800750886*^9}, {
  3.699761769703529*^9, 3.699761771556242*^9}, {3.7053818632907352`*^9, 
  3.705381867297986*^9}, {3.705384908592659*^9, 3.705384908783701*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QinMs", "=", 
  RowBox[{
   RowBox[{"QinM", "/.", "withselfreplacement"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"QoutMs", "=", 
  RowBox[{
   RowBox[{"QoutM", "/.", "withselfreplacement"}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.699707806640571*^9, 3.699707829687098*^9}, {
  3.69979375286362*^9, 3.699793753996879*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Mu]", "-", 
      RowBox[{"d", " ", "\[Mu]"}], "+", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}]}], ")"}]}], 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
    "+", 
    RowBox[{"m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
      ")"}]}]}]]}]], "Output",
 CellChangeTimes->{{3.699707822487941*^9, 3.6997078300797243`*^9}, 
   3.699710623036839*^9, 3.699711328310384*^9, 3.699768644054297*^9, 
   3.6997876439009438`*^9, 3.6997938314317703`*^9, 3.699847452538445*^9, 
   3.699848116650117*^9, 3.699848919649077*^9, 3.699853736709804*^9, 
   3.699955346222619*^9, 3.702201304927656*^9, 3.702289663410713*^9, 
   3.704178948032831*^9, 3.704517704496286*^9, 3.7053818969921217`*^9, 
   3.705387187476713*^9, 3.709989817244776*^9, {3.709990551191963*^9, 
   3.70999055919449*^9}, 3.710045876700582*^9, 3.710049685191901*^9, 
   3.710054025153308*^9, 3.71005449771804*^9, 3.7101569425406923`*^9, 
   3.713407333770465*^9, 3.71422789484529*^9, 3.7142318766498127`*^9, 
   3.719552284852483*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.699707822487941*^9, 3.6997078300797243`*^9}, 
   3.699710623036839*^9, 3.699711328310384*^9, 3.699768644054297*^9, 
   3.6997876439009438`*^9, 3.6997938314317703`*^9, 3.699847452538445*^9, 
   3.699848116650117*^9, 3.699848919649077*^9, 3.699853736709804*^9, 
   3.699955346222619*^9, 3.702201304927656*^9, 3.702289663410713*^9, 
   3.704178948032831*^9, 3.704517704496286*^9, 3.7053818969921217`*^9, 
   3.705387187476713*^9, 3.709989817244776*^9, {3.709990551191963*^9, 
   3.70999055919449*^9}, 3.710045876700582*^9, 3.710049685191901*^9, 
   3.710054025153308*^9, 3.71005449771804*^9, 3.7101569425406923`*^9, 
   3.713407333770465*^9, 3.71422789484529*^9, 3.7142318766498127`*^9, 
   3.719552284859222*^9}]
}, Open  ]],

Cell["\<\
Simplify the way the equations are written (human - friendly versions), and \
check that the formulas remain correct\
\>", "Text",
 CellChangeTimes->{{3.699761775008071*^9, 3.69976179237366*^9}, {
  3.705381811547044*^9, 3.7053818119865637`*^9}, {3.705381903377886*^9, 
  3.7053819107714367`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QinMs", "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", "\[Mu]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "m"}], ")"}]}], "-", "\[Mu]", "+", "m"}], " ", 
       ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}], " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}], 
     ")"}]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6997113031664057`*^9, 3.699711312567246*^9}, {
  3.699711368217142*^9, 3.69971148194987*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699711306964435*^9, 3.699711330449128*^9}, {
   3.699711405295108*^9, 3.699711501403634*^9}, 3.699768644077819*^9, 
   3.699787643923314*^9, 3.699793831480157*^9, 3.699847452660646*^9, 
   3.699848116752124*^9, 3.6998489197130423`*^9, 3.699853736916744*^9, 
   3.69995534633053*^9, 3.7022013051187*^9, 3.7022896635798073`*^9, 
   3.7041789480787897`*^9, 3.704517704688941*^9, 3.705381898245832*^9, 
   3.7053871875219584`*^9, 3.709989819509569*^9, {3.709990551224366*^9, 
   3.709990559243415*^9}, 3.71004587800937*^9, 3.710049685228863*^9, 
   3.710054025267234*^9, 3.7100544977550898`*^9, 3.7101569426100616`*^9, 
   3.7134073337992907`*^9, 3.714227894877342*^9, 3.7142318770507183`*^9, 
   3.719552284960434*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QoutMs", "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}], " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}], 
     ")"}]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.69971150684383*^9, 3.699711545927258*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699711511809864*^9, 3.699711546280471*^9}, 
   3.699768644102571*^9, 3.6997876439352217`*^9, 3.6997938315034237`*^9, 
   3.699847452770508*^9, 3.699848116860183*^9, 3.699848919721965*^9, 
   3.699853737057955*^9, 3.6999553464342012`*^9, 3.702201305216506*^9, 
   3.70228966369522*^9, 3.704178948091934*^9, 3.704517704726959*^9, 
   3.705381899750991*^9, 3.705387187658793*^9, 3.709989820518887*^9, {
   3.70999055124793*^9, 3.7099905592497807`*^9}, 3.710045879528764*^9, 
   3.710049685258443*^9, 3.710054025301811*^9, 3.71005449782145*^9, 
   3.710156942730199*^9, 3.713407333818192*^9, 3.71422789490689*^9, 
   3.7142318772985497`*^9, 3.719552285249906*^9}]
}, Open  ]],

Cell["Check limit behavior:", "Text",
 CellChangeTimes->{{3.699761804937606*^9, 3.699761810525722*^9}, 
   3.705381914092618*^9, 3.710045889491081*^9}],

Cell["\<\
First infinite population, then zero mutation 
vs.
First zero mutation, then infinite population\
\>", "Text",
 CellChangeTimes->{{3.7100458907978363`*^9, 3.710045923323934*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QoutMs", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{
    RowBox[{"Limit", "[", 
     RowBox[{"QoutMs", ",", 
      RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}], ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.699708994901635*^9, 3.699709018760296*^9}, {
  3.705381924595291*^9, 3.705381939234544*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6997090038532143`*^9, 3.699709012966531*^9}, 
   3.699710624218858*^9, 3.69976864421404*^9, 3.699787644053496*^9, 
   3.699793831590859*^9, 3.699847453243531*^9, 3.699848117304596*^9, 
   3.6998489198823643`*^9, 3.6998537373803596`*^9, 3.699955346792079*^9, 
   3.702201305800952*^9, 3.702289664021549*^9, 3.704178948298765*^9, 
   3.704517704957149*^9, 3.705381940123757*^9, 3.705387187711927*^9, 
   3.7099898222878647`*^9, {3.709990551273045*^9, 3.70999055927314*^9}, 
   3.710045881455665*^9, 3.710045924657275*^9, 3.710049685308382*^9, 
   3.710054025374247*^9, 3.7100544979436417`*^9, 3.710156943119441*^9, 
   3.713407333882366*^9, 3.714227894977618*^9, 3.7142318775416727`*^9, 
   3.719552285449535*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.6997090038532143`*^9, 3.699709012966531*^9}, 
   3.699710624218858*^9, 3.69976864421404*^9, 3.699787644053496*^9, 
   3.699793831590859*^9, 3.699847453243531*^9, 3.699848117304596*^9, 
   3.6998489198823643`*^9, 3.6998537373803596`*^9, 3.699955346792079*^9, 
   3.702201305800952*^9, 3.702289664021549*^9, 3.704178948298765*^9, 
   3.704517704957149*^9, 3.705381940123757*^9, 3.705387187711927*^9, 
   3.7099898222878647`*^9, {3.709990551273045*^9, 3.70999055927314*^9}, 
   3.710045881455665*^9, 3.710045924657275*^9, 3.710049685308382*^9, 
   3.710054025374247*^9, 3.7100544979436417`*^9, 3.710156943119441*^9, 
   3.713407333882366*^9, 3.714227894977618*^9, 3.7142318775416727`*^9, 
   3.719552285521401*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QinMs", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.699709024470386*^9, 3.699709032489929*^9}, {
   3.7053819512260942`*^9, 3.705381968403285*^9}, 3.709989834560059*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "1"}], "+", "m", "+", "\[Mu]", "-", 
   RowBox[{"m", " ", "\[Mu]"}]}], 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
   RowBox[{"n", " ", "\[Mu]"}]}]]], "Output",
 CellChangeTimes->{
  3.709989835594761*^9, {3.709990551335326*^9, 3.7099905593324757`*^9}, 
   3.710045882961616*^9, 3.710049685388282*^9, 3.710054025531011*^9, 
   3.7100544980909367`*^9, 3.7101569432513866`*^9, 3.713407333971468*^9, 
   3.714227895078969*^9, 3.7142318778082657`*^9, 3.719552285674273*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "-", "m"}], 
  RowBox[{"1", "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.709989835594761*^9, {3.709990551335326*^9, 3.7099905593324757`*^9}, 
   3.710045882961616*^9, 3.710049685388282*^9, 3.710054025531011*^9, 
   3.7100544980909367`*^9, 3.7101569432513866`*^9, 3.713407333971468*^9, 
   3.714227895078969*^9, 3.7142318778082657`*^9, 3.719552285676735*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Limit", "[", 
  RowBox[{"QinMs", ",", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"%", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.699709024470386*^9, 3.699709032489929*^9}, {
   3.7053819512260942`*^9, 3.705381968403285*^9}, 3.709989834560059*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.6997090210092278`*^9, 3.69970903277978*^9}, 
   3.69971062653979*^9, 3.6997686442727537`*^9, 3.6997876441319523`*^9, 
   3.699793831695056*^9, 3.6998474533978977`*^9, 3.699848117481538*^9, 
   3.699848919995821*^9, 3.699853737514176*^9, 3.699955347039455*^9, 
   3.7022013059393*^9, 3.702289664091626*^9, 3.704178948396358*^9, 
   3.704517705179842*^9, {3.70538195535952*^9, 3.705381969324675*^9}, 
   3.7053871878032713`*^9, {3.7099898250017147`*^9, 3.709989836762285*^9}, {
   3.709990551370511*^9, 3.7099905593424892`*^9}, 3.710045884479703*^9, 
   3.7100496854278107`*^9, 3.710054025571554*^9, 3.710054498173779*^9, 
   3.7101569434079103`*^9, 3.713407334009355*^9, 3.71422789515598*^9, 
   3.7142318781002607`*^9, 3.7195522857231283`*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.6997090210092278`*^9, 3.69970903277978*^9}, 
   3.69971062653979*^9, 3.6997686442727537`*^9, 3.6997876441319523`*^9, 
   3.699793831695056*^9, 3.6998474533978977`*^9, 3.699848117481538*^9, 
   3.699848919995821*^9, 3.699853737514176*^9, 3.699955347039455*^9, 
   3.7022013059393*^9, 3.702289664091626*^9, 3.704178948396358*^9, 
   3.704517705179842*^9, {3.70538195535952*^9, 3.705381969324675*^9}, 
   3.7053871878032713`*^9, {3.7099898250017147`*^9, 3.709989836762285*^9}, {
   3.709990551370511*^9, 3.7099905593424892`*^9}, 3.710045884479703*^9, 
   3.7100496854278107`*^9, 3.710054025571554*^9, 3.710054498173779*^9, 
   3.7101569434079103`*^9, 3.713407334009355*^9, 3.71422789515598*^9, 
   3.7142318781002607`*^9, 3.719552285724368*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{"QinMs", ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.699709522250888*^9, 3.6997095278721046`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "-", 
   RowBox[{"d", " ", "n", " ", "\[Mu]"}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
    SeriesData[$CellContext`\[Mu], 0, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Mu], 0, {1, -$CellContext`d $CellContext`n}, 0, 2,
    1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.699709528137528*^9, 3.699710628816844*^9, 3.699768644340559*^9, 
   3.6997876442139177`*^9, 3.699793831783923*^9, 3.699847453618741*^9, 
   3.6998481177477207`*^9, 3.6998489201632957`*^9, 3.699853737777616*^9, 
   3.699955347297236*^9, 3.702201306310264*^9, 3.702289664332473*^9, 
   3.704178948535757*^9, 3.7045177056573*^9, 3.7053819754795647`*^9, 
   3.7053871878887367`*^9, 3.709989838511971*^9, {3.709990551394704*^9, 
   3.709990559363714*^9}, 3.710045885750225*^9, 3.710049685460968*^9, 
   3.7100540255983458`*^9, 3.710054498245143*^9, 3.710156943564168*^9, 
   3.713407334032131*^9, 3.7142278952644043`*^9, 3.714231878425647*^9, 
   3.719552285921775*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations without Self - replacement (dself = 0)", "Subsubsection",
 CellChangeTimes->{{3.699711579833871*^9, 3.699711584927043*^9}, {
  3.699761821670733*^9, 3.699761827557994*^9}, {3.7053849023043747`*^9, 
  3.70538490546406*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QinMw", "=", 
  RowBox[{
   RowBox[{"QinM", "/.", "noselfreplacement"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"QoutMw", "=", 
  RowBox[{
   RowBox[{"QoutM", "/.", "noselfreplacement"}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.699711592836095*^9, 3.699711601325761*^9}, {
  3.699793767821855*^9, 3.699793768748652*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["m", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]"}], "+", 
     
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{"n", "-", 
        RowBox[{"d", " ", "n", " ", "\[Mu]"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["m", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   RowBox[{"m", " ", "n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.6997116019468412`*^9, 3.699768644533671*^9, 3.699787644417185*^9, 
   3.69979383204049*^9, 3.699847454036537*^9, 3.6998481181339483`*^9, 
   3.699848920540834*^9, 3.699853738101304*^9, 3.6999553475849333`*^9, 
   3.702201306731875*^9, 3.7022896646408653`*^9, 3.704178948882905*^9, 
   3.7045177059345617`*^9, 3.705382083512805*^9, 3.7053871881299458`*^9, 
   3.709989869429002*^9, {3.7099905516280603`*^9, 3.7099905595853243`*^9}, 
   3.710046272076508*^9, 3.710049685721094*^9, 3.710054025887533*^9, 
   3.710054498606215*^9, 3.710156943880591*^9, 3.713407334292684*^9, 
   3.7142278955827703`*^9, 3.714231878910118*^9, 3.7195522863404503`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{"n", "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", "\[Mu]"}], ")"}], 
   " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["m", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   RowBox[{"m", " ", "n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.6997116019468412`*^9, 3.699768644533671*^9, 3.699787644417185*^9, 
   3.69979383204049*^9, 3.699847454036537*^9, 3.6998481181339483`*^9, 
   3.699848920540834*^9, 3.699853738101304*^9, 3.6999553475849333`*^9, 
   3.702201306731875*^9, 3.7022896646408653`*^9, 3.704178948882905*^9, 
   3.7045177059345617`*^9, 3.705382083512805*^9, 3.7053871881299458`*^9, 
   3.709989869429002*^9, {3.7099905516280603`*^9, 3.7099905595853243`*^9}, 
   3.710046272076508*^9, 3.710049685721094*^9, 3.710054025887533*^9, 
   3.710054498606215*^9, 3.710156943880591*^9, 3.713407334292684*^9, 
   3.7142278955827703`*^9, 3.714231878910118*^9, 3.7195522863917627`*^9}]
}, Open  ]],

Cell["Simplify the way they are written", "Text",
 CellChangeTimes->{{3.699761833396513*^9, 3.6997618399413424`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QinMw", "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", "n", " ", "\[Mu]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "m"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "-", "\[Mu]"}], ")"}], " ", "n"}], "-", 
        RowBox[{
         SuperscriptBox["m", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"+", 
        RowBox[{"(", 
         RowBox[{"d", "-", "1"}], ")"}]}], " ", "n", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
      RowBox[{"m", " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]}], ")"}]}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699711609067724*^9, 3.699711686309361*^9}, {
  3.699711723919117*^9, 3.699711751542611*^9}, {3.699711797895731*^9, 
  3.699711864734956*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.699711686662211*^9, 3.699711751870494*^9, {3.699711816592347*^9, 
   3.699711865845346*^9}, 3.699768644600362*^9, 3.699787644466792*^9, 
   3.699793832110257*^9, 3.699847454256627*^9, 3.699848118360941*^9, 
   3.699848920677671*^9, 3.6998537381867332`*^9, 3.6999553476635313`*^9, 
   3.7022013069615297`*^9, 3.702289664866558*^9, 3.704178948975071*^9, 
   3.704517706039962*^9, 3.705382086381508*^9, 3.7053871881938877`*^9, 
   3.709989870934738*^9, {3.70999055167981*^9, 3.7099905596367064`*^9}, 
   3.7100462735697193`*^9, 3.710049685793274*^9, 3.7100540259570208`*^9, 
   3.71005449868565*^9, 3.710156944157042*^9, 3.713407334372147*^9, 
   3.714227895716914*^9, 3.714231879301087*^9, 3.719552286656837*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QoutMw", "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{"n", "+", 
        RowBox[{"m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", "\[Mu]"}], ")"}],
       " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"+", 
        RowBox[{"(", 
         RowBox[{"d", "-", "1"}], ")"}]}], " ", "n", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
      RowBox[{"m", " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]}], ")"}]}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699711882991263*^9, 3.6997119306666183`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699711887715342*^9, 3.699711931186315*^9}, 
   3.6997119658647413`*^9, 3.6997686446717653`*^9, 3.699787644491955*^9, 
   3.699793832136303*^9, 3.699847454363967*^9, 3.699848118497181*^9, 
   3.6998489207195683`*^9, 3.699853738308305*^9, 3.6999553477646217`*^9, 
   3.702201307137039*^9, 3.702289664955021*^9, 3.704178949023452*^9, 
   3.704517706089518*^9, 3.705382087722787*^9, 3.705387188283839*^9, 
   3.709989872699587*^9, {3.709990551701099*^9, 3.709990559655723*^9}, 
   3.710046275025535*^9, 3.710049685833633*^9, 3.71005402599236*^9, 
   3.71005449875325*^9, 3.710156944268029*^9, 3.7134073343879757`*^9, 
   3.714227895760038*^9, 3.714231879589013*^9, 3.7195522868520193`*^9}]
}, Open  ]],

Cell["Limit behavior", "Text",
 CellChangeTimes->{{3.699761843004692*^9, 3.699761846775701*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QinMw", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"%", ",", 
    RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.699712140320222*^9, 3.699712144381168*^9}, {
  3.705382091882864*^9, 3.705382102661297*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "1"}], "+", "m", "+", "\[Mu]", "-", 
   RowBox[{"m", " ", "\[Mu]"}]}], 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}]]], "Output",
 CellChangeTimes->{{3.699712141760172*^9, 3.6997121446551123`*^9}, 
   3.69976864475666*^9, 3.6997876445813713`*^9, 3.69979383222227*^9, 
   3.6998474545895653`*^9, 3.699848118748927*^9, 3.69984892083706*^9, 
   3.6998537385996017`*^9, 3.6999553479241657`*^9, 3.7022013074046917`*^9, 
   3.70228966515206*^9, 3.704178949211241*^9, 3.7045177062678623`*^9, {
   3.705382089870524*^9, 3.7053821029634037`*^9}, 3.70538718836833*^9, 
   3.709989873812937*^9, {3.709990551762856*^9, 3.709990559711013*^9}, 
   3.710046276126759*^9, 3.710049685955085*^9, 3.710054026077231*^9, 
   3.710054498920992*^9, 3.710156944554285*^9, 3.713407334488763*^9, 
   3.714227895975457*^9, 3.714231879864925*^9, 3.7195522870377293`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "-", "m"}], 
  RowBox[{"1", "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "n"}], ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.699712141760172*^9, 3.6997121446551123`*^9}, 
   3.69976864475666*^9, 3.6997876445813713`*^9, 3.69979383222227*^9, 
   3.6998474545895653`*^9, 3.699848118748927*^9, 3.69984892083706*^9, 
   3.6998537385996017`*^9, 3.6999553479241657`*^9, 3.7022013074046917`*^9, 
   3.70228966515206*^9, 3.704178949211241*^9, 3.7045177062678623`*^9, {
   3.705382089870524*^9, 3.7053821029634037`*^9}, 3.70538718836833*^9, 
   3.709989873812937*^9, {3.709990551762856*^9, 3.709990559711013*^9}, 
   3.710046276126759*^9, 3.710049685955085*^9, 3.710054026077231*^9, 
   3.710054498920992*^9, 3.710156944554285*^9, 3.713407334488763*^9, 
   3.714227895975457*^9, 3.714231879864925*^9, 3.71955228707613*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Limit", "[", 
  RowBox[{"QoutMw", ",", 
   RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Limit", "[", 
  RowBox[{"QoutMw", ",", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.699712130826983*^9, 3.699712135993896*^9}, {
  3.705382111666535*^9, 3.7053821152416763`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.699712136340899*^9, 3.6997686447847843`*^9, 3.699787644605831*^9, 
   3.6997938322542067`*^9, 3.699847454702386*^9, 3.699848118809474*^9, 
   3.699848920892647*^9, 3.699853738738146*^9, 3.699955348164055*^9, 
   3.702201307497787*^9, 3.702289665309238*^9, 3.7041789492668447`*^9, 
   3.704517706398435*^9, 3.705382115731319*^9, 3.705387188430135*^9, 
   3.7099898750301332`*^9, {3.709990551842244*^9, 3.709990559739213*^9}, 
   3.7100462777802267`*^9, 3.710049686036673*^9, 3.710054026183473*^9, 
   3.7100544990007257`*^9, 3.710156944790821*^9, 3.7134073345463943`*^9, 
   3.7142278960319147`*^9, 3.714231880161955*^9, 3.719552287166959*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.699712136340899*^9, 3.6997686447847843`*^9, 3.699787644605831*^9, 
   3.6997938322542067`*^9, 3.699847454702386*^9, 3.699848118809474*^9, 
   3.699848920892647*^9, 3.699853738738146*^9, 3.699955348164055*^9, 
   3.702201307497787*^9, 3.702289665309238*^9, 3.7041789492668447`*^9, 
   3.704517706398435*^9, 3.705382115731319*^9, 3.705387188430135*^9, 
   3.7099898750301332`*^9, {3.709990551842244*^9, 3.709990559739213*^9}, 
   3.7100462777802267`*^9, 3.710049686036673*^9, 3.710054026183473*^9, 
   3.7100544990007257`*^9, 3.710156944790821*^9, 3.7134073345463943`*^9, 
   3.7142278960319147`*^9, 3.714231880161955*^9, 3.7195522872015543`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wright - Fisher", "Section",
 CellChangeTimes->{{3.698755041677388*^9, 3.698755047045236*^9}}],

Cell["\<\
The structure of this part is the same as for the Moran version above, so \
comments are lighter here.\
\>", "Text",
 CellChangeTimes->{{3.7100462860792913`*^9, 3.710046305307435*^9}}],

Cell[CellGroupData[{

Cell["Simplify QinM and QoutM", "Subsection",
 CellChangeTimes->{{3.7053925967093763`*^9, 3.705392598368638*^9}}],

Cell["\<\
See Appendix B2 for details on how Qself, Qin and Qout were obtained using a \
formula presented in the appendix of Debarre 2017 JTB for \"2D graphs\".\
\>", "Text",
 CellChangeTimes->{{3.7053850217373037`*^9, 3.705385024128645*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"QselfWF2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", " ", "-", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"dself", "-", "din"}], ")"}], "2"]}]}]], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "d"}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "m", "-", 
             FractionBox["m", 
              RowBox[{"d", "-", "1"}]]}], ")"}], "2"]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QinWF2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", " ", "-", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]], "-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"dself", "-", "din"}], ")"}], "2"]}]}]], "d"}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "m", "-", 
             FractionBox["m", 
              RowBox[{"d", "-", "1"}]]}], ")"}], "2"]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QoutWF2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", " ", "-", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]], "-", 
      FractionBox["1", 
       RowBox[{"1", "-", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "m", "-", 
            FractionBox["m", 
             RowBox[{"d", "-", "1"}]]}], ")"}], "2"]}]}]]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6997135185821047`*^9, 3.699713651029313*^9}, {
  3.699793796275002*^9, 3.6997938023562527`*^9}}],

Cell["Find \[Lambda] using Qself == 1", "Text",
 CellChangeTimes->{{3.699768554735057*^9, 3.699768560789783*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Lambda]WF", "=", 
  RowBox[{"\[Lambda]", "/.", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"QselfWF2", "\[Equal]", "1"}], ",", "\[Lambda]"}], "]"}], 
    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}]], "Input",
 CellChangeTimes->{{3.6997136534525347`*^9, 3.699713667340845*^9}, 
   3.699793805199163*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"d", " ", "n"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"1", "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]], "+", 
     FractionBox[
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
      RowBox[{"1", "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "din"}], "+", "dself"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], 
      RowBox[{"1", "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "m", "-", 
           FractionBox["m", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "d"}]]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]}]]}], ")"}], " ", 
   "\[Mu]"}]]], "Output",
 CellChangeTimes->{{3.699713663992773*^9, 3.699713667644438*^9}, 
   3.6997686498867693`*^9, 3.699787648892887*^9, 3.699793840904955*^9, 
   3.699847462821162*^9, 3.699848127086094*^9, 3.699848944043481*^9, 
   3.699853745219801*^9, 3.699955353774413*^9, 3.702201314357094*^9, 
   3.702289671887183*^9, 3.7041789574015827`*^9, 3.704517713153195*^9, 
   3.705382208155657*^9, 3.705387188496587*^9, 3.709989880379635*^9, 
   3.7099905519487133`*^9, 3.710046310259514*^9, 3.710049686132474*^9, 
   3.7100540298370333`*^9, 3.7100544991556787`*^9, 3.710156945301324*^9, 
   3.7134073346076727`*^9, 3.714227896228875*^9, 3.714231880543619*^9, 
   3.71955228741881*^9}]
}, Open  ]],

Cell["Replace \[Lambda] in the equations", "Text",
 CellChangeTimes->{{3.699768563135151*^9, 3.699768568700657*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QinWF", "=", 
  RowBox[{
   RowBox[{"QinWF2", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", "\[Lambda]WF"}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"QoutWF", "=", 
  RowBox[{
   RowBox[{"QoutWF2", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", "\[Lambda]WF"}]}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.699713671535714*^9, 3.699713691587577*^9}, {
  3.699793806834413*^9, 3.6997938110520763`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox["d", 
     RowBox[{"1", "-", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"din", "-", "dself"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}]}]]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
    RowBox[{"1", "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"din", "-", "dself"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.699713678348674*^9, 3.699713692055463*^9}, 
   3.6997686513293247`*^9, 3.699787650296679*^9, 3.699793842625929*^9, 
   3.699847464903398*^9, 3.699848129275997*^9, 3.699848946322311*^9, 
   3.69985374668642*^9, 3.6999553552201347`*^9, 3.702201315969821*^9, 
   3.7022896737779007`*^9, 3.7041789595883904`*^9, 3.704517714606336*^9, 
   3.705382210606203*^9, 3.705387190408545*^9, 3.709989882981759*^9, 
   3.709990553462431*^9, 3.710046313245983*^9, 3.7100496882054787`*^9, 
   3.71005403169142*^9, 3.710054501055789*^9, 3.7101569472870493`*^9, 
   3.7134073368716087`*^9, 3.714227898289114*^9, 3.714231881935482*^9, 
   3.719552289479233*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
    RowBox[{"1", "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"din", "-", "dself"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.699713678348674*^9, 3.699713692055463*^9}, 
   3.6997686513293247`*^9, 3.699787650296679*^9, 3.699793842625929*^9, 
   3.699847464903398*^9, 3.699848129275997*^9, 3.699848946322311*^9, 
   3.69985374668642*^9, 3.6999553552201347`*^9, 3.702201315969821*^9, 
   3.7022896737779007`*^9, 3.7041789595883904`*^9, 3.704517714606336*^9, 
   3.705382210606203*^9, 3.705387190408545*^9, 3.709989882981759*^9, 
   3.709990553462431*^9, 3.710046313245983*^9, 3.7100496882054787`*^9, 
   3.71005403169142*^9, 3.710054501055789*^9, 3.7101569472870493`*^9, 
   3.7134073368716087`*^9, 3.714227898289114*^9, 3.714231881935482*^9, 
   3.719552289703912*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check numerically", "Subsection",
 CellChangeTimes->{{3.705383839778914*^9, 3.7053838430531073`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NGetQWF", "[", 
   RowBox[{
   "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "p_", ",", 
    "\[Mu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"QT", ",", "eqs", ",", "vars", ",", "sols", ",", "QTs"}], "}"}], 
    ",", 
    RowBox[{"(*", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", " ", "is", " ", "the", " ", "dispersal", " ", "graph"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
      "\[CapitalNu]", " ", "is", " ", "the", " ", "size", " ", "of", " ", 
       "the", " ", "population"}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "graphdegree", " ", "is", " ", "the", " ", "degree", " ", "of", " ", 
       "the", " ", "graph", " ", 
       RowBox[{"(", 
        RowBox[{"=", 
         RowBox[{"1", " ", "in", " ", "a", " ", "subdivided", " ", "pop"}]}], 
        ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "is", " ", "the", " ", "mutation", " ", "biais"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]", " ", "is", " ", "the", " ", "mutation", " ", 
       RowBox[{"probability", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Initialize", " ", "the", " ", "QT", " ", "matrix"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], "=", "0"}], ";", 
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], "=."}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"QT", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        SubscriptBox["Q", 
         RowBox[{"i", ",", "j"}]], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QT", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], "=", "1"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       SubscriptBox["Q", 
        RowBox[{"i", ",", "i"}]], "=", "1"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QT", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
        SubscriptBox["Q", 
         RowBox[{"j", ",", "i"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"j", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Because", " ", "Q", " ", "is", " ", "symmetric"}], " ", "*)"}],
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["Q", 
           RowBox[{"i", ",", "j"}]], "\[Equal]", 
          RowBox[{
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
            SuperscriptBox["graphdegree", "2"]], 
           RowBox[{"(", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"G", "\[LeftDoubleBracket]", 
                RowBox[{"l", ",", "j"}], "\[RightDoubleBracket]"}], 
               RowBox[{"G", "\[LeftDoubleBracket]", 
                RowBox[{"k", ",", "i"}], "\[RightDoubleBracket]"}], 
               RowBox[{"QT", "\[LeftDoubleBracket]", 
                RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
            ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sols", "=", 
      RowBox[{"NSolve", "[", 
       RowBox[{"eqs", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"QTs", "=", 
      RowBox[{"QT", "/.", 
       RowBox[{
       "sols", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", "QTs"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.710046837714695*^9, 3.710046841508738*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"prs", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CheckQWF", "[", 
   RowBox[{"prs_", ",", "dvalues_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NG", ",", "NQin", ",", "NQout", ",", "NQinMatrix"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NG", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<G\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"d", " ", "n"}], "/.", "prs"}], "]"}], "<>", 
          "\"\<generic\>\""}], "]"}], "/.", "dvalues"}], "/.", "prs"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"NQinMatrix", "=", 
      RowBox[{"NGetQWF", "[", 
       RowBox[{"NG", ",", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "/.", "prs"}], ",", "1", ",", "0.5", ",", 
        RowBox[{"\[Mu]", "/.", "prs"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NQin", "=", 
      RowBox[{"NQinMatrix", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NQout", "=", 
      RowBox[{"NQinMatrix", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "/.", "prs"}]}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Qin\>\"", ",", "NQin", ",", 
            RowBox[{
             RowBox[{"QinWF", "/.", "dvalues"}], "/.", "prs"}]}], "}"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"\"\<Qout\>\"", ",", "NQout", ",", 
            RowBox[{
             RowBox[{"QoutWF", "/.", "dvalues"}], "/.", "prs"}]}], "}"}]}], 
         "}"}], "//", "Transpose"}], "//", "MatrixForm"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.705383847090728*^9, 3.705383857404091*^9}, {
  3.7053838996520348`*^9, 3.7053839022914953`*^9}, {3.710046333220248*^9, 
  3.71004636876978*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"CheckQWF", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}], ",", 
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", 
   "withselfreplacement"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"CheckQWF", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}], ",", 
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", "noselfreplacement"}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"CheckQWF", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "2"}], ",", 
     RowBox[{"n", "\[Rule]", "5"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", 
   "withselfreplacement"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"CheckQWF", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "2"}], ",", 
     RowBox[{"n", "\[Rule]", "5"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", "noselfreplacement"}],
   "]"}]}], "Input",
 CellChangeTimes->{{3.705383847090728*^9, 3.705383857404091*^9}, {
  3.7053838996520348`*^9, 3.7053839022914953`*^9}, {3.710046333220248*^9, 
  3.710046381231841*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.21835246847214482`", "0.08161535624318243`"},
     {"0.21835246847214485`", "0.08161535624318234`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.70538389339319*^9, 3.705383903192623*^9}, 
   3.7053871909954557`*^9, 3.7099898974331007`*^9, 3.709990553945369*^9, 
   3.71004631687917*^9, {3.710046356579269*^9, 3.710046381920025*^9}, 
   3.7100468461683073`*^9, 3.710049688721513*^9, 3.710054032116688*^9, 
   3.710054501687112*^9, 3.710156948167297*^9, 3.71340733740383*^9, 
   3.714227899137577*^9, 3.714231882825202*^9, 3.7195522902034817`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.17804414067103275`", "0.07703574013905495`"},
     {"0.17804414067103244`", "0.07703574013905486`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.70538389339319*^9, 3.705383903192623*^9}, 
   3.7053871909954557`*^9, 3.7099898974331007`*^9, 3.709990553945369*^9, 
   3.71004631687917*^9, {3.710046356579269*^9, 3.710046381920025*^9}, 
   3.7100468461683073`*^9, 3.710049688721513*^9, 3.710054032116688*^9, 
   3.710054501687112*^9, 3.710156948167297*^9, 3.71340733740383*^9, 
   3.714227899137577*^9, 3.714231882825202*^9, 3.719552290285969*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.171990359970927`", "0.1224130675949659`"},
     {"0.17199035997092688`", "0.12241306759496573`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.70538389339319*^9, 3.705383903192623*^9}, 
   3.7053871909954557`*^9, 3.7099898974331007`*^9, 3.709990553945369*^9, 
   3.71004631687917*^9, {3.710046356579269*^9, 3.710046381920025*^9}, 
   3.7100468461683073`*^9, 3.710049688721513*^9, 3.710054032116688*^9, 
   3.710054501687112*^9, 3.710156948167297*^9, 3.71340733740383*^9, 
   3.714227899137577*^9, 3.714231882825202*^9, 3.719552290324992*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.16477201691061744`", "0.12031913465055881`"},
     {"0.16477201691061727`", "0.12031913465055864`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.70538389339319*^9, 3.705383903192623*^9}, 
   3.7053871909954557`*^9, 3.7099898974331007`*^9, 3.709990553945369*^9, 
   3.71004631687917*^9, {3.710046356579269*^9, 3.710046381920025*^9}, 
   3.7100468461683073`*^9, 3.710049688721513*^9, 3.710054032116688*^9, 
   3.710054501687112*^9, 3.710156948167297*^9, 3.71340733740383*^9, 
   3.714227899137577*^9, 3.714231882825202*^9, 3.719552290399097*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Particular cases", "Subsection",
 CellChangeTimes->{{3.7099899437833014`*^9, 3.70998994895147*^9}}],

Cell[CellGroupData[{

Cell["With Self Replacement", "Subsubsection",
 CellChangeTimes->{{3.699713697718473*^9, 3.699713702474758*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QinWFs", "=", 
  RowBox[{
   RowBox[{"QinWF", "/.", "withselfreplacement"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699713715219798*^9, 3.699713729121462*^9}, 
   3.6997938139913893`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "d"}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.6997137205942917`*^9, 3.6997137296346273`*^9}, 
   3.6997686517538443`*^9, 3.6997876505973454`*^9, 3.699793843963087*^9, 
   3.699847465465046*^9, 3.69984812985738*^9, 3.699848946767274*^9, 
   3.699853747064089*^9, 3.699955355684174*^9, 3.702201316414547*^9, 
   3.7022896743934183`*^9, 3.7041789601167593`*^9, 3.704517715073738*^9, 
   3.705382211114374*^9, 3.705387191365016*^9, 3.709989902727758*^9, 
   3.709990554071863*^9, 3.710046388215872*^9, 3.710049689182773*^9, 
   3.7100540325722713`*^9, 3.7100545020664988`*^9, 3.710156948694996*^9, 
   3.713407337873167*^9, 3.714227899635427*^9, 3.714231883509173*^9, 
   3.719552290618723*^9}]
}, Open  ]],

Cell["Simplify the way it is written", "Text",
 CellChangeTimes->{{3.710046422562079*^9, 3.710046428585051*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M1", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M2", "=", 
    FractionBox["1", 
     RowBox[{
      RowBox[{"2", " ", "\[Mu]"}], "-", 
      SuperscriptBox["\[Mu]", "2"]}]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qinwfs", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "d"}], " ", "+", " ", "M1", "+", "M2"}], 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}], "d"}], "+", "M1", "+", "M2"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QinWFs", " ", "-", " ", "qinwfs"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.704715667696094*^9, 3.70471569325393*^9}, {
  3.71004644570728*^9, 3.710046446146241*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.710046446538151*^9, 3.7100496892133427`*^9, 
  3.710054032601166*^9, 3.710054502132368*^9, 3.7101569488466187`*^9, 
  3.7134073378947353`*^9, 3.714227899670794*^9, 3.714231883812028*^9, 
  3.7195522908015413`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QoutWFs", "=", 
  RowBox[{
   RowBox[{"QoutWF", "/.", "withselfreplacement"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.69971376959558*^9, 3.699713781778393*^9}, 
   3.699793816389996*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{3.699713782107119*^9, 3.6997686518296843`*^9, 
  3.699787650721113*^9, 3.699793844171132*^9, 3.699847465709929*^9, 
  3.699848130119707*^9, 3.699848946820631*^9, 3.69985374730326*^9, 
  3.6999553558645163`*^9, 3.702201316667905*^9, 3.702289674700729*^9, 
  3.7041789602895823`*^9, 3.704517715379057*^9, 3.7053822164241*^9, 
  3.7053871914895887`*^9, 3.70998990368915*^9, 3.70999055422438*^9, 
  3.710046389301339*^9, 3.710049689296924*^9, 3.710054032672058*^9, 
  3.710054502279993*^9, 3.710156949101604*^9, 3.713407337961378*^9, 
  3.714227899740139*^9, 3.714231884109681*^9, 3.719552291071203*^9}]
}, Open  ]],

Cell["Simplify the way it is written", "Text",
 CellChangeTimes->{{3.7100464596730213`*^9, 3.710046464870203*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qoutwfs", "=", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"-", "1"}], 
        RowBox[{"d", "-", "1"}]], "M1"}], "+", "M2"}], 
     RowBox[{
      RowBox[{"d", 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}], "+", "M1", "+", "M2"}]], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qoutwfs", "-", "QoutWFs"}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.710046466715753*^9, 3.710046475975423*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.710046473334022*^9, 3.710046476392544*^9}, 
   3.710049689325638*^9, 3.7100540327022533`*^9, 3.710054502293746*^9, 
   3.71015694919741*^9, 3.713407337989614*^9, 3.7142278999337473`*^9, 
   3.71423188434804*^9, 3.719552291229485*^9}]
}, Open  ]],

Cell["Limit behavior", "Text",
 CellChangeTimes->{{3.705385041146565*^9, 3.70538504847071*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Limit", "[", 
  RowBox[{"QinWFs", ",", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Limit", "[", 
  RowBox[{"QoutWFs", ",", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7053850501521*^9, 3.705385108098117*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.7053851085939703`*^9, 3.705387191627996*^9, 
  3.7099899052270317`*^9, 3.709990554245013*^9, 3.710046390154361*^9, 
  3.710049689383913*^9, 3.710054032821878*^9, 3.71005450246974*^9, 
  3.7101569493481092`*^9, 3.7134073381801767`*^9, 3.714227900049821*^9, 
  3.714231884569687*^9, 3.719552291410769*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.7053851085939703`*^9, 3.705387191627996*^9, 
  3.7099899052270317`*^9, 3.709990554245013*^9, 3.710046390154361*^9, 
  3.710049689383913*^9, 3.710054032821878*^9, 3.71005450246974*^9, 
  3.7101569493481092`*^9, 3.7134073381801767`*^9, 3.714227900049821*^9, 
  3.714231884569687*^9, 3.719552291439598*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QinWFs", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"%", ",", 
    RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7053850501521*^9, 3.705385099592635*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "1"}], "-", 
    RowBox[{"2", " ", "m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["m", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", 
     "\[Mu]"}]}]]}]], "Output",
 CellChangeTimes->{{3.7053850729698668`*^9, 3.705385099935501*^9}, 
   3.7053871919399967`*^9, 3.7099899065603447`*^9, 3.709990554385026*^9, 
   3.7100463911668177`*^9, 3.710049689690675*^9, 3.710054033106924*^9, 
   3.7100545028536243`*^9, 3.7101569496858053`*^9, 3.713407338656136*^9, 
   3.7142279003587093`*^9, 3.7142318850416603`*^9, 3.719552291814623*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}]]}]], "Output",
 CellChangeTimes->{{3.7053850729698668`*^9, 3.705385099935501*^9}, 
   3.7053871919399967`*^9, 3.7099899065603447`*^9, 3.709990554385026*^9, 
   3.7100463911668177`*^9, 3.710049689690675*^9, 3.710054033106924*^9, 
   3.7100545028536243`*^9, 3.7101569496858053`*^9, 3.713407338656136*^9, 
   3.7142279003587093`*^9, 3.7142318850416603`*^9, 3.7195522918459997`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QoutWFs", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.705385116067935*^9, 3.705385122312422*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.7053851175044403`*^9, 3.7053851229146233`*^9}, 
   3.705387192135598*^9, 3.7099899076389303`*^9, 3.7099905544255743`*^9, 
   3.710046392165245*^9, 3.710049689859709*^9, 3.710054033248378*^9, 
   3.710054503002428*^9, 3.710156949996866*^9, 3.7134073387900457`*^9, 
   3.7142279004834127`*^9, 3.714231885285528*^9, 3.71955229214532*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Comparison to Cockerham and Weir 1987", "Subsubsection",
 CellChangeTimes->{{3.7101558010783978`*^9, 3.710155812523353*^9}}],

Cell["Cockerham and Weir\[CloseCurlyQuote]s \[Beta]", "Text",
 CellChangeTimes->{{3.7101533456316957`*^9, 3.710153350912513*^9}, {
  3.710155679639537*^9, 3.7101556816751003`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dd", " ", "=", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", " ", 
       FractionBox["nbdemes", 
        RowBox[{"nbdemes", "-", "1"}]]}]}], ")"}], "2"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", "=", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7101533589980097`*^9, 3.710153431778693*^9}, {
   3.7101534922471943`*^9, 3.710153506936021*^9}, 3.710153933234684*^9, 
   3.710155690597134*^9, 3.710155742896264*^9}],

Cell["\<\
Update deme size, which is 2 N in their paper, to N, to adapt the result to a \
haploid population\
\>", "Text",
 CellChangeTimes->{{3.7101556954302807`*^9, 3.7101557143671417`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[Beta]", " ", "=", " ", 
  RowBox[{
   RowBox[{"\[Rho]", " ", 
    RowBox[{"dd", " ", "/", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"demesize", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"\[Rho]", " ", "dd"}]}], ")"}]}], "+", 
       RowBox[{"\[Rho]", " ", "dd"}]}], ")"}]}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", "=."}], ";", 
  RowBox[{"dd", "=."}], ";"}]}], "Input",
 CellChangeTimes->{{3.7101533589980097`*^9, 3.710153431778693*^9}, {
   3.7101534922471943`*^9, 3.710153506936021*^9}, 3.710153933234684*^9, {
   3.710155690597134*^9, 3.710155694185615*^9}, {3.7101557458729973`*^9, 
   3.710155766567562*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "nbdemes"}]}], ")"}], 
    "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "nbdemes"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"demesize", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "nbdemes"}]}], 
            ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "nbdemes"}], ")"}], "2"]]}], ")"}]}], 
     "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "nbdemes"}]}], ")"}],
         "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "nbdemes"}], ")"}], "2"]]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{{3.710153415668852*^9, 3.7101534323330593`*^9}, {
   3.7101534965249243`*^9, 3.710153507959269*^9}, 3.710153935736274*^9, 
   3.710153989895019*^9, {3.710155753039229*^9, 3.710155770064417*^9}, 
   3.710156950895701*^9, 3.7134073398087*^9, 3.714227901206571*^9, 
   3.7142318875639133`*^9, 3.7195522931130123`*^9}]
}, Open  ]],

Cell["For us:", "Text",
 CellChangeTimes->{{3.710153511616827*^9, 3.710153517064158*^9}, {
  3.7101557182870827`*^9, 3.710155719678792*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"my\[Beta]", "=", 
  RowBox[{
   FractionBox[
    RowBox[{"QinWF", "-", "QoutWF"}], 
    RowBox[{"1", "-", "QoutWF"}]], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.7101535909793243`*^9, 3.710153618436535*^9}, {
  3.710155736968443*^9, 3.710155754666039*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"din", "-", "dself"}], ")"}], "2"]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "d", " ", "m"}], "-", 
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SuperscriptBox["m", "2"]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", 
    RowBox[{"2", " ", "\[Mu]"}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", "n"}], ")"}], " ", 
     "\[Mu]"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", "n"}], ")"}], " ", 
     SuperscriptBox["\[Mu]", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
       RowBox[{"2", " ", "\[Mu]"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", "n"}], ")"}], " ", 
        "\[Mu]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}], "+", 
    RowBox[{"2", " ", "d", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"din", "-", "dself"}], ")"}], "2"], "-", "m", "+", 
       RowBox[{"m", " ", "n"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", "m", "+", "n", 
          "-", 
          RowBox[{"m", " ", "n"}]}], ")"}], " ", "\[Mu]"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", "m", "+", "n", 
          "-", 
          RowBox[{"m", " ", "n"}]}], ")"}], " ", 
        SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.710153612255775*^9, 3.710153619120739*^9}, 
   3.7101539400130787`*^9, 3.710153994000152*^9, {3.710155755518497*^9, 
   3.710155771191538*^9}, 3.710156952359514*^9, 3.713407342261114*^9, 
   3.714227902738133*^9, 3.714231889107934*^9, 3.719552294794332*^9}]
}, Open  ]],

Cell["Compare the two -> same !", "Text",
 CellChangeTimes->{{3.710155774070763*^9, 3.710155783048971*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"my\[Beta]", "-", "\[Beta]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nbdemes", "\[Rule]", "d"}], ",", 
     RowBox[{"demesize", "\[Rule]", "n"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.710153631178689*^9, 3.710153648804803*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"d", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
              " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}], ")"}]}], "+", 
         
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"d", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
           
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}], ")"}]}]]}], "+", 
    
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"din", "-", "dself"}], ")"}], "2"]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "d", " ", "m"}], "-", 
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SuperscriptBox["m", "2"]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", 
       RowBox[{"2", " ", "\[Mu]"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", "n"}], ")"}], 
        " ", "\[Mu]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", "n"}], ")"}], 
        " ", 
        SuperscriptBox["\[Mu]", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
          RowBox[{"2", " ", "\[Mu]"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", "n"}], ")"}], 
           " ", "\[Mu]"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
           SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}], "+", 
       RowBox[{"2", " ", "d", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"din", "-", "dself"}], ")"}], "2"], "-", "m", "+", 
          RowBox[{"m", " ", "n"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", "m", "+", "n",
              "-", 
             RowBox[{"m", " ", "n"}]}], ")"}], " ", "\[Mu]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", "m", "+", "n",
              "-", 
             RowBox[{"m", " ", "n"}]}], ")"}], " ", 
           SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.710153644453782*^9, 3.710153649486642*^9}, {
   3.710153977518886*^9, 3.710153996770756*^9}, {3.710155757055417*^9, 
   3.710155772257462*^9}, 3.7101569568974047`*^9, 3.713407348314444*^9, 
   3.71422790744143*^9, 3.7142318971413527`*^9, 3.719552299495515*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]", "=."}], ";", 
  RowBox[{"my\[Beta]", "=."}], ";"}]], "Input",
 CellChangeTimes->{{3.710155827463566*^9, 3.710155833449524*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Without Self Replacement", "Subsubsection",
 CellChangeTimes->{{3.699713697718473*^9, 3.699713702474758*^9}, {
  3.6997140344242887`*^9, 3.6997140345381327`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QinWFw", "=", 
  RowBox[{
   RowBox[{"QinWF", "/.", "noselfreplacement"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699713715219798*^9, 3.699713729121462*^9}, {
   3.699714032451695*^9, 3.699714037934367*^9}, 3.699793818749946*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
   FractionBox["d", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox[
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.6997137205942917`*^9, 3.6997137296346273`*^9}, 
   3.699714039975412*^9, 3.699768653054854*^9, 3.699787652032732*^9, 
   3.6997938456645737`*^9, 3.699847467487503*^9, 3.6998481320938587`*^9, 
   3.6998489485357647`*^9, 3.699853748614737*^9, 3.699955357081094*^9, 
   3.702201318097715*^9, 3.702289676445603*^9, 3.704178962090172*^9, 
   3.7045177167620573`*^9, 3.705382220777729*^9, 3.7053871936452217`*^9, 
   3.70998991030722*^9, 3.7099905553194304`*^9, 3.7100464851628847`*^9, 
   3.71004969115324*^9, 3.7100540344483*^9, 3.710054504229106*^9, 
   3.710156958417386*^9, 3.7134073501330633`*^9, 3.714227908931292*^9, 
   3.714231898992942*^9, 3.71955230106396*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QoutWFw", "=", 
  RowBox[{
   RowBox[{"QoutWF", "/.", "noselfreplacement"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.69971376959558*^9, 3.699713781778393*^9}, {
   3.699714043938485*^9, 3.699714047373885*^9}, 3.6997938202130213`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox[
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{3.699713782107119*^9, 3.699714048290897*^9, 
  3.6997686532808933`*^9, 3.699787652287928*^9, 3.6997938458919277`*^9, 
  3.699847467901083*^9, 3.6998481326015472`*^9, 3.699848948881896*^9, 
  3.699853748947424*^9, 3.699955357392652*^9, 3.7022013184846163`*^9, 
  3.70228967685288*^9, 3.704178962424152*^9, 3.7045177171525517`*^9, 
  3.705382220970962*^9, 3.7053871941159887`*^9, 3.70998991061347*^9, 
  3.709990555540123*^9, 3.7100464856492453`*^9, 3.710049691371263*^9, 
  3.7100540346669807`*^9, 3.710054504572701*^9, 3.7101569588867083`*^9, 
  3.71340735044776*^9, 3.7142279093643913`*^9, 3.714231900137219*^9, 
  3.719552301427497*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export to R the Q results", "Section",
 CellChangeTimes->{{3.702201500553801*^9, 3.702201503237453*^9}, {
  3.704803404476313*^9, 3.7048034064996977`*^9}}],

Cell["Rewrite the Greek letters", "Text",
 CellChangeTimes->{{3.702202576100587*^9, 3.702202585533182*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GreekTerms", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Omega]", "\[Rule]", "sel"}], ",", " ", 
    RowBox[{"\[Mu]", "\[Rule]", "mut"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.702201509383871*^9, 3.702201525212894*^9}, {
  3.704724390807227*^9, 3.70472439943757*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Omega]", "\[Rule]", "sel"}], ",", 
   RowBox[{"\[Mu]", "\[Rule]", "mut"}]}], "}"}]], "Output",
 CellChangeTimes->{3.70220152616304*^9, 3.7022030131218777`*^9, 
  3.7022897635244837`*^9, 3.704179086467165*^9, 3.7045177944473457`*^9, 
  3.704724393799959*^9, 3.7047246634923162`*^9, 3.704736510164259*^9, 
  3.710054037836182*^9, 3.710054504691545*^9, 3.7101569590860987`*^9, 
  3.713407350476017*^9, 3.714227909395928*^9, 3.7142319005319*^9, 
  3.719552301597114*^9}]
}, Open  ]],

Cell["Common parts to all functions", "Text",
 CellChangeTimes->{{3.7022025881711607`*^9, 3.7022025922143908`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "FunctionPartB", "=", 
   "\"\< <- function(p, sel, mut, m, g, n, d, Idself, Ieself){\n## Arguments:\
\n#  p   mutation bias\n#  sel intensity of selection\n#  mut mutation \
probability\n#  m   emigration probability\n#  g   proportion of interactions \
out of the group (interaction equivalent of m)\n#  n   deme size\n#  d   \
number of demes\n#  Idself whether reproduction in site where the parent is\n\
#  Ieself whether interactions with oneself\nreturn(\n\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FunctionPartE", "=", "\"\<)\n}\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.702201586590098*^9, 3.702201660652206*^9}, {
  3.702202515399782*^9, 3.70220251599327*^9}, {3.702202562602117*^9, 
  3.702202562914797*^9}, {3.702202598064639*^9, 3.702202697296604*^9}, {
  3.702202988690043*^9, 3.702203007885222*^9}, {3.704724417045898*^9, 
  3.7047244695037813`*^9}}],

Cell["Function to translate Mathematica to R", "Text",
 CellChangeTimes->{{3.702202703211164*^9, 3.702202713861825*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToRForm", "[", "x_", "]"}], ":=", 
  RowBox[{"ToString", "[", 
   RowBox[{
    RowBox[{"x", "/.", "GreekTerms"}], "//", "CForm"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.702201842966589*^9, 3.702201859620515*^9}}],

Cell["Do it for Q", "Text",
 CellChangeTimes->{{3.704724511134218*^9, 3.704724513442933*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RtxtQinM", "=", 
   RowBox[{"\"\<QinM \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{"QinM", "/.", "genericde"}], "//", "FullSimplify"}], "]"}], "<>",
     "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtQoutM", "=", 
   RowBox[{"\"\<QoutM \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{"QoutM", "/.", "genericde"}], "//", "FullSimplify"}], "]"}], "<>",
     "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtQinWF", "=", 
   RowBox[{"\"\<QinWF \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{"QinWF", "/.", "genericde"}], "//", "FullSimplify"}], "]"}], "<>",
     "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtQoutWF", "=", 
   RowBox[{"\"\<QoutWF \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{"QoutWF", "/.", "genericde"}], "//", "FullSimplify"}], "]"}], "<>",
     "FunctionPartE"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.704724517750942*^9, 3.704724604063252*^9}}],

Cell["Define Power function in R", "Text",
 CellChangeTimes->{{3.7022027318210173`*^9, 3.702202737612219*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PowerDef", "=", "\"\<Power <- function(a,b) return(a^b)\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.702201909153489*^9, 3.7022019359137297`*^9}, {
  3.7022019780679827`*^9, 3.702201985090732*^9}}],

Cell["Combine all texts", "Text",
 CellChangeTimes->{{3.702202739839615*^9, 3.702202745125101*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rtxt", "=", 
   RowBox[{
   "PowerDef", "<>", "\"\<\n\n\>\"", "<>", "RtxtQinM", "<>", "\"\<\n\n\>\"", "<>",
     "RtxtQoutM", "<>", "\"\<\n\n\>\"", "<>", "RtxtQinWF", "<>", 
    "\"\<\n\n\>\"", "<>", "RtxtQoutWF"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7022019405139227`*^9, 3.702201966147601*^9}, {
  3.7047246131819277`*^9, 3.704724637059588*^9}}],

Cell["Export to txt file (Mathematica did not want R)", "Text",
 CellChangeTimes->{{3.702202748144455*^9, 3.70220275825738*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"pathtosave", "<>", "\"\<Mathematica/analyticsQ.txt\>\""}], ",", 
    "Rtxt"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.702201967861699*^9, 3.702202007961507*^9}, {
   3.702202094017145*^9, 3.7022021946253023`*^9}, 3.7047246446676083`*^9, {
   3.710054058242139*^9, 3.710054064754195*^9}, 3.7100544433043947`*^9}],

Cell["Convert the file extension to R", "Text",
 CellChangeTimes->{{3.702202760522964*^9, 3.702202776867174*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cmd", "=", 
   RowBox[{
   "\"\<mv \>\"", "<>", "pathtosave", "<>", 
    "\"\<Mathematica/analyticsQ.txt \>\"", "<>", "pathtosave", "<>", 
    "\"\<Mathematica/analyticsQ.R\>\""}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7100540725428658`*^9, 3.710054132681882*^9}}],

Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{"\"\<!\>\"", "<>", "cmd"}], "]"}]], "Input",
 CellChangeTimes->{{3.71005413757959*^9, 3.710054140750166*^9}, {
  3.7100541794834137`*^9, 3.710054181106045*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
2) Expected frequency of altruists in a subdivided population\
\>", "Title",
 CellChangeTimes->{{3.714226756880457*^9, 3.7142267846734247`*^9}}],

Cell[CellGroupData[{

Cell["Initializations", "Section",
 CellChangeTimes->{{3.714227869949942*^9, 3.714227873207934*^9}}],

Cell["Conditions on the parameters", "Text",
 CellChangeTimes->{{3.712973643690879*^9, 3.712973648322013*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"assumpts", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", ">", "1"}], "&&", 
     RowBox[{"d", ">", "2"}], "&&", 
     RowBox[{"\[Mu]", ">", "0"}], "&&", 
     RowBox[{"\[Mu]", "<", "1"}], "&&", 
     RowBox[{"m", ">", "0"}], "&&", 
     RowBox[{"m", "<", "1"}], "&&", 
     RowBox[{"b", ">", "0"}], "&&", 
     RowBox[{"c", ">", "0"}], "&&", 
     RowBox[{"b", ">", "c"}], "&&", 
     RowBox[{"\[Nu]", ">", "0"}], "&&", 
     RowBox[{"\[Nu]", "<", "1"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.712973640251402*^9, {3.713414973843594*^9, 3.713414977819476*^9}}],

Cell["Fullsimplify with conditions on the parameters", "Text",
 CellChangeTimes->{{3.712973651749627*^9, 3.712973659335209*^9}, {
  3.71299998629117*^9, 3.712999988131076*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AF", "[", "x_", "]"}], ":=", 
  RowBox[{"Assuming", "[", 
   RowBox[{"assumpts", ",", 
    RowBox[{"FullSimplify", "[", "x", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.712973660152466*^9, 3.712973669462085*^9}}],

Cell[CellGroupData[{

Cell["Relatedness", "Subsection",
 CellChangeTimes->{{3.71422919344092*^9, 3.7142291964147663`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"R2M", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"QinM", "-", "QoutM"}], 
      RowBox[{"1", "-", "QoutM"}]], "/.", "genericde"}], "/.", 
    RowBox[{"{", 
     RowBox[{"Idself", "\[Rule]", "1"}], "}"}]}], "//", 
   "AF"}]}], "\[IndentingNewLine]", 
 RowBox[{"R2WF", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"QinWF", "-", "QoutWF"}], 
      RowBox[{"1", "-", "QoutWF"}]], "/.", "genericde"}], "/.", 
    RowBox[{"{", 
     RowBox[{"Idself", "\[Rule]", "1"}], "}"}]}], "//", "AF"}]}]}], "Input",
 CellChangeTimes->{{3.7142291980260553`*^9, 3.714229243404766*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], 
   RowBox[{"1", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
       RowBox[{"n", " ", "\[Mu]"}]}], ")"}]}]}]]}]], "Output",
 CellChangeTimes->{{3.714229203117908*^9, 3.7142292438277073`*^9}, 
   3.7142319093299017`*^9, {3.7195523730301743`*^9, 3.7195523779102297`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
      "+", 
      RowBox[{"2", " ", "\[Mu]"}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", "n"}], ")"}], " ", 
       "\[Mu]"}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
       SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.714229203117908*^9, 3.7142292438277073`*^9}, 
   3.7142319093299017`*^9, {3.7195523730301743`*^9, 3.719552378555109*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameters", "Subsection",
 CellChangeTimes->{{3.7142294219628763`*^9, 3.714229426311678*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"prm", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d", "\[Rule]", "15"}], ",", 
     RowBox[{"n", "\[Rule]", "4"}], ",", 
     RowBox[{"b", "\[Rule]", "15"}], ",", 
     RowBox[{"c", "\[Rule]", "1"}], ",", 
     RowBox[{"\[Delta]", "\[Rule]", "0.05"}], ",", 
     RowBox[{"\[Nu]", "\[Rule]", "0.45"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.714229430093514*^9, 3.714229432290728*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivatives of the expected frequency of altruists", "Section",
 CellChangeTimes->{{3.714226588268301*^9, 3.7142265983468113`*^9}}],

Cell[CellGroupData[{

Cell["Definitions", "Subsection",
 CellChangeTimes->{{3.7134087082825403`*^9, 3.713408710648761*^9}}],

Cell[TextData[{
 "Fitness derivative: decomposition \n",
 StyleBox["Notation:",
  FontWeight->"Bold"],
 " s=self, i=deme-mate who is not the focal"
}], "Text",
 CellChangeTimes->{{3.7142261666161013`*^9, 3.714226196613112*^9}, {
  3.714226340334671*^9, 3.714226343850244*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dW", "=", 
   RowBox[{"dWs", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], "dWi", " ", "R2"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.712984150139451*^9, 3.712984179431731*^9}}],

Cell["Further decomposition with fecundities:", "Text",
 CellChangeTimes->{{3.714226204055153*^9, 3.714226215940929*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dWs", "=", 
   RowBox[{
    RowBox[{"dWfs", " ", 
     RowBox[{"(", 
      RowBox[{"-", "c"}], ")"}]}], "+", 
    RowBox[{"b", " ", "dWfi"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dWi", "=", 
   RowBox[{
    RowBox[{"dWfs", " ", 
     FractionBox["b", 
      RowBox[{"n", "-", "1"}]]}], "+", 
    RowBox[{"dWfi", 
     RowBox[{"(", 
      RowBox[{"-", "c"}], ")"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"n", "-", "2"}], 
      RowBox[{"n", "-", "1"}]], "b", " ", "dWfi"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.712984186904654*^9, 3.712984288567268*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Values for each life-cycle, obtained by taking derivatives in table S2\
\[CloseCurlyDoubleQuote]\
\>", "Subsection",
 CellChangeTimes->{{3.714226309372588*^9, 3.714226318628942*^9}}],

Cell[CellGroupData[{

Cell["Moran Death - Birth", "Subsubsection",
 CellChangeTimes->{{3.714226220081223*^9, 3.7142262246698437`*^9}, {
  3.7142262854943*^9, 3.714226327838628*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dWfsDB", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], 
    FractionBox["1", 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "m"}], ")"}], "2"], "n"], "-", 
      FractionBox[
       SuperscriptBox["m", "2"], 
       RowBox[{"n", 
        RowBox[{"(", 
         RowBox[{"d", "-", "1"}], ")"}]}]]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dWfiDB", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], 
    FractionBox["1", 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "m"}], ")"}], "2"], "n"]}], "-", 
      FractionBox[
       SuperscriptBox["m", "2"], 
       RowBox[{"n", 
        RowBox[{"(", 
         RowBox[{"d", "-", "1"}], ")"}]}]]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.712984338322064*^9, 3.712984434238719*^9}, {
  3.712984620339417*^9, 3.712984621296452*^9}}],

Cell["Combine with the formula for dW", "Text",
 CellChangeTimes->{{3.714226357429411*^9, 3.714226367126733*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dWDB", "=", 
   RowBox[{
    RowBox[{"dW", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dWfs", "\[Rule]", "dWfsDB"}], ",", 
       RowBox[{"dWfi", "\[Rule]", "dWfiDB"}]}], "}"}]}], "//", "AF"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BDB", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}], "dWi"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dWfs", "\[Rule]", "dWfsDB"}], ",", 
       RowBox[{"dWfi", "\[Rule]", "dWfiDB"}]}], "}"}]}], "//", "AF"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CDB", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "dWs"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dWfs", "\[Rule]", "dWfsDB"}], ",", 
       RowBox[{"dWfi", "\[Rule]", "dWfiDB"}]}], "}"}]}], "//", "AF"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.712984634828814*^9, 3.7129846819993057`*^9}, {
   3.714226391944724*^9, 3.7142263924264603`*^9}, 3.71422645700879*^9, {
   3.714226631832975*^9, 3.714226653663334*^9}, 3.714227782366641*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dEXDB", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"n", " ", "d", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "Qout"}], ")"}], "\[Mu]"], "\[Nu]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Nu]"}], ")"}], "dW"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"dWfs", "\[Rule]", "dWfsDB"}], ",", 
          RowBox[{"dWfi", "\[Rule]", "dWfiDB"}]}], "}"}]}], "/.", 
       RowBox[{"R2", "\[Rule]", "R2M"}]}], "/.", 
      RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{"dself", "\[Rule]", "din"}], "}"}]}], "/.", 
    RowBox[{"din", "\[Rule]", 
     FractionBox[
      RowBox[{"1", "-", "m"}], "n"]}]}]}], ";"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moran Birth - Death", "Subsubsection",
 CellChangeTimes->{{3.714226323727347*^9, 3.7142263319698277`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dWfsBD", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Mu]"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"n", " ", "d"}]], "-", 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"n", " ", "d"}], ")"}], "2"]]}], ")"}]}], "-", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"1", "-", "m"}], ")"}], 
       RowBox[{"n", " ", "n", " ", "d"}]], "-", 
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"n", " ", "d"}], ")"}], "2"]]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dWfiBD", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Mu]"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"-", 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"n", " ", "d"}], ")"}], "2"]]}], ")"}]}], "-", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"1", "-", "m"}], ")"}], 
       RowBox[{"n", " ", "n", " ", "d"}]], "-", 
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"n", " ", "d"}], ")"}], "2"]]}], ")"}]}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.712984436080041*^9, 3.712984536114875*^9}, {
  3.71298457202428*^9, 3.7129845994517117`*^9}}],

Cell["Combine with dW", "Text",
 CellChangeTimes->{{3.714226432225672*^9, 3.714226437625572*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dEXBD", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"n", " ", "d", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "Qout"}], ")"}], "\[Mu]"], "\[Nu]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Nu]"}], ")"}], "dW"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"dWfs", "\[Rule]", "dWfsBD"}], ",", 
          RowBox[{"dWfi", "\[Rule]", "dWfiBD"}]}], "}"}]}], "/.", 
       RowBox[{"R2", "\[Rule]", "R2M"}]}], "/.", 
      RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{"dself", "\[Rule]", "din"}], "}"}]}], "/.", 
    RowBox[{"din", "\[Rule]", 
     FractionBox[
      RowBox[{"1", "-", "m"}], "n"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BBD", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}], "dWi"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dWfs", "\[Rule]", "dWfsBD"}], ",", 
       RowBox[{"dWfi", "\[Rule]", "dWfiBD"}]}], "}"}]}], "//", "AF"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CBD", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "dWs"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dWfs", "\[Rule]", "dWfsBD"}], ",", 
       RowBox[{"dWfi", "\[Rule]", "dWfiBD"}]}], "}"}]}], "//", "AF"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.714226663875696*^9, 3.714226685169915*^9}, 
   3.7142277803936663`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wright - Fisher", "Subsubsection",
 CellChangeTimes->{{3.714226334001795*^9, 3.714226336639578*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dWfsWF", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "m"}], ")"}], "2"], "n"], "-", 
      FractionBox[
       SuperscriptBox["m", "2"], 
       RowBox[{"n", 
        RowBox[{"(", 
         RowBox[{"d", "-", "1"}], ")"}]}]]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dWfiWF", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "m"}], ")"}], "2"], "n"]}], "-", 
      FractionBox[
       SuperscriptBox["m", "2"], 
       RowBox[{"n", 
        RowBox[{"(", 
         RowBox[{"d", "-", "1"}], ")"}]}]]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.712984609967702*^9, 3.712984627342272*^9}}],

Cell["Combine with dW", "Text",
 CellChangeTimes->{{3.714226447299099*^9, 3.714226450709735*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dEXWF", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "Qout"}], ")"}], "\[Mu]"], "\[Nu]", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Nu]"}], ")"}], "dW"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dWfs", "\[Rule]", "dWfsWF"}], ",", 
           RowBox[{"dWfi", "\[Rule]", "dWfiWF"}]}], "}"}]}], "/.", 
        RowBox[{"R2", "\[Rule]", "R2WF"}]}], "/.", 
       RowBox[{"Qout", "\[Rule]", "QoutWF"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{"dself", "\[Rule]", "din"}], "}"}]}], "/.", 
     RowBox[{"din", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "m"}], "n"]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BWF", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}], "dWi"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dWfs", "\[Rule]", "dWfsWF"}], ",", 
       RowBox[{"dWfi", "\[Rule]", "dWfiWF"}]}], "}"}]}], "//", "AF"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CWF", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "dWs"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dWfs", "\[Rule]", "dWfsWF"}], ",", 
       RowBox[{"dWfi", "\[Rule]", "dWfiWF"}]}], "}"}]}], "//", "AF"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.713356121753063*^9, 3.713356145407228*^9}, {
   3.713356262561409*^9, 3.713356289706917*^9}, {3.7134092611364822`*^9, 
   3.713409287537105*^9}, {3.713409394585511*^9, 3.713409401028379*^9}, {
   3.713409466430297*^9, 3.713409477770836*^9}, {3.713409642601273*^9, 
   3.713409642948991*^9}, {3.7134097273349447`*^9, 3.7134097314434566`*^9}, {
   3.714226430041389*^9, 3.714226446297415*^9}, {3.7142266926418533`*^9, 
   3.714226705614146*^9}, 3.714227772815279*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Checking signs", "Section",
 CellChangeTimes->{{3.712984710044484*^9, 3.7129847134595737`*^9}, {
  3.714227754190227*^9, 3.714227756927113*^9}, {3.7142284879942827`*^9, 
  3.7142284891670427`*^9}}],

Cell[CellGroupData[{

Cell["Death-Birth, whole B term", "Subsection",
 CellChangeTimes->{{3.714226931366014*^9, 3.71422693502754*^9}, {
  3.7142284922174387`*^9, 3.714228495247962*^9}, {3.714228587326931*^9, 
  3.7142285882315083`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AF", "[", 
  RowBox[{"Reduce", "[", 
   RowBox[{
    RowBox[{"BDB", ">", "0"}], ",", "m"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.714226971698881*^9, 3.714226983359057*^9}, {
  3.714228513489498*^9, 3.714228547039112*^9}, {3.714228577410121*^9, 
  3.714228577536928*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"-", "1"}], "+", "d", "-", 
    SqrtBox[
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"b", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}]}]]]}], "d"], "<", "m", "<", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "1"}], "+", "d", "+", 
    SqrtBox[
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"b", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}]}]]]}], "d"]}]], "Output",
 CellChangeTimes->{
  3.71422699040685*^9, 3.71422795709315*^9, {3.7142285318449097`*^9, 
   3.7142285801378613`*^9}, 3.7142319246724577`*^9}]
}, Open  ]],

Cell[TextData[{
 "and this is true when m<",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"d", "-", "1"}], "d"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "."
}], "Text",
 CellChangeTimes->{{3.714227016915841*^9, 3.714227027024652*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AF", "[", 
  RowBox[{"Reduce", "[", 
   RowBox[{
    RowBox[{"CDB", ">", "0"}], ",", "m"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.714227763219575*^9, 3.714227763339057*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.714227766702195*^9, 3.714227789347801*^9}, 
   3.714227957739546*^9, 3.714231925490996*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Competition terms", "Subsection",
 CellChangeTimes->{{3.7142269035058813`*^9, 3.71422690769203*^9}}],

Cell[CellGroupData[{

Cell["Check for BD competition", "Subsubsection",
 CellChangeTimes->{{3.713323238990649*^9, 3.7133232420530863`*^9}, {
  3.713324382666643*^9, 3.7133243848522463`*^9}, {3.713327111038334*^9, 
  3.713327121646955*^9}}],

Cell["Competition term in the BD life-cycle", "Text",
 CellChangeTimes->{{3.713324419947974*^9, 3.713324425275394*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BDcomp", "=", 
   RowBox[{
    FractionBox["\[Mu]", 
     RowBox[{"n", " ", "d"}]], "-", 
    FractionBox[
     RowBox[{"1", "-", "m"}], "n"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.71332441344331*^9, 3.713324429055477*^9}}],

Cell["It increases with m (because its derivative is >0)", "Text",
 CellChangeTimes->{{3.713324436570373*^9, 3.7133244475331287`*^9}, {
  3.714228930210991*^9, 3.71422893517703*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"BDcomp", ",", "m"}], "]"}], "//", "AF"}]], "Input",
 CellChangeTimes->{{3.713323489920775*^9, 3.713323493703521*^9}, {
  3.713324461675806*^9, 3.713324463509656*^9}}],

Cell[BoxData[
 FractionBox["1", "n"]], "Output",
 CellChangeTimes->{3.713323494108646*^9, 3.7133244639754963`*^9, 
  3.7142286280644207`*^9, 3.7142319257261477`*^9}]
}, Open  ]],

Cell["It is negative when m=0 (because \[Mu]<d)", "Text",
 CellChangeTimes->{{3.7133244502867823`*^9, 3.713324501695187*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BDcomp", "/.", 
   RowBox[{"m", "\[Rule]", "0"}]}], "//", "AF"}]], "Input",
 CellChangeTimes->{{3.7133244684416103`*^9, 3.713324476422662*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "d"}], "+", "\[Mu]"}], 
  RowBox[{"d", " ", "n"}]]], "Output",
 CellChangeTimes->{{3.7133244718724327`*^9, 3.71332447690895*^9}, 
   3.714228630712381*^9, 3.714231925899115*^9}]
}, Open  ]],

Cell["And it is still negative when we reach mc", "Text",
 CellChangeTimes->{{3.7133245052551537`*^9, 3.713324511996076*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BDcomp", "/.", 
   RowBox[{"m", "\[Rule]", 
    FractionBox[
     RowBox[{"d", "-", "1"}], "d"]}]}], "//", "AF"}]], "Input",
 CellChangeTimes->{{3.713323462877427*^9, 3.713323470848113*^9}, {
  3.713324516564931*^9, 3.713324517437285*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "1"}], "+", "\[Mu]"}], 
  RowBox[{"d", " ", "n"}]]], "Output",
 CellChangeTimes->{{3.713323366815885*^9, 3.7133233696445923`*^9}, {
   3.713323468202882*^9, 3.713323471247219*^9}, 3.713324519077026*^9, 
   3.714228631687543*^9, 3.714231926015806*^9}]
}, Open  ]],

Cell["\<\
So it is negative for all values of m that we consider, and increases with m.
-> Competition is reduced as m increases (the absolute value of the \
competition term decreases)\
\>", "Text",
 CellChangeTimes->{{3.714228898527234*^9, 3.714228964968194*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check for DB & WF competition", "Subsubsection",
 CellChangeTimes->{{3.713327127143981*^9, 3.7133271325012608`*^9}, {
  3.714228697482586*^9, 3.714228698023656*^9}}],

Cell["The competition term is negative:", "Text",
 CellChangeTimes->{{3.714228856037085*^9, 3.714228862831358*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DBcomp", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Mu]"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "m"}], ")"}], "2"], "n"], "+", 
      FractionBox[
       SuperscriptBox["m", "2"], 
       RowBox[{"n", " ", 
        RowBox[{"(", 
         RowBox[{"d", "-", "1"}], ")"}]}]]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.71332713480097*^9, 3.7133271664738703`*^9}}],

Cell["\<\
How does it change with m? 
Derivative with respect to m\
\>", "Text",
 CellChangeTimes->{{3.714228703954336*^9, 3.714228714714078*^9}, {
  3.714228867607938*^9, 3.714228875270731*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dcomp", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"DBcomp", ",", "m"}], "]"}], "//", "AF"}]}]], "Input",
 CellChangeTimes->{{3.713327168000235*^9, 3.7133271802262363`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n"}]]], "Output",
 CellChangeTimes->{{3.71332717158104*^9, 3.71332718094524*^9}, 
   3.713438794155141*^9, 3.714228634169249*^9, 3.714231926209448*^9}]
}, Open  ]],

Cell["Derivative changes sign at the critical m value", "Text",
 CellChangeTimes->{{3.714228719269672*^9, 3.714228727763007*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"dcomp", "\[Equal]", "0"}], ",", "m"}], "]"}]], "Input",
 CellChangeTimes->{{3.7133271942348948`*^9, 3.713327197418749*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"m", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], "d"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.713327197869233*^9, 3.714228636268414*^9, 
  3.714231926309305*^9}]
}, Open  ]],

Cell["\<\
Second derivative is negative -> derivative decreases 
-> derivative is positive for m<1-1/d (and indeed it is for m->0)
-> competition term increases with m, BUT...\
\>", "Text",
 CellChangeTimes->{{3.7142286864349613`*^9, 3.714228689079811*^9}, {
  3.7142287340457163`*^9, 3.714228849910329*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"dcomp", ",", "m"}], "]"}], "//", "AF"}]], "Input",
 CellChangeTimes->{{3.713438810288028*^9, 3.7134388145208483`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "d", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n"}]]], "Output",
 CellChangeTimes->{{3.713438812829534*^9, 3.713438815081916*^9}, 
   3.714228636993326*^9, 3.714231926468281*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dcomp", "/.", 
   RowBox[{"m", "\[Rule]", "0"}]}], "//", "AF"}]], "Input",
 CellChangeTimes->{{3.713327204096084*^9, 3.713327210197323*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", "-", 
   RowBox[{"2", " ", "\[Mu]"}]}], "n"]], "Output",
 CellChangeTimes->{{3.713327207516994*^9, 3.713327210680633*^9}, 
   3.714228637741973*^9, 3.7142319265392113`*^9}]
}, Open  ]],

Cell["\<\
... BUT competition term is negative, so competition is reduced as m increases\
\>", "Text",
 CellChangeTimes->{{3.714228828139855*^9, 3.714228847078383*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Changes with m", "Section",
 CellChangeTimes->{{3.714228980531352*^9, 3.7142289843809557`*^9}}],

Cell[CellGroupData[{

Cell["Birth - Death", "Subsection",
 CellChangeTimes->{{3.7142289881192904`*^9, 3.714228991903933*^9}}],

Cell["Derivative with respect to m", "Text",
 CellChangeTimes->{{3.7142290122859173`*^9, 3.7142290195363283`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ddEXBD", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"dEXBD", ",", "m"}], "]"}], "//", "AF"}]}]], "Input",
 CellChangeTimes->{{3.714229021051134*^9, 3.714229054222846*^9}, 
   3.714229169806116*^9, {3.714229259996747*^9, 3.714229260564464*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", "\[Mu]", " ", 
   RowBox[{"(", 
    RowBox[{"c", "+", 
     RowBox[{"c", " ", "d", " ", "n"}], "-", 
     RowBox[{"c", " ", "\[Mu]"}], "+", 
     RowBox[{"b", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}]}]}], ")"}], " ", 
         "\[Mu]"}]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Nu]"}], ")"}], " ", "\[Nu]"}], 
  RowBox[{"d", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
      "-", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
        ")"}]}]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{{3.714229166523149*^9, 3.714229170355075*^9}, {
   3.714229255201606*^9, 3.7142292618892593`*^9}, 3.714231927246978*^9}]
}, Open  ]],

Cell["There are no roots -> monotonic change with m", "Text",
 CellChangeTimes->{{3.714229060096945*^9, 3.71422907949137*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"ddEXBD", "\[Equal]", "0"}], ",", "m"}], "]"}], "//", 
  "AF"}]], "Input",
 CellChangeTimes->{{3.714229021051134*^9, 3.714229068084038*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.714229264856741*^9, 3.714231927514934*^9}]
}, Open  ]],

Cell["How does the sign of the derivative change with \[Mu]?", "Text",
 CellChangeTimes->{{3.714229086990836*^9, 3.7142291046049023`*^9}, {
  3.71422935090206*^9, 3.714229351013934*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"ddEXBD", "\[Equal]", "0"}], ",", "\[Mu]"}], "]"}], "//", 
  "AF"}]], "Input",
 CellChangeTimes->{{3.714229021051134*^9, 3.714229068084038*^9}, {
  3.714229269806576*^9, 3.714229281693572*^9}, {3.714229356267791*^9, 
  3.71422936030971*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"b", "-", "c", "-", 
        RowBox[{"2", " ", "b", " ", "d", " ", "n"}], "+", 
        SqrtBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"b", "-", "c"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"b", "-", "c", "+", 
            RowBox[{"4", " ", "b", " ", 
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["n", "2"]}]}], ")"}]}]]}], 
       RowBox[{"2", " ", "b", " ", "d", " ", "n"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", 
     FractionBox[
      RowBox[{"c", "+", 
       RowBox[{"b", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "d", " ", "n"}]}], ")"}]}], "+", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"b", "-", "c"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"b", "-", "c", "+", 
           RowBox[{"4", " ", "b", " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["n", "2"]}]}], ")"}]}]]}], 
      RowBox[{"2", " ", "b", " ", "d", " ", "n"}]]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.714229373223629*^9, 3.714231929168882*^9}]
}, Open  ]],

Cell["Select the admissible solution", "Text",
 CellChangeTimes->{{3.7142293611631536`*^9, 3.7142293683526497`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Mu]cBD", "=", 
    RowBox[{
     RowBox[{"\[Mu]", "/.", 
      RowBox[{"%", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "//",
      "AF"}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.714229021051134*^9, 3.714229068084038*^9}, {
  3.714229269806576*^9, 3.714229281693572*^9}, {3.714229356267791*^9, 
  3.71422936030971*^9}, {3.714229399186849*^9, 3.71422939985465*^9}}],

Cell["Value with our parameters", "Text",
 CellChangeTimes->{{3.714229400823316*^9, 3.714229403999908*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Mu]cBD", "/.", "prm"}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.714229442776513*^9, 3.714229446939659*^9}}],

Cell[BoxData["0.02609913112021685`"], "Output",
 CellChangeTimes->{{3.7142294449082413`*^9, 3.7142294472242317`*^9}, 
   3.714231929384791*^9}]
}, Open  ]],

Cell["\<\
How is it affected by changes in d or n? (they play the same role)\
\>", "Text",
 CellChangeTimes->{{3.714229379741334*^9, 3.714229388062199*^9}, {
  3.71423025427663*^9, 3.714230258454563*^9}}],

Cell["\<\
The derivative is positive : the threshold increases with d and n\
\>", "Text",
 CellChangeTimes->{{3.71423026001819*^9, 3.714230270801515*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"\[Mu]cBD", ",", "d"}], "]"}], "//", "AF"}]], "Input",
 CellChangeTimes->{{3.714230241438333*^9, 3.7142302467914677`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SqrtBox[
    FractionBox[
     RowBox[{"b", "-", "c"}], 
     RowBox[{"b", "-", "c", "+", 
      RowBox[{"4", " ", "b", " ", 
       SuperscriptBox["d", "2"], " ", 
       SuperscriptBox["n", "2"]}]}]]], " ", 
   RowBox[{"(", 
    RowBox[{"b", "-", "c", "+", 
     SqrtBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"b", "-", "c", "+", 
         RowBox[{"4", " ", "b", " ", 
          SuperscriptBox["d", "2"], " ", 
          SuperscriptBox["n", "2"]}]}], ")"}]}]]}], ")"}]}], 
  RowBox[{"2", " ", "b", " ", 
   SuperscriptBox["d", "2"], " ", "n"}]]], "Output",
 CellChangeTimes->{3.714230247484139*^9, 3.714231929745648*^9}]
}, Open  ]],

Cell["The maximum value of the threshold is", "Text",
 CellChangeTimes->{{3.714230275155513*^9, 3.7142302833922853`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"\[Mu]cBD", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "AF"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"b", "\[Rule]", "15"}], ",", 
     RowBox[{"c", "\[Rule]", "1"}]}], "}"}]}], "//", "N"}]}], "Input",
 CellChangeTimes->{{3.714229021051134*^9, 3.714229068084038*^9}, {
  3.714229269806576*^9, 3.71422930338155*^9}, {3.714230238962978*^9, 
  3.714230240078824*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", 
  SqrtBox[
   RowBox[{"1", "-", 
    FractionBox["c", "b"]}]]}]], "Output",
 CellChangeTimes->{3.714229304487348*^9, 3.7142319302347918`*^9}],

Cell[BoxData["0.033908216920704115`"], "Output",
 CellChangeTimes->{3.714229304487348*^9, 3.714231930238089*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"->", 
   RowBox[{
   "The", " ", "critical", " ", "value", " ", "of", " ", "\[Mu]", " ", 
    "above", " ", "which", " ", 
    RowBox[{"E", "[", "X", "]"}], " ", "increases", " ", "with", " ", "m", 
    " ", "is"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]cBD", "=", 
   RowBox[{"1", "-", 
    FractionBox[
     RowBox[{"b", "-", "c", "+", 
      SqrtBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "-", "c"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"b", "-", "c", "+", 
          RowBox[{"4", " ", "b", " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["n", "2"]}]}], ")"}]}]]}], 
     RowBox[{"2", " ", "b", " ", "d", " ", "n"}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "this", " ", "threshold", " ", "increases", " ", "with", " ", "d", " ", 
   "and", " ", "n", " ", "to", " ", "reach", " ", "a", " ", "maximum", " ", 
   "value", " ", "\[Mu]cBDmax"}], " ", "=", " ", 
  RowBox[{"1", "-", 
   SqrtBox[
    RowBox[{"1", "-", 
     FractionBox["c", "b"]}]]}]}]}], "Text",
 CellChangeTimes->{{3.7142300771116667`*^9, 3.7142301737907963`*^9}},
 FontFamily->"Nimbus Sans L",
 Background->RGBColor[0.94, 0.91, 0.88]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Death - Birth", "Subsection",
 CellChangeTimes->{{3.7142294623082247`*^9, 3.71422946623085*^9}}],

Cell["Derivative with respect to m", "Text",
 CellChangeTimes->{{3.714229487271793*^9, 3.7142294923960943`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ddEXDB", " ", "=", " ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"dEXDB", ",", "m"}], "]"}], "//", "AF"}]}]], "Input",
 CellChangeTimes->{{3.714229496794116*^9, 3.714229503625708*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "d"}], " ", 
          SuperscriptBox["m", "2"]}], "+", "\[Mu]", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", 
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", "m"}], ")"}]}], "-", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "n"}], ")"}]}], "-", 
               RowBox[{"d", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"m", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", "n"}], 
                 ")"}]}]}], ")"}]}]}], ")"}], " ", "\[Mu]"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"d", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
          SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}], "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "d"}], " ", 
          SuperscriptBox["m", "2"]}], "+", "\[Mu]", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", 
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{"2", "+", "m"}], ")"}]}], "+", 
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"m", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "m", "-", 
                  RowBox[{"m", " ", "n"}]}], ")"}]}]}], ")"}]}]}], ")"}], " ",
           "\[Mu]"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"d", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"]}], 
            "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "+", 
               RowBox[{"2", " ", "d", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "m"}], ")"}]}], "+", 
               RowBox[{
                SuperscriptBox["d", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m"}]}], 
                 ")"}]}]}], ")"}], " ", "n"}]}], ")"}], " ", 
          SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Nu]"}], ")"}], " ", "\[Nu]"}], ")"}], "/", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
     "-", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}],
     ")"}], "2"]}]], "Output",
 CellChangeTimes->{3.714229510729363*^9, 3.714231935460911*^9}]
}, Open  ]],

Cell["The change is not monotonic with m:", "Text",
 CellChangeTimes->{{3.714229554708325*^9, 3.7142295682256603`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"ddEXDB", "\[Equal]", "0"}], ",", "m"}], "]"}], "//", 
  "AF"}]], "Input",
 CellChangeTimes->{{3.714229534380978*^9, 3.7142295446676617`*^9}, {
  3.714229830126457*^9, 3.714229831305579*^9}, {3.714229997988777*^9, 
  3.714229999896916*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"b", "-", "c"}], ")"}], " ", "d", " ", "\[Mu]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
            ")"}]}], "-", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"b", "-", "c"}], ")"}]}], " ", "d", " ", "\[Mu]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"c", " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", "n"}], ")"}]}], "+", 
              RowBox[{"c", " ", "\[Mu]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", 
                 RowBox[{"d", " ", 
                  SuperscriptBox["n", "2"]}], "+", "\[Mu]", "-", 
                 RowBox[{"n", " ", "\[Mu]"}]}], ")"}]}], "+", 
              RowBox[{"b", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"\[Mu]", " ", 
                  RowBox[{"(", 
                   RowBox[{"2", "-", "\[Mu]", "+", 
                    RowBox[{"n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", 
                    "\[Mu]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "-", "c"}], ")"}], " ", "d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}],
        ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"m", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"b", "-", "c"}], ")"}], " ", "d", " ", "\[Mu]", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
            ")"}]}], "+", 
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"b", "-", "c"}], ")"}]}], " ", "d", " ", "\[Mu]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"c", " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", "n"}], ")"}]}], "+", 
              RowBox[{"c", " ", "\[Mu]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", 
                 RowBox[{"d", " ", 
                  SuperscriptBox["n", "2"]}], "+", "\[Mu]", "-", 
                 RowBox[{"n", " ", "\[Mu]"}]}], ")"}]}], "+", 
              RowBox[{"b", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"\[Mu]", " ", 
                  RowBox[{"(", 
                   RowBox[{"2", "-", "\[Mu]", "+", 
                    RowBox[{"n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", 
                    "\[Mu]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "-", "c"}], ")"}], " ", "d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}],
        ")"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7142300358465567`*^9, 3.714231948743877*^9}]
}, Open  ]],

Cell["Select admissible solution (denominator <0)", "Text",
 CellChangeTimes->{{3.714230002890151*^9, 3.714230012784911*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mcDB", "=", 
  RowBox[{"m", "/.", 
   RowBox[{
   "%", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}]], "Input",
 CellChangeTimes->{{3.714230015461989*^9, 3.714230018288484*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "c"}], ")"}], " ", "d", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
      "-", 
      SqrtBox[
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"b", "-", "c"}], ")"}]}], " ", "d", " ", "\[Mu]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "n"}], ")"}]}], "+", 
          RowBox[{"c", " ", "\[Mu]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", 
             RowBox[{"d", " ", 
              SuperscriptBox["n", "2"]}], "+", "\[Mu]", "-", 
             RowBox[{"n", " ", "\[Mu]"}]}], ")"}]}], "+", 
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"\[Mu]", " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", "\[Mu]", "+", 
                RowBox[{"n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
                   RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", 
                    "\[Mu]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"b", "-", "c"}], ")"}], " ", "d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.7142295405204678`*^9, 3.714229566058485*^9}, 
   3.714229851936678*^9, {3.7142300187899103`*^9, 3.7142300359670677`*^9}, 
   3.714231948903594*^9}]
}, Open  ]],

Cell["\<\
We need to know whether this is a max or a min... 
But the solutions are a bit complicated, so let' s focus on what happens at m \
-> 0\
\>", "Text",
 CellChangeTimes->{{3.71422957100807*^9, 3.714229583920951*^9}, {
  3.714230054368207*^9, 3.7142300626396503`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ddEXDB0", "=", 
  RowBox[{
   RowBox[{"ddEXDB", "/.", 
    RowBox[{"m", "\[Rule]", "0"}]}], "//", "AF"}]}]], "Input",
 CellChangeTimes->{{3.714229590485798*^9, 3.714229597749955*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"b", "+", 
     RowBox[{"b", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "n"}]}], ")"}], " ", "\[Mu]"}], "-", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "n", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}],
     ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Nu]"}], ")"}], " ", "\[Nu]"}], 
  RowBox[{"\[Mu]", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}], 
    "2"]}]]], "Output",
 CellChangeTimes->{3.714229598235066*^9, 3.714231949144637*^9}]
}, Open  ]],

Cell["How does this change with \[Mu]?", "Text",
 CellChangeTimes->{{3.714229603756278*^9, 3.71422961020947*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dddEXDB0", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"ddEXDB0", ",", "\[Mu]"}], "]"}], "//", "AF"}]}]], "Input",
 CellChangeTimes->{{3.714229611360251*^9, 3.714229632595389*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "n"}], ")"}]}], "-", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "n"}], ")"}]}], "+", 
         RowBox[{"3", " ", "\[Mu]"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
          SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}], "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{"3", "-", 
            RowBox[{"3", " ", "n", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "3"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["n", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
           ")"}]}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Nu]"}], ")"}], " ", "\[Nu]"}], 
   RowBox[{
    SuperscriptBox["\[Mu]", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}], 
     "3"]}]]}]], "Output",
 CellChangeTimes->{{3.714229619922111*^9, 3.71422963543924*^9}, 
   3.7142319518424397`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AF", "[", 
  RowBox[{"Reduce", "[", 
   RowBox[{
    RowBox[{"ddEXDB0", ">", "0"}], ",", "\[Mu]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AF", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"ddEXDB0", "\[Equal]", "0"}], ",", "\[Mu]"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.714229699358397*^9, 3.714229749248536*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"c", "+", 
    RowBox[{"c", " ", "n"}], "+", 
    RowBox[{"b", " ", "\[Mu]"}], "+", 
    RowBox[{"c", " ", "n", " ", "\[Mu]"}]}], "<", 
   RowBox[{"b", "+", 
    RowBox[{"c", " ", "\[Mu]"}], "+", 
    RowBox[{"2", " ", "b", " ", "n", " ", "\[Mu]"}]}]}], "||", 
  RowBox[{"b", "\[GreaterEqual]", 
   RowBox[{"c", "+", 
    RowBox[{"c", " ", "n"}]}]}]}]], "Output",
 CellChangeTimes->{{3.714229707855596*^9, 3.7142297164261723`*^9}, 
   3.7142297502835417`*^9, 3.714231957267721*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "b"}], "+", "c", "+", 
       RowBox[{"c", " ", "n"}]}], 
      RowBox[{"c", "-", 
       RowBox[{"c", " ", "n"}], "+", 
       RowBox[{"b", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "n"}]}], ")"}]}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.714229707855596*^9, 3.7142297164261723`*^9}, 
   3.7142297502835417`*^9, 3.714231957281426*^9}]
}, Open  ]],

Cell[TextData[{
 "-> E[X] is a non - monotonic function of m;\n\nThe initial (i.e., for m -> \
0) increase of E[X] with m depends on the values of b and \[Mu] :\nif b > c \
(n + 1), E[X] initially increases with m ;\notherwise, E[X] initially \
increases with m if \[Mu]>",
 Cell[BoxData[
  FractionBox[
   RowBox[{
    RowBox[{"-", "b"}], "+", "c", "+", 
    RowBox[{"c", " ", "n"}]}], 
   RowBox[{"c", "-", 
    RowBox[{"c", " ", "n"}], "+", 
    RowBox[{"b", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "n"}]}], ")"}]}]}]]], "Output",
  CellChangeTimes->{{3.714229707855596*^9, 3.7142297164261723`*^9}, 
    3.714229750312285*^9}],
 ";\n\nThen, a maximum is reached at m=",
 Cell[BoxData[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "-", "c"}], ")"}], " ", "d", " ", "\[Mu]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}],
        "-", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"b", "-", "c"}], ")"}]}], " ", "d", " ", "\[Mu]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "n"}], ")"}]}], "+", 
           RowBox[{"c", " ", "\[Mu]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", 
              RowBox[{"d", " ", 
               SuperscriptBox["n", "2"]}], "+", "\[Mu]", "-", 
              RowBox[{"n", " ", "\[Mu]"}]}], ")"}]}], "+", 
           RowBox[{"b", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"\[Mu]", " ", 
               RowBox[{"(", 
                RowBox[{"2", "-", "\[Mu]", "+", 
                 RowBox[{"n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", 
                    "\[Mu]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]]}], ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", "-", "c"}], ")"}], " ", "d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
    ")"}]}]], "Output",
  CellChangeTimes->{{3.7142295405204678`*^9, 3.714229566058485*^9}, 
    3.714229851936678*^9, {3.7142300187899103`*^9, 3.7142300359670677`*^9}}],
 ";\n"
}], "Text",
 CellChangeTimes->{{3.714230301883078*^9, 3.714230467804916*^9}},
 Background->RGBColor[0.94, 0.91, 0.88]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wright - Fisher", "Subsection",
 CellChangeTimes->{{3.714230478680243*^9, 3.714230481534193*^9}}],

Cell["Derivative with respect to m", "Text",
 CellChangeTimes->{{3.714230488499378*^9, 3.714230496037897*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ddEXWF", " ", "=", " ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"dEXWF", ",", "m"}], "]"}], "//", "AF"}]}]], "Input",
 CellChangeTimes->{{3.714230498204989*^9, 3.714230500951848*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], "3"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], " ", "n", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"c", "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], ")"}], 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Nu]"}], ")"}], " ", "\[Nu]"}], ")"}], "/", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "m", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}], "+", 
     RowBox[{"d", " ", 
      SuperscriptBox["m", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}]}], ")"}], "2"]}]], "Output",
 CellChangeTimes->{3.714230502877071*^9, 3.714231959412127*^9}]
}, Open  ]],

Cell["\<\
An extremum is reached at the maximum possible emigration value:\
\>", "Text",
 CellChangeTimes->{{3.714230519799027*^9, 3.714230541446657*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"ddEXWF", "\[Equal]", "0"}], ",", "m"}], "]"}], "//", 
  "AF"}]], "Input",
 CellChangeTimes->{{3.7142305074529247`*^9, 3.714230517414317*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"m", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], "d"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.714230513771491*^9, 3.714230517773347*^9}, 
   3.714231959654847*^9}]
}, Open  ]],

Cell["\<\
Whether it is a min or max depends on \[Mu]; let\[CloseCurlyQuote]s consider \
for simplicity m->0\
\>", "Text",
 CellChangeTimes->{{3.714230552421446*^9, 3.7142305743505287`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ddEXWF0", "=", 
  RowBox[{
   RowBox[{"ddEXWF", "/.", 
    RowBox[{"m", "\[Rule]", "0"}]}], "//", "AF"}]}]], "Input",
 CellChangeTimes->{{3.714230681636448*^9, 3.714230692666686*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", "n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"c", "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], ")"}], 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Nu]"}], ")"}], " ", "\[Nu]"}], 
   RowBox[{"\[Mu]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], ")"}], 
     "2"]}]]}]], "Output",
 CellChangeTimes->{3.714230693094363*^9, 3.7142319598965693`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AF", "[", 
  RowBox[{"Reduce", "[", 
   RowBox[{
    RowBox[{"ddEXWF0", ">", "0"}], ",", "\[Mu]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.71423070479364*^9, 3.7142307147625504`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SqrtBox[
    RowBox[{"1", "-", 
     FractionBox["c", "b"]}]], "+", "\[Mu]"}], ">", "1"}]], "Output",
 CellChangeTimes->{3.714230718419951*^9, 3.714231963856244*^9}]
}, Open  ]],

Cell[TextData[{
 "->E[X] is a monotonic function of m for 0 < m < 1 - 1/d,\nand it is an \
increasing function for \[Mu]>1 - ",
 Cell[BoxData[
  SqrtBox[
   RowBox[{"1", "-", 
    FractionBox["c", "b"]}]]], "Output",
  CellChangeTimes->{3.714230718419951*^9}]
}], "Text",
 CellChangeTimes->{{3.7142307307612467`*^9, 3.714230777665942*^9}},
 Background->RGBColor[0.94, 0.91, 0.88]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Qualitative effect of m on E[X] in the Moran DB life - cycle", "Section",
 CellChangeTimes->{{3.714231005366385*^9, 3.714231022348549*^9}}],

Cell["We have already checked that BDB>0", "Text",
 CellChangeTimes->{{3.714231027392906*^9, 3.714231038490273*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CBratio", "=", 
  RowBox[{
   FractionBox["CDB", "BDB"], "//", "AF"}]}]], "Input",
 CellChangeTimes->{{3.714231040235314*^9, 3.714231047761689*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", "-", "c"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"d", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"]}], "+", 
       RowBox[{"2", " ", "m"}]}], ")"}]}], "+", 
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n"}]}], 
   RowBox[{
    RowBox[{
     RowBox[{"-", "c"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"d", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"]}], "+", 
       RowBox[{"2", " ", "m"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
    RowBox[{"b", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"d", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"]}], "+", 
       RowBox[{"2", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", "n"}]}], 
      ")"}]}]}]]}]], "Output",
 CellChangeTimes->{3.7142310489013243`*^9, 3.714231965044311*^9}]
}, Open  ]],

Cell["\<\
Values of R and C/B for m -> 0
we have R<= C/B, == when \[Mu]->0\
\>", "Text",
 CellChangeTimes->{{3.7142310562859383`*^9, 3.71423107198041*^9}, {
  3.714231105177857*^9, 3.714231115529365*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"R2M", ",", 
    RowBox[{"m", "\[Rule]", "0"}]}], "]"}], "//", 
  "AF"}], "\[IndentingNewLine]", 
 RowBox[{"Limit", "[", 
  RowBox[{"%", ",", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.714231074915859*^9, 3.714231088266698*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "-", "\[Mu]"}], 
  RowBox[{"1", "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}]]], "Output",
 CellChangeTimes->{{3.714231079499547*^9, 3.7142310890028048`*^9}, 
   3.714231965222693*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.714231079499547*^9, 3.7142310890028048`*^9}, 
   3.714231965226536*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"CBratio", ",", 
    RowBox[{"m", "\[Rule]", "0"}]}], "]"}], "//", "AF"}]], "Input",
 CellChangeTimes->{{3.71423109108398*^9, 3.7142310994223547`*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.7142310998142357`*^9, 3.71423196532088*^9}]
}, Open  ]],

Cell["At the other extreme:", "Text",
 CellChangeTimes->{{3.7142311295716887`*^9, 3.714231132930059*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"R2M", ",", 
    RowBox[{"m", "\[Rule]", 
     RowBox[{"1", "-", 
      RowBox[{"1", "/", "d"}]}]}]}], "]"}], "//", "AF"}]], "Input",
 CellChangeTimes->{{3.714231135373782*^9, 3.71423114361067*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.7142311415327463`*^9, 3.71423114392092*^9}, 
   3.714231965423812*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"CBratio", ",", 
    RowBox[{"m", "\[Rule]", 
     RowBox[{"1", "-", 
      RowBox[{"1", "/", "d"}]}]}]}], "]"}], "//", "AF"}]], "Input",
 CellChangeTimes->{{3.714231148044702*^9, 3.714231151213529*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"b", "+", 
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"d", " ", "n"}]}], ")"}]}]}], 
  RowBox[{"b", "+", 
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
   RowBox[{"b", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n"}]}]]], "Output",
 CellChangeTimes->{3.714231152020175*^9, 3.714231965592244*^9}]
}, Open  ]],

Cell["Threshold emigration value to have R>C/B", "Text",
 CellChangeTimes->{{3.714231183025928*^9, 3.7142311971785*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mDBqualit", "=", 
  RowBox[{
   RowBox[{"m", "/.", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"R2M", " ", "BDB"}], "-", "CDB"}], "\[Equal]", "0"}], ",", 
      "m"}], "]"}]}], "//", "AF"}]}]], "Input",
 CellChangeTimes->{{3.7142311988419323`*^9, 3.714231261788662*^9}, {
  3.714231300883994*^9, 3.714231301250543*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"b", "-", "c"}], ")"}], " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "d", "+", 
         RowBox[{"d", " ", "n"}]}], ")"}]}], "+", 
      RowBox[{"c", " ", "d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}], "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "d", "+", 
         RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}], "-", 
      SqrtBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", 
         RowBox[{"(", 
          RowBox[{"b", "-", "c"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "d", " ", 
         RowBox[{"(", 
          RowBox[{"b", "+", 
           RowBox[{"c", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
         "\[Mu]"}], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "d", "+", 
              RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}], "+", 
           RowBox[{"c", " ", 
            RowBox[{"(", 
             RowBox[{"2", "-", 
              RowBox[{"d", " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", "n"}], ")"}]}], "+", 
              RowBox[{"d", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
             ")"}]}]}], ")"}], "2"]}]]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"b", "-", "c"}], ")"}], " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "d", "+", 
         RowBox[{"d", " ", "n"}]}], ")"}]}], "+", 
      RowBox[{"c", " ", "d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}], "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "d", "+", 
         RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}], "+", 
      SqrtBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", 
         RowBox[{"(", 
          RowBox[{"b", "-", "c"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "d", " ", 
         RowBox[{"(", 
          RowBox[{"b", "+", 
           RowBox[{"c", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
         "\[Mu]"}], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "d", "+", 
              RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}], "+", 
           RowBox[{"c", " ", 
            RowBox[{"(", 
             RowBox[{"2", "-", 
              RowBox[{"d", " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", "n"}], ")"}]}], "+", 
              RowBox[{"d", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
             ")"}]}]}], ")"}], "2"]}]]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.714231207549797*^9, 3.714231270553595*^9}, 
   3.714231307688175*^9, 3.714231971364995*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3) Expected Frequency Equations - Generic method", "Title",
 CellChangeTimes->{{3.699768851984043*^9, 3.699768858124469*^9}, {
  3.710048459761939*^9, 3.710048460391974*^9}, {3.714225569299754*^9, 
  3.714225576082962*^9}}],

Cell["\<\
Here we use the methodology presented in D\[EAcute]barre 2017 JTB, and \
similar terminology and decomposition of E[X].
The derivation is much more tedious... but it allows us to consider other \
kinds of subdivided populations:
- we do not specify the values of dself, din and dout (for instance we can \
have dself  =0, no replacement of the parent by the offspring),
- we  do not specify the values of eself, ein and eout (for instance, we can \
have eout proportional to dout, i.e. not restrict social interaction to \
deme-mates).\
\>", "Text",
 CellChangeTimes->{{3.714231518822658*^9, 3.714231672262864*^9}}],

Cell[CellGroupData[{

Cell["Formulas for the different life-cycles", "Section",
 CellChangeTimes->{{3.699768859805334*^9, 3.699768867744869*^9}, {
  3.705387119787652*^9, 3.705387127043717*^9}}],

Cell["\<\
The formulas for each term is obtained by hand, by replacing the dispersal \
and interaction graphs by their formulas in a subdivided population, from the \
equations given in Appendix B1. In some cases (e.g., \[Beta]I for the Moran \
DB life-cycle), there is a large number of cases to consider when unpacking \
the sums. 
D corresponds to direct / primary effects,
I corresponds to indirect / secondary effects. \
\>", "Text",
 CellChangeTimes->{{3.705385172637076*^9, 3.705385179189186*^9}, {
  3.7099900011579723`*^9, 3.709990009774757*^9}, {3.709990043198502*^9, 
  3.70999004982239*^9}, {3.7100468534555197`*^9, 3.710046912245219*^9}, {
  3.710046964544293*^9, 3.710046983885819*^9}, {3.710047084744001*^9, 
  3.71004711913234*^9}}],

Cell[CellGroupData[{

Cell["Moran, Birth-Death", "Subsection",
 CellChangeTimes->{{3.699788303462345*^9, 3.699788307241809*^9}, {
  3.705387130107669*^9, 3.7053871363953457`*^9}}],

Cell[CellGroupData[{

Cell["\[Beta]", "Subsubsection",
 CellChangeTimes->{{3.699768872084917*^9, 3.699768873677112*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]BDD", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"eself", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "ein", " ", "Qin"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "eout", " ", "Qout"}]}], 
     ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699768876066028*^9, 3.699768891232036*^9}, {
  3.699768961189538*^9, 3.699768983541917*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]BDI", "=", 
   RowBox[{
    RowBox[{"dself", " ", "eself"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], "din", " ", "ein"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", "d"}], " ", "-", "n"}], " ", ")"}], "dout", " ", 
     "eout"}], 
    RowBox[{"(*", "\[IndentingNewLine]", "*)"}], "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"din", " ", "eself"}], " ", "+", " ", 
       RowBox[{"dself", " ", "ein"}], " ", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "2"}], ")"}], "din", " ", "ein"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], "dout", " ", 
        "eout"}]}], ")"}], "Qin"}], " ", 
    RowBox[{"(*", "\[IndentingNewLine]", "*)"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", "d"}], " ", "-", " ", "n"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dself", " ", "eout"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "din", " ", "eout"}], " ", "+", " ", 
       
       RowBox[{"dout", " ", "eself"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "ein"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "d"}], " ", "-", 
          RowBox[{"2", "n"}]}], ")"}], "dout", " ", "eout"}]}], ")"}], 
     "Qout"}], 
    RowBox[{"(*", "\[IndentingNewLine]", "*)"}], "-", 
    RowBox[{
     FractionBox["\[Mu]", 
      RowBox[{"n", " ", "d"}]], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "Qin"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], "Qout"}]}], ")"}], 
     
     RowBox[{"(", 
      RowBox[{"eself", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "ein"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "eout"}]}], ")"}]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.69976898989773*^9, 3.699769149062419*^9}, {
  3.699783552293282*^9, 3.699783562281807*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"factorBD", "=", 
  FractionBox[
   RowBox[{"p", 
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}]}], "\[Mu]"]}]], "Input",
 CellChangeTimes->{{3.6997810044037027`*^9, 3.699781013324629*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], " ", "p"}], "\[Mu]"]], "Output",
 CellChangeTimes->{3.699781014738659*^9, 3.6997838030770693`*^9, 
  3.699784269757339*^9, 3.6997877195844793`*^9, 3.699793866547782*^9, 
  3.699847509848752*^9, 3.6998489929737797`*^9, 3.699853749222508*^9, 
  3.699955357639187*^9, 3.702201318696995*^9, 3.702289677094816*^9, 
  3.7041789624936743`*^9, 3.7045177173812933`*^9, 3.7053855253985558`*^9, 
  3.705385746169188*^9, 3.709990054876704*^9, 3.709990584352785*^9, 
  3.710046995960639*^9, 3.7100496914174633`*^9, 3.710054304576977*^9, 
  3.710054510445734*^9, 3.710156967486904*^9, 3.713407360864963*^9, 
  3.714231971746398*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]BD", "=", 
   RowBox[{"factorBD", 
    RowBox[{"(", 
     RowBox[{"\[Beta]BDD", "-", "\[Beta]BDI"}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699781018565494*^9, 3.699781031469839*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Gamma]", "Subsubsection",
 CellChangeTimes->{{3.699787927626891*^9, 3.699787929439444*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]BDD", "=", 
   RowBox[{"1", "-", "\[Mu]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699787932024872*^9, 3.699787942256565*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]BDI", "=", 
   RowBox[{"dself", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], "din", " ", "Qin"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", "Qout"}], "-", 
    RowBox[{
     FractionBox["\[Mu]", 
      RowBox[{"n", " ", "d"}]], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "Qin"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "Qout"}]}], ")"}]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.6997879444913797`*^9, 3.6997879865015497`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]BD", "=", 
  RowBox[{
   RowBox[{"factorBD", 
    RowBox[{"(", 
     RowBox[{"\[Gamma]BDD", "-", "\[Gamma]BDI"}], ")"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699787990021633*^9, 3.699788004937168*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "dself", "+", 
        RowBox[{"din", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "dout", " ", "n", " ", 
         "Qout"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "Qin", "+", 
        RowBox[{"n", " ", 
         RowBox[{"(", 
          RowBox[{"d", "-", "Qin", "+", "Qout", "-", 
           RowBox[{"d", " ", "Qout"}]}], ")"}]}]}], ")"}], " ", "\[Mu]"}]}], 
    ")"}]}], 
  RowBox[{"d", " ", "n", " ", "\[Mu]"}]]], "Output",
 CellChangeTimes->{{3.6997880018981028`*^9, 3.699788005307209*^9}, 
   3.699793867687854*^9, 3.699847510539104*^9, 3.699848993407742*^9, 
   3.699853749752069*^9, 3.6999553580700197`*^9, 3.702201319343082*^9, 
   3.702289677567067*^9, 3.7041789628852587`*^9, 3.7045177179484787`*^9, 
   3.70538552563669*^9, 3.7053857493865147`*^9, 3.70999005510261*^9, 
   3.709990584634004*^9, 3.710047000000866*^9, 3.710049691737043*^9, 
   3.7100543048914223`*^9, 3.710054510902038*^9, 3.7101569679797*^9, 
   3.713407361156756*^9, 3.714231972377007*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moran, Death-Birth", "Subsection",
 CellChangeTimes->{{3.6997882937760963`*^9, 3.699788365013695*^9}}],

Cell[CellGroupData[{

Cell["\[Beta]", "Subsubsection",
 CellChangeTimes->{{3.6997883477895412`*^9, 3.69978834940098*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]DBD", "=", "\[Beta]BDD"}]], "Input",
 CellChangeTimes->{{3.699788350622011*^9, 3.699788367592432*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"eself", "+", 
    RowBox[{"ein", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
    RowBox[{"eout", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "n"}], "+", 
       RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", "\[Mu]"}], ")"}]}]], "Output",
 CellChangeTimes->{3.699788368875032*^9, 3.699793867805636*^9, 
  3.699847510687601*^9, 3.699848999986759*^9, 3.699853749950212*^9, 
  3.699955358165345*^9, 3.7022013195009747`*^9, 3.702289677727807*^9, 
  3.704178962940996*^9, 3.704517718153728*^9, 3.705385528716528*^9, 
  3.7053857544696503`*^9, 3.70999005511514*^9, 3.7099905846572647`*^9, 
  3.7100470023149157`*^9, 3.7100496917726088`*^9, 3.710054304921584*^9, 
  3.710054511039755*^9, 3.710156968077525*^9, 3.713407361186426*^9, 
  3.714231972551651*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]DBI", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1", "*", "dself", " ", "dself", " ", "eself", "*", "1"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "02", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dself", " ", "din", " ", "ein", " ", 
       "*", "1"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "03", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dself", " ", "dout", 
       " ", "eout", " ", "*", "1"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "04", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dself", " ", "dself", " ", "ein", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "05", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "dself", " ", "din", " ", 
       "eself", " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "06", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "dself", " ", "din", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "07", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], " ", "dself", " ", 
       "dout", " ", "eout", " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "08", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], "dself", " ", 
       "dself", " ", "eout", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "09", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "dself", " ", "din", " ", "eout",
        " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "10", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], "dself", " ", 
       "dout", " ", "eself", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "11", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "dself", " ", "dout", " ", "ein",
        " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "12", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], " ", "dself", " ", "dout", " ", "eout", 
       " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "13", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "din", " ", "dself", " ", "eself", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "14", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "din", " ", "din", " ", "ein", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "15", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "din", " ", "din", " ", "ein", " ", 
       "Qin"}], " ", 
      RowBox[{"(*", "\[IndentingNewLine]", "16", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], "din", " ", "dout", 
       " ", "eout", " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "17", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "din", " ", "dself", " ", "ein"}], 
      " ", 
      RowBox[{"(*", "\[IndentingNewLine]", "18", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "din", " ", "din", " ", "eself"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "19", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "din", " ", "din", " ", "ein"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "20", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "din", " ", "dout", " ", 
       "eout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "21", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "din", " ", "dself", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "22", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "din", " ", "din", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "23", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], " ", "din", " ", "din", " ", "eself", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "24", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "3"}], ")"}], "din", " ", "din", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "25", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "din", " ", "dout", " ", 
       "eout", " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "26", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "din", " ", "dself", " ",
        "eout", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "27", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "din", " ", "din", " ", 
       "eout", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "28", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "din", " ", "din", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "29", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "din", " ", "dout", " ", 
       "eself", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "30", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "din", " ", "dout", " ", "ein", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "31", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], " ", "din", " ", "dout", " ", "eout", 
       " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "32", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", "dself", 
       " ", "eself", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "33", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din", " ", "ein", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "34", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", "dout", " ",
        "eout", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "35", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "dout", " ", "dout", " ", "eout",
        " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "36", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "37", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dself", " ", "ein", " ",
        "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "38", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din", " ", "eself", " ",
        "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "39", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "dout", " ", "din", " ", "ein", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "40", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "eout", " ",
        "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "41", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "eout", " ",
        "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "42", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "43", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", "dself", 
       " ", "eout"}], " ", 
      RowBox[{"(*", "\[IndentingNewLine]", "44", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din", " ", "eout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "45", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", "dout", " ",
        "eself"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "46", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "ein"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "47", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "48", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dself", " ", "eout", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "49", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din", " ", "eout", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "50", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "51", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "eself", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "52", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "dout", " ", "dout", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "53", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "54", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dself", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "55", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "56", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "57", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "eout", " ",
        "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "58", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eself", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "59", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "ein", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "60", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"3", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout", " ", 
       "Qout"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699788370828354*^9, 3.6997883737861567`*^9}, {
  3.6997885910757103`*^9, 3.6997887279414787`*^9}, {3.699788766452323*^9, 
  3.69978887959624*^9}, {3.699789587279212*^9, 3.699789590128297*^9}, {
  3.6997897035456047`*^9, 3.699790157751882*^9}, {3.699790248805749*^9, 
  3.6997904719344053`*^9}, {3.6997909127859507`*^9, 3.699791106760395*^9}, {
  3.699791559504848*^9, 3.699791710511548*^9}, {3.69979191446669*^9, 
  3.6997919239386578`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"factorDB", "=", "factorBD"}]], "Input",
 CellChangeTimes->{{3.699791725220916*^9, 3.699791732023768*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], " ", "p"}], "\[Mu]"]], "Output",
 CellChangeTimes->{{3.699791726790472*^9, 3.699791732340192*^9}, 
   3.6997938682265463`*^9, 3.699847981983308*^9, 3.699849000076928*^9, 
   3.6998537501443233`*^9, 3.6999553584313593`*^9, 3.702201319689139*^9, 
   3.7022896779804573`*^9, 3.704178963019085*^9, 3.7045177183790417`*^9, 
   3.705385528792678*^9, 3.7053857545731573`*^9, 3.7099900551495123`*^9, 
   3.70999058469648*^9, 3.710047029070117*^9, 3.710049691820953*^9, 
   3.7100543049660788`*^9, 3.710054511148797*^9, 3.710156968281186*^9, 
   3.713407361244309*^9, 3.714231972719874*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]DB", "=", 
  RowBox[{
   RowBox[{"factorDB", 
    RowBox[{"(", 
     RowBox[{"\[Beta]DBD", "-", "\[Beta]DBI"}], ")"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699791734393208*^9, 3.6997917476423197`*^9}, {
  3.6997926117664433`*^9, 3.6997926138905087`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "\[Mu]"], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{"eself", "+", 
     RowBox[{"ein", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "eout", " ", "n", " ", 
      "Qout"}], "-", 
     RowBox[{
      SuperscriptBox["dself", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"eself", "+", 
        RowBox[{"ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "eout", " ", "n", " ", 
         "Qout"}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["din", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"eself", "+", 
        RowBox[{"eself", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
        RowBox[{"ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "n", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"3", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}], 
            " ", "Qin"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", "Qout"}]}], 
       ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
      SuperscriptBox["dout", "2"], " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"eself", "+", 
           RowBox[{"ein", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "eout", " ", 
            "n"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}]}], ")"}]}], 
        "+", 
        RowBox[{"n", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "eself"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "ein", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"3", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "3"}], "+", "d"}], ")"}], " ", "d"}]}], ")"}], 
            " ", "eout", " ", "n"}]}], ")"}], " ", "Qout"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "dout", " ", "dself", " ",
       "n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"eself", "+", 
           RowBox[{"ein", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", "Qout"}],
         "+", 
        RowBox[{"eout", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "n", " ", 
            "Qout"}]}], ")"}]}]}], ")"}]}], "-", 
     RowBox[{"2", " ", "din", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dself", " ", 
         RowBox[{"(", 
          RowBox[{"ein", "+", 
           RowBox[{"eself", " ", "Qin"}], "+", 
           RowBox[{"ein", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "eout", " ", "n", 
            " ", "Qout"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "dout", " ", "n", " ", 
         
         RowBox[{"(", 
          RowBox[{"eout", "+", 
           RowBox[{"eout", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"eself", "+", 
              RowBox[{"ein", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "eout", " ", 
               "n"}]}], ")"}], " ", "Qout"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
   " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "\[Mu]"}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.699791749004755*^9, 3.699791928140911*^9, 
  3.699792626181149*^9, 3.699793879672049*^9, 3.6998475283084784`*^9, 
  3.699849009846263*^9, 3.699853759446772*^9, 3.6999553665676394`*^9, 
  3.702201328485806*^9, 3.702289688938758*^9, 3.7041789784206753`*^9, 
  3.704517727201066*^9, 3.7053855375718317`*^9, 3.705385759703961*^9, 
  3.70999006205303*^9, 3.7099905943620863`*^9, 3.710047040104258*^9, 
  3.710049702228156*^9, 3.710054313368938*^9, 3.710054519456626*^9, 
  3.7101569805272512`*^9, 3.713407377816057*^9, 3.714232036638342*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Gamma]", "Subsubsection",
 CellChangeTimes->{{3.6997883477895412`*^9, 3.69978834940098*^9}, {
  3.699792669000319*^9, 3.699792670294528*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]DBD", "=", "\[Gamma]BDD"}]], "Input",
 CellChangeTimes->{{3.699792671742481*^9, 3.699792678668209*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", "\[Mu]"}]], "Output",
 CellChangeTimes->{3.6997926798829107`*^9, 3.699793879753723*^9, 
  3.699847528456636*^9, 3.6998490099380207`*^9, 3.699853759632382*^9, 
  3.699955366711424*^9, 3.702201328654451*^9, 3.702289689100259*^9, 
  3.704178978486375*^9, 3.7045177274160137`*^9, 3.7053855377473497`*^9, 
  3.705385759747951*^9, 3.709990062316594*^9, 3.7099905944100246`*^9, 
  3.710047042329115*^9, 3.710049702285987*^9, 3.710054313496426*^9, 
  3.7100545195890703`*^9, 3.710156980738796*^9, 3.713407377862473*^9, 
  3.714232036820908*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]DBI", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["dself", "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       SuperscriptBox["din", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       SuperscriptBox["dout", "2"]}], 
      RowBox[{"(*", "\[IndentingNewLine]", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", "din"}], "+", " ", 
         RowBox[{"din", " ", "dself"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}], "din", " ", "din"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", 
          "dout"}]}], ")"}], "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", "dout"}], " ", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "din", " ", "dout"}], "+", " ", 
         RowBox[{"dout", " ", "dself"}], "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"n", " ", "d"}], "-", 
            RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout"}]}], ")"}], 
       "Qout"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699792681385618*^9, 3.6997928220916023`*^9}, {
  3.6997931579841633`*^9, 3.699793164560968*^9}, {3.699793207548834*^9, 
  3.699793212788492*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]DB", "=", 
  RowBox[{"factorDB", 
   RowBox[{"(", 
    RowBox[{"\[Gamma]DBD", "-", "\[Gamma]DBI"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6997928247896*^9, 3.699792842326086*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "\[Mu]"], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["dself", "2"], "+", 
        RowBox[{
         SuperscriptBox["din", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["dout", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "din", " ", "dself"}], "+", 
           RowBox[{
            SuperscriptBox["din", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "n"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["dout", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "n"}], "+", 
              RowBox[{"d", " ", "n"}]}], ")"}]}]}], ")"}], " ", "Qin"}], "+", 
        
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "dout", " ", "dself"}], "+", 
           RowBox[{"2", " ", "din", " ", "dout", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["dout", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "n"}], "+", 
              RowBox[{"d", " ", "n"}]}], ")"}]}]}], ")"}], " ", "Qout"}]}], 
       ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}]}], "-", "\[Mu]"}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.699792843210064*^9, 3.6997931658091793`*^9, 
  3.699793214494582*^9, 3.699793879823855*^9, 3.699847528602282*^9, 
  3.699849009993635*^9, 3.699853759799317*^9, 3.699955366875863*^9, 
  3.702201328835555*^9, 3.7022896892128677`*^9, 3.7041789785551357`*^9, 
  3.704517727624941*^9, 3.705385537806016*^9, 3.7053857598273993`*^9, 
  3.709990062326001*^9, 3.7099905944497538`*^9, 3.710047043549039*^9, 
  3.7100497023242273`*^9, 3.71005431353528*^9, 3.7100545197590714`*^9, 
  3.710156980911428*^9, 3.7134073779281187`*^9, 3.714232037032537*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wright - Fisher", "Subsection",
 CellChangeTimes->{{3.69979364538774*^9, 3.6997936505742283`*^9}}],

Cell["\<\
The formulas are the same as the Moran DB life-cycle, only the probabilities \
of identity by descent Q will differ. \
\>", "Text",
 CellChangeTimes->{{3.71004712599955*^9, 3.7100471537307873`*^9}}],

Cell[CellGroupData[{

Cell["\[Beta]", "Subsubsection",
 CellChangeTimes->{{3.699793660765585*^9, 3.699793662299658*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Beta]WFI", "=", "\[Beta]DBI"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]WFD", "=", "\[Beta]DBD"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]WF", "=", "\[Beta]DB"}], ";"}]}], "Input",
 CellChangeTimes->{{3.699793681804043*^9, 3.6997936868298264`*^9}, {
  3.7100516610266438`*^9, 3.7100516730745697`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Gamma]", "Subsubsection",
 CellChangeTimes->{{3.699793660765585*^9, 3.699793691772121*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Gamma]WF", "=", "\[Gamma]DB"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]WFD", "=", "\[Gamma]DBD"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]WFI", "=", "\[Gamma]DBI"}], ";"}]}], "Input",
 CellChangeTimes->{{3.699793681804043*^9, 3.699793695476061*^9}, {
  3.710054344520341*^9, 3.710054351104436*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check the results numerically", "Section",
 CellChangeTimes->{{3.69976960096646*^9, 3.699769610384227*^9}, {
  3.699850594091323*^9, 3.69985059613144*^9}, {3.705385403861724*^9, 
  3.705385410277524*^9}}],

Cell["\<\
We use generic equations valid for any life-cycle and any graph, and adapt \
them to our life-cycles and to a subdivided population. We compare the \
numerical results to the ones obtained with the equations written above. \
\>", "Text",
 CellChangeTimes->{{3.705385415146649*^9, 3.7053854805488234`*^9}}],

Cell[CellGroupData[{

Cell["Full functions, any life-cycle", "Subsection",
 CellChangeTimes->{{3.667805530329844*^9, 3.667805533236369*^9}, {
   3.667817240550598*^9, 3.6678172439254503`*^9}, 3.6703187116345387`*^9}],

Cell["\<\
\[Beta] and \[Gamma] were calculated by hand - these are generic equations \
value for any life-cycle and any regular graph. 
(see Appendix B1 for details, and Debarre 2017 JTB for even further details)\
\>", "Text",
 CellChangeTimes->{{3.679394260451545*^9, 3.679394277503475*^9}, 
   3.7053852236151247`*^9, {3.7053853495020123`*^9, 3.705385388886067*^9}, {
   3.710047168386541*^9, 3.7100471691967497`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetBeta", "[", 
    RowBox[{
    "sBf_", ",", "Df_", ",", "G_", ",", "GE_", ",", "Qmat_", ",", 
     "\[CapitalNu]_", ",", "graphdegree_", ",", "Bstar_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"part1", ",", "part2", ",", "factor"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"factor", "=", 
       FractionBox[
        RowBox[{"p", 
         RowBox[{"(", 
          RowBox[{"1", "-", "p"}], ")"}]}], 
        RowBox[{"\[Mu]", " ", "\[CapitalNu]", " ", "Bstar"}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"part1", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Mu]"}], ")"}], 
             RowBox[{"sBf", "[", 
              RowBox[{
              "G", ",", "\[CapitalNu]", ",", "graphdegree", ",", "j", ",", 
               "l"}], "]"}]}], "-", 
            RowBox[{"Df", "[", 
             RowBox[{
             "G", ",", "\[CapitalNu]", ",", "graphdegree", ",", "j", ",", 
              "l"}], "]"}]}], ")"}], "*", 
          RowBox[{"GE", "\[LeftDoubleBracket]", 
           RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}], "*", 
          RowBox[{"Qmat", "\[LeftDoubleBracket]", 
           RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"factor", "*", "part1"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetGamma", "[", 
   RowBox[{
   "sBf_", ",", "Df_", ",", "G_", ",", "GE_", ",", "Qmat_", ",", 
    "\[CapitalNu]_", ",", "graphdegree_", ",", "Bstar_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"part1", ",", "part2", ",", "factor"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"factor", "=", 
      FractionBox[
       RowBox[{"p", 
        RowBox[{"(", 
         RowBox[{"1", "-", "p"}], ")"}]}], 
       RowBox[{"\[Mu]", " ", "\[CapitalNu]", " ", "Bstar"}]]}], ";", 
     RowBox[{"part1", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Mu]"}], ")"}], 
            RowBox[{"sBf", "[", 
             RowBox[{
             "G", ",", "\[CapitalNu]", ",", "graphdegree", ",", "j", ",", 
              "k"}], "]"}]}], "-", 
           RowBox[{"Df", "[", 
            RowBox[{
            "G", ",", "\[CapitalNu]", ",", "graphdegree", ",", "j", ",", 
             "k"}], "]"}]}], ")"}], "*", 
         RowBox[{"Qmat", "\[LeftDoubleBracket]", 
          RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"factor", "*", "part1"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6767809663714542`*^9, 3.676781023510331*^9}, {
  3.676804537681356*^9, 3.676804544825398*^9}, {3.679396412220232*^9, 
  3.679396413286743*^9}, {3.699769980839834*^9, 3.699769997947857*^9}, {
  3.699778646203886*^9, 3.6997786598998013`*^9}, {3.699778713529934*^9, 
  3.6997788466070232`*^9}, {3.6997814408909063`*^9, 3.699781470396274*^9}, {
  3.6997873888540173`*^9, 3.69978742458986*^9}, {3.710044608058228*^9, 
  3.710044629109458*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moran DB", "Subsection",
 CellChangeTimes->{{3.667817266049498*^9, 3.667817267641507*^9}, {
  3.667829361694632*^9, 3.667829362862344*^9}, {3.670318555363709*^9, 
  3.67031856010742*^9}, {3.679394287560162*^9, 3.6793942988890533`*^9}}],

Cell[CellGroupData[{

Cell["Define \[Delta]B and \[Delta]D", "Subsubsection",
 CellChangeTimes->{{3.667817270639081*^9, 3.667817303563981*^9}}],

Cell["graphdegree is the degree of the graph, here equal to 1", "Text",
 CellChangeTimes->{{3.705385243294672*^9, 3.705385251443304*^9}, 
   3.710044631061921*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sBfDB", "[", 
    RowBox[{
    "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "j_", ",", "k_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Delta", "[", 
        RowBox[{"k", "-", "j"}], "]"}], 
       SuperscriptBox["graphdegree", "2"]}], "-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"G", "\[LeftDoubleBracket]", 
          RowBox[{"j", ",", "i"}], "\[RightDoubleBracket]"}], 
         RowBox[{"G", "\[LeftDoubleBracket]", 
          RowBox[{"k", ",", "i"}], "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], 
     ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"\[CapitalNu]", " ", 
      SuperscriptBox["graphdegree", "2"]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DfDB", "[", 
    RowBox[{
    "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "j_", ",", "k_"}], 
    "]"}], ":=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BstarDB", "=", 
   FractionBox["1", "\[CapitalNu]"]}], ";"}]}], "Input",
 CellChangeTimes->{{3.667805794031062*^9, 3.6678058049416933`*^9}, {
   3.667805883047532*^9, 3.667806013751638*^9}, {3.667806064496217*^9, 
   3.667806108193321*^9}, {3.6678067367929573`*^9, 3.667806737538381*^9}, {
   3.667806855132804*^9, 3.667806855241205*^9}, 3.6678069002815533`*^9, {
   3.6678178907809553`*^9, 3.6678178913089523`*^9}, {3.699778852523326*^9, 
   3.699778862434937*^9}, {3.6997874275513897`*^9, 3.699787463278324*^9}, {
   3.710044633532029*^9, 3.7100446369559927`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Beta]", "Subsubsection",
 CellChangeTimes->{{3.69978004306563*^9, 3.6997800470396347`*^9}, {
  3.699792857641252*^9, 3.6997928577847347`*^9}}],

Cell["Numerical comparison for the population of size 12", "Text",
 CellChangeTimes->{{3.710047191461318*^9, 3.710047206628955*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]DBexemple", "=", 
  RowBox[{
   RowBox[{"GetBeta", "[", 
    RowBox[{
    "sBfDB", ",", "DfDB", ",", "G12generic", ",", "GE12generic", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarDB", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997800509176693`*^9, 3.6997800766118813`*^9}, {
  3.699780227296484*^9, 3.699780254043705*^9}, {3.699781039145463*^9, 
  3.699781043696348*^9}, {3.6997811552598333`*^9, 3.699781156248343*^9}, {
  3.699791766659071*^9, 3.699791790258472*^9}, {3.705385777149726*^9, 
  3.705385779307852*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["dself", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"eself", "+", 
         RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
         RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["din", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"ein", "+", "eself", "+", 
         RowBox[{"3", " ", "ein", " ", "Qin"}], "+", 
         RowBox[{"eself", " ", "Qin"}], "+", 
         RowBox[{"18", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"18", " ", "dout", " ", "dself", " ", 
       RowBox[{"(", 
        RowBox[{"eout", "+", 
         RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
         RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
         RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
         RowBox[{"eself", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"9", " ", 
       SuperscriptBox["dout", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "ein"}], "+", 
            RowBox[{"6", " ", "eout"}], "+", "eself"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "Qin"}]}], ")"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "ein"}], "+", 
            RowBox[{"21", " ", "eout"}], "+", 
            RowBox[{"2", " ", "eself"}]}], ")"}], " ", "Qout"}]}], ")"}]}], 
      "+", 
      RowBox[{"4", " ", "din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", 
          RowBox[{"(", 
           RowBox[{"ein", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ein", "+", "eself"}], ")"}], " ", "Qin"}], "+", 
            RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
         RowBox[{"9", " ", "dout", " ", 
          RowBox[{"(", 
           RowBox[{"eout", "+", 
            RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
            RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
            RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
            RowBox[{"eself", " ", "Qout"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.69978024638573*^9, 3.699780256098102*^9}, 
   3.699781045273366*^9, 3.699781157642991*^9, 3.699781474913704*^9, 
   3.699783922853292*^9, 3.699787598717938*^9, {3.6997917699729023`*^9, 
   3.699791791253379*^9}, 3.6997938463840523`*^9, 3.6998474709052677`*^9, 
   3.699848136068221*^9, 3.6998506023560133`*^9, 3.699853761541006*^9, 
   3.699955368362294*^9, 3.7022013304406977`*^9, 3.702289690824561*^9, 
   3.704178980449655*^9, 3.704517729262532*^9, 3.705385501064349*^9, 
   3.705385711972087*^9, {3.70538577278124*^9, 3.705385780505777*^9}, 
   3.709990174748199*^9, 3.709990595225204*^9, 3.710047180131008*^9, 
   3.7100497031853237`*^9, 3.710054314797099*^9, 3.710054521349021*^9, 
   3.710156982949984*^9, 3.713407380491803*^9, 3.7142320418460827`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]DBexemple", "-", "\[Beta]DB"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699791793075905*^9, 3.6997918142667027`*^9}, {
  3.704518414547575*^9, 3.704518424365841*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699791804334284*^9, 3.699791815023748*^9}, 
   3.699791940967175*^9, 3.699793849735236*^9, 3.699847473358466*^9, 
   3.699848138659239*^9, 3.6998506024698*^9, 3.699853761680664*^9, 
   3.699955368504578*^9, 3.702201330605775*^9, 3.702289690977955*^9, 
   3.704178980521405*^9, 3.704517729471529*^9, {3.704518416387002*^9, 
   3.704518424546892*^9}, 3.705385503251767*^9, {3.70538569358629*^9, 
   3.705385718349859*^9}, 3.7053857820865*^9, 3.709990183151667*^9, 
   3.709990595261455*^9, 3.710047181094242*^9, 3.7100497032193537`*^9, 
   3.710054314876215*^9, 3.710054521482843*^9, 3.7101569830927143`*^9, 
   3.713407380530377*^9, 3.714232042067981*^9}]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 3.7100472277111177`*^9}}],

Cell["Numerical comparison for the population of size 10", "Text",
 CellChangeTimes->{{3.710047191461318*^9, 3.710047216676303*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]DBexemple2", "=", 
  RowBox[{
   RowBox[{"GetBeta", "[", 
    RowBox[{
    "sBfDB", ",", "DfDB", ",", "G10generic", ",", "GE10generic", ",", 
     "Q10generic", ",", "10", ",", "1", ",", 
     RowBox[{"BstarDB", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "10"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997922176034184`*^9, 3.6997922333025217`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["dself", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"eself", "+", 
         RowBox[{"4", " ", "ein", " ", "Qin"}], "+", 
         RowBox[{"5", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["din", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"eself", "+", 
         RowBox[{"3", " ", "eself", " ", "Qin"}], "+", 
         RowBox[{"ein", " ", 
          RowBox[{"(", 
           RowBox[{"3", "+", 
            RowBox[{"13", " ", "Qin"}]}], ")"}]}], "+", 
         RowBox[{"20", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"5", " ", 
       SuperscriptBox["dout", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "ein"}], "+", "eself"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"4", " ", "Qin"}]}], ")"}]}], "+", 
         RowBox[{"25", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"10", " ", "dout", " ", "dself", " ", 
       RowBox[{"(", 
        RowBox[{"eout", "+", 
         RowBox[{"4", " ", "eout", " ", "Qin"}], "+", 
         RowBox[{"4", " ", "ein", " ", "Qout"}], "+", 
         RowBox[{"eself", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"8", " ", "din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", 
          RowBox[{"(", 
           RowBox[{"ein", "+", 
            RowBox[{"3", " ", "ein", " ", "Qin"}], "+", 
            RowBox[{"eself", " ", "Qin"}], "+", 
            RowBox[{"5", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
         RowBox[{"5", " ", "dout", " ", 
          RowBox[{"(", 
           RowBox[{"eout", "+", 
            RowBox[{"4", " ", "eout", " ", "Qin"}], "+", 
            RowBox[{"4", " ", "ein", " ", "Qout"}], "+", 
            RowBox[{"eself", " ", "Qout"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.6997922351725397`*^9, 3.6997938504112864`*^9, 
  3.699847474799409*^9, 3.699848140390723*^9, 3.6998506041587563`*^9, 
  3.6998537629428673`*^9, 3.699955369423333*^9, 3.702201331633013*^9, 
  3.70228969212409*^9, 3.704178982196525*^9, 3.7045177304936438`*^9, 
  3.705385695022094*^9, 3.705385784128316*^9, 3.709990186222736*^9, 
  3.709990596312099*^9, 3.710047392762372*^9, 3.7100497046122913`*^9, 
  3.710054315795927*^9, 3.7100545225544653`*^9, 3.7101569844063683`*^9, 
  3.713407382219857*^9, 3.714232045746003*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]DBexemple2", "-", "\[Beta]DB"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "5"}], ",", 
     RowBox[{"d", "\[Rule]", "2"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699792241182529*^9, 3.699792249407493*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699792244617155*^9, 3.699792249502091*^9}, 
   3.6997938551855373`*^9, 3.699847477795148*^9, 3.699848143818454*^9, 
   3.699850604259791*^9, 3.699853763077199*^9, 3.699955369567561*^9, 
   3.7022013318022823`*^9, 3.70228969228119*^9, 3.704178982263274*^9, 
   3.704517730731916*^9, 3.7053856950796824`*^9, 3.705385785289909*^9, 
   3.709990190147925*^9, 3.709990596395607*^9, 3.710047393269868*^9, 
   3.710049704654264*^9, 3.7100543158352003`*^9, 3.7100545226815147`*^9, 
   3.71015698455232*^9, 3.713407382257227*^9, 3.714232045908511*^9}]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 3.7100472277111177`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Gamma]", "Subsubsection",
 CellChangeTimes->{{3.69978004306563*^9, 3.6997800470396347`*^9}, {
  3.699792857641252*^9, 3.6997928674291353`*^9}}],

Cell["Numerical comparison for the population of size 12", "Text",
 CellChangeTimes->{{3.710047191461318*^9, 3.710047216676303*^9}, {
  3.7100480367495193`*^9, 3.710048037368987*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]DBexemple", "=", 
  RowBox[{
   RowBox[{"GetGamma", "[", 
    RowBox[{
    "sBfDB", ",", "DfDB", ",", "G12generic", ",", "GE12generic", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarDB", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997800509176693`*^9, 3.6997800766118813`*^9}, {
  3.699780227296484*^9, 3.699780254043705*^9}, {3.699781039145463*^9, 
  3.699781043696348*^9}, {3.6997811552598333`*^9, 3.699781156248343*^9}, {
  3.699791766659071*^9, 3.699791790258472*^9}, {3.699792869185608*^9, 
  3.699792873215055*^9}, {3.705386121796611*^9, 3.705386123738603*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["dself", "2"], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["din", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "Qin"}], ")"}]}], "+", 
      RowBox[{"4", " ", "din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", "Qin"}], "+", 
         RowBox[{"9", " ", "dout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"9", " ", "dout", " ", 
       RowBox[{"(", 
        RowBox[{"dout", "+", 
         RowBox[{"2", " ", "dout", " ", "Qin"}], "+", 
         RowBox[{"6", " ", "dout", " ", "Qout"}], "+", 
         RowBox[{"2", " ", "dself", " ", "Qout"}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.69978024638573*^9, 3.699780256098102*^9}, 
   3.699781045273366*^9, 3.699781157642991*^9, 3.699781474913704*^9, 
   3.699783922853292*^9, 3.699787598717938*^9, {3.6997917699729023`*^9, 
   3.699791791253379*^9}, 3.6997928744168043`*^9, 3.699793225128313*^9, 
   3.6997938553436613`*^9, 3.6998474781335363`*^9, 3.6998481443005123`*^9, 
   3.6998506070961523`*^9, 3.699853763359934*^9, 3.6999553698191566`*^9, 
   3.702201332087606*^9, 3.7022896925574408`*^9, 3.704178982497615*^9, 
   3.704517731012682*^9, 3.705385789772509*^9, 3.7053861246182823`*^9, 
   3.709990192385351*^9, 3.709990596589851*^9, 3.710048038606057*^9, 
   3.7100497048101377`*^9, 3.710054316019289*^9, 3.7100545229004307`*^9, 
   3.7101569847769136`*^9, 3.713407382455076*^9, 3.714232046221287*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]DBexemple", "-", "\[Gamma]DB"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699791793075905*^9, 3.6997918142667027`*^9}, {
  3.699792876177504*^9, 3.6997928792173023`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699791804334284*^9, 3.699791815023748*^9}, 
   3.699791940967175*^9, 3.699792879944309*^9, 3.699793181383277*^9, 
   3.699793225184245*^9, 3.6997938556744423`*^9, 3.699847478511882*^9, 
   3.69984814491894*^9, 3.6998506090564632`*^9, 3.699853763529297*^9, 
   3.699955369950479*^9, 3.702201332286913*^9, 3.702289692727661*^9, 
   3.704178982565536*^9, 3.704517731180649*^9, 3.705386133224227*^9, 
   3.7099901943515453`*^9, 3.709990596596596*^9, 3.710048039355609*^9, 
   3.710049704837688*^9, 3.7100543160623617`*^9, 3.7100545229144917`*^9, 
   3.710156984806225*^9, 3.71340738247503*^9, 3.714232046375513*^9}]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 3.7100472277111177`*^9}}],

Cell["Numerical comparison for the population of size 10", "Text",
 CellChangeTimes->{{3.710047191461318*^9, 3.710047216676303*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]DBexemple2", "=", 
  RowBox[{
   RowBox[{"GetGamma", "[", 
    RowBox[{
    "sBfDB", ",", "DfDB", ",", "G10generic", ",", "GE10generic", ",", 
     "Q10generic", ",", "10", ",", "1", ",", 
     RowBox[{"BstarDB", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "10"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997922176034184`*^9, 3.6997922333025217`*^9}, {
  3.6997928836005917`*^9, 3.699792884605294*^9}, {3.6997931965600157`*^9, 
  3.6997931976610737`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["dself", "2"], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["din", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"3", " ", "Qin"}]}], ")"}]}], "+", 
      RowBox[{"8", " ", "din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", "Qin"}], "+", 
         RowBox[{"5", " ", "dout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"5", " ", "dout", " ", 
       RowBox[{"(", 
        RowBox[{"dout", "+", 
         RowBox[{"4", " ", "dout", " ", "Qin"}], "+", 
         RowBox[{"2", " ", "dself", " ", "Qout"}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "\[Mu]"]}]], "Output",
 CellChangeTimes->{
  3.6997922351725397`*^9, 3.699792888128591*^9, {3.699793182918476*^9, 
   3.6997932253132267`*^9}, 3.699793855883088*^9, 3.69984747883878*^9, 
   3.6998481453289337`*^9, 3.699850609714999*^9, 3.699853763776083*^9, 
   3.69995537019744*^9, 3.702201332538973*^9, 3.702289692983096*^9, 
   3.704178982832259*^9, 3.70451773145947*^9, 3.705386134677553*^9, 
   3.709990195901651*^9, 3.709990596765334*^9, 3.7100480415088997`*^9, 
   3.710049704981529*^9, 3.71005431621916*^9, 3.710054523095546*^9, 
   3.710156985057029*^9, 3.7134073826680117`*^9, 3.714232046717184*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]DBexemple2", "-", "\[Gamma]DB"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "5"}], ",", 
     RowBox[{"d", "\[Rule]", "2"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699792241182529*^9, 3.699792249407493*^9}, {
  3.699792889401593*^9, 3.699792892793714*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699792244617155*^9, 3.699792249502091*^9}, 
   3.699792895322885*^9, {3.699793185251954*^9, 3.6997932253397837`*^9}, 
   3.6997938561037617`*^9, 3.699847479378138*^9, 3.699848145708249*^9, 
   3.699850610231893*^9, 3.699853763858077*^9, 3.699955370216586*^9, 
   3.7022013325889177`*^9, 3.70228969307031*^9, 3.704178982875839*^9, 
   3.704517731499671*^9, 3.70538613635847*^9, 3.709990197060823*^9, 
   3.709990596805367*^9, 3.710048042098637*^9, 3.71004970501007*^9, 
   3.71005431626306*^9, 3.710054523164699*^9, 3.710156985132773*^9, 
   3.7134073826897593`*^9, 3.714232046809765*^9}]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 3.7100472277111177`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moran BD", "Subsection",
 CellChangeTimes->{{3.667817266049498*^9, 3.667817267641507*^9}, {
   3.66782181858403*^9, 3.667821819675145*^9}, {3.66782936574275*^9, 
   3.667829366991437*^9}, 3.670318572988695*^9, {3.6793943239760017`*^9, 
   3.67939432588864*^9}}],

Cell["\<\
The structure is the same as for Moran DB above - comments are lighter here!\
\>", "Text",
 CellChangeTimes->{{3.710048063471426*^9, 3.710048080308312*^9}}],

Cell[CellGroupData[{

Cell["Define \[Delta]B and \[Delta]D", "Subsubsection",
 CellChangeTimes->{{3.667817270639081*^9, 3.667817303563981*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sBfBD", "[", 
    RowBox[{
    "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "j_", ",", "k_"}], 
    "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"Delta", "[", 
       RowBox[{"k", "-", "j"}], "]"}], "\[CapitalNu]"}], "-", "1"}], 
    SuperscriptBox["\[CapitalNu]", "2"]]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DfBD", "[", 
    RowBox[{
    "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "j_", ",", "k_"}], 
    "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"G", "\[LeftDoubleBracket]", 
      RowBox[{"k", ",", "j"}], "\[RightDoubleBracket]"}], 
     RowBox[{"\[CapitalNu]", " ", "graphdegree"}]], "-", 
    FractionBox["1", 
     SuperscriptBox["\[CapitalNu]", "2"]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BstarBD", "=", 
   FractionBox["1", "\[CapitalNu]"]}], ";"}]}], "Input",
 CellChangeTimes->{{3.667805794031062*^9, 3.6678058049416933`*^9}, {
   3.667805883047532*^9, 3.667806013751638*^9}, {3.667806064496217*^9, 
   3.667806108193321*^9}, {3.6678067367929573`*^9, 3.667806737538381*^9}, {
   3.667806855132804*^9, 3.667806855241205*^9}, 3.6678069002815533`*^9, {
   3.6678178907809553`*^9, 3.6678178913089523`*^9}, {3.6678218224839478`*^9, 
   3.667821926596066*^9}, {3.69977903377708*^9, 3.699779037288487*^9}, {
   3.699787474076399*^9, 3.699787478013597*^9}, {3.6997875245164633`*^9, 
   3.699787524675749*^9}, {3.710044637988566*^9, 3.710044639211814*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations \[Beta]", "Subsubsection",
 CellChangeTimes->{{3.69978004306563*^9, 3.6997800470396347`*^9}, {
  3.699788019288118*^9, 3.699788020367642*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]BDexemple", "=", 
  RowBox[{
   RowBox[{"GetBeta", "[", 
    RowBox[{
    "sBfBD", ",", "DfBD", ",", "G12generic", ",", "GE12generic", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarBD", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997800509176693`*^9, 3.6997800766118813`*^9}, {
   3.699780227296484*^9, 3.699780254043705*^9}, {3.699781039145463*^9, 
   3.699781043696348*^9}, {3.6997811552598333`*^9, 3.699781176230454*^9}, {
   3.6997814599873953`*^9, 3.699781463270492*^9}, 3.699787561723735*^9, {
   3.699787605440502*^9, 3.6997876067381372`*^9}, {3.6997876630669823`*^9, 
   3.699787667730566*^9}, {3.705386274883584*^9, 3.705386277097451*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"12", " ", "\[Mu]"}]], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"12", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "dself"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"eself", "+", 
           RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
           RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", "din", " ", 
         RowBox[{"(", 
          RowBox[{"ein", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ein", "+", "eself"}], ")"}], " ", "Qin"}], "+", 
           RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
        RowBox[{"9", " ", "dout", " ", 
         RowBox[{"(", 
          RowBox[{"eout", "+", 
           RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
           RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
           RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
           RowBox[{"eself", " ", "Qout"}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "9"}], " ", "eout"}], "+", 
        RowBox[{"11", " ", "eself"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"ein", "-", 
           RowBox[{"10", " ", "ein", " ", "Qin"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"9", " ", "eout"}], "+", "eself"}], ")"}], " ", 
            "Qin"}]}], ")"}]}], "-", 
        RowBox[{"9", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "ein"}], "-", 
           RowBox[{"3", " ", "eout"}], "+", "eself"}], ")"}], " ", "Qout"}]}],
        ")"}], " ", "\[Mu]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.699781180204089*^9, {3.699781446797988*^9, 3.699781479785037*^9}, 
   3.699787527248124*^9, {3.699787559397271*^9, 3.699787562336577*^9}, 
   3.6997876019039497`*^9, {3.699787663714706*^9, 3.6997876695101843`*^9}, 
   3.699793857302267*^9, 3.6998474811847258`*^9, 3.699848148104183*^9, 
   3.699850615293481*^9, 3.699853766085619*^9, 3.6999553719306917`*^9, 
   3.702201334540431*^9, 3.702289695066875*^9, 3.704178985781805*^9, 
   3.704517733491603*^9, 3.705386141655033*^9, 3.7053862795179243`*^9, 
   3.709990201244254*^9, 3.709990598061387*^9, 3.710048084022653*^9, 
   3.710049706553835*^9, 3.710054317893012*^9, 3.710054524579379*^9, 
   3.710156987840686*^9, 3.713407386662087*^9, 3.714232052057707*^9}]
}, Open  ]],

Cell["Check also the different terms separately", "Text",
 CellChangeTimes->{{3.7100481590332317`*^9, 3.7100481746310043`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]IBDtest", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["\[Mu]", 
           SuperscriptBox["\[CapitalNu]", "2"]], "-", 
          FractionBox[
           RowBox[{"G", "\[LeftDoubleBracket]", 
            RowBox[{"l", ",", "j"}], "\[RightDoubleBracket]"}], 
           "\[CapitalNu]"]}], ")"}], 
        RowBox[{"GE", "\[LeftDoubleBracket]", 
         RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}], 
        RowBox[{"Q", "\[LeftDoubleBracket]", 
         RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"G", "\[Rule]", "G12generic"}], ",", 
       RowBox[{"GE", "\[Rule]", "GE12generic"}], ",", 
       RowBox[{"Q", "\[Rule]", "Q12generic"}], ",", 
       RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}], "}"}]}], "//", 
    "FullSimplify"}], "//", "Quiet"}]}]], "Input",
 CellChangeTimes->{{3.699782870840354*^9, 3.699783001047284*^9}, {
  3.699783945553492*^9, 3.699783947090015*^9}, {3.705386306210133*^9, 
  3.7053863084189987`*^9}, {3.710048089207355*^9, 3.7100480900302362`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "dself"}], " ", 
   RowBox[{"(", 
    RowBox[{"eself", "+", 
     RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
     RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "-", 
  RowBox[{"2", " ", "din", " ", 
   RowBox[{"(", 
    RowBox[{"ein", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ein", "+", "eself"}], ")"}], " ", "Qin"}], "+", 
     RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "-", 
  RowBox[{"9", " ", "dout", " ", 
   RowBox[{"(", 
    RowBox[{"eout", "+", 
     RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
     RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
     RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
     RowBox[{"eself", " ", "Qout"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "12"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "ein"}], "+", 
     RowBox[{"9", " ", "eout"}], "+", "eself"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"2", " ", "Qin"}], "+", 
     RowBox[{"9", " ", "Qout"}]}], ")"}], " ", "\[Mu]"}]}]], "Output",
 CellChangeTimes->{
  3.699850626908044*^9, 3.69985377477147*^9, 3.69995537862757*^9, 
   3.702201342087907*^9, 3.7022897036459637`*^9, 3.704178998731361*^9, 
   3.704517741831716*^9, 3.7053863161025667`*^9, 3.709990212274704*^9, 
   3.709990598795203*^9, {3.7100480919870453`*^9, 3.710048096375235*^9}, 
   3.710049707222682*^9, 3.710054326783057*^9, 3.710054533899839*^9, 
   3.710156994807612*^9, 3.713407395873147*^9, 3.714232062292047*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]IBDtest", "+", "\[Beta]BDI"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699783020789446*^9, 3.699783038546137*^9}, 
   3.699783089340975*^9, {3.699783957941577*^9, 3.699783963099947*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699783026270259*^9, 3.699783039204505*^9}, 
   3.699783090301508*^9, 3.699783569034895*^9, {3.6997839494167013`*^9, 
   3.69978396360054*^9}, {3.699787700318171*^9, 3.699787726454076*^9}, 
   3.699793858230879*^9, 3.6998474919171143`*^9, 3.6998506272226458`*^9, 
   3.699853774989265*^9, 3.699955378817668*^9, 3.702201342294386*^9, 
   3.702289703879959*^9, 3.70417899891127*^9, 3.7045177421432943`*^9, 
   3.70538631770267*^9, 3.7099902164877*^9, 3.709990598835939*^9, 
   3.7100480970973253`*^9, 3.7100497072601223`*^9, 3.710054326895178*^9, 
   3.710054534204973*^9, 3.710156995064357*^9, 3.71340739596626*^9, 
   3.714232062567128*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]DBDtest", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "\[CapitalNu]"], 
        RowBox[{"GE", "\[LeftDoubleBracket]", 
         RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}], 
        RowBox[{"Q", "\[LeftDoubleBracket]", 
         RowBox[{"l", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"G", "\[Rule]", "G12generic"}], ",", 
       RowBox[{"GE", "\[Rule]", "GE12generic"}], ",", 
       RowBox[{"Q", "\[Rule]", "Q12generic"}], ",", 
       RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}], "}"}]}], "//", 
    "FullSimplify"}], "//", "Quiet"}]}]], "Input",
 CellChangeTimes->{{3.699783999036151*^9, 3.699784026470895*^9}, {
  3.705386321946117*^9, 3.70538632397878*^9}, {3.7100481003225203`*^9, 
  3.710048101278778*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{"eself", "+", 
     RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
     RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]], "Output",
 CellChangeTimes->{3.699784037424552*^9, 3.699787735289548*^9, 
  3.6997938582837276`*^9, 3.69984750347519*^9, 3.699850638367219*^9, 
  3.699853784041383*^9, 3.6999553855026217`*^9, 3.702201349396064*^9, 
  3.702289713059708*^9, 3.704179011634886*^9, 3.70451774950618*^9, 
  3.7053863310392017`*^9, 3.709990224577718*^9, 3.709990598917156*^9, 
  3.71004810892866*^9, 3.710049707307419*^9, 3.710054335698373*^9, 
  3.710054543084178*^9, 3.710157002124436*^9, 3.713407405004422*^9, 
  3.714232072555332*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]DBDtest", "-", "\[Beta]BDD"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699784038835702*^9, 3.69978404413303*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.699784045088913*^9, 3.6997877353512278`*^9, 
  3.6997938583591948`*^9, 3.699847503650477*^9, 3.699850638481913*^9, 
  3.699853784270899*^9, 3.699955385681616*^9, 3.702201349573618*^9, 
  3.702289713227303*^9, 3.704179011750761*^9, 3.7045177497505617`*^9, 
  3.705386331099812*^9, 3.709990236560951*^9, 3.709990598923615*^9, 
  3.710048109047861*^9, 3.710049707339924*^9, 3.7100543357814617`*^9, 
  3.7100545432558804`*^9, 3.7101570023209543`*^9, 3.713407405062214*^9, 
  3.714232072835046*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]BDtest", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"p", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p"}], ")"}]}], "\[Mu]"], 
     RowBox[{"(", 
      RowBox[{"\[Beta]DBDtest", "+", "\[Beta]IBDtest"}], ")"}]}], "//", 
    "FullSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6997840516560383`*^9, 3.699784066994879*^9}, {
   3.699784124706222*^9, 3.699784180324698*^9}, {3.699784434476344*^9, 
   3.699784438938961*^9}, 3.7100481939081993`*^9}],

Cell["\<\
Numerical comparison (the differences are zero: we are fine!)\
\>", "Text",
 CellChangeTimes->{{3.710048127222234*^9, 3.710048138020673*^9}, {
  3.7100481992860727`*^9, 3.71004820811012*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]BDtest", "-", "\[Beta]BD"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6997841387119617`*^9, 3.699784144916231*^9}, {
  3.6997841825084257`*^9, 3.699784184642168*^9}, {3.699784448322966*^9, 
  3.699784451265874*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699784145255732*^9, 3.699784186958892*^9}, 
   3.699784452682255*^9, 3.699787736958263*^9, 3.699793862518971*^9, 
   3.699847507948889*^9, 3.699850640346918*^9, 3.6998537858932962`*^9, 
   3.6999553869110813`*^9, 3.702201350832096*^9, 3.702289714792705*^9, 
   3.704179013976646*^9, 3.704517751616626*^9, 3.705386332362678*^9, 
   3.709990240896392*^9, 3.709990600096583*^9, 3.710048110910675*^9, 
   3.7100481967790203`*^9, 3.7100497074300737`*^9, 3.710054337243113*^9, 
   3.710054544484828*^9, 3.710157004058296*^9, 3.713407407251863*^9, 
   3.714232075670663*^9}]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 3.7100472277111177`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]BDD", "-", "\[Beta]DBDtest"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699784301329733*^9, 3.699784327843625*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699784315772072*^9, 3.699784328285502*^9}, 
   3.699787737025803*^9, 3.699793862734157*^9, 3.69984750811241*^9, 
   3.699850640429304*^9, 3.699853785979096*^9, 3.699955387013412*^9, 
   3.7022013509303293`*^9, 3.7022897148979387`*^9, 3.704179014096588*^9, 
   3.704517751800221*^9, 3.705386341001157*^9, 3.709990241790206*^9, 
   3.709990600143642*^9, 3.710048110954846*^9, 3.710049707461434*^9, 
   3.71005433724935*^9, 3.710054544572597*^9, 3.710157004139224*^9, 
   3.713407407274166*^9, 3.714232075781427*^9}]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 3.7100472277111177`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]BDI", "+", "\[Beta]IBDtest"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699784332794595*^9, 3.6997843402035503`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6997843371632423`*^9, 3.699784340651658*^9}, 
   3.6997877370675783`*^9, 3.699793863115623*^9, 3.699847508572557*^9, 
   3.69985064051857*^9, 3.699853786064782*^9, 3.699955387107954*^9, 
   3.702201351026763*^9, 3.702289714985482*^9, 3.704179014169434*^9, 
   3.704517751951542*^9, 3.705386341733025*^9, 3.709990242288851*^9, 
   3.7099906001897717`*^9, 3.71004811100462*^9, 3.710049707512568*^9, 
   3.710054337278998*^9, 3.710054544665125*^9, 3.7101570042156153`*^9, 
   3.713407407299868*^9, 3.714232075927137*^9}]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 3.7100472277111177`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations \[Gamma]", "Subsubsection",
 CellChangeTimes->{{3.69978004306563*^9, 3.6997800470396347`*^9}, {
  3.699788019288118*^9, 3.699788039145166*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]BDexemple", "=", 
  RowBox[{
   RowBox[{"GetGamma", "[", 
    RowBox[{
    "sBfBD", ",", "DfBD", ",", "G12generic", ",", "GE12generic", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarBD", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997800509176693`*^9, 3.6997800766118813`*^9}, {
   3.699780227296484*^9, 3.699780254043705*^9}, {3.699781039145463*^9, 
   3.699781043696348*^9}, {3.6997811552598333`*^9, 3.699781176230454*^9}, {
   3.6997814599873953`*^9, 3.699781463270492*^9}, 3.699787561723735*^9, {
   3.699787605440502*^9, 3.6997876067381372`*^9}, {3.6997876630669823`*^9, 
   3.699787667730566*^9}, {3.699788044392364*^9, 3.699788048476987*^9}, {
   3.705386355939402*^9, 3.705386358345911*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"12", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "dself", "+", 
        RowBox[{"2", " ", "din", " ", "Qin"}], "+", 
        RowBox[{"9", " ", "dout", " ", "Qout"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"11", "-", 
        RowBox[{"2", " ", "Qin"}], "-", 
        RowBox[{"9", " ", "Qout"}]}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
  RowBox[{"12", " ", "\[Mu]"}]]], "Output",
 CellChangeTimes->{
  3.699781180204089*^9, {3.699781446797988*^9, 3.699781479785037*^9}, 
   3.699787527248124*^9, {3.699787559397271*^9, 3.699787562336577*^9}, 
   3.6997876019039497`*^9, {3.699787663714706*^9, 3.6997876695101843`*^9}, 
   3.699788051319792*^9, 3.699793864949399*^9, 3.699847509644327*^9, 
   3.699850685973023*^9, 3.699853786497395*^9, 3.699955387562585*^9, 
   3.70220135154718*^9, 3.7022897154491863`*^9, 3.70417901455355*^9, 
   3.704517752570101*^9, {3.705386353950165*^9, 3.7053863587980022`*^9}, 
   3.70538654765583*^9, 3.709990246021771*^9, 3.709990600417149*^9, 
   3.710048215703889*^9, 3.71004970764592*^9, 3.71005433740177*^9, 
   3.7100545448285646`*^9, 3.710157004389598*^9, 3.7134074074413013`*^9, 
   3.714232076216346*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]BDexemple", "-", "\[Gamma]BD"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.6997880588652267`*^9, 3.699788076656334*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699788066511174*^9, 3.6997880771213427`*^9}, 
   3.699793865313139*^9, 3.6998475097083883`*^9, 3.699850686611573*^9, 
   3.699853786579216*^9, 3.699955387656536*^9, 3.702201351583353*^9, 
   3.702289715530821*^9, 3.7041790146585817`*^9, 3.7045177527881517`*^9, 
   3.705386360358778*^9, 3.7053865484441767`*^9, 3.709990247084528*^9, 
   3.709990600462048*^9, 3.710048216095747*^9, 3.710049707701622*^9, 
   3.710054337456411*^9, 3.710054544909442*^9, 3.710157004516389*^9, 
   3.713407407464106*^9, 3.7142320763685913`*^9}]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 3.7100472277111177`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wright-Fisher", "Subsection",
 CellChangeTimes->{{3.667817266049498*^9, 3.667817267641507*^9}, {
   3.66782181858403*^9, 3.667821819675145*^9}, {3.66782936574275*^9, 
   3.6678293897729073`*^9}, 3.670318583924882*^9, {3.679394331716178*^9, 
   3.67939433186239*^9}}],

Cell["\<\
The structure is the same as for Moran DB above - comments are lighter here!\
\>", "Text",
 CellChangeTimes->{{3.710048063471426*^9, 3.710048080308312*^9}}],

Cell[CellGroupData[{

Cell["Define \[Delta]B and \[Delta]D", "Subsubsection",
 CellChangeTimes->{{3.667817270639081*^9, 3.667817303563981*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sBfWF", "[", 
    RowBox[{
    "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "j_", ",", "k_"}], 
    "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox["graphdegree", "2"]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Delta", "[", 
        RowBox[{"k", "-", "j"}], "]"}], 
       SuperscriptBox["graphdegree", "2"]}], "-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"G", "\[LeftDoubleBracket]", 
          RowBox[{"j", ",", "i"}], "\[RightDoubleBracket]"}], 
         RowBox[{"G", "\[LeftDoubleBracket]", 
          RowBox[{"k", ",", "i"}], "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], 
     ")"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DfWF", "[", 
    RowBox[{
    "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "j_", ",", "k_"}], 
    "]"}], ":=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BstarWF", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.667805794031062*^9, 3.6678058049416933`*^9}, {
   3.667805883047532*^9, 3.667806013751638*^9}, {3.667806064496217*^9, 
   3.667806108193321*^9}, {3.6678067367929573`*^9, 3.667806737538381*^9}, {
   3.667806855132804*^9, 3.667806855241205*^9}, 3.6678069002815533`*^9, {
   3.6678178907809553`*^9, 3.6678178913089523`*^9}, {3.6678218224839478`*^9, 
   3.667821926596066*^9}, {3.667829392668222*^9, 3.667829444078204*^9}, {
   3.699779079313068*^9, 3.699779084984041*^9}, {3.699787483271895*^9, 
   3.699787499548053*^9}, 3.6997875336757717`*^9, {3.710044640003652*^9, 
   3.710044641907976*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations \[Beta]", "Subsubsection",
 CellChangeTimes->{{3.704518466305232*^9, 3.704518471077755*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]WFexemple", "=", 
  RowBox[{
   RowBox[{"GetBeta", "[", 
    RowBox[{
    "sBfWF", ",", "DfWF", ",", "G12generic", ",", "GE12generic", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarWF", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.704518473149928*^9, 3.704518477106106*^9}, {
  3.704518525281973*^9, 3.704518525614408*^9}, {3.705386390297328*^9, 
  3.70538639242488*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["dself", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"eself", "+", 
         RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
         RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["din", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"ein", "+", "eself", "+", 
         RowBox[{"3", " ", "ein", " ", "Qin"}], "+", 
         RowBox[{"eself", " ", "Qin"}], "+", 
         RowBox[{"18", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"18", " ", "dout", " ", "dself", " ", 
       RowBox[{"(", 
        RowBox[{"eout", "+", 
         RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
         RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
         RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
         RowBox[{"eself", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"9", " ", 
       SuperscriptBox["dout", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "ein"}], "+", 
            RowBox[{"6", " ", "eout"}], "+", "eself"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "Qin"}]}], ")"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "ein"}], "+", 
            RowBox[{"21", " ", "eout"}], "+", 
            RowBox[{"2", " ", "eself"}]}], ")"}], " ", "Qout"}]}], ")"}]}], 
      "+", 
      RowBox[{"4", " ", "din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", 
          RowBox[{"(", 
           RowBox[{"ein", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ein", "+", "eself"}], ")"}], " ", "Qin"}], "+", 
            RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
         RowBox[{"9", " ", "dout", " ", 
          RowBox[{"(", 
           RowBox[{"eout", "+", 
            RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
            RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
            RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
            RowBox[{"eself", " ", "Qout"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.704518529446055*^9, 3.705386394172173*^9, 3.709990250496046*^9, 
   3.709990600623661*^9, {3.710048220351632*^9, 3.7100482284837847`*^9}, 
   3.710049708447452*^9, 3.710054337700239*^9, 3.710054545933804*^9, 
   3.710157005828615*^9, 3.713407408939728*^9, 3.714232079348612*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]WFexemple", "-", "\[Beta]WF"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.704518541723769*^9, 3.7045185466164417`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.704518548079015*^9, 3.705386395290873*^9, 
  3.70999025086061*^9, 3.70999060071074*^9, 3.710048229113312*^9, 
  3.710049708497816*^9, 3.710054337735457*^9, 3.7100545460946293`*^9, 
  3.7101570060424633`*^9, 3.713407408981235*^9, 3.7142320795117064`*^9}]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 3.7100472277111177`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations \[Gamma]", "Subsubsection",
 CellChangeTimes->{{3.704518466305232*^9, 3.704518471077755*^9}, {
  3.704518565295594*^9, 3.7045185659244537`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]WFexemple", "=", 
  RowBox[{
   RowBox[{"GetGamma", "[", 
    RowBox[{
    "sBfWF", ",", "DfWF", ",", "G12generic", ",", "GE12generic", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarWF", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.704518473149928*^9, 3.704518477106106*^9}, {
  3.704518525281973*^9, 3.704518525614408*^9}, {3.704518573841819*^9, 
  3.70451857849754*^9}, {3.7053863990730762`*^9, 3.705386401225338*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["dself", "2"], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["din", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "Qin"}], ")"}]}], "+", 
      RowBox[{"4", " ", "din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", "Qin"}], "+", 
         RowBox[{"9", " ", "dout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"9", " ", "dout", " ", 
       RowBox[{"(", 
        RowBox[{"dout", "+", 
         RowBox[{"2", " ", "dout", " ", "Qin"}], "+", 
         RowBox[{"6", " ", "dout", " ", "Qout"}], "+", 
         RowBox[{"2", " ", "dself", " ", "Qout"}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.704518529446055*^9, 3.704518586982461*^9, 
  3.70538640188498*^9, 3.709990252338045*^9, 3.709990600925812*^9, 
  3.7100482304906187`*^9, 3.7100497086671467`*^9, 3.71005433787577*^9, 
  3.710054546329961*^9, 3.7101570062810593`*^9, 3.713407409178536*^9, 
  3.714232079805571*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]WFexemple", "-", "\[Gamma]WF"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.704518541723769*^9, 3.7045185466164417`*^9}, {
  3.704518588888479*^9, 3.7045185931197243`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.7045185935188313`*^9, 3.705386404107149*^9, 
  3.709990253340064*^9, 3.70999060098426*^9, 3.710048230938107*^9, 
  3.7100497087072163`*^9, 3.710054337911253*^9, 3.710054546363802*^9, 
  3.710157006309971*^9, 3.713407409201877*^9, 3.714232079899316*^9}]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 3.7100472277111177`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Expected frequencies of altruists in the population", "Section",
 CellChangeTimes->{{3.699793899806631*^9, 3.699793901911666*^9}, {
  3.710048355732325*^9, 3.710048363875052*^9}}],

Cell[CellGroupData[{

Cell["Moran BD", "Subsection",
 CellChangeTimes->{{3.7100483656347847`*^9, 3.7100483687841043`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EXBD", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"p", "+", 
      RowBox[{"\[Delta]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Beta]BD", " ", "b"}], " ", "-", " ", 
         RowBox[{"\[Gamma]BD", " ", "c"}]}], ")"}]}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
       RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", "genericde"}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.699794103164796*^9, 3.699794182877057*^9}, {
   3.699847658278121*^9, 3.69984768206605*^9}, {3.6998478842384787`*^9, 
   3.69984789314879*^9}, 3.699847955062521*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", "\[Mu]",
        " ", 
       RowBox[{"(", 
        RowBox[{"m", "-", "n", "+", 
         RowBox[{"Idself", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
         RowBox[{"m", " ", "\[Mu]"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "c"}], " ", "Idself", " ", "m", " ", "n", " ", 
          "\[Delta]"}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "\[Delta]"}], "+", 
         RowBox[{"c", " ", "Idself", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "\[Delta]"}], "+", 
         RowBox[{"c", " ", "m", " ", 
          SuperscriptBox["n", "2"], " ", "\[Delta]"}], "+", 
         RowBox[{
         "c", " ", "Idself", " ", "m", " ", "n", " ", "p", " ", "\[Delta]"}], 
         "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "p", " ", "\[Delta]"}], 
         "-", 
         RowBox[{"c", " ", "Idself", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "p", " ", "\[Delta]"}], 
         "-", 
         RowBox[{"c", " ", "m", " ", 
          SuperscriptBox["n", "2"], " ", "p", " ", "\[Delta]"}], "+", 
         RowBox[{"Idself", " ", "\[Mu]"}], "-", 
         RowBox[{"Idself", " ", "m", " ", "\[Mu]"}], "-", 
         RowBox[{"n", " ", "\[Mu]"}], "+", 
         RowBox[{"2", " ", "m", " ", "n", " ", "\[Mu]"}], "-", 
         RowBox[{"m", " ", 
          SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
         RowBox[{
         "2", " ", "c", " ", "Idself", " ", "\[Delta]", " ", "\[Mu]"}], "-", 
         RowBox[{
         "2", " ", "c", " ", "Idself", " ", "m", " ", "\[Delta]", " ", 
          "\[Mu]"}], "-", 
         RowBox[{"2", " ", "c", " ", "n", " ", "\[Delta]", " ", "\[Mu]"}], 
         "-", 
         RowBox[{
         "c", " ", "Idself", " ", "n", " ", "\[Delta]", " ", "\[Mu]"}], "+", 
         RowBox[{
         "2", " ", "c", " ", "m", " ", "n", " ", "\[Delta]", " ", "\[Mu]"}], 
         "+", 
         RowBox[{
         "2", " ", "c", " ", "Idself", " ", "m", " ", "n", " ", "\[Delta]", 
          " ", "\[Mu]"}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "\[Delta]", " ", "\[Mu]"}],
          "-", 
         RowBox[{"c", " ", "Idself", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "\[Delta]", " ", "\[Mu]"}],
          "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["n", "2"], " ", "\[Delta]", " ", "\[Mu]"}], "-", 
         RowBox[{"2", " ", "c", " ", "m", " ", 
          SuperscriptBox["n", "2"], " ", "\[Delta]", " ", "\[Mu]"}], "-", 
         RowBox[{
         "2", " ", "c", " ", "Idself", " ", "p", " ", "\[Delta]", " ", 
          "\[Mu]"}], "+", 
         RowBox[{
         "2", " ", "c", " ", "Idself", " ", "m", " ", "p", " ", "\[Delta]", 
          " ", "\[Mu]"}], "+", 
         RowBox[{
         "2", " ", "c", " ", "n", " ", "p", " ", "\[Delta]", " ", "\[Mu]"}], 
         "+", 
         RowBox[{
         "c", " ", "Idself", " ", "n", " ", "p", " ", "\[Delta]", " ", 
          "\[Mu]"}], "-", 
         RowBox[{
         "2", " ", "c", " ", "m", " ", "n", " ", "p", " ", "\[Delta]", " ", 
          "\[Mu]"}], "-", 
         RowBox[{
         "2", " ", "c", " ", "Idself", " ", "m", " ", "n", " ", "p", " ", 
          "\[Delta]", " ", "\[Mu]"}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "p", " ", "\[Delta]", " ", 
          "\[Mu]"}], "+", 
         RowBox[{"c", " ", "Idself", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "p", " ", "\[Delta]", " ", 
          "\[Mu]"}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["n", "2"], " ", "p", " ", "\[Delta]", " ", "\[Mu]"}],
          "+", 
         RowBox[{"2", " ", "c", " ", "m", " ", 
          SuperscriptBox["n", "2"], " ", "p", " ", "\[Delta]", " ", "\[Mu]"}],
          "-", 
         RowBox[{"Idself", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"Idself", " ", "m", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"2", " ", "n", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"2", " ", "m", " ", "n", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["n", "2"], " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"m", " ", 
          SuperscriptBox["n", "2"], " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"c", " ", "Idself", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"c", " ", "Idself", " ", "m", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"2", " ", "c", " ", "n", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"2", " ", "c", " ", "m", " ", "n", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["n", "2"], " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"c", " ", "m", " ", 
          SuperscriptBox["n", "2"], " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"c", " ", "Idself", " ", "p", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"c", " ", "Idself", " ", "m", " ", "p", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"2", " ", "c", " ", "n", " ", "p", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{
         "2", " ", "c", " ", "m", " ", "n", " ", "p", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["n", "2"], " ", "p", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"c", " ", "m", " ", 
          SuperscriptBox["n", "2"], " ", "p", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "Ieself"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", "\[Mu]"}],
               ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", "\[Mu]"}],
               ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "n", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}], "+", 
            RowBox[{"Idself", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Ieself", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"m", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
                  "\[Mu]"}], ")"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}],
               ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["m", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"c", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]"}], "+", 
            
            RowBox[{"b", " ", 
             RowBox[{"(", 
              RowBox[{"\[Delta]", "-", 
               RowBox[{"p", " ", "\[Delta]"}]}], ")"}]}], "+", "\[Mu]"}], 
           ")"}]}], "+", 
         RowBox[{"\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"c", "+", 
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", "Ieself"}]}], 
                 ")"}]}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
             "\[Mu]"}], "+", 
            RowBox[{"n", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"3", " ", "c", " ", "\[Delta]"}], "-", 
               RowBox[{"3", " ", "c", " ", "p", " ", "\[Delta]"}], "-", 
               RowBox[{"2", " ", "\[Mu]"}], "-", 
               RowBox[{"2", " ", "c", " ", "\[Delta]", " ", "\[Mu]"}], "+", 
               RowBox[{
               "2", " ", "c", " ", "p", " ", "\[Delta]", " ", "\[Mu]"}], "-", 
               
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", "Ieself", "+", 
                  RowBox[{"g", " ", 
                   RowBox[{"(", 
                    RowBox[{"2", "+", 
                    RowBox[{"Ieself", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
                    "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
                  RowBox[{"Ieself", " ", "\[Mu]"}]}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["n", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"\[Mu]", "+", 
               RowBox[{"c", " ", "\[Delta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "p", "+", "\[Mu]", "-", 
                  RowBox[{"p", " ", "\[Mu]"}]}], ")"}]}]}], ")"}]}]}], 
           ")"}]}], "+", 
         RowBox[{"m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"n", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Delta]", "-", 
                  RowBox[{"p", " ", "\[Delta]"}]}], ")"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"c", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
                   "\[Delta]"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
             "\[Mu]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "c", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "-", "Ieself", "-", 
                  RowBox[{"2", " ", "\[Mu]"}], "+", 
                  RowBox[{"g", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "Ieself", "+", "\[Mu]"}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"Idself", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]"}], 
               "+", 
               RowBox[{"c", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Delta]", "-", 
                  RowBox[{"p", " ", "\[Delta]"}]}], ")"}]}], "-", "\[Mu]"}], 
              ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
            RowBox[{"\[Mu]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Mu]", "+", 
               RowBox[{"c", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", "n", "+", 
                  RowBox[{"2", " ", "\[Mu]"}]}], ")"}]}], "+", 
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
                RowBox[{"(", 
                 RowBox[{"3", "-", "Ieself", "-", 
                  RowBox[{"2", " ", "\[Mu]"}], "+", 
                  RowBox[{"g", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "Ieself", "+", "\[Mu]"}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
      RowBox[{"Idself", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
         RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
      "+", 
      RowBox[{"m", " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
        ")"}]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.699847950839044*^9, 3.699847957073048*^9}, 
   3.699850696950412*^9, 3.699853788663226*^9, 3.699955389774281*^9, 
   3.702201353655032*^9, 3.702218213982106*^9, 3.70228971785221*^9, 
   3.7041790172637997`*^9, 3.70451775497647*^9, 3.7053869313432703`*^9, 
   3.705387257551435*^9, 3.709990257453497*^9, 3.7099906025612917`*^9, 
   3.7100497104966097`*^9, 3.710054339658348*^9, 3.710054547929489*^9, 
   3.710157008043213*^9, 3.713407411466063*^9, 3.714232082429041*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moran DB", "Subsection",
 CellChangeTimes->{{3.710048383474581*^9, 3.7100483857029552`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EXDB", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"p", "+", 
      RowBox[{"\[Delta]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Beta]DB", " ", "b"}], " ", "-", " ", 
         RowBox[{"\[Gamma]DB", " ", "c"}]}], ")"}]}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
       RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", "genericde"}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.699794103164796*^9, 3.699794182877057*^9}, {
   3.699847658278121*^9, 3.69984768206605*^9}, {3.6998478842384787`*^9, 
   3.6998479101499863`*^9}, {3.6998479617010317`*^9, 3.699847962342051*^9}, 
   3.7100483811403723`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"n", "-", 
          RowBox[{"d", " ", "n"}]}], ")"}], "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["m", "2"]}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
         RowBox[{"Idself", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
            RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]", 
          " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
           ")"}]}], "-", 
         RowBox[{"m", " ", "n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
           ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
       SuperscriptBox["n", "3"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p"}], ")"}], " ", "\[Delta]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m", " ", "n", " ", 
             RowBox[{"(", 
              RowBox[{"2", "+", 
               RowBox[{"d", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"n", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
                  RowBox[{"2", " ", "\[Mu]"}]}], ")"}]}]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "n", " ", 
             "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["m", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", 
               RowBox[{"d", " ", "n"}], "+", "\[Mu]"}], ")"}]}], "-", 
            RowBox[{
             SuperscriptBox["Idself", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"m", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
                  "\[Mu]"}], ")"}]}], "+", "\[Mu]"}], ")"}]}], "+", 
            RowBox[{"Idself", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", " ", 
                SuperscriptBox["m", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]"}], "+", 
               
               RowBox[{"m", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "-", 
                  RowBox[{"2", " ", "d", " ", "\[Mu]"}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["m", "2"]}], "-", 
            RowBox[{"2", " ", "d", " ", 
             SuperscriptBox["m", "2"]}], "-", 
            RowBox[{"2", " ", "d", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "Ieself", " ", 
             SuperscriptBox["m", "2"]}], "+", 
            RowBox[{"2", " ", "d", " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"]}], "+", 
            RowBox[{"d", " ", "g", " ", 
             SuperscriptBox["m", "3"]}], "+", 
            RowBox[{"d", " ", "Ieself", " ", 
             SuperscriptBox["m", "3"]}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "Ieself", " ", 
             SuperscriptBox["m", "3"]}], "-", 
            RowBox[{"d", " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "3"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "3"]}], "-", 
            RowBox[{"2", " ", "m", " ", "n"}], "+", 
            RowBox[{"2", " ", "d", " ", "m", " ", "n"}], "+", 
            RowBox[{"2", " ", "d", " ", "Ieself", " ", "m", " ", "n"}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "Ieself", " ", "m", " ", "n"}], 
            "-", 
            RowBox[{
            "2", " ", "d", " ", "g", " ", "Ieself", " ", "m", " ", "n"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", "m", " ",
              "n"}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["m", "2"], " ", "n"}], "+", 
            RowBox[{"3", " ", "d", " ", 
             SuperscriptBox["m", "2"], " ", "n"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["m", "2"], " ", "n"}], "-", 
            RowBox[{"2", " ", "d", " ", "g", " ", 
             SuperscriptBox["m", "2"], " ", "n"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", 
             SuperscriptBox["m", "2"], " ", "n"}], "-", 
            RowBox[{"d", " ", 
             SuperscriptBox["m", "3"], " ", "n"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["m", "3"], " ", "n"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", 
             SuperscriptBox["m", "3"], " ", "n"}], "+", 
            RowBox[{"2", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "-", 
            RowBox[{"3", " ", "d", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{"d", " ", "g", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "-", 
            RowBox[{"d", " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{"d", " ", "g", " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{"d", " ", 
             SuperscriptBox["m", "2"], " ", 
             SuperscriptBox["n", "2"]}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["m", "2"], " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", 
             SuperscriptBox["m", "2"], " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{"2", " ", "g", " ", "m", " ", "\[Mu]"}], "-", 
            RowBox[{"2", " ", "d", " ", "g", " ", "m", " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", "Ieself", " ", "m", " ", "\[Mu]"}], "-", 
            RowBox[{"4", " ", "d", " ", "Ieself", " ", "m", " ", "\[Mu]"}], 
            "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "Ieself", " ", "m", " ", 
             "\[Mu]"}], "-", 
            RowBox[{"2", " ", "g", " ", "Ieself", " ", "m", " ", "\[Mu]"}], 
            "+", 
            RowBox[{
            "4", " ", "d", " ", "g", " ", "Ieself", " ", "m", " ", "\[Mu]"}], 
            "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", "m", " ",
              "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"d", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"g", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", "d", " ", "g", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"Ieself", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"4", " ", "d", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["d", "2"], " ", "Ieself", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"g", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"4", " ", "d", " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"3", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"d", " ", "g", " ", 
             SuperscriptBox["m", "3"], " ", "\[Mu]"}], "-", 
            RowBox[{"d", " ", "Ieself", " ", 
             SuperscriptBox["m", "3"], " ", "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "Ieself", " ", 
             SuperscriptBox["m", "3"], " ", "\[Mu]"}], "+", 
            RowBox[{"d", " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "3"], " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "3"], " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{"4", " ", "d", " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{"2", " ", "g", " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"4", " ", "d", " ", "g", " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "n", " ", "\[Mu]"}], 
            "-", 
            RowBox[{"2", " ", "Ieself", " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"4", " ", "d", " ", "Ieself", " ", "n", " ", "\[Mu]"}], 
            "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "Ieself", " ", "n", " ", 
             "\[Mu]"}], "+", 
            RowBox[{"2", " ", "g", " ", "Ieself", " ", "n", " ", "\[Mu]"}], 
            "-", 
            RowBox[{
            "4", " ", "d", " ", "g", " ", "Ieself", " ", "n", " ", "\[Mu]"}], 
            "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", "n", " ",
              "\[Mu]"}], "-", 
            RowBox[{"2", " ", "m", " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"6", " ", "d", " ", "m", " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["d", "2"], " ", "m", " ", "n", " ", "\[Mu]"}], 
            "-", 
            RowBox[{
            "4", " ", "d", " ", "g", " ", "m", " ", "n", " ", "\[Mu]"}], "+", 
            
            RowBox[{"4", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "m", " ", "n", " ", 
             "\[Mu]"}], "-", 
            RowBox[{
            "2", " ", "d", " ", "Ieself", " ", "m", " ", "n", " ", "\[Mu]"}], 
            "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "Ieself", " ", "m", " ", "n", " ",
              "\[Mu]"}], "+", 
            RowBox[{
            "2", " ", "d", " ", "g", " ", "Ieself", " ", "m", " ", "n", " ", 
             "\[Mu]"}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", "m", " ",
              "n", " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["m", "2"], " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{"5", " ", "d", " ", 
             SuperscriptBox["m", "2"], " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"3", " ", 
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["m", "2"], " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", "d", " ", "g", " ", 
             SuperscriptBox["m", "2"], " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", 
             SuperscriptBox["m", "2"], " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"d", " ", 
             SuperscriptBox["m", "3"], " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["m", "3"], " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", 
             SuperscriptBox["m", "3"], " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", "d", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"g", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"2", " ", "d", " ", "g", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"Ieself", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"2", " ", "d", " ", "Ieself", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "Ieself", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"g", " ", "Ieself", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", "d", " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"d", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"d", " ", "g", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"d", " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"d", " ", "g", " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", 
             SuperscriptBox["Idself", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "Ieself"}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"m", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
                  "\[Mu]"}], ")"}]}], "+", "\[Mu]"}], ")"}]}], "+", 
            RowBox[{"Idself", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", " ", 
                SuperscriptBox["m", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "-", 
                  RowBox[{"2", " ", "g", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Ieself"}], ")"}]}], "+", 
                  RowBox[{"2", " ", "Ieself"}], "+", 
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "Ieself"}], "-", "n"}], ")"}]}], "-", 
                  "n"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "Ieself"}], ")"}], " ", "\[Mu]"}], 
               "-", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "m", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "n", "+", 
                  RowBox[{"g", " ", "\[Mu]"}], "+", 
                  RowBox[{"Ieself", " ", "\[Mu]"}], "-", 
                  RowBox[{"g", " ", "Ieself", " ", "\[Mu]"}], "-", 
                  RowBox[{"n", " ", "\[Mu]"}], "-", 
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"Ieself", "+", 
                    RowBox[{"n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]",
                     "-", 
                    RowBox[{"2", " ", "Ieself", " ", "\[Mu]"}]}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
  "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"n", "-", 
       RowBox[{"d", " ", "n"}]}], ")"}], "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
      RowBox[{"Idself", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
         RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
      "-", 
      RowBox[{"m", " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
        ")"}]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.69984796692839*^9, 3.6998480003521223`*^9, 
  3.699850704564148*^9, 3.699853794552924*^9, 3.6999553946642847`*^9, 
  3.702201359294602*^9, 3.70228972401832*^9, 3.7041790259883947`*^9, 
  3.704517760316613*^9, 3.7053872631482477`*^9, 3.709990262320902*^9, 
  3.709990608073999*^9, 3.710049716465612*^9, 3.710054345134987*^9, 
  3.7100545532419252`*^9, 3.710157012991042*^9, 3.713407418498376*^9, 
  3.7142320899761143`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wright - Fisher", "Subsection",
 CellChangeTimes->{{3.7100483889694242`*^9, 3.7100483963311768`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EXWF", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"p", "+", 
      RowBox[{"\[Delta]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Beta]WF", " ", "b"}], " ", "-", " ", 
         RowBox[{"\[Gamma]WF", " ", "c"}]}], ")"}]}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Qin", "\[Rule]", "QinWF"}], ",", 
       RowBox[{"Qout", "\[Rule]", "QoutWF"}]}], "}"}]}], "/.", "genericde"}], 
   "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.699794103164796*^9, 3.699794182877057*^9}, {
  3.699847658278121*^9, 3.69984768206605*^9}, {3.6998478842384787`*^9, 
  3.6998479101499863`*^9}, {3.6998479656376753`*^9, 3.699847966301961*^9}}],

Cell[BoxData[
 RowBox[{"p", "+", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}], " ", "p", " ", "\[Delta]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{
              SuperscriptBox["Idself", "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"]}], 
             SuperscriptBox["n", "2"]], "+", 
            FractionBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"Idself", "-", "n"}], ")"}], "2"]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
              SuperscriptBox["n", "2"]}]], "+", 
            FractionBox[
             SuperscriptBox["m", "2"], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n"}]], "-", 
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "+", 
                RowBox[{"d", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2"}], "+", "m"}], ")"}]}]}], ")"}], " ", "m",
               " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["1", 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                FractionBox["1", 
                 RowBox[{
                  RowBox[{"2", " ", "\[Mu]"}], "-", 
                  SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                FractionBox[
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "d"}], 
                 RowBox[{"1", "-", 
                  FractionBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                FractionBox[
                 RowBox[{"d", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                 RowBox[{"1", "-", 
                  FractionBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                FractionBox["1", 
                 RowBox[{
                  RowBox[{"2", " ", "\[Mu]"}], "-", 
                  SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "Idself", " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
                  SuperscriptBox["Idself", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "n"}], "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "m", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "n"}], "+", 
                 RowBox[{
                  SuperscriptBox["m", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "n"}]}], 
                   ")"}]}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                 FractionBox["d", 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                 FractionBox[
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}], "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"Ieself", "-", 
           RowBox[{"g", " ", "Ieself"}]}], "n"], "+", 
         FractionBox[
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", 
               RowBox[{"1", "-", 
                FractionBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                  " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
             FractionBox["1", 
              RowBox[{
               RowBox[{"2", " ", "\[Mu]"}], "-", 
               SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"-", "1"}], "+", "d"}], 
            RowBox[{"1", "-", 
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
               " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
           FractionBox[
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
            RowBox[{"1", "-", 
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
           FractionBox["1", 
            RowBox[{
             RowBox[{"2", " ", "\[Mu]"}], "-", 
             SuperscriptBox["\[Mu]", "2"]}]]}]], "-", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Ieself", "-", "n"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                 " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
             FractionBox["d", 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
             FractionBox["1", 
              RowBox[{
               RowBox[{"2", " ", "\[Mu]"}], "-", 
               SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
          RowBox[{"n", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                 " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
             FractionBox[
              RowBox[{"d", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
             FractionBox["1", 
              RowBox[{
               RowBox[{"2", " ", "\[Mu]"}], "-", 
               SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]], "-", 
         RowBox[{
          FractionBox["1", 
           SuperscriptBox["n", "2"]], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Idself", "-", 
              RowBox[{"Idself", " ", "m"}]}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"Ieself", "-", 
               RowBox[{"g", " ", "Ieself"}]}], "n"], "+", 
             FractionBox[
              RowBox[{"g", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["1", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "1"}], "+", "d"}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                   " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
               FractionBox[
                RowBox[{"d", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
               FractionBox["1", 
                RowBox[{
                 RowBox[{"2", " ", "\[Mu]"}], "-", 
                 SuperscriptBox["\[Mu]", "2"]}]]}]], "-", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "g"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"Ieself", "-", "n"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                 FractionBox["d", 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
              RowBox[{"n", " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                 FractionBox[
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]]}], ")"}]}]}], 
         "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", "n"}]], 
          RowBox[{
           SuperscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "-", 
                 RowBox[{"3", " ", "d"}], "+", 
                 SuperscriptBox["d", "2"], "+", "g"}], ")"}], " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["1", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "1"}], "+", "d"}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                   " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
               FractionBox[
                RowBox[{"d", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
               FractionBox["1", 
                RowBox[{
                 RowBox[{"2", " ", "\[Mu]"}], "-", 
                 SuperscriptBox["\[Mu]", "2"]}]]}]], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d", "-", "g"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                FractionBox[
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                    FractionBox["d", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                  FractionBox[
                   RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                  FractionBox["1", 
                   RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}]]}], ")"}]}]}], 
            ")"}]}]}], "-", 
         RowBox[{
          FractionBox["1", "n"], 
          RowBox[{"2", " ", "Idself", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "m"}], ")"}], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "g"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["1", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "1"}], "+", "d"}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                   " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
               FractionBox[
                RowBox[{"d", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
               FractionBox["1", 
                RowBox[{
                 RowBox[{"2", " ", "\[Mu]"}], "-", 
                 SuperscriptBox["\[Mu]", "2"]}]]}]], "+", 
             RowBox[{
              FractionBox["1", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n"}]], 
              RowBox[{"g", " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "n", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                   FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                   FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}]], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                    FractionBox["d", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                   FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                   FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}]]}], ")"}]}]}]}], 
            ")"}]}]}], "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
            SuperscriptBox["n", "2"]}]], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Idself", "-", "n"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"Ieself", "-", 
               RowBox[{"g", " ", "Ieself"}]}], "n"], "+", 
             FractionBox[
              RowBox[{"g", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["1", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "1"}], "+", "d"}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                   " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
               FractionBox[
                RowBox[{"d", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
               FractionBox["1", 
                RowBox[{
                 RowBox[{"2", " ", "\[Mu]"}], "-", 
                 SuperscriptBox["\[Mu]", "2"]}]]}]], "+", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "g"}], ")"}], " ", "Ieself", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                 FractionBox["d", 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
              RowBox[{"n", " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                 FractionBox[
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "g"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"Ieself", "-", "n"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "n", "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"3", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", "n"}]}], 
                    ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                    FractionBox["d", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                   FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                   FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}]]}], ")"}]}], 
              RowBox[{"n", "-", 
               SuperscriptBox["n", "2"]}]]}], ")"}]}]}], "+", 
         RowBox[{
          FractionBox["1", "n"], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "m"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Idself", "-", "n"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["1", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}]], 
              RowBox[{"m", " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox["g", "n"], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d", "-", "g"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                   FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                   FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}]], "+", 
                 FractionBox[
                  RowBox[{"g", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                    FractionBox["d", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{"n", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                    FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]]}], ")"}]}]}], 
             "+", 
             RowBox[{
              FractionBox["1", "n"], 
              RowBox[{"Idself", " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", "m"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"Ieself", "-", "n"}], ")"}]}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]], "+", 
                 FractionBox[
                  RowBox[{"g", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                   FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                   FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}]], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "g"}], ")"}], " ", "Ieself", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                    FractionBox["d", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{"n", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                    FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "g"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"Ieself", "-", "n"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                    FractionBox["d", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"n", "-", 
                    SuperscriptBox["n", "2"]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                    FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]]}], 
                ")"}]}]}]}], ")"}]}]}]}], ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.6998479732848587`*^9, 3.699848060824608*^9, 
  3.6998507474099894`*^9, 3.6998538313784227`*^9, 3.699955425644464*^9, 
  3.7022013904600773`*^9, 3.702289763161767*^9, 3.7041790863427*^9, 
  3.704517794173602*^9, 3.705387298191299*^9, 3.709990299963561*^9, 
  3.709990640396688*^9, 3.710049751502159*^9, 3.710054379436544*^9, 
  3.710054587014152*^9, 3.7101570439856453`*^9, 3.713407464767517*^9, 
  3.714232142150387*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export to R", "Section",
 CellChangeTimes->{{3.710054285978345*^9, 3.710054288785317*^9}}],

Cell[CellGroupData[{

Cell["Export the EX formulas to R", "Subsubsection",
 CellChangeTimes->{{3.702201500553801*^9, 3.702201503237453*^9}, {
  3.710048406724223*^9, 3.710048409155136*^9}, {3.7100542275051394`*^9, 
  3.710054227856474*^9}}],

Cell["Rewrite the Greek letters", "Text",
 CellChangeTimes->{{3.702202576100587*^9, 3.702202585533182*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GreekTerms", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Delta]", "\[Rule]", "sel"}], ",", " ", 
    RowBox[{"\[Mu]", "\[Rule]", "mut"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.702201509383871*^9, 3.702201525212894*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Delta]", "\[Rule]", "sel"}], ",", 
   RowBox[{"\[Mu]", "\[Rule]", "mut"}]}], "}"}]], "Output",
 CellChangeTimes->{3.70220152616304*^9, 3.7022030131218777`*^9, 
  3.7022897635244837`*^9, 3.704179086467165*^9, 3.7045177944473457`*^9, 
  3.709990534196932*^9, 3.709990640508429*^9, 3.71004975160399*^9, 
  3.7100545872346973`*^9, 3.710157044181634*^9, 3.7134074649711103`*^9, 
  3.714232142419485*^9}]
}, Open  ]],

Cell["Common parts to all functions", "Text",
 CellChangeTimes->{{3.7022025881711607`*^9, 3.7022025922143908`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "FunctionPartB", "=", 
   "\"\< <- function(b, c, p, sel, mut, m, g, n, d, Idself, Ieself){\n## \
Arguments:\n#  b   benefit of interaction\n#  c   cost of interaction\n#  p   \
mutation bias\n#  sel intensity of selection\n#  mut mutation probability\n#  \
m   emigration probability\n#  g   proportion of interactions out of the \
group (interaction equivalent of m)\n#  n   deme size\n#  d   number of demes\
\n#  Idself whether reproduction in site where the parent is\n#  Ieself \
whether interactions with oneself\nreturn(\n\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FunctionPartE", "=", "\"\<)\n}\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.702201586590098*^9, 3.702201660652206*^9}, {
  3.702202515399782*^9, 3.70220251599327*^9}, {3.702202562602117*^9, 
  3.702202562914797*^9}, {3.702202598064639*^9, 3.702202697296604*^9}, {
  3.702202988690043*^9, 3.702203007885222*^9}}],

Cell["Function to translate Mathematica to R", "Text",
 CellChangeTimes->{{3.702202703211164*^9, 3.702202713861825*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToRForm", "[", "x_", "]"}], ":=", 
  RowBox[{"ToString", "[", 
   RowBox[{
    RowBox[{"x", "/.", "GreekTerms"}], "//", "CForm"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.702201842966589*^9, 3.702201859620515*^9}}],

Cell["Do it for all life cycles", "Text",
 CellChangeTimes->{{3.70220271595133*^9, 3.70220272896882*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RtxtBD", "=", 
   RowBox[{"\"\<pBD \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", "EXBD", "]"}], "<>", "FunctionPartE"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtDB", "=", 
   RowBox[{"\"\<pDB \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", "EXDB", "]"}], "<>", "FunctionPartE"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtWF", "=", 
   RowBox[{"\"\<pWF \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", "EXWF", "]"}], "<>", "FunctionPartE"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.702201679506662*^9, 3.702201723635545*^9}, {
  3.7022018328117237`*^9, 3.702201832929533*^9}, {3.702201871610055*^9, 
  3.702201903052576*^9}}],

Cell["Define Power function in R", "Text",
 CellChangeTimes->{{3.7022027318210173`*^9, 3.702202737612219*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PowerDef", "=", "\"\<Power <- function(a,b) return(a^b)\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.702201909153489*^9, 3.7022019359137297`*^9}, {
  3.7022019780679827`*^9, 3.702201985090732*^9}}],

Cell["Combine all texts", "Text",
 CellChangeTimes->{{3.702202739839615*^9, 3.702202745125101*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rtxt", "=", 
   RowBox[{
   "PowerDef", "<>", "\"\<\n\n\>\"", "<>", "RtxtBD", "<>", "\"\<\n\n\>\"", "<>",
     "RtxtDB", "<>", "\"\<\n\n\>\"", "<>", "RtxtWF"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7022019405139227`*^9, 3.702201966147601*^9}}],

Cell["Export to txt file (Mathematica did not want R)", "Text",
 CellChangeTimes->{{3.702202748144455*^9, 3.70220275825738*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"pathtosave", "<>", "\"\<Mathematica/analytics.txt\>\""}], ",", 
    "Rtxt"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.702201967861699*^9, 3.702202007961507*^9}, {
   3.702202094017145*^9, 3.7022021946253023`*^9}, {3.705388016090308*^9, 
   3.705388027352977*^9}, 3.705388096352022*^9}],

Cell["Convert the file extension to R", "Text",
 CellChangeTimes->{{3.702202760522964*^9, 3.702202776867174*^9}, {
  3.709990758298483*^9, 3.7099907595872707`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cmd", "=", 
   RowBox[{
   "\"\<mv\>\"", "<>", "\"\< \>\"", "<>", " ", "pathtosave", "<>", 
    "\"\<Mathematica/analytics.txt \>\"", "<>", "pathtosave", "<>", 
    "\"\<Mathematica/analytics.R\>\""}]}], ";"}]], "Input",
 CellChangeTimes->{{3.709991369942276*^9, 3.709991373128109*^9}, 
   3.7099914070907507`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"\"\<!\>\"", "<>", "cmd"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.709991066140975*^9, 3.709991076975725*^9}, 
   3.7099911333551807`*^9, {3.70999138465051*^9, 3.7099913991181173`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export to R the \[Beta] and \[Gamma] functions", "Subsubsection",
 CellChangeTimes->{{3.702201500553801*^9, 3.702201503237453*^9}, {
  3.704803404476313*^9, 3.7048034241860743`*^9}}],

Cell["Rewrite the Greek letters", "Text",
 CellChangeTimes->{{3.702202576100587*^9, 3.702202585533182*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GreekTerms", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Omega]", "\[Rule]", "sel"}], ",", " ", 
    RowBox[{"\[Mu]", "\[Rule]", "mut"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.702201509383871*^9, 3.702201525212894*^9}, {
  3.704724390807227*^9, 3.70472439943757*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Omega]", "\[Rule]", "sel"}], ",", 
   RowBox[{"\[Mu]", "\[Rule]", "mut"}]}], "}"}]], "Output",
 CellChangeTimes->{3.70220152616304*^9, 3.7022030131218777`*^9, 
  3.7022897635244837`*^9, 3.704179086467165*^9, 3.7045177944473457`*^9, 
  3.704724393799959*^9, 3.7047246634923162`*^9, 3.704736510164259*^9, 
  3.704803775109002*^9, 3.7100545877607107`*^9, 3.7101570448356543`*^9, 
  3.7134074650996113`*^9, 3.714232143030241*^9}]
}, Open  ]],

Cell["Common parts to all functions", "Text",
 CellChangeTimes->{{3.7022025881711607`*^9, 3.7022025922143908`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "FunctionPartB", "=", 
   "\"\< <- function(p, sel, mut, m, g, n, d, Idself, Ieself){\n## Arguments:\
\n#  p   mutation bias\n#  sel intensity of selection\n#  mut mutation \
probability\n#  m   emigration probability\n#  g   proportion of interactions \
out of the group (interaction equivalent of m)\n#  n   deme size\n#  d   \
number of demes\n#  Idself whether reproduction in site where the parent is\n\
#  Ieself whether interactions with oneself\nreturn(\n\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FunctionPartE", "=", "\"\<)\n}\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.702201586590098*^9, 3.702201660652206*^9}, {
  3.702202515399782*^9, 3.70220251599327*^9}, {3.702202562602117*^9, 
  3.702202562914797*^9}, {3.702202598064639*^9, 3.702202697296604*^9}, {
  3.702202988690043*^9, 3.702203007885222*^9}, {3.704724417045898*^9, 
  3.7047244695037813`*^9}}],

Cell["Function to translate Mathematica to R", "Text",
 CellChangeTimes->{{3.702202703211164*^9, 3.702202713861825*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToRForm", "[", "x_", "]"}], ":=", 
  RowBox[{"ToString", "[", 
   RowBox[{
    RowBox[{"x", "/.", "GreekTerms"}], "//", "CForm"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.702201842966589*^9, 3.702201859620515*^9}}],

Cell["Do it for \[Beta] and \[Gamma]", "Text",
 CellChangeTimes->{{3.704724511134218*^9, 3.704724513442933*^9}, {
  3.704803452274454*^9, 3.704803455115556*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RtxtbBDD", "=", 
   RowBox[{"\"\<bBDD \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]BDD", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
    "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtbBDI", "=", 
   RowBox[{"\"\<bBDI \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]BDI", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
    "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtcBDD", "=", 
   RowBox[{"\"\<cBDD \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Gamma]BDD", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
    "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtcBDI", "=", 
   RowBox[{"\"\<cBDI \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Gamma]BDI", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
    "FunctionPartE"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.704724517750942*^9, 3.704724604063252*^9}, {
   3.704803463935075*^9, 3.704803684371352*^9}, 3.704803938490445*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"RtxtbDBD", "=", 
     RowBox[{"\"\<bDBD \>\"", "<>", "FunctionPartB", "<>", 
      RowBox[{"ToRForm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Beta]DBD", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
            RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
         "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
      "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RtxtbDBI", "=", 
     RowBox[{"\"\<bDBI \>\"", "<>", "FunctionPartB", "<>", 
      RowBox[{"ToRForm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Beta]DBI", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
            RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
         "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
      "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RtxtcDBD", "=", 
     RowBox[{"\"\<cDBD \>\"", "<>", "FunctionPartB", "<>", 
      RowBox[{"ToRForm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Gamma]DBD", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
            RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
         "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
      "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RtxtcDBI", "=", 
     RowBox[{"\"\<cDBI \>\"", "<>", "FunctionPartB", "<>", 
      RowBox[{"ToRForm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Gamma]DBI", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
            RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
         "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
      "FunctionPartE"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.704724517750942*^9, 3.704724604063252*^9}, {
  3.704803463935075*^9, 3.704803684371352*^9}, {3.704803938490445*^9, 
  3.7048039400125237`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RtxtbWFD", "=", 
   RowBox[{"\"\<bWFD \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]WFD", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinWF"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutWF"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "Simplify"}], "]"}], "<>", "FunctionPartE"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtbWFI", "=", 
   RowBox[{"\"\<bWFI \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]WFI", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinWF"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutWF"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "Simplify"}], "]"}], "<>", "FunctionPartE"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtcWFD", "=", 
   RowBox[{"\"\<cWFD \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Gamma]WFD", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinWF"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutWF"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "Simplify"}], "]"}], "<>", "FunctionPartE"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.704724517750942*^9, 3.704724604063252*^9}, {
   3.704803463935075*^9, 3.704803684371352*^9}, {3.704803938490445*^9, 
   3.7048039400125237`*^9}, 3.7048042118459272`*^9, {3.704804392342845*^9, 
   3.70480439722366*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RtxtcWFI", "=", 
    RowBox[{"\"\<cWFI \>\"", "<>", "FunctionPartB", "<>", 
     RowBox[{"ToRForm", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Gamma]WFI", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Qin", "\[Rule]", "QinWF"}], ",", 
           RowBox[{"Qout", "\[Rule]", "QoutWF"}]}], "}"}]}], "/.", 
        "genericde"}], "//", "Simplify"}], "]"}], "<>", "FunctionPartE"}]}], 
   ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.704724517750942*^9, 3.704724604063252*^9}, {
   3.704803463935075*^9, 3.704803684371352*^9}, {3.704803938490445*^9, 
   3.7048039400125237`*^9}, 3.7048042118459272`*^9, 3.7048043981410503`*^9}],

Cell["Define Power function in R", "Text",
 CellChangeTimes->{{3.7022027318210173`*^9, 3.702202737612219*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PowerDef", "=", "\"\<Power <- function(a,b) return(a^b)\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.702201909153489*^9, 3.7022019359137297`*^9}, {
  3.7022019780679827`*^9, 3.702201985090732*^9}}],

Cell["Combine all texts", "Text",
 CellChangeTimes->{{3.702202739839615*^9, 3.702202745125101*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rtxt", "=", 
   RowBox[{
   "PowerDef", "<>", "\"\<\n\n\>\"", "<>", "RtxtbBDD", "<>", "\"\<\n\n\>\"", "<>",
     "RtxtbBDI", "<>", "\"\<\n\n\>\"", "<>", "RtxtcBDD", "<>", "\"\<\n\n\>\"",
     "<>", "RtxtcBDI", "<>", "\"\<\n\n\>\"", "<>", "RtxtbDBD", "<>", 
    "\"\<\n\n\>\"", "<>", "RtxtbDBI", "<>", "\"\<\n\n\>\"", "<>", "RtxtcDBD", 
    "<>", "\"\<\n\n\>\"", "<>", "RtxtcDBI", "<>", "\"\<\n\n\>\"", "<>", 
    "RtxtbWFD", "<>", "\"\<\n\n\>\"", "<>", "RtxtbWFI", "<>", "\"\<\n\n\>\"", 
    "<>", "RtxtcWFD", "<>", "\"\<\n\n\>\"", "<>", "RtxtcWFI"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7022019405139227`*^9, 3.702201966147601*^9}, {
  3.7047246131819277`*^9, 3.704724637059588*^9}, {3.704803694719769*^9, 
  3.704803749843987*^9}}],

Cell["Export to txt file (Mathematica did not want R)", "Text",
 CellChangeTimes->{{3.702202748144455*^9, 3.70220275825738*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"pathtosave", "<>", "\"\<Mathematica/analyticsBC.txt\>\""}], ",", 
    "Rtxt"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.702201967861699*^9, 3.702202007961507*^9}, {
   3.702202094017145*^9, 3.7022021946253023`*^9}, 3.7047246446676083`*^9, {
   3.7048037577002163`*^9, 3.704803757783225*^9}, {3.710054369552413*^9, 
   3.7100543764643507`*^9}, 3.710054449473357*^9}],

Cell["Convert the file extension to R", "Text",
 CellChangeTimes->{{3.702202760522964*^9, 3.702202776867174*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cmd", "=", 
  RowBox[{
  "\"\<mv \>\"", "<>", "pathtosave", "<>", 
   "\"\<Mathematica/analyticsBC.txt \>\"", "<>", "pathtosave", "<>", 
   "\"\<Mathematica/analyticsBC.R\>\""}]}]], "Input",
 CellChangeTimes->{{3.710054379829246*^9, 3.7100544084086437`*^9}}],

Cell[BoxData["\<\"mv \
~/Documents/Work/Projects/2016_SocEvolSubdivPop/Programs/Mathematica/\
analyticsBC.txt \
~/Documents/Work/Projects/2016_SocEvolSubdivPop/Programs/Mathematica/\
analyticsBC.R\"\>"], "Output",
 CellChangeTimes->{3.710054642095193*^9, 3.710157118088244*^9, 
  3.713407557544063*^9, 3.714232270946007*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"\"\<!\>\"", "<>", "cmd"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7022022612757597`*^9, 3.702202281727586*^9}, {
  3.7047246545885*^9, 3.7047246565359173`*^9}, {3.7048037640761023`*^9, 
  3.704803767929439*^9}, {3.710054411496415*^9, 3.7100544300801153`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1062, 1028},
WindowMargins->{{7, Automatic}, {0, Automatic}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 352, 8, 56, "Text"],
Cell[913, 30, 2025, 35, 539, "Text"],
Cell[2941, 67, 1408, 27, 228, "Text"],
Cell[4352, 96, 174, 2, 33, "Text"],
Cell[4529, 100, 224, 6, 32, "Input"],
Cell[4756, 108, 232, 5, 33, "Text"],
Cell[4991, 115, 318, 8, 34, "Input"],
Cell[CellGroupData[{
Cell[5334, 127, 215, 3, 93, "Title"],
Cell[CellGroupData[{
Cell[5574, 134, 149, 2, 65, "Section"],
Cell[5726, 138, 240, 5, 33, "Text"],
Cell[5969, 145, 361, 12, 61, "Input"],
Cell[6333, 159, 96, 1, 33, "Text"],
Cell[6432, 162, 178, 5, 34, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6647, 172, 373, 5, 65, "Section"],
Cell[CellGroupData[{
Cell[7045, 181, 120, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[7190, 186, 235, 3, 35, "Subsubsection"],
Cell[7428, 191, 169, 2, 33, "Text"],
Cell[7600, 195, 1802, 35, 289, "Input"],
Cell[9405, 232, 165, 2, 33, "Text"],
Cell[9573, 236, 1043, 24, 192, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10653, 265, 231, 3, 35, "Subsubsection"],
Cell[10887, 270, 796, 20, 57, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11720, 295, 162, 2, 35, "Subsubsection"],
Cell[11885, 299, 252, 5, 33, "Text"],
Cell[12140, 306, 993, 31, 96, "Input"],
Cell[13136, 339, 203, 4, 33, "Text"],
Cell[13342, 345, 709, 21, 96, "Input"],
Cell[14054, 368, 181, 4, 33, "Text"],
Cell[14238, 374, 955, 30, 96, "Input"],
Cell[15196, 406, 254, 5, 33, "Text"],
Cell[15453, 413, 1535, 48, 104, "Input"],
Cell[16991, 463, 93, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[17109, 468, 693, 23, 55, "Input"],
Cell[17805, 493, 386, 6, 32, "Output"],
Cell[18194, 501, 385, 6, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18640, 514, 133, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[18798, 519, 213, 4, 35, "Subsubsection"],
Cell[19014, 525, 90, 1, 33, "Text"],
Cell[19107, 528, 1463, 29, 228, "Input"],
Cell[20573, 559, 90, 1, 33, "Text"],
Cell[20666, 562, 995, 23, 192, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21734, 593, 256, 3, 93, "Title"],
Cell[CellGroupData[{
Cell[22015, 600, 90, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[22130, 605, 162, 2, 45, "Subsection"],
Cell[22295, 609, 384, 7, 55, "Text"],
Cell[22682, 618, 1446, 45, 74, "Input"],
Cell[24131, 665, 2563, 85, 145, "Input"],
Cell[26697, 752, 115, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[26837, 757, 385, 10, 34, "Input"],
Cell[27225, 769, 2143, 58, 53, "Output"]
}, Open  ]],
Cell[29383, 830, 133, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[29541, 835, 474, 12, 55, "Input"],
Cell[30018, 849, 2252, 62, 53, "Output"],
Cell[32273, 913, 2016, 54, 53, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34338, 973, 107, 1, 45, "Subsection"],
Cell[34448, 976, 291, 5, 55, "Text"],
Cell[34742, 983, 5812, 150, 566, "Input"],
Cell[40557, 1135, 345, 6, 55, "Text"],
Cell[40905, 1143, 2169, 55, 194, "Input"],
Cell[43077, 1200, 117, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[43219, 1205, 831, 21, 57, "Input"],
Cell[CellGroupData[{
Cell[44075, 1230, 1054, 23, 59, "Print"],
Cell[45132, 1255, 1053, 23, 59, "Print"]
}, Open  ]]
}, Open  ]],
Cell[46212, 1282, 119, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[46356, 1287, 831, 21, 57, "Input"],
Cell[CellGroupData[{
Cell[47212, 1312, 1028, 23, 59, "Print"],
Cell[48243, 1337, 1029, 23, 59, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[49333, 1367, 105, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[49463, 1372, 282, 3, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[49770, 1379, 395, 10, 55, "Input"],
Cell[50168, 1391, 1779, 49, 53, "Output"],
Cell[51950, 1442, 1494, 40, 52, "Output"]
}, Open  ]],
Cell[53459, 1485, 307, 6, 33, "Text"],
Cell[CellGroupData[{
Cell[53791, 1495, 1090, 34, 32, "Input"],
Cell[54884, 1531, 766, 11, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55687, 1547, 859, 27, 32, "Input"],
Cell[56549, 1576, 710, 10, 32, "Output"]
}, Open  ]],
Cell[57274, 1589, 151, 2, 33, "Text"],
Cell[57428, 1593, 188, 5, 77, "Text"],
Cell[CellGroupData[{
Cell[57641, 1602, 547, 15, 57, "Input"],
Cell[58191, 1619, 762, 11, 32, "Output"],
Cell[58956, 1632, 762, 11, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59755, 1648, 427, 10, 56, "Input"],
Cell[60185, 1660, 729, 19, 52, "Output"],
Cell[60917, 1681, 500, 12, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61454, 1698, 423, 10, 57, "Input"],
Cell[61880, 1710, 794, 11, 32, "Output"],
Cell[62677, 1723, 792, 11, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63506, 1739, 217, 5, 34, "Input"],
Cell[63726, 1746, 1072, 22, 34, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[64847, 1774, 238, 3, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[65110, 1781, 392, 10, 55, "Input"],
Cell[65505, 1793, 2039, 60, 60, "Output"],
Cell[67547, 1855, 1780, 51, 52, "Output"]
}, Open  ]],
Cell[69342, 1909, 117, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[69484, 1914, 1550, 47, 64, "Input"],
Cell[71037, 1963, 763, 11, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71837, 1979, 1269, 40, 64, "Input"],
Cell[73109, 2021, 736, 10, 32, "Output"]
}, Open  ]],
Cell[73860, 2034, 96, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[73981, 2039, 438, 12, 57, "Input"],
Cell[74422, 2053, 1192, 27, 52, "Output"],
Cell[75617, 2082, 901, 17, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76555, 2104, 366, 8, 57, "Input"],
Cell[76924, 2114, 695, 10, 32, "Output"],
Cell[77622, 2126, 697, 10, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[78392, 2144, 100, 1, 65, "Section"],
Cell[78495, 2147, 194, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[78714, 2155, 113, 1, 45, "Subsection"],
Cell[78830, 2158, 243, 4, 55, "Text"],
Cell[79076, 2164, 3202, 105, 222, "Input"],
Cell[82281, 2271, 113, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[82419, 2276, 367, 9, 34, "Input"],
Cell[82789, 2287, 1791, 49, 76, "Output"]
}, Open  ]],
Cell[84595, 2339, 116, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[84736, 2344, 464, 12, 55, "Input"],
Cell[85203, 2358, 2850, 88, 104, "Output"],
Cell[88056, 2448, 2525, 76, 104, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[90630, 2530, 107, 1, 45, "Subsection"],
Cell[90740, 2533, 5649, 146, 574, "Input"],
Cell[96392, 2681, 2139, 56, 194, "Input"],
Cell[CellGroupData[{
Cell[98556, 2741, 1411, 39, 103, "Input"],
Cell[CellGroupData[{
Cell[99992, 2784, 1121, 24, 59, "Print"],
Cell[101116, 2810, 1119, 24, 59, "Print"],
Cell[102238, 2836, 1116, 24, 59, "Print"],
Cell[103357, 2862, 1119, 24, 59, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[104537, 2893, 105, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[104667, 2898, 112, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[104804, 2903, 234, 6, 32, "Input"],
Cell[105041, 2911, 2283, 68, 103, "Output"]
}, Open  ]],
Cell[107339, 2982, 112, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[107476, 2987, 1379, 47, 215, "Input"],
Cell[108858, 3036, 263, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109158, 3045, 233, 6, 32, "Input"],
Cell[109394, 3053, 2198, 65, 103, "Output"]
}, Open  ]],
Cell[111607, 3121, 114, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[111746, 3126, 548, 17, 93, "Input"],
Cell[112297, 3145, 284, 4, 32, "Output"]
}, Open  ]],
Cell[112596, 3152, 95, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[112716, 3157, 308, 7, 57, "Input"],
Cell[113027, 3166, 353, 5, 32, "Output"],
Cell[113383, 3173, 353, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113773, 3183, 411, 11, 79, "Input"],
Cell[114187, 3196, 1404, 43, 57, "Output"],
Cell[115594, 3241, 759, 20, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116390, 3266, 233, 6, 34, "Input"],
Cell[116626, 3274, 385, 5, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[117060, 3285, 130, 1, 35, "Subsubsection"],
Cell[117193, 3288, 180, 2, 33, "Text"],
Cell[117376, 3292, 601, 17, 80, "Input"],
Cell[117980, 3311, 192, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[118197, 3319, 732, 19, 56, "Input"],
Cell[118932, 3340, 2059, 67, 71, "Output"]
}, Open  ]],
Cell[121006, 3410, 140, 2, 33, "Text"],
Cell[CellGroupData[{
Cell[121171, 3416, 295, 7, 57, "Input"],
Cell[121469, 3425, 4047, 124, 119, "Output"]
}, Open  ]],
Cell[125531, 3552, 107, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[125663, 3557, 318, 9, 34, "Input"],
Cell[125984, 3568, 6133, 184, 244, "Output"]
}, Open  ]],
Cell[132132, 3755, 172, 4, 34, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132341, 3764, 168, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[132534, 3770, 276, 6, 32, "Input"],
Cell[132813, 3778, 3170, 99, 104, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136020, 3882, 279, 6, 32, "Input"],
Cell[136302, 3890, 2681, 82, 104, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[139056, 3980, 161, 2, 65, "Section"],
Cell[139220, 3984, 107, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[139352, 3989, 301, 7, 34, "Input"],
Cell[139656, 3998, 520, 10, 34, "Output"]
}, Open  ]],
Cell[140191, 4011, 115, 1, 33, "Text"],
Cell[140309, 4014, 930, 17, 344, "Input"],
Cell[141242, 4033, 120, 1, 33, "Text"],
Cell[141365, 4036, 250, 6, 34, "Input"],
Cell[141618, 4044, 93, 1, 33, "Text"],
Cell[141714, 4047, 1183, 29, 103, "Input"],
Cell[142900, 4078, 110, 1, 33, "Text"],
Cell[143013, 4081, 237, 5, 34, "Input"],
Cell[143253, 4088, 99, 1, 33, "Text"],
Cell[143355, 4091, 388, 8, 210, "Input"],
Cell[143746, 4101, 128, 1, 33, "Text"],
Cell[143877, 4104, 393, 8, 34, "Input"],
Cell[144273, 4114, 113, 1, 33, "Text"],
Cell[144389, 4117, 302, 7, 34, "Input"],
Cell[144694, 4126, 206, 4, 32, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[144949, 4136, 154, 3, 150, "Title"],
Cell[CellGroupData[{
Cell[145128, 4143, 100, 1, 65, "Section"],
Cell[145231, 4146, 110, 1, 33, "Text"],
Cell[145344, 4149, 616, 17, 34, "Input"],
Cell[145963, 4168, 176, 2, 33, "Text"],
Cell[146142, 4172, 253, 6, 34, "Input"],
Cell[CellGroupData[{
Cell[146420, 4182, 100, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[146545, 4187, 671, 20, 105, "Input"],
Cell[147219, 4209, 981, 31, 53, "Output"],
Cell[148203, 4242, 2321, 73, 65, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[150573, 4321, 100, 1, 44, "Subsection"],
Cell[150676, 4324, 435, 11, 34, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[151160, 4341, 137, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[151322, 4346, 101, 1, 44, "Subsection"],
Cell[151426, 4349, 276, 7, 56, "Text"],
Cell[151705, 4358, 248, 8, 34, "Input"],
Cell[151956, 4368, 121, 1, 33, "Text"],
Cell[152080, 4371, 630, 21, 77, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152747, 4397, 192, 4, 45, "Subsection"],
Cell[CellGroupData[{
Cell[152964, 4405, 159, 2, 35, "Subsubsection"],
Cell[153126, 4409, 1157, 40, 114, "Input"],
Cell[154286, 4451, 113, 1, 33, "Text"],
Cell[154402, 4454, 1103, 34, 80, "Input"],
Cell[155508, 4490, 798, 24, 98, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[156343, 4519, 112, 1, 35, "Subsubsection"],
Cell[156458, 4522, 1428, 50, 110, "Input"],
Cell[157889, 4574, 97, 1, 33, "Text"],
Cell[157989, 4577, 1519, 48, 145, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159545, 4630, 106, 1, 35, "Subsubsection"],
Cell[159654, 4633, 1000, 35, 114, "Input"],
Cell[160657, 4670, 97, 1, 33, "Text"],
Cell[160757, 4673, 1962, 55, 181, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[162780, 4735, 203, 3, 65, "Section"],
Cell[CellGroupData[{
Cell[163008, 4742, 214, 3, 44, "Subsection"],
Cell[CellGroupData[{
Cell[163247, 4749, 303, 7, 34, "Input"],
Cell[163553, 4758, 1617, 54, 78, "Output"]
}, Open  ]],
Cell[165185, 4815, 257, 9, 42, "Text"],
Cell[CellGroupData[{
Cell[165467, 4828, 205, 5, 34, "Input"],
Cell[165675, 4835, 145, 2, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[165869, 4843, 106, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[166000, 4848, 217, 3, 35, "Subsubsection"],
Cell[166220, 4853, 119, 1, 33, "Text"],
Cell[166342, 4856, 263, 8, 53, "Input"],
Cell[166608, 4866, 182, 2, 33, "Text"],
Cell[CellGroupData[{
Cell[166815, 4872, 223, 5, 34, "Input"],
Cell[167041, 4879, 165, 3, 49, "Output"]
}, Open  ]],
Cell[167221, 4885, 125, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[167371, 4890, 178, 4, 32, "Input"],
Cell[167552, 4896, 232, 6, 50, "Output"]
}, Open  ]],
Cell[167799, 4905, 125, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[167949, 4910, 274, 7, 54, "Input"],
Cell[168226, 4919, 305, 7, 49, "Output"]
}, Open  ]],
Cell[168546, 4929, 265, 5, 55, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[168848, 4939, 171, 2, 35, "Subsubsection"],
Cell[169022, 4943, 115, 1, 33, "Text"],
Cell[169140, 4946, 550, 18, 61, "Input"],
Cell[169693, 4966, 195, 5, 55, "Text"],
Cell[CellGroupData[{
Cell[169913, 4975, 205, 5, 34, "Input"],
Cell[170121, 4982, 536, 17, 53, "Output"]
}, Open  ]],
Cell[170672, 5002, 129, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[170826, 5007, 184, 4, 34, "Input"],
Cell[171013, 5013, 263, 8, 50, "Output"]
}, Open  ]],
Cell[171291, 5024, 308, 6, 77, "Text"],
Cell[CellGroupData[{
Cell[171624, 5034, 175, 4, 34, "Input"],
Cell[171802, 5040, 362, 11, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[172201, 5056, 175, 4, 32, "Input"],
Cell[172379, 5062, 215, 5, 49, "Output"]
}, Open  ]],
Cell[172609, 5070, 168, 3, 33, "Text"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[172838, 5080, 101, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[172964, 5085, 103, 1, 44, "Subsection"],
Cell[173070, 5088, 114, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[173209, 5093, 275, 6, 34, "Input"],
Cell[173487, 5101, 1643, 53, 57, "Output"]
}, Open  ]],
Cell[175145, 5157, 126, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[175296, 5162, 213, 6, 34, "Input"],
Cell[175512, 5170, 109, 2, 32, "Output"]
}, Open  ]],
Cell[175636, 5175, 186, 2, 33, "Text"],
Cell[CellGroupData[{
Cell[175847, 5181, 314, 8, 34, "Input"],
Cell[176164, 5191, 1385, 41, 78, "Output"]
}, Open  ]],
Cell[177564, 5235, 116, 1, 33, "Text"],
Cell[177683, 5238, 436, 10, 34, "Input"],
Cell[178122, 5250, 107, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[178254, 5255, 149, 3, 32, "Input"],
Cell[178406, 5260, 143, 2, 32, "Output"]
}, Open  ]],
Cell[178564, 5265, 204, 4, 33, "Text"],
Cell[178771, 5271, 154, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[178950, 5278, 178, 4, 34, "Input"],
Cell[179131, 5284, 745, 23, 82, "Output"]
}, Open  ]],
Cell[179891, 5310, 121, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[180037, 5315, 512, 14, 57, "Input"],
Cell[180552, 5331, 175, 5, 59, "Output"],
Cell[180730, 5338, 112, 1, 32, "Output"]
}, Open  ]],
Cell[180857, 5342, 1245, 35, 165, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182139, 5382, 102, 1, 44, "Subsection"],
Cell[182244, 5385, 112, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[182381, 5390, 213, 5, 34, "Input"],
Cell[182597, 5397, 4304, 130, 92, "Output"]
}, Open  ]],
Cell[186916, 5530, 119, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[187060, 5535, 313, 8, 34, "Input"],
Cell[187376, 5545, 5651, 159, 270, "Output"]
}, Open  ]],
Cell[193042, 5707, 125, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[193192, 5712, 214, 5, 32, "Input"],
Cell[193409, 5719, 2658, 79, 146, "Output"]
}, Open  ]],
Cell[196082, 5801, 275, 6, 55, "Text"],
Cell[CellGroupData[{
Cell[196382, 5811, 207, 5, 32, "Input"],
Cell[196592, 5818, 952, 33, 53, "Output"]
}, Open  ]],
Cell[197559, 5854, 113, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[197697, 5859, 211, 5, 34, "Input"],
Cell[197911, 5866, 1945, 61, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[199893, 5932, 375, 11, 57, "Input"],
Cell[200271, 5945, 527, 14, 32, "Output"],
Cell[200801, 5961, 630, 19, 53, "Output"]
}, Open  ]],
Cell[201446, 5983, 3555, 102, 342, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[205038, 6090, 103, 1, 45, "Subsection"],
Cell[205144, 6093, 110, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[205279, 6098, 213, 5, 34, "Input"],
Cell[205495, 6105, 2667, 89, 92, "Output"]
}, Open  ]],
Cell[208177, 6197, 154, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[208356, 6204, 215, 6, 34, "Input"],
Cell[208574, 6212, 266, 8, 50, "Output"]
}, Open  ]],
Cell[208855, 6223, 190, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[209070, 6231, 207, 5, 32, "Input"],
Cell[209280, 6238, 889, 30, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210206, 6273, 214, 5, 34, "Input"],
Cell[210423, 6280, 203, 6, 59, "Output"]
}, Open  ]],
Cell[210641, 6289, 380, 10, 97, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[211070, 6305, 145, 1, 65, "Section"],
Cell[211218, 6308, 116, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[211359, 6313, 172, 4, 53, "Input"],
Cell[211534, 6319, 1528, 52, 63, "Output"]
}, Open  ]],
Cell[213077, 6374, 204, 5, 55, "Text"],
Cell[CellGroupData[{
Cell[213306, 6383, 327, 9, 57, "Input"],
Cell[213636, 6394, 293, 9, 52, "Output"],
Cell[213932, 6405, 122, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214091, 6412, 211, 5, 34, "Input"],
Cell[214305, 6419, 93, 1, 32, "Output"]
}, Open  ]],
Cell[214413, 6423, 105, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[214543, 6428, 258, 7, 34, "Input"],
Cell[214804, 6437, 121, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214962, 6444, 263, 7, 34, "Input"],
Cell[215228, 6453, 496, 17, 53, "Output"]
}, Open  ]],
Cell[215739, 6473, 120, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[215884, 6478, 388, 11, 34, "Input"],
Cell[216275, 6491, 3803, 118, 179, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[220139, 6616, 229, 3, 150, "Title"],
Cell[220371, 6621, 625, 11, 121, "Text"],
Cell[CellGroupData[{
Cell[221021, 6636, 172, 2, 65, "Section"],
Cell[221196, 6640, 748, 13, 121, "Text"],
Cell[CellGroupData[{
Cell[221969, 6657, 157, 2, 44, "Subsection"],
Cell[CellGroupData[{
Cell[222151, 6663, 98, 1, 36, "Subsubsection"],
Cell[222252, 6666, 564, 17, 34, "Input"],
Cell[222819, 6685, 2446, 76, 116, "Input"],
Cell[CellGroupData[{
Cell[225290, 6765, 219, 6, 55, "Input"],
Cell[225512, 6773, 710, 13, 51, "Output"]
}, Open  ]],
Cell[226237, 6789, 236, 6, 34, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[226510, 6800, 99, 1, 36, "Subsubsection"],
Cell[226612, 6803, 171, 4, 34, "Input"],
Cell[226786, 6809, 740, 24, 50, "Input"],
Cell[CellGroupData[{
Cell[227551, 6837, 260, 7, 32, "Input"],
Cell[227814, 6846, 1478, 38, 52, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[229353, 6891, 108, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[229486, 6896, 99, 1, 36, "Subsubsection"],
Cell[CellGroupData[{
Cell[229610, 6901, 133, 2, 32, "Input"],
Cell[229746, 6905, 934, 22, 32, "Output"]
}, Open  ]],
Cell[230695, 6930, 18085, 498, 1332, "Input"],
Cell[CellGroupData[{
Cell[248805, 7432, 129, 2, 32, "Input"],
Cell[248937, 7436, 673, 12, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[249647, 7453, 312, 8, 32, "Input"],
Cell[249962, 7463, 6384, 188, 190, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[256395, 7657, 149, 2, 36, "Subsubsection"],
Cell[CellGroupData[{
Cell[256569, 7663, 135, 2, 32, "Input"],
Cell[256707, 7667, 569, 9, 32, "Output"]
}, Open  ]],
Cell[257291, 7679, 1959, 57, 94, "Input"],
Cell[CellGroupData[{
Cell[259275, 7740, 216, 5, 32, "Input"],
Cell[259494, 7747, 2623, 72, 79, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[262178, 7826, 104, 1, 45, "Subsection"],
Cell[262285, 7829, 208, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[262518, 7837, 98, 1, 36, "Subsubsection"],
Cell[262619, 7840, 378, 8, 80, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[263034, 7853, 99, 1, 36, "Subsubsection"],
Cell[263136, 7856, 378, 8, 80, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[263575, 7871, 210, 3, 65, "Section"],
Cell[263788, 7876, 315, 5, 55, "Text"],
Cell[CellGroupData[{
Cell[264128, 7885, 194, 2, 45, "Subsection"],
Cell[264325, 7889, 420, 7, 55, "Text"],
Cell[264748, 7898, 3847, 98, 315, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[268632, 8001, 241, 3, 44, "Subsection"],
Cell[CellGroupData[{
Cell[268898, 8008, 121, 1, 35, "Subsubsection"],
Cell[269022, 8011, 163, 2, 33, "Text"],
Cell[269188, 8015, 1674, 43, 137, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[270899, 8063, 150, 2, 36, "Subsubsection"],
Cell[271052, 8067, 132, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[271209, 8072, 662, 14, 34, "Input"],
Cell[271874, 8088, 3384, 83, 123, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[275295, 8176, 365, 10, 34, "Input"],
Cell[275663, 8188, 705, 10, 32, "Output"]
}, Open  ]],
Cell[276383, 8201, 120, 1, 33, "Text"],
Cell[276506, 8204, 132, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[276663, 8209, 419, 10, 34, "Input"],
Cell[277085, 8221, 2867, 73, 101, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[279989, 8299, 315, 9, 34, "Input"],
Cell[280307, 8310, 592, 8, 32, "Output"]
}, Open  ]],
Cell[280914, 8321, 120, 1, 33, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[281071, 8327, 151, 2, 36, "Subsubsection"],
Cell[281225, 8331, 183, 2, 33, "Text"],
Cell[CellGroupData[{
Cell[281433, 8337, 710, 14, 34, "Input"],
Cell[282146, 8353, 1772, 40, 101, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[283955, 8398, 369, 10, 34, "Input"],
Cell[284327, 8410, 662, 9, 32, "Output"]
}, Open  ]],
Cell[285004, 8422, 120, 1, 33, "Text"],
Cell[285127, 8425, 132, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[285284, 8430, 525, 12, 34, "Input"],
Cell[285812, 8444, 1523, 37, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[287372, 8486, 366, 10, 34, "Input"],
Cell[287741, 8498, 638, 9, 32, "Output"]
}, Open  ]],
Cell[288394, 8510, 120, 1, 33, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[288563, 8517, 267, 4, 44, "Subsection"],
Cell[288833, 8523, 166, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[289024, 8530, 121, 1, 35, "Subsubsection"],
Cell[289148, 8533, 1519, 36, 148, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[290704, 8574, 158, 2, 36, "Subsubsection"],
Cell[CellGroupData[{
Cell[290887, 8580, 790, 15, 34, "Input"],
Cell[291680, 8597, 2645, 66, 97, "Output"]
}, Open  ]],
Cell[294340, 8666, 127, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[294492, 8671, 1467, 35, 103, "Input"],
Cell[295962, 8708, 1514, 38, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[297513, 8751, 385, 10, 34, "Input"],
Cell[297901, 8763, 690, 10, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[298628, 8778, 1136, 28, 98, "Input"],
Cell[299767, 8808, 790, 17, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[300594, 8830, 312, 9, 34, "Input"],
Cell[300909, 8841, 543, 8, 32, "Output"]
}, Open  ]],
Cell[301467, 8852, 518, 14, 55, "Input"],
Cell[301988, 8868, 201, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[302214, 8876, 413, 11, 34, "Input"],
Cell[302630, 8889, 618, 9, 32, "Output"]
}, Open  ]],
Cell[303263, 8901, 120, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[303408, 8906, 313, 9, 34, "Input"],
Cell[303724, 8917, 564, 8, 32, "Output"]
}, Open  ]],
Cell[304303, 8928, 120, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[304448, 8933, 315, 9, 34, "Input"],
Cell[304766, 8944, 568, 8, 32, "Output"]
}, Open  ]],
Cell[305349, 8955, 120, 1, 33, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[305506, 8961, 159, 2, 36, "Subsubsection"],
Cell[CellGroupData[{
Cell[305690, 8967, 842, 16, 34, "Input"],
Cell[306535, 8985, 1365, 31, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[307937, 9021, 311, 8, 34, "Input"],
Cell[308251, 9031, 574, 8, 32, "Output"]
}, Open  ]],
Cell[308840, 9042, 120, 1, 33, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[309009, 9049, 272, 4, 45, "Subsection"],
Cell[309284, 9055, 166, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[309475, 9062, 121, 1, 35, "Subsubsection"],
Cell[309599, 9065, 1720, 42, 105, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[311356, 9112, 108, 1, 36, "Subsubsection"],
Cell[CellGroupData[{
Cell[311489, 9117, 511, 12, 34, "Input"],
Cell[312003, 9131, 2905, 77, 123, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[314945, 9213, 309, 8, 34, "Input"],
Cell[315257, 9223, 303, 4, 32, "Output"]
}, Open  ]],
Cell[315575, 9230, 120, 1, 33, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[315732, 9236, 160, 2, 36, "Subsubsection"],
Cell[CellGroupData[{
Cell[315917, 9242, 561, 12, 34, "Input"],
Cell[316481, 9256, 1281, 34, 101, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[317799, 9295, 362, 9, 34, "Input"],
Cell[318164, 9306, 302, 4, 32, "Output"]
}, Open  ]],
Cell[318481, 9313, 120, 1, 33, "Text"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[318662, 9321, 185, 2, 65, "Section"],
Cell[CellGroupData[{
Cell[318872, 9327, 100, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[318997, 9332, 666, 18, 34, "Input"],
Cell[319666, 9352, 16612, 418, 423, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[336327, 9776, 98, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[336450, 9781, 723, 19, 34, "Input"],
Cell[337176, 9802, 23063, 551, 658, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[360288, 10359, 107, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[360420, 10364, 695, 18, 34, "Input"],
Cell[361118, 10384, 79982, 2040, 3641, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[441161, 12431, 96, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[441282, 12436, 218, 3, 35, "Subsubsection"],
Cell[441503, 12441, 107, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[441635, 12446, 253, 6, 34, "Input"],
Cell[441891, 12454, 452, 9, 34, "Output"]
}, Open  ]],
Cell[442358, 12466, 115, 1, 33, "Text"],
Cell[442476, 12469, 946, 17, 388, "Input"],
Cell[443425, 12488, 120, 1, 33, "Text"],
Cell[443548, 12491, 250, 6, 34, "Input"],
Cell[443801, 12499, 105, 1, 33, "Text"],
Cell[443909, 12502, 758, 18, 80, "Input"],
Cell[444670, 12522, 110, 1, 33, "Text"],
Cell[444783, 12525, 237, 5, 34, "Input"],
Cell[445023, 12532, 99, 1, 33, "Text"],
Cell[445125, 12535, 282, 6, 166, "Input"],
Cell[445410, 12543, 128, 1, 33, "Text"],
Cell[445541, 12546, 366, 8, 34, "Input"],
Cell[445910, 12556, 164, 2, 33, "Text"],
Cell[446077, 12560, 349, 8, 34, "Input"],
Cell[446429, 12570, 250, 5, 34, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[446716, 12580, 188, 2, 36, "Subsubsection"],
Cell[446907, 12584, 107, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[447039, 12589, 301, 7, 34, "Input"],
Cell[447343, 12598, 479, 9, 34, "Output"]
}, Open  ]],
Cell[447837, 12610, 115, 1, 33, "Text"],
Cell[447955, 12613, 930, 17, 344, "Input"],
Cell[448888, 12632, 120, 1, 33, "Text"],
Cell[449011, 12635, 250, 6, 34, "Input"],
Cell[449264, 12643, 161, 2, 33, "Text"],
Cell[449428, 12647, 1997, 54, 195, "Input"],
Cell[451428, 12703, 2175, 57, 217, "Input"],
Cell[453606, 12762, 1623, 43, 149, "Input"],
Cell[455232, 12807, 724, 17, 79, "Input"],
Cell[455959, 12826, 110, 1, 33, "Text"],
Cell[456072, 12829, 237, 5, 34, "Input"],
Cell[456312, 12836, 99, 1, 33, "Text"],
Cell[456414, 12839, 776, 14, 562, "Input"],
Cell[457193, 12855, 128, 1, 33, "Text"],
Cell[457324, 12858, 446, 9, 34, "Input"],
Cell[457773, 12869, 113, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[457911, 12874, 282, 6, 32, "Input"],
Cell[458196, 12882, 324, 6, 55, "Output"]
}, Open  ]],
Cell[458535, 12891, 325, 6, 67, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

