(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    535086,      15257]
NotebookOptionsPosition[    506600,      14345]
NotebookOutlinePosition[    506939,      14360]
CellTagsIndexPosition[    506896,      14357]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "Supplementary Mathematica file. \n",
 StyleBox["July 2017",
  FontWeight->"Plain"]
}], "Text",
 CellChangeTimes->{{3.7053817047370768`*^9, 3.705381712931221*^9}, {
  3.709989523473722*^9, 3.7099895240254107`*^9}, {3.710053640860198*^9, 
  3.710053650141354*^9}},
 FontWeight->"Bold"],

Cell[TextData[{
 StyleBox["CONTENTS: \n\nPart 0",
  FontWeight->"Bold"],
 ": \[OpenCurlyDoubleQuote]Housekeeping\[CloseCurlyDoubleQuote], definitions \
of functions, matrices and replacement rules that will be used throughout the \
file. \n\n",
 StyleBox["Part 1",
  FontWeight->"Bold"],
 ": Probabilities of identity by descent (related to Appendix B2 and C2). \n  \
          We compare the formulas calculated by hand to the ones obtained \
numerically for special structures, to check that the formulas are correct \
(they are).\n            \n",
 StyleBox["Part 2",
  FontWeight->"Bold"],
 ": Expected Frequencies Functions (related to Appendix B1 and C1, and \
formulas in the main text)\n             - We simplify the formulas obtained \
by hand by replacing the dispersal (d) and interaction (e) graphs by their \
formulas in subdivided populations. \n             - We compare the formulas \
calculated by hand to the ones obtained numerically for special structures, \
to check that the formulas are correct (they are).\n             - We export \
the formulas to R for further use. \n\n",
 StyleBox["Part 3",
  FontWeight->"Bold"],
 ": Changes with ",
 StyleBox["m\n             ",
  FontSlant->"Italic"],
 "We study how the different terms of our equations (probabilities of \
identity by descent Q, indirect/secondary terms I, and full equations EX) \
change with the emigration probability ",
 StyleBox["m",
  FontSlant->"Italic"],
 ", and identify critical values. \n                           "
}], "Text",
 CellChangeTimes->{{3.7100486122993307`*^9, 3.7100486691530867`*^9}, {
  3.710048701304635*^9, 3.7100487152290573`*^9}, {3.7100487622241507`*^9, 
  3.710048897825068*^9}, {3.71004916081533*^9, 3.710049303512838*^9}},
 Background->GrayLevel[0.85]],

Cell[TextData[{
 StyleBox["Please note:\n",
  FontWeight->"Bold"],
 "-  In this file, the mutation bias is denoted by p (as in Tarnita and \
Taylor 2014 and Debarre 2017), instead of \[Nu] as in the manuscript. \n   \
The letter \[Nu] was chosen in the manuscript because p was sometimes \
mistaken by others as average frequency of altruists in the population (",
 Cell[BoxData[
  FormBox[
   OverscriptBox["X", "_"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " in the manuscript)... But this file was written before the change, and it \
is too complicated to change every instance of \[OpenCurlyDoubleQuote]p\
\[CloseCurlyDoubleQuote].\n   \n-  Make sure to change `pathtosave` with the \
path to the folder containing the codes. "
}], "Text",
 CellChangeTimes->{{3.709989667224828*^9, 3.7099897100888243`*^9}, {
   3.7099900953347473`*^9, 3.7099901568227654`*^9}, 3.7100445466381598`*^9, {
   3.710044653324129*^9, 3.710044653923409*^9}, {3.71004470069179*^9, 
   3.710044776161139*^9}, {3.710048561933441*^9, 3.710048606698984*^9}, {
   3.7100492887766237`*^9, 3.7100493957508297`*^9}},
 Background->GrayLevel[0.85]],

Cell["Before doing anything, clean the memory", "Text",
 CellChangeTimes->{{3.7099894867598257`*^9, 3.709989496506331*^9}, {
  3.7100493755278254`*^9, 3.710049379170722*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"Evaluate", "[", 
   RowBox[{
    RowBox[{"Context", "[", "]"}], "<>", "\"\<*\>\""}], "]"}], "]"}]], "Input",\

 CellChangeTimes->{{3.699768620256393*^9, 3.69976863906523*^9}}],

Cell["\<\
Set path to folder where outputs should be saved (otherwise it is the default \
Mathematica one)\
\>", "Text",
 CellChangeTimes->{{3.709989499062375*^9, 3.70998951336238*^9}, {
  3.71004479279252*^9, 3.71004481852061*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "pathtosave", "=", 
   "\"\<~/Documents/Work/Projects/2016_SocEvolSubdivPop/Programs/\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.705387996764245*^9, 3.7053879984325037`*^9}, {
  3.705388032144833*^9, 3.705388039805272*^9}, {3.709990745446624*^9, 
  3.7099907457090263`*^9}}],

Cell[CellGroupData[{

Cell["0) Generalities - Initializations", "Title",
 CellChangeTimes->{{3.6998481203326683`*^9, 3.699848124351286*^9}, {
  3.70538498351235*^9, 3.705384986975419*^9}, {3.710048447708098*^9, 
  3.710048448254251*^9}}],

Cell[CellGroupData[{

Cell["Some functions", "Section",
 CellChangeTimes->{{3.69976195851033*^9, 3.6997619606822844`*^9}, {
  3.705381692643553*^9, 3.705381694507731*^9}}],

Cell["\<\
Function to turn P (expected state of pairs of sites) into Q (probabilities \
of identity by descent)\
\>", "Text",
 CellChangeTimes->{{3.699761638267042*^9, 3.699761643190976*^9}, {
  3.710044987970128*^9, 3.710045000889764*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PtoQ", "[", "P_", "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"P", "-", 
      SuperscriptBox["p", "2"]}], 
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}]}]], "//", "FullSimplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6997074055269413`*^9, 3.699707418282507*^9}}],

Cell["Delta function", "Text",
 CellChangeTimes->{{3.699761981659233*^9, 3.699761983664853*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Delta", "[", "x_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"x", "\[Equal]", "0"}], ",", "1", ",", "0"}], "]"}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define graphs for numerical evaluation", "Section",
 CellChangeTimes->{{3.668999943448367*^9, 3.668999951062648*^9}, {
  3.669090333143214*^9, 3.6690903447306433`*^9}, {3.6690903789232073`*^9, 
  3.6690903841955957`*^9}, {3.6702349799301558`*^9, 3.670234987354018*^9}, {
  3.699761597799471*^9, 3.699761603112997*^9}, {3.705381823275504*^9, 
  3.705381826586681*^9}}],

Cell[CellGroupData[{

Cell["Dispersal and Interaction Graphs", "Subsection",
 CellChangeTimes->{{3.710045015347454*^9, 3.710045025005965*^9}}],

Cell[CellGroupData[{

Cell["Island model, dispersal graph, generic", "Subsubsection",
 CellChangeTimes->{{3.6702357682102127`*^9, 3.6702357769730186`*^9}, {
  3.6997616053042727`*^9, 3.699761610197031*^9}, {3.699779221556974*^9, 
  3.6997792225091047`*^9}}],

Cell["N = 12, 4 demes of 3 individuals", "Text",
 CellChangeTimes->{{3.7053816073690863`*^9, 3.705381610787718*^9}, {
  3.7100450872081947`*^9, 3.7100450924090233`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"G12generic", "=", 
   RowBox[{"(", GridBox[{
      {"dself", "din", "din", "dout", "dout", "dout", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"din", "dself", "din", "dout", "dout", "dout", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"din", "din", "dself", "dout", "dout", "dout", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "dself", "din", "din", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "din", "dself", "din", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "din", "din", "dself", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "dself", "din", "din", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "din", "dself", "din", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "din", "din", "dself", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout",
        "dself", "din", "din"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout",
        "din", "dself", "din"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout",
        "din", "din", "dself"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nin", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ndemes", "=", "4"}], ";"}]}], "Input",
 CellChangeTimes->{{3.668999966108613*^9, 3.668999984048553*^9}, {
  3.669000027438491*^9, 3.669000197449211*^9}, {3.699779227001737*^9, 
  3.699779365815967*^9}, {3.705382335922227*^9, 3.7053823360656347`*^9}}],

Cell["N = 10, 2 demes of 5 individuals", "Text",
 CellChangeTimes->{{3.7053816073690863`*^9, 3.705381617268631*^9}, {
  3.710045094361265*^9, 3.710045098800516*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"G10generic", "=", 
   RowBox[{"(", GridBox[{
      {"dself", "din", "din", "din", "din", "dout", "dout", "dout", "dout", 
       "dout"},
      {"din", "dself", "din", "din", "din", "dout", "dout", "dout", "dout", 
       "dout"},
      {"din", "din", "dself", "din", "din", "dout", "dout", "dout", "dout", 
       "dout"},
      {"din", "din", "din", "dself", "din", "dout", "dout", "dout", "dout", 
       "dout"},
      {"din", "din", "din", "din", "dself", "dout", "dout", "dout", "dout", 
       "dout"},
      {"dout", "dout", "dout", "dout", "dout", "dself", "din", "din", "din", 
       "din"},
      {"dout", "dout", "dout", "dout", "dout", "din", "dself", "din", "din", 
       "din"},
      {"dout", "dout", "dout", "dout", "dout", "din", "din", "dself", "din", 
       "din"},
      {"dout", "dout", "dout", "dout", "dout", "din", "din", "din", "dself", 
       "din"},
      {"dout", "dout", "dout", "dout", "dout", "din", "din", "din", "din", 
       "dself"}
     }], ")"}]}], ";"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Island model, interaction graph, generic", "Subsubsection",
 CellChangeTimes->{{3.699761622641583*^9, 3.699761631727844*^9}, {
  3.699762000382402*^9, 3.699762003637082*^9}, {3.6997793522666693`*^9, 
  3.699779354892267*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GE12generic", "=", 
   RowBox[{"G12generic", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dself", "\[Rule]", "eself"}], ",", 
      RowBox[{"dout", "\[Rule]", "eout"}], ",", 
      RowBox[{"din", "\[Rule]", "ein"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GE10generic", "=", 
   RowBox[{"G10generic", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dself", "\[Rule]", "eself"}], ",", 
      RowBox[{"dout", "\[Rule]", "eout"}], ",", 
      RowBox[{"din", "\[Rule]", "ein"}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.679392136687027*^9, 3.679392176855454*^9}, {
  3.699779361234367*^9, 3.699779471181334*^9}, {3.705381642158368*^9, 
  3.705381650694024*^9}, {3.7053823499146967`*^9, 3.705382353401075*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Formulas for d and e", "Subsubsection",
 CellChangeTimes->{{3.7053847971199408`*^9, 3.705384811375741*^9}, {
  3.705386643590569*^9, 3.705386651654303*^9}}],

Cell["\<\
Replacements for the generic dispersal probabilities, depending on whether \
there is self-replacement or not\
\>", "Text",
 CellChangeTimes->{{3.6997616658203783`*^9, 3.699761687567214*^9}, {
  3.705384783688675*^9, 3.7053847850708513`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"noselfreplacement", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dself", "\[Rule]", "0"}], ",", 
     RowBox[{"din", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "m"}], 
       RowBox[{"n", "-", "1"}]]}], ",", 
     RowBox[{"dout", "\[Rule]", 
      FractionBox["m", 
       RowBox[{
        RowBox[{"d", " ", "n"}], " ", "-", " ", "n"}]]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"withselfreplacement", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dself", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "m"}], "n"]}], ",", 
     RowBox[{"din", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "m"}], "n"]}], ",", 
     RowBox[{"dout", "\[Rule]", 
      FractionBox["m", 
       RowBox[{
        RowBox[{"d", " ", "n"}], " ", "-", " ", "n"}]]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6997075039255657`*^9, 3.699707552648037*^9}, {
  3.699794949387794*^9, 3.699794952038497*^9}}],

Cell["\<\
Replacements for the generic interaction probabilities, depending on whether \
there is self - interaction or not\
\>", "Text",
 CellChangeTimes->{{3.7053866725645*^9, 3.7053866854887857`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"groupnoself", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"eself", "\[Rule]", "0"}], ",", 
     RowBox[{"ein", "\[Rule]", 
      FractionBox["1", 
       RowBox[{"n", "-", "1"}]]}], ",", 
     RowBox[{"eout", "\[Rule]", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"groupwithself", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"eself", "\[Rule]", 
      FractionBox["1", "n"]}], ",", 
     RowBox[{"ein", "\[Rule]", 
      FractionBox["1", "n"]}], ",", 
     RowBox[{"eout", "\[Rule]", "0"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.699794001410203*^9, 3.6997940825421743`*^9}, 
   3.705386614026968*^9, 3.705386696609133*^9}],

Cell["\<\
We can even assume that there are a proportion g of interactions outside of \
the group\
\>", "Text",
 CellChangeTimes->{{3.7053866988119307`*^9, 3.7053867171153393`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"widewithself", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"eself", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "g"}], "n"]}], ",", 
     RowBox[{"ein", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "g"}], "n"]}], ",", 
     RowBox[{"eout", "\[Rule]", 
      FractionBox["g", 
       RowBox[{
        RowBox[{"n", " ", "d"}], "-", "n"}]]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"widenoself", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"eself", "\[Rule]", "0"}], ",", 
     RowBox[{"ein", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "g"}], 
       RowBox[{"n", "-", "1"}]]}], ",", 
     RowBox[{"eout", "\[Rule]", 
      FractionBox["g", 
       RowBox[{
        RowBox[{"n", " ", "d"}], "-", "n"}]]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.699794001410203*^9, 3.6997940825421743`*^9}, 
   3.705386614026968*^9, 3.705386696609133*^9}],

Cell["\<\
Combine these using Idself and Ieself, indicator variables for whether there \
is dispersal/interaction with self\
\>", "Text",
 CellChangeTimes->{{3.705386722588567*^9, 3.7053867328708897`*^9}, {
  3.705386774295669*^9, 3.705386796017934*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"genericde", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dself", "\[Rule]", 
      RowBox[{"Idself", " ", 
       FractionBox[
        RowBox[{"1", "-", "m"}], "n"]}]}], ",", 
     RowBox[{"din", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "m"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"n", "-", "1"}]], "-", 
         RowBox[{"Idself", " ", 
          FractionBox["1", 
           RowBox[{"n", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}]]}]}], ")"}]}]}], ",", 
     RowBox[{"dout", "\[Rule]", 
      FractionBox["m", 
       RowBox[{
        RowBox[{"n", " ", "d"}], "-", "n"}]]}], ",", 
     RowBox[{"(*", "\[IndentingNewLine]", "*)"}], 
     RowBox[{"eself", "\[Rule]", 
      RowBox[{"Ieself", " ", 
       FractionBox[
        RowBox[{"1", "-", "g"}], "n"]}]}], ",", 
     RowBox[{"ein", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "g"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"n", "-", "1"}]], "-", 
         RowBox[{"Ieself", " ", 
          FractionBox["1", 
           RowBox[{"n", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}]]}]}], ")"}]}]}], ",", 
     RowBox[{"eout", "\[Rule]", 
      FractionBox["g", 
       RowBox[{
        RowBox[{"n", " ", "d"}], "-", "n"}]]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699847700264285*^9, 3.699847847432616*^9}}],

Cell["Quick check", "Text",
 CellChangeTimes->{{3.710045112069128*^9, 3.710045114517186*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"eself", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], "ein"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "eout"}]}], "/.", 
   "genericde"}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dself", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], "din"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout"}]}], "/.", 
   "genericde"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.6998478529415617`*^9, 3.6998478741336203`*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.705386835798964*^9, 3.7099895977242107`*^9, 3.709990547431911*^9, 
   3.710045154959765*^9, 3.710049683670619*^9, {3.7100540128343143`*^9, 
   3.71005401875179*^9}, 3.7100544959334183`*^9, 3.710156937313199*^9, 
   3.713407332357637*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.705386835798964*^9, 3.7099895977242107`*^9, 3.709990547431911*^9, 
   3.710045154959765*^9, 3.710049683670619*^9, {3.7100540128343143`*^9, 
   3.71005401875179*^9}, 3.7100544959334183`*^9, 3.710156937313199*^9, 
   3.713407332371851*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Probabilities of identity by descent matrices", "Subsection",
 CellChangeTimes->{{3.710045034592218*^9, 3.710045049896731*^9}}],

Cell[CellGroupData[{

Cell["\<\
Generic Q matrix corresponding to the populations defined above\
\>", "Subsubsection",
 CellChangeTimes->{{3.699780083079438*^9, 3.699780089064321*^9}, {
  3.710045053816822*^9, 3.7100450723451557`*^9}}],

Cell["N = 12", "Text",
 CellChangeTimes->{{3.7053816637626743`*^9, 3.705381672787184*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q12generic", "=", 
   RowBox[{"(", GridBox[{
      {"1", "Qin", "Qin", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qin", "1", "Qin", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qin", "Qin", "1", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "1", "Qin", "Qin", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qin", "1", "Qin", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qin", "Qin", "1", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "1", "Qin", "Qin", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "1", "Qin", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "Qin", "1", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout",
        "1", "Qin", "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout",
        "Qin", "1", "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout",
        "Qin", "Qin", "1"}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699780094260882*^9, 3.699780213049553*^9}}],

Cell["N = 10", "Text",
 CellChangeTimes->{{3.7053816637626743`*^9, 3.705381667315893*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q10generic", "=", 
   RowBox[{"(", GridBox[{
      {"1", "Qin", "Qin", "Qin", "Qin", "Qout", "Qout", "Qout", "Qout", 
       "Qout"},
      {"Qin", "1", "Qin", "Qin", "Qin", "Qout", "Qout", "Qout", "Qout", 
       "Qout"},
      {"Qin", "Qin", "1", "Qin", "Qin", "Qout", "Qout", "Qout", "Qout", 
       "Qout"},
      {"Qin", "Qin", "Qin", "1", "Qin", "Qout", "Qout", "Qout", "Qout", 
       "Qout"},
      {"Qin", "Qin", "Qin", "Qin", "1", "Qout", "Qout", "Qout", "Qout", 
       "Qout"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "1", "Qin", "Qin", "Qin", 
       "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "1", "Qin", "Qin", 
       "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "Qin", "1", "Qin", 
       "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "Qin", "Qin", "1", 
       "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "Qin", "Qin", "Qin", "1"}
     }], ")"}]}], ";"}]], "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["1) Probabilities of identity by descent (Q)", "Title",
 CellChangeTimes->{{3.6997615711578712`*^9, 3.6997615782063017`*^9}, 
   3.705381722579816*^9, {3.705384972132237*^9, 3.7053849776404448`*^9}, {
   3.7100484523695393`*^9, 3.710048452937963*^9}}],

Cell[CellGroupData[{

Cell["Moran", "Section",
 CellChangeTimes->{{3.699707345527932*^9, 3.699707348878216*^9}}],

Cell[CellGroupData[{

Cell["Simplify QinM and QoutM", "Subsection",
 CellChangeTimes->{{3.705384837006383*^9, 3.7053848450598097`*^9}, {
  3.705384918344077*^9, 3.705384919135845*^9}}],

Cell["\<\
See Appendix B2 for calculation details on how Qself, Qin and Qout were \
obtained using a formula presented in the appendix of Debarre 2017 JTB for \
\[OpenCurlyDoubleQuote]2D graphs\[CloseCurlyDoubleQuote]. Here we just copy \
these formulas. \
\>", "Text",
 CellChangeTimes->{{3.705384701614676*^9, 3.705384767903507*^9}, {
  3.710045185256304*^9, 3.710045212024458*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"QselfM2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "\[Mu]"], " ", "+", " ", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "m", "-", 
            FractionBox["m", 
             RowBox[{"d", "-", "1"}]]}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699707557939262*^9, 3.69970763486366*^9}, {
   3.6997106026698093`*^9, 3.6997106056848392`*^9}, 3.705381789237061*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"QinM2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "\[Mu]"], " ", "+", " ", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "m", "-", 
            FractionBox["m", 
             RowBox[{"d", "-", "1"}]]}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QoutM2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "\[Mu]"], " ", "+", " ", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "m", "-", 
            FractionBox["m", 
             RowBox[{"d", "-", "1"}]]}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}], "+", 
      FractionBox["1", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"dself", "-", "din"}], ")"}]}]}]]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.699707683180396*^9, 3.699707713960421*^9}, {
  3.699710614334208*^9, 3.699710618463037*^9}}],

Cell["Find \[Lambda] using Qself == 1", "Text",
 CellChangeTimes->{{3.6997617343192577`*^9, 3.699761741343073*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"the\[Lambda]M", "=", 
  RowBox[{
   RowBox[{"\[Lambda]", "/.", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"QselfM2", "\[Equal]", "1"}], ",", "\[Lambda]"}], "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699707717272316*^9, 3.699707738311771*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"n", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "din", "+", 
     RowBox[{"dself", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
     RowBox[{"din", " ", "\[Mu]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "d"}], " ", "m"}], "+", "\[Mu]", "+", 
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
  RowBox[{
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "din", "-", "dself", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "din"}], "+", "dself", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
       "\[Mu]"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "dself", "+", 
      RowBox[{"din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"dself", "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.69970772408389*^9, 3.699707738698215*^9}, 
   3.699710621593836*^9, 3.6997686437904377`*^9, 3.699787643568434*^9, 
   3.699793830771269*^9, 3.6998474518868103`*^9, 3.699848116000793*^9, 
   3.699848919108547*^9, 3.6998537361374397`*^9, 3.699955345715513*^9, 
   3.70220130432386*^9, 3.702289662990987*^9, 3.704178947628963*^9, 
   3.70451770389784*^9, 3.705381803222721*^9, 3.7053871868134527`*^9, 
   3.7099896361553926`*^9, {3.709990550342622*^9, 3.709990558553536*^9}, 
   3.7100452223244133`*^9, 3.710049684287039*^9, 3.7100540244959297`*^9, 
   3.7100544967705727`*^9, 3.710156941308593*^9, 3.713407333063487*^9}]
}, Open  ]],

Cell["Replace \[Lambda] in the equations for Qin and Qout", "Text",
 CellChangeTimes->{{3.699761747312605*^9, 3.699761756389374*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QinM", "=", 
  RowBox[{
   RowBox[{"QinM2", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", " ", "the\[Lambda]M"}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"QoutM", "=", 
  RowBox[{
   RowBox[{"QoutM2", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", " ", "the\[Lambda]M"}]}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.6997077421873693`*^9, 3.699707784984331*^9}, {
  3.699793746074094*^9, 3.699793747396491*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "din", "-", "dself"}], ")"}], " ", "\[Mu]"}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "din", "-", "dself", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d", "+", "din", "-", "dself"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "din", "-", "dself", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "din"}], "+", "dself", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
       "\[Mu]"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "dself", "+", 
      RowBox[{"din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"dself", "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.6997077647180653`*^9, 3.6997077855738363`*^9}, 
   3.699710621747601*^9, 3.699768643934836*^9, 3.699787643727768*^9, 
   3.699793748652389*^9, 3.699793831243638*^9, 3.6998474522920237`*^9, 
   3.699848116415012*^9, 3.6998489194040213`*^9, 3.699853736523282*^9, 
   3.699955346045332*^9, 3.702201304718186*^9, 3.702289663254939*^9, 
   3.7041789478680773`*^9, 3.704517704162591*^9, 3.705381804447599*^9, 
   3.705387187037231*^9, 3.709989638164032*^9, {3.709990550674816*^9, 
   3.7099905588175917`*^9}, 3.710045224036543*^9, 3.710049684677297*^9, 
   3.710054024680799*^9, 3.710054497021096*^9, 3.710156941540985*^9, 
   3.7134073333554697`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "din", "+", 
     RowBox[{"dself", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
     RowBox[{"din", " ", "\[Mu]"}]}], ")"}]}], 
  RowBox[{
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "din", "-", "dself", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "din"}], "+", "dself", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
       "\[Mu]"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "dself", "+", 
      RowBox[{"din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"dself", "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.6997077647180653`*^9, 3.6997077855738363`*^9}, 
   3.699710621747601*^9, 3.699768643934836*^9, 3.699787643727768*^9, 
   3.699793748652389*^9, 3.699793831243638*^9, 3.6998474522920237`*^9, 
   3.699848116415012*^9, 3.6998489194040213`*^9, 3.699853736523282*^9, 
   3.699955346045332*^9, 3.702201304718186*^9, 3.702289663254939*^9, 
   3.7041789478680773`*^9, 3.704517704162591*^9, 3.705381804447599*^9, 
   3.705387187037231*^9, 3.709989638164032*^9, {3.709990550674816*^9, 
   3.7099905588175917`*^9}, 3.710045224036543*^9, 3.710049684677297*^9, 
   3.710054024680799*^9, 3.710054497021096*^9, 3.710156941540985*^9, 
   3.713407333460346*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check numerically", "Subsection",
 CellChangeTimes->{{3.705382410622026*^9, 3.7053824143751183`*^9}}],

Cell["\<\
Here we evaluate the probabilities of identity by descent numerically, using \
the recursion formula (\[OpenCurlyDoubleQuote]eqs\[CloseCurlyDoubleQuote] in \
the function below), with specific graphs. \
\>", "Text",
 CellChangeTimes->{{3.710045361619101*^9, 3.710045403286997*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NGetQM", "[", 
   RowBox[{
   "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "p_", ",", 
    "\[Mu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"QT", ",", "eqs", ",", "vars", ",", "sols", ",", "QTs"}], "}"}], 
    ",", 
    RowBox[{"(*", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", " ", "is", " ", "the", " ", "dispersal", " ", "graph"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
      "\[CapitalNu]", " ", "is", " ", "the", " ", "size", " ", "of", " ", 
       "the", " ", "population"}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "graphdegree", " ", "is", " ", "the", " ", "degree", " ", "of", " ", 
       "the", " ", "graph", " ", 
       RowBox[{"(", 
        RowBox[{"=", 
         RowBox[{
         "1", " ", "in", " ", "a", " ", "subdivided", " ", "population"}]}], 
        ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "is", " ", "the", " ", "mutation", " ", "biais"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]", " ", "is", " ", "the", " ", "mutation", " ", 
       RowBox[{"probability", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Initialize", " ", "the", " ", "QT", " ", "matrix"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], "=", "0"}], ";", 
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], "=."}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"QT", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        SubscriptBox["Q", 
         RowBox[{"i", ",", "j"}]], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QT", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], "=", "1"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       SubscriptBox["Q", 
        RowBox[{"i", ",", "i"}]], "=", " ", "1"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QT", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
        SubscriptBox["Q", 
         RowBox[{"j", ",", "i"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"j", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Because", " ", "Q", " ", "is", " ", "symmetric"}], " ", "*)"}],
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["Q", 
           RowBox[{"i", ",", "j"}]], "\[Equal]", 
          RowBox[{
           FractionBox[
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Mu]"}], ")"}], 
            RowBox[{"2", " ", "graphdegree"}]], 
           RowBox[{"(", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"G", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "j"}], "\[RightDoubleBracket]"}], 
                RowBox[{"QT", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "i"}], "\[RightDoubleBracket]"}]}], "+", 
               RowBox[{
                RowBox[{"G", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "i"}], "\[RightDoubleBracket]"}], 
                RowBox[{"QT", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "j"}], "\[RightDoubleBracket]"}]}]}], ",", 
              
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
            ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sols", "=", 
      RowBox[{"NSolve", "[", 
       RowBox[{"eqs", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"QTs", "=", 
      RowBox[{"QT", "/.", 
       RowBox[{
       "sols", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", "QTs"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7053848697994337`*^9, 3.7053848780155973`*^9}, {
   3.710046771770358*^9, 3.7100467772587967`*^9}, 3.710046826103231*^9}],

Cell["\<\
This function compares the numerical version to the analytical one, for \
specific graph structures. If the numerical values are the same, we are fine! \
(and we are, otherwise there would not be a paper)\
\>", "Text",
 CellChangeTimes->{{3.7100454323796387`*^9, 3.710045461466309*^9}, {
  3.710045859794882*^9, 3.710045869034852*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"prs", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CheckQM", "[", 
   RowBox[{"prs_", ",", "dvalues_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NG", ",", "NQin", ",", "NQout", ",", "NQinMatrix"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NG", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<G\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"d", " ", "n"}], "/.", "prs"}], "]"}], "<>", 
          "\"\<generic\>\""}], "]"}], "/.", "dvalues"}], "/.", "prs"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"NQinMatrix", "=", 
      RowBox[{"NGetQM", "[", 
       RowBox[{"NG", ",", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "/.", "prs"}], ",", "1", ",", "0.5", ",", 
        RowBox[{"\[Mu]", "/.", "prs"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NQin", "=", 
      RowBox[{"NQinMatrix", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NQout", "=", 
      RowBox[{"NQinMatrix", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "/.", "prs"}]}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Qin\>\"", ",", "NQin", ",", 
            RowBox[{
             RowBox[{"QinM", "/.", "dvalues"}], "/.", "prs"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Qout\>\"", ",", "NQout", ",", 
            RowBox[{
             RowBox[{"QoutM", "/.", "dvalues"}], "/.", "prs"}]}], "}"}]}], 
         "}"}], "//", "Transpose"}], "//", "MatrixForm"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.705382415477868*^9, 3.7053825416943493`*^9}, {
  3.705382574036092*^9, 3.705382818529418*^9}, {3.710045481283993*^9, 
  3.710045543949483*^9}, {3.710045661117234*^9, 3.710045848195723*^9}}],

Cell["Check for the population of size 12", "Text",
 CellChangeTimes->{{3.710045770824685*^9, 3.710045778810508*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"CheckQM", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}], ",", 
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", 
   "withselfreplacement"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"CheckQM", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}], ",", 
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", "noselfreplacement"}],
   "]"}]}], "Input",
 CellChangeTimes->{{3.705382415477868*^9, 3.7053825416943493`*^9}, {
  3.705382574036092*^9, 3.705382818529418*^9}, {3.710045481283993*^9, 
  3.710045543949483*^9}, {3.710045661117234*^9, 3.71004578309207*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.4076433121019112`", "0.12738853503184724`"},
     {"0.40764331210191085`", "0.12738853503184713`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.71004580185327*^9, 3.710045818527726*^9}, {
   3.7100458496621733`*^9, 3.710045872175068*^9}, {3.710046804979011*^9, 
   3.7100468303769608`*^9}, 3.710049684959083*^9, 3.7100540248957777`*^9, 
   3.710054497393442*^9, 3.710156942151408*^9, 3.7134073335485477`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.5037353255069373`", "0.14087513340448243`"},
     {"0.5037353255069368`", "0.14087513340448238`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.71004580185327*^9, 3.710045818527726*^9}, {
   3.7100458496621733`*^9, 3.710045872175068*^9}, {3.710046804979011*^9, 
   3.7100468303769608`*^9}, 3.710049684959083*^9, 3.7100540248957777`*^9, 
   3.710054497393442*^9, 3.710156942151408*^9, 3.7134073335782623`*^9}]
}, Open  ]]
}, Open  ]],

Cell["Check for the population of size 10", "Text",
 CellChangeTimes->{{3.7100457840799427`*^9, 3.710045789765402*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"CheckQM", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "2"}], ",", 
     RowBox[{"n", "\[Rule]", "5"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", 
   "withselfreplacement"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"CheckQM", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "2"}], ",", 
     RowBox[{"n", "\[Rule]", "5"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", "noselfreplacement"}],
   "]"}]}], "Input",
 CellChangeTimes->{{3.705382415477868*^9, 3.7053825416943493`*^9}, {
  3.705382574036092*^9, 3.705382818529418*^9}, {3.710045481283993*^9, 
  3.710045543949483*^9}, {3.710045661117234*^9, 3.71004578309207*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.329896907216495`", "0.20618556701030943`"},
     {"0.32989690721649484`", "0.2061855670103093`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.710045737188779*^9, 3.710045790980493*^9}, {
   3.710045822282939*^9, 3.710045873189179*^9}, 3.7100468323201847`*^9, 
   3.710049685041671*^9, 3.71005402499269*^9, 3.710054497489567*^9, 
   3.7101569423007517`*^9, 3.7134073336129847`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.3761996161228409`", "0.2226487523992325`"},
     {"0.3761996161228407`", "0.2226487523992322`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.710045737188779*^9, 3.710045790980493*^9}, {
   3.710045822282939*^9, 3.710045873189179*^9}, 3.7100468323201847`*^9, 
   3.710049685041671*^9, 3.71005402499269*^9, 3.710054497489567*^9, 
   3.7101569423007517`*^9, 3.713407333630314*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Particular cases", "Subsection",
 CellChangeTimes->{{3.7099899437833014`*^9, 3.70998994895147*^9}}],

Cell[CellGroupData[{

Cell["Equations with self replacement (dself = din)", "Subsubsection",
 CellChangeTimes->{{3.699707797145195*^9, 3.699707800750886*^9}, {
  3.699761769703529*^9, 3.699761771556242*^9}, {3.7053818632907352`*^9, 
  3.705381867297986*^9}, {3.705384908592659*^9, 3.705384908783701*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QinMs", "=", 
  RowBox[{
   RowBox[{"QinM", "/.", "withselfreplacement"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"QoutMs", "=", 
  RowBox[{
   RowBox[{"QoutM", "/.", "withselfreplacement"}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.699707806640571*^9, 3.699707829687098*^9}, {
  3.69979375286362*^9, 3.699793753996879*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Mu]", "-", 
      RowBox[{"d", " ", "\[Mu]"}], "+", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}]}], ")"}]}], 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
    "+", 
    RowBox[{"m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
      ")"}]}]}]]}]], "Output",
 CellChangeTimes->{{3.699707822487941*^9, 3.6997078300797243`*^9}, 
   3.699710623036839*^9, 3.699711328310384*^9, 3.699768644054297*^9, 
   3.6997876439009438`*^9, 3.6997938314317703`*^9, 3.699847452538445*^9, 
   3.699848116650117*^9, 3.699848919649077*^9, 3.699853736709804*^9, 
   3.699955346222619*^9, 3.702201304927656*^9, 3.702289663410713*^9, 
   3.704178948032831*^9, 3.704517704496286*^9, 3.7053818969921217`*^9, 
   3.705387187476713*^9, 3.709989817244776*^9, {3.709990551191963*^9, 
   3.70999055919449*^9}, 3.710045876700582*^9, 3.710049685191901*^9, 
   3.710054025153308*^9, 3.71005449771804*^9, 3.7101569425406923`*^9, 
   3.713407333770465*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.699707822487941*^9, 3.6997078300797243`*^9}, 
   3.699710623036839*^9, 3.699711328310384*^9, 3.699768644054297*^9, 
   3.6997876439009438`*^9, 3.6997938314317703`*^9, 3.699847452538445*^9, 
   3.699848116650117*^9, 3.699848919649077*^9, 3.699853736709804*^9, 
   3.699955346222619*^9, 3.702201304927656*^9, 3.702289663410713*^9, 
   3.704178948032831*^9, 3.704517704496286*^9, 3.7053818969921217`*^9, 
   3.705387187476713*^9, 3.709989817244776*^9, {3.709990551191963*^9, 
   3.70999055919449*^9}, 3.710045876700582*^9, 3.710049685191901*^9, 
   3.710054025153308*^9, 3.71005449771804*^9, 3.7101569425406923`*^9, 
   3.713407333783182*^9}]
}, Open  ]],

Cell["\<\
Simplify the way the equations are written (human - friendly versions), and \
check that the formulas remain correct\
\>", "Text",
 CellChangeTimes->{{3.699761775008071*^9, 3.69976179237366*^9}, {
  3.705381811547044*^9, 3.7053818119865637`*^9}, {3.705381903377886*^9, 
  3.7053819107714367`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QinMs", "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", "\[Mu]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "m"}], ")"}]}], "-", "\[Mu]", "+", "m"}], " ", 
       ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}], " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}], 
     ")"}]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6997113031664057`*^9, 3.699711312567246*^9}, {
  3.699711368217142*^9, 3.69971148194987*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699711306964435*^9, 3.699711330449128*^9}, {
   3.699711405295108*^9, 3.699711501403634*^9}, 3.699768644077819*^9, 
   3.699787643923314*^9, 3.699793831480157*^9, 3.699847452660646*^9, 
   3.699848116752124*^9, 3.6998489197130423`*^9, 3.699853736916744*^9, 
   3.69995534633053*^9, 3.7022013051187*^9, 3.7022896635798073`*^9, 
   3.7041789480787897`*^9, 3.704517704688941*^9, 3.705381898245832*^9, 
   3.7053871875219584`*^9, 3.709989819509569*^9, {3.709990551224366*^9, 
   3.709990559243415*^9}, 3.71004587800937*^9, 3.710049685228863*^9, 
   3.710054025267234*^9, 3.7100544977550898`*^9, 3.7101569426100616`*^9, 
   3.7134073337992907`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QoutMs", "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}], " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}], 
     ")"}]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.69971150684383*^9, 3.699711545927258*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699711511809864*^9, 3.699711546280471*^9}, 
   3.699768644102571*^9, 3.6997876439352217`*^9, 3.6997938315034237`*^9, 
   3.699847452770508*^9, 3.699848116860183*^9, 3.699848919721965*^9, 
   3.699853737057955*^9, 3.6999553464342012`*^9, 3.702201305216506*^9, 
   3.70228966369522*^9, 3.704178948091934*^9, 3.704517704726959*^9, 
   3.705381899750991*^9, 3.705387187658793*^9, 3.709989820518887*^9, {
   3.70999055124793*^9, 3.7099905592497807`*^9}, 3.710045879528764*^9, 
   3.710049685258443*^9, 3.710054025301811*^9, 3.71005449782145*^9, 
   3.710156942730199*^9, 3.713407333818192*^9}]
}, Open  ]],

Cell["Check limit behavior:", "Text",
 CellChangeTimes->{{3.699761804937606*^9, 3.699761810525722*^9}, 
   3.705381914092618*^9, 3.710045889491081*^9}],

Cell["\<\
First infinite population, then zero mutation 
vs.
First zero mutation, then infinite population\
\>", "Text",
 CellChangeTimes->{{3.7100458907978363`*^9, 3.710045923323934*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QoutMs", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{
    RowBox[{"Limit", "[", 
     RowBox[{"QoutMs", ",", 
      RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}], ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.699708994901635*^9, 3.699709018760296*^9}, {
  3.705381924595291*^9, 3.705381939234544*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6997090038532143`*^9, 3.699709012966531*^9}, 
   3.699710624218858*^9, 3.69976864421404*^9, 3.699787644053496*^9, 
   3.699793831590859*^9, 3.699847453243531*^9, 3.699848117304596*^9, 
   3.6998489198823643`*^9, 3.6998537373803596`*^9, 3.699955346792079*^9, 
   3.702201305800952*^9, 3.702289664021549*^9, 3.704178948298765*^9, 
   3.704517704957149*^9, 3.705381940123757*^9, 3.705387187711927*^9, 
   3.7099898222878647`*^9, {3.709990551273045*^9, 3.70999055927314*^9}, 
   3.710045881455665*^9, 3.710045924657275*^9, 3.710049685308382*^9, 
   3.710054025374247*^9, 3.7100544979436417`*^9, 3.710156943119441*^9, 
   3.713407333882366*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.6997090038532143`*^9, 3.699709012966531*^9}, 
   3.699710624218858*^9, 3.69976864421404*^9, 3.699787644053496*^9, 
   3.699793831590859*^9, 3.699847453243531*^9, 3.699848117304596*^9, 
   3.6998489198823643`*^9, 3.6998537373803596`*^9, 3.699955346792079*^9, 
   3.702201305800952*^9, 3.702289664021549*^9, 3.704178948298765*^9, 
   3.704517704957149*^9, 3.705381940123757*^9, 3.705387187711927*^9, 
   3.7099898222878647`*^9, {3.709990551273045*^9, 3.70999055927314*^9}, 
   3.710045881455665*^9, 3.710045924657275*^9, 3.710049685308382*^9, 
   3.710054025374247*^9, 3.7100544979436417`*^9, 3.710156943119441*^9, 
   3.713407333907147*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QinMs", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.699709024470386*^9, 3.699709032489929*^9}, {
   3.7053819512260942`*^9, 3.705381968403285*^9}, 3.709989834560059*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "1"}], "+", "m", "+", "\[Mu]", "-", 
   RowBox[{"m", " ", "\[Mu]"}]}], 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
   RowBox[{"n", " ", "\[Mu]"}]}]]], "Output",
 CellChangeTimes->{
  3.709989835594761*^9, {3.709990551335326*^9, 3.7099905593324757`*^9}, 
   3.710045882961616*^9, 3.710049685388282*^9, 3.710054025531011*^9, 
   3.7100544980909367`*^9, 3.7101569432513866`*^9, 3.713407333971468*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "-", "m"}], 
  RowBox[{"1", "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.709989835594761*^9, {3.709990551335326*^9, 3.7099905593324757`*^9}, 
   3.710045882961616*^9, 3.710049685388282*^9, 3.710054025531011*^9, 
   3.7100544980909367`*^9, 3.7101569432513866`*^9, 3.713407333984499*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Limit", "[", 
  RowBox[{"QinMs", ",", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"%", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.699709024470386*^9, 3.699709032489929*^9}, {
   3.7053819512260942`*^9, 3.705381968403285*^9}, 3.709989834560059*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.6997090210092278`*^9, 3.69970903277978*^9}, 
   3.69971062653979*^9, 3.6997686442727537`*^9, 3.6997876441319523`*^9, 
   3.699793831695056*^9, 3.6998474533978977`*^9, 3.699848117481538*^9, 
   3.699848919995821*^9, 3.699853737514176*^9, 3.699955347039455*^9, 
   3.7022013059393*^9, 3.702289664091626*^9, 3.704178948396358*^9, 
   3.704517705179842*^9, {3.70538195535952*^9, 3.705381969324675*^9}, 
   3.7053871878032713`*^9, {3.7099898250017147`*^9, 3.709989836762285*^9}, {
   3.709990551370511*^9, 3.7099905593424892`*^9}, 3.710045884479703*^9, 
   3.7100496854278107`*^9, 3.710054025571554*^9, 3.710054498173779*^9, 
   3.7101569434079103`*^9, 3.713407334009355*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.6997090210092278`*^9, 3.69970903277978*^9}, 
   3.69971062653979*^9, 3.6997686442727537`*^9, 3.6997876441319523`*^9, 
   3.699793831695056*^9, 3.6998474533978977`*^9, 3.699848117481538*^9, 
   3.699848919995821*^9, 3.699853737514176*^9, 3.699955347039455*^9, 
   3.7022013059393*^9, 3.702289664091626*^9, 3.704178948396358*^9, 
   3.704517705179842*^9, {3.70538195535952*^9, 3.705381969324675*^9}, 
   3.7053871878032713`*^9, {3.7099898250017147`*^9, 3.709989836762285*^9}, {
   3.709990551370511*^9, 3.7099905593424892`*^9}, 3.710045884479703*^9, 
   3.7100496854278107`*^9, 3.710054025571554*^9, 3.710054498173779*^9, 
   3.7101569434079103`*^9, 3.7134073340110683`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{"QinMs", ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.699709522250888*^9, 3.6997095278721046`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "-", 
   RowBox[{"d", " ", "n", " ", "\[Mu]"}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
    SeriesData[$CellContext`\[Mu], 0, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Mu], 0, {1, -$CellContext`d $CellContext`n}, 0, 2,
    1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.699709528137528*^9, 3.699710628816844*^9, 3.699768644340559*^9, 
   3.6997876442139177`*^9, 3.699793831783923*^9, 3.699847453618741*^9, 
   3.6998481177477207`*^9, 3.6998489201632957`*^9, 3.699853737777616*^9, 
   3.699955347297236*^9, 3.702201306310264*^9, 3.702289664332473*^9, 
   3.704178948535757*^9, 3.7045177056573*^9, 3.7053819754795647`*^9, 
   3.7053871878887367`*^9, 3.709989838511971*^9, {3.709990551394704*^9, 
   3.709990559363714*^9}, 3.710045885750225*^9, 3.710049685460968*^9, 
   3.7100540255983458`*^9, 3.710054498245143*^9, 3.710156943564168*^9, 
   3.713407334032131*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations without Self - replacement (dself = 0)", "Subsubsection",
 CellChangeTimes->{{3.699711579833871*^9, 3.699711584927043*^9}, {
  3.699761821670733*^9, 3.699761827557994*^9}, {3.7053849023043747`*^9, 
  3.70538490546406*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QinMw", "=", 
  RowBox[{
   RowBox[{"QinM", "/.", "noselfreplacement"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"QoutMw", "=", 
  RowBox[{
   RowBox[{"QoutM", "/.", "noselfreplacement"}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.699711592836095*^9, 3.699711601325761*^9}, {
  3.699793767821855*^9, 3.699793768748652*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["m", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]"}], "+", 
     
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{"n", "-", 
        RowBox[{"d", " ", "n", " ", "\[Mu]"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["m", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   RowBox[{"m", " ", "n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.6997116019468412`*^9, 3.699768644533671*^9, 3.699787644417185*^9, 
   3.69979383204049*^9, 3.699847454036537*^9, 3.6998481181339483`*^9, 
   3.699848920540834*^9, 3.699853738101304*^9, 3.6999553475849333`*^9, 
   3.702201306731875*^9, 3.7022896646408653`*^9, 3.704178948882905*^9, 
   3.7045177059345617`*^9, 3.705382083512805*^9, 3.7053871881299458`*^9, 
   3.709989869429002*^9, {3.7099905516280603`*^9, 3.7099905595853243`*^9}, 
   3.710046272076508*^9, 3.710049685721094*^9, 3.710054025887533*^9, 
   3.710054498606215*^9, 3.710156943880591*^9, 3.713407334292684*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{"n", "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", "\[Mu]"}], ")"}], 
   " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["m", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   RowBox[{"m", " ", "n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.6997116019468412`*^9, 3.699768644533671*^9, 3.699787644417185*^9, 
   3.69979383204049*^9, 3.699847454036537*^9, 3.6998481181339483`*^9, 
   3.699848920540834*^9, 3.699853738101304*^9, 3.6999553475849333`*^9, 
   3.702201306731875*^9, 3.7022896646408653`*^9, 3.704178948882905*^9, 
   3.7045177059345617`*^9, 3.705382083512805*^9, 3.7053871881299458`*^9, 
   3.709989869429002*^9, {3.7099905516280603`*^9, 3.7099905595853243`*^9}, 
   3.710046272076508*^9, 3.710049685721094*^9, 3.710054025887533*^9, 
   3.710054498606215*^9, 3.710156943880591*^9, 3.713407334326559*^9}]
}, Open  ]],

Cell["Simplify the way they are written", "Text",
 CellChangeTimes->{{3.699761833396513*^9, 3.6997618399413424`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QinMw", "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", "n", " ", "\[Mu]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "m"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "-", "\[Mu]"}], ")"}], " ", "n"}], "-", 
        RowBox[{
         SuperscriptBox["m", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"+", 
        RowBox[{"(", 
         RowBox[{"d", "-", "1"}], ")"}]}], " ", "n", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
      RowBox[{"m", " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]}], ")"}]}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699711609067724*^9, 3.699711686309361*^9}, {
  3.699711723919117*^9, 3.699711751542611*^9}, {3.699711797895731*^9, 
  3.699711864734956*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.699711686662211*^9, 3.699711751870494*^9, {3.699711816592347*^9, 
   3.699711865845346*^9}, 3.699768644600362*^9, 3.699787644466792*^9, 
   3.699793832110257*^9, 3.699847454256627*^9, 3.699848118360941*^9, 
   3.699848920677671*^9, 3.6998537381867332`*^9, 3.6999553476635313`*^9, 
   3.7022013069615297`*^9, 3.702289664866558*^9, 3.704178948975071*^9, 
   3.704517706039962*^9, 3.705382086381508*^9, 3.7053871881938877`*^9, 
   3.709989870934738*^9, {3.70999055167981*^9, 3.7099905596367064`*^9}, 
   3.7100462735697193`*^9, 3.710049685793274*^9, 3.7100540259570208`*^9, 
   3.71005449868565*^9, 3.710156944157042*^9, 3.713407334372147*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QoutMw", "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{"n", "+", 
        RowBox[{"m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", "\[Mu]"}], ")"}],
       " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"+", 
        RowBox[{"(", 
         RowBox[{"d", "-", "1"}], ")"}]}], " ", "n", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
      RowBox[{"m", " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]}], ")"}]}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699711882991263*^9, 3.6997119306666183`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699711887715342*^9, 3.699711931186315*^9}, 
   3.6997119658647413`*^9, 3.6997686446717653`*^9, 3.699787644491955*^9, 
   3.699793832136303*^9, 3.699847454363967*^9, 3.699848118497181*^9, 
   3.6998489207195683`*^9, 3.699853738308305*^9, 3.6999553477646217`*^9, 
   3.702201307137039*^9, 3.702289664955021*^9, 3.704178949023452*^9, 
   3.704517706089518*^9, 3.705382087722787*^9, 3.705387188283839*^9, 
   3.709989872699587*^9, {3.709990551701099*^9, 3.709990559655723*^9}, 
   3.710046275025535*^9, 3.710049685833633*^9, 3.71005402599236*^9, 
   3.71005449875325*^9, 3.710156944268029*^9, 3.7134073343879757`*^9}]
}, Open  ]],

Cell["Limit behavior", "Text",
 CellChangeTimes->{{3.699761843004692*^9, 3.699761846775701*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QinMw", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"%", ",", 
    RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.699712140320222*^9, 3.699712144381168*^9}, {
  3.705382091882864*^9, 3.705382102661297*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "1"}], "+", "m", "+", "\[Mu]", "-", 
   RowBox[{"m", " ", "\[Mu]"}]}], 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}]]], "Output",
 CellChangeTimes->{{3.699712141760172*^9, 3.6997121446551123`*^9}, 
   3.69976864475666*^9, 3.6997876445813713`*^9, 3.69979383222227*^9, 
   3.6998474545895653`*^9, 3.699848118748927*^9, 3.69984892083706*^9, 
   3.6998537385996017`*^9, 3.6999553479241657`*^9, 3.7022013074046917`*^9, 
   3.70228966515206*^9, 3.704178949211241*^9, 3.7045177062678623`*^9, {
   3.705382089870524*^9, 3.7053821029634037`*^9}, 3.70538718836833*^9, 
   3.709989873812937*^9, {3.709990551762856*^9, 3.709990559711013*^9}, 
   3.710046276126759*^9, 3.710049685955085*^9, 3.710054026077231*^9, 
   3.710054498920992*^9, 3.710156944554285*^9, 3.713407334488763*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "-", "m"}], 
  RowBox[{"1", "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "n"}], ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.699712141760172*^9, 3.6997121446551123`*^9}, 
   3.69976864475666*^9, 3.6997876445813713`*^9, 3.69979383222227*^9, 
   3.6998474545895653`*^9, 3.699848118748927*^9, 3.69984892083706*^9, 
   3.6998537385996017`*^9, 3.6999553479241657`*^9, 3.7022013074046917`*^9, 
   3.70228966515206*^9, 3.704178949211241*^9, 3.7045177062678623`*^9, {
   3.705382089870524*^9, 3.7053821029634037`*^9}, 3.70538718836833*^9, 
   3.709989873812937*^9, {3.709990551762856*^9, 3.709990559711013*^9}, 
   3.710046276126759*^9, 3.710049685955085*^9, 3.710054026077231*^9, 
   3.710054498920992*^9, 3.710156944554285*^9, 3.713407334519265*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Limit", "[", 
  RowBox[{"QoutMw", ",", 
   RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Limit", "[", 
  RowBox[{"QoutMw", ",", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.699712130826983*^9, 3.699712135993896*^9}, {
  3.705382111666535*^9, 3.7053821152416763`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.699712136340899*^9, 3.6997686447847843`*^9, 3.699787644605831*^9, 
   3.6997938322542067`*^9, 3.699847454702386*^9, 3.699848118809474*^9, 
   3.699848920892647*^9, 3.699853738738146*^9, 3.699955348164055*^9, 
   3.702201307497787*^9, 3.702289665309238*^9, 3.7041789492668447`*^9, 
   3.704517706398435*^9, 3.705382115731319*^9, 3.705387188430135*^9, 
   3.7099898750301332`*^9, {3.709990551842244*^9, 3.709990559739213*^9}, 
   3.7100462777802267`*^9, 3.710049686036673*^9, 3.710054026183473*^9, 
   3.7100544990007257`*^9, 3.710156944790821*^9, 3.7134073345463943`*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.699712136340899*^9, 3.6997686447847843`*^9, 3.699787644605831*^9, 
   3.6997938322542067`*^9, 3.699847454702386*^9, 3.699848118809474*^9, 
   3.699848920892647*^9, 3.699853738738146*^9, 3.699955348164055*^9, 
   3.702201307497787*^9, 3.702289665309238*^9, 3.7041789492668447`*^9, 
   3.704517706398435*^9, 3.705382115731319*^9, 3.705387188430135*^9, 
   3.7099898750301332`*^9, {3.709990551842244*^9, 3.709990559739213*^9}, 
   3.7100462777802267`*^9, 3.710049686036673*^9, 3.710054026183473*^9, 
   3.7100544990007257`*^9, 3.710156944790821*^9, 3.713407334579516*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wright - Fisher", "Section",
 CellChangeTimes->{{3.698755041677388*^9, 3.698755047045236*^9}}],

Cell["\<\
The structure of this part is the same as for the Moran version above, so \
comments are lighter here.\
\>", "Text",
 CellChangeTimes->{{3.7100462860792913`*^9, 3.710046305307435*^9}}],

Cell[CellGroupData[{

Cell["Simplify QinM and QoutM", "Subsection",
 CellChangeTimes->{{3.7053925967093763`*^9, 3.705392598368638*^9}}],

Cell["\<\
See Appendix B2 for details on how Qself, Qin and Qout were obtained using a \
formula presented in the appendix of Debarre 2017 JTB for \"2D graphs\".\
\>", "Text",
 CellChangeTimes->{{3.7053850217373037`*^9, 3.705385024128645*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"QselfWF2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", " ", "-", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"dself", "-", "din"}], ")"}], "2"]}]}]], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "d"}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "m", "-", 
             FractionBox["m", 
              RowBox[{"d", "-", "1"}]]}], ")"}], "2"]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QinWF2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", " ", "-", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]], "-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"dself", "-", "din"}], ")"}], "2"]}]}]], "d"}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "m", "-", 
             FractionBox["m", 
              RowBox[{"d", "-", "1"}]]}], ")"}], "2"]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QoutWF2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", " ", "-", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]], "-", 
      FractionBox["1", 
       RowBox[{"1", "-", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "m", "-", 
            FractionBox["m", 
             RowBox[{"d", "-", "1"}]]}], ")"}], "2"]}]}]]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6997135185821047`*^9, 3.699713651029313*^9}, {
  3.699793796275002*^9, 3.6997938023562527`*^9}}],

Cell["Find \[Lambda] using Qself == 1", "Text",
 CellChangeTimes->{{3.699768554735057*^9, 3.699768560789783*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Lambda]WF", "=", 
  RowBox[{"\[Lambda]", "/.", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"QselfWF2", "\[Equal]", "1"}], ",", "\[Lambda]"}], "]"}], 
    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}]], "Input",
 CellChangeTimes->{{3.6997136534525347`*^9, 3.699713667340845*^9}, 
   3.699793805199163*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"d", " ", "n"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"1", "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]], "+", 
     FractionBox[
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
      RowBox[{"1", "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "din"}], "+", "dself"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], 
      RowBox[{"1", "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "m", "-", 
           FractionBox["m", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "d"}]]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]}]]}], ")"}], " ", 
   "\[Mu]"}]]], "Output",
 CellChangeTimes->{{3.699713663992773*^9, 3.699713667644438*^9}, 
   3.6997686498867693`*^9, 3.699787648892887*^9, 3.699793840904955*^9, 
   3.699847462821162*^9, 3.699848127086094*^9, 3.699848944043481*^9, 
   3.699853745219801*^9, 3.699955353774413*^9, 3.702201314357094*^9, 
   3.702289671887183*^9, 3.7041789574015827`*^9, 3.704517713153195*^9, 
   3.705382208155657*^9, 3.705387188496587*^9, 3.709989880379635*^9, 
   3.7099905519487133`*^9, 3.710046310259514*^9, 3.710049686132474*^9, 
   3.7100540298370333`*^9, 3.7100544991556787`*^9, 3.710156945301324*^9, 
   3.7134073346076727`*^9}]
}, Open  ]],

Cell["Replace \[Lambda] in the equations", "Text",
 CellChangeTimes->{{3.699768563135151*^9, 3.699768568700657*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QinWF", "=", 
  RowBox[{
   RowBox[{"QinWF2", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", "\[Lambda]WF"}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"QoutWF", "=", 
  RowBox[{
   RowBox[{"QoutWF2", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", "\[Lambda]WF"}]}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.699713671535714*^9, 3.699713691587577*^9}, {
  3.699793806834413*^9, 3.6997938110520763`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox["d", 
     RowBox[{"1", "-", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"din", "-", "dself"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}]}]]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
    RowBox[{"1", "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"din", "-", "dself"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.699713678348674*^9, 3.699713692055463*^9}, 
   3.6997686513293247`*^9, 3.699787650296679*^9, 3.699793842625929*^9, 
   3.699847464903398*^9, 3.699848129275997*^9, 3.699848946322311*^9, 
   3.69985374668642*^9, 3.6999553552201347`*^9, 3.702201315969821*^9, 
   3.7022896737779007`*^9, 3.7041789595883904`*^9, 3.704517714606336*^9, 
   3.705382210606203*^9, 3.705387190408545*^9, 3.709989882981759*^9, 
   3.709990553462431*^9, 3.710046313245983*^9, 3.7100496882054787`*^9, 
   3.71005403169142*^9, 3.710054501055789*^9, 3.7101569472870493`*^9, 
   3.7134073368716087`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
    RowBox[{"1", "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"din", "-", "dself"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.699713678348674*^9, 3.699713692055463*^9}, 
   3.6997686513293247`*^9, 3.699787650296679*^9, 3.699793842625929*^9, 
   3.699847464903398*^9, 3.699848129275997*^9, 3.699848946322311*^9, 
   3.69985374668642*^9, 3.6999553552201347`*^9, 3.702201315969821*^9, 
   3.7022896737779007`*^9, 3.7041789595883904`*^9, 3.704517714606336*^9, 
   3.705382210606203*^9, 3.705387190408545*^9, 3.709989882981759*^9, 
   3.709990553462431*^9, 3.710046313245983*^9, 3.7100496882054787`*^9, 
   3.71005403169142*^9, 3.710054501055789*^9, 3.7101569472870493`*^9, 
   3.7134073372197866`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check numerically", "Subsection",
 CellChangeTimes->{{3.705383839778914*^9, 3.7053838430531073`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NGetQWF", "[", 
   RowBox[{
   "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "p_", ",", 
    "\[Mu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"QT", ",", "eqs", ",", "vars", ",", "sols", ",", "QTs"}], "}"}], 
    ",", 
    RowBox[{"(*", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", " ", "is", " ", "the", " ", "dispersal", " ", "graph"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
      "\[CapitalNu]", " ", "is", " ", "the", " ", "size", " ", "of", " ", 
       "the", " ", "population"}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "graphdegree", " ", "is", " ", "the", " ", "degree", " ", "of", " ", 
       "the", " ", "graph", " ", 
       RowBox[{"(", 
        RowBox[{"=", 
         RowBox[{"1", " ", "in", " ", "a", " ", "subdivided", " ", "pop"}]}], 
        ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "is", " ", "the", " ", "mutation", " ", "biais"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]", " ", "is", " ", "the", " ", "mutation", " ", 
       RowBox[{"probability", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Initialize", " ", "the", " ", "QT", " ", "matrix"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], "=", "0"}], ";", 
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], "=."}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"QT", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        SubscriptBox["Q", 
         RowBox[{"i", ",", "j"}]], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QT", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], "=", "1"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       SubscriptBox["Q", 
        RowBox[{"i", ",", "i"}]], "=", "1"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QT", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
        SubscriptBox["Q", 
         RowBox[{"j", ",", "i"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"j", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Because", " ", "Q", " ", "is", " ", "symmetric"}], " ", "*)"}],
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["Q", 
           RowBox[{"i", ",", "j"}]], "\[Equal]", 
          RowBox[{
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
            SuperscriptBox["graphdegree", "2"]], 
           RowBox[{"(", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"G", "\[LeftDoubleBracket]", 
                RowBox[{"l", ",", "j"}], "\[RightDoubleBracket]"}], 
               RowBox[{"G", "\[LeftDoubleBracket]", 
                RowBox[{"k", ",", "i"}], "\[RightDoubleBracket]"}], 
               RowBox[{"QT", "\[LeftDoubleBracket]", 
                RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
            ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sols", "=", 
      RowBox[{"NSolve", "[", 
       RowBox[{"eqs", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"QTs", "=", 
      RowBox[{"QT", "/.", 
       RowBox[{
       "sols", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", "QTs"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.710046837714695*^9, 3.710046841508738*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"prs", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CheckQWF", "[", 
   RowBox[{"prs_", ",", "dvalues_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NG", ",", "NQin", ",", "NQout", ",", "NQinMatrix"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NG", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<G\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"d", " ", "n"}], "/.", "prs"}], "]"}], "<>", 
          "\"\<generic\>\""}], "]"}], "/.", "dvalues"}], "/.", "prs"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"NQinMatrix", "=", 
      RowBox[{"NGetQWF", "[", 
       RowBox[{"NG", ",", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "/.", "prs"}], ",", "1", ",", "0.5", ",", 
        RowBox[{"\[Mu]", "/.", "prs"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NQin", "=", 
      RowBox[{"NQinMatrix", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NQout", "=", 
      RowBox[{"NQinMatrix", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "/.", "prs"}]}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Qin\>\"", ",", "NQin", ",", 
            RowBox[{
             RowBox[{"QinWF", "/.", "dvalues"}], "/.", "prs"}]}], "}"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"\"\<Qout\>\"", ",", "NQout", ",", 
            RowBox[{
             RowBox[{"QoutWF", "/.", "dvalues"}], "/.", "prs"}]}], "}"}]}], 
         "}"}], "//", "Transpose"}], "//", "MatrixForm"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.705383847090728*^9, 3.705383857404091*^9}, {
  3.7053838996520348`*^9, 3.7053839022914953`*^9}, {3.710046333220248*^9, 
  3.71004636876978*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"CheckQWF", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}], ",", 
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", 
   "withselfreplacement"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"CheckQWF", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}], ",", 
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", "noselfreplacement"}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"CheckQWF", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "2"}], ",", 
     RowBox[{"n", "\[Rule]", "5"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", 
   "withselfreplacement"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"CheckQWF", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "2"}], ",", 
     RowBox[{"n", "\[Rule]", "5"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", "noselfreplacement"}],
   "]"}]}], "Input",
 CellChangeTimes->{{3.705383847090728*^9, 3.705383857404091*^9}, {
  3.7053838996520348`*^9, 3.7053839022914953`*^9}, {3.710046333220248*^9, 
  3.710046381231841*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.21835246847214482`", "0.08161535624318243`"},
     {"0.21835246847214485`", "0.08161535624318234`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.70538389339319*^9, 3.705383903192623*^9}, 
   3.7053871909954557`*^9, 3.7099898974331007`*^9, 3.709990553945369*^9, 
   3.71004631687917*^9, {3.710046356579269*^9, 3.710046381920025*^9}, 
   3.7100468461683073`*^9, 3.710049688721513*^9, 3.710054032116688*^9, 
   3.710054501687112*^9, 3.710156948167297*^9, 3.71340733740383*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.17804414067103275`", "0.07703574013905495`"},
     {"0.17804414067103244`", "0.07703574013905486`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.70538389339319*^9, 3.705383903192623*^9}, 
   3.7053871909954557`*^9, 3.7099898974331007`*^9, 3.709990553945369*^9, 
   3.71004631687917*^9, {3.710046356579269*^9, 3.710046381920025*^9}, 
   3.7100468461683073`*^9, 3.710049688721513*^9, 3.710054032116688*^9, 
   3.710054501687112*^9, 3.710156948167297*^9, 3.713407337497966*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.171990359970927`", "0.1224130675949659`"},
     {"0.17199035997092688`", "0.12241306759496573`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.70538389339319*^9, 3.705383903192623*^9}, 
   3.7053871909954557`*^9, 3.7099898974331007`*^9, 3.709990553945369*^9, 
   3.71004631687917*^9, {3.710046356579269*^9, 3.710046381920025*^9}, 
   3.7100468461683073`*^9, 3.710049688721513*^9, 3.710054032116688*^9, 
   3.710054501687112*^9, 3.710156948167297*^9, 3.713407337553334*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.16477201691061744`", "0.12031913465055881`"},
     {"0.16477201691061727`", "0.12031913465055864`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.70538389339319*^9, 3.705383903192623*^9}, 
   3.7053871909954557`*^9, 3.7099898974331007`*^9, 3.709990553945369*^9, 
   3.71004631687917*^9, {3.710046356579269*^9, 3.710046381920025*^9}, 
   3.7100468461683073`*^9, 3.710049688721513*^9, 3.710054032116688*^9, 
   3.710054501687112*^9, 3.710156948167297*^9, 3.71340733760526*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Particular cases", "Subsection",
 CellChangeTimes->{{3.7099899437833014`*^9, 3.70998994895147*^9}}],

Cell[CellGroupData[{

Cell["With Self Replacement", "Subsubsection",
 CellChangeTimes->{{3.699713697718473*^9, 3.699713702474758*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QinWFs", "=", 
  RowBox[{
   RowBox[{"QinWF", "/.", "withselfreplacement"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699713715219798*^9, 3.699713729121462*^9}, 
   3.6997938139913893`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "d"}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.6997137205942917`*^9, 3.6997137296346273`*^9}, 
   3.6997686517538443`*^9, 3.6997876505973454`*^9, 3.699793843963087*^9, 
   3.699847465465046*^9, 3.69984812985738*^9, 3.699848946767274*^9, 
   3.699853747064089*^9, 3.699955355684174*^9, 3.702201316414547*^9, 
   3.7022896743934183`*^9, 3.7041789601167593`*^9, 3.704517715073738*^9, 
   3.705382211114374*^9, 3.705387191365016*^9, 3.709989902727758*^9, 
   3.709990554071863*^9, 3.710046388215872*^9, 3.710049689182773*^9, 
   3.7100540325722713`*^9, 3.7100545020664988`*^9, 3.710156948694996*^9, 
   3.713407337873167*^9}]
}, Open  ]],

Cell["Simplify the way it is written", "Text",
 CellChangeTimes->{{3.710046422562079*^9, 3.710046428585051*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M1", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M2", "=", 
    FractionBox["1", 
     RowBox[{
      RowBox[{"2", " ", "\[Mu]"}], "-", 
      SuperscriptBox["\[Mu]", "2"]}]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qinwfs", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "d"}], " ", "+", " ", "M1", "+", "M2"}], 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}], "d"}], "+", "M1", "+", "M2"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QinWFs", " ", "-", " ", "qinwfs"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.704715667696094*^9, 3.70471569325393*^9}, {
  3.71004644570728*^9, 3.710046446146241*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.710046446538151*^9, 3.7100496892133427`*^9, 
  3.710054032601166*^9, 3.710054502132368*^9, 3.7101569488466187`*^9, 
  3.7134073378947353`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QoutWFs", "=", 
  RowBox[{
   RowBox[{"QoutWF", "/.", "withselfreplacement"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.69971376959558*^9, 3.699713781778393*^9}, 
   3.699793816389996*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{3.699713782107119*^9, 3.6997686518296843`*^9, 
  3.699787650721113*^9, 3.699793844171132*^9, 3.699847465709929*^9, 
  3.699848130119707*^9, 3.699848946820631*^9, 3.69985374730326*^9, 
  3.6999553558645163`*^9, 3.702201316667905*^9, 3.702289674700729*^9, 
  3.7041789602895823`*^9, 3.704517715379057*^9, 3.7053822164241*^9, 
  3.7053871914895887`*^9, 3.70998990368915*^9, 3.70999055422438*^9, 
  3.710046389301339*^9, 3.710049689296924*^9, 3.710054032672058*^9, 
  3.710054502279993*^9, 3.710156949101604*^9, 3.713407337961378*^9}]
}, Open  ]],

Cell["Simplify the way it is written", "Text",
 CellChangeTimes->{{3.7100464596730213`*^9, 3.710046464870203*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qoutwfs", "=", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"-", "1"}], 
        RowBox[{"d", "-", "1"}]], "M1"}], "+", "M2"}], 
     RowBox[{
      RowBox[{"d", 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}], "+", "M1", "+", "M2"}]], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qoutwfs", "-", "QoutWFs"}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.710046466715753*^9, 3.710046475975423*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.710046473334022*^9, 3.710046476392544*^9}, 
   3.710049689325638*^9, 3.7100540327022533`*^9, 3.710054502293746*^9, 
   3.71015694919741*^9, 3.713407337989614*^9}]
}, Open  ]],

Cell["Limit behavior", "Text",
 CellChangeTimes->{{3.705385041146565*^9, 3.70538504847071*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Limit", "[", 
  RowBox[{"QinWFs", ",", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Limit", "[", 
  RowBox[{"QoutWFs", ",", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7053850501521*^9, 3.705385108098117*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.7053851085939703`*^9, 3.705387191627996*^9, 
  3.7099899052270317`*^9, 3.709990554245013*^9, 3.710046390154361*^9, 
  3.710049689383913*^9, 3.710054032821878*^9, 3.71005450246974*^9, 
  3.7101569493481092`*^9, 3.7134073381801767`*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.7053851085939703`*^9, 3.705387191627996*^9, 
  3.7099899052270317`*^9, 3.709990554245013*^9, 3.710046390154361*^9, 
  3.710049689383913*^9, 3.710054032821878*^9, 3.71005450246974*^9, 
  3.7101569493481092`*^9, 3.713407338218832*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QinWFs", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"%", ",", 
    RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7053850501521*^9, 3.705385099592635*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "1"}], "-", 
    RowBox[{"2", " ", "m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["m", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", 
     "\[Mu]"}]}]]}]], "Output",
 CellChangeTimes->{{3.7053850729698668`*^9, 3.705385099935501*^9}, 
   3.7053871919399967`*^9, 3.7099899065603447`*^9, 3.709990554385026*^9, 
   3.7100463911668177`*^9, 3.710049689690675*^9, 3.710054033106924*^9, 
   3.7100545028536243`*^9, 3.7101569496858053`*^9, 3.713407338656136*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}]]}]], "Output",
 CellChangeTimes->{{3.7053850729698668`*^9, 3.705385099935501*^9}, 
   3.7053871919399967`*^9, 3.7099899065603447`*^9, 3.709990554385026*^9, 
   3.7100463911668177`*^9, 3.710049689690675*^9, 3.710054033106924*^9, 
   3.7100545028536243`*^9, 3.7101569496858053`*^9, 3.713407338699437*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QoutWFs", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.705385116067935*^9, 3.705385122312422*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.7053851175044403`*^9, 3.7053851229146233`*^9}, 
   3.705387192135598*^9, 3.7099899076389303`*^9, 3.7099905544255743`*^9, 
   3.710046392165245*^9, 3.710049689859709*^9, 3.710054033248378*^9, 
   3.710054503002428*^9, 3.710156949996866*^9, 3.7134073387900457`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Comparison to Cockerham and Weir 1987", "Subsubsection",
 CellChangeTimes->{{3.7101558010783978`*^9, 3.710155812523353*^9}}],

Cell["Cockerham and Weir\[CloseCurlyQuote]s \[Beta]", "Text",
 CellChangeTimes->{{3.7101533456316957`*^9, 3.710153350912513*^9}, {
  3.710155679639537*^9, 3.7101556816751003`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dd", " ", "=", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", " ", 
       FractionBox["nbdemes", 
        RowBox[{"nbdemes", "-", "1"}]]}]}], ")"}], "2"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", "=", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7101533589980097`*^9, 3.710153431778693*^9}, {
   3.7101534922471943`*^9, 3.710153506936021*^9}, 3.710153933234684*^9, 
   3.710155690597134*^9, 3.710155742896264*^9}],

Cell["\<\
Update deme size, which is 2 N in their paper, to N, to adapt the result to a \
haploid population\
\>", "Text",
 CellChangeTimes->{{3.7101556954302807`*^9, 3.7101557143671417`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[Beta]", " ", "=", " ", 
  RowBox[{
   RowBox[{"\[Rho]", " ", 
    RowBox[{"dd", " ", "/", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"demesize", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"\[Rho]", " ", "dd"}]}], ")"}]}], "+", 
       RowBox[{"\[Rho]", " ", "dd"}]}], ")"}]}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", "=."}], ";", 
  RowBox[{"dd", "=."}], ";"}]}], "Input",
 CellChangeTimes->{{3.7101533589980097`*^9, 3.710153431778693*^9}, {
   3.7101534922471943`*^9, 3.710153506936021*^9}, 3.710153933234684*^9, {
   3.710155690597134*^9, 3.710155694185615*^9}, {3.7101557458729973`*^9, 
   3.710155766567562*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "nbdemes"}]}], ")"}], 
    "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "nbdemes"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"demesize", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "nbdemes"}]}], 
            ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "nbdemes"}], ")"}], "2"]]}], ")"}]}], 
     "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "nbdemes"}]}], ")"}],
         "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "nbdemes"}], ")"}], "2"]]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{{3.710153415668852*^9, 3.7101534323330593`*^9}, {
   3.7101534965249243`*^9, 3.710153507959269*^9}, 3.710153935736274*^9, 
   3.710153989895019*^9, {3.710155753039229*^9, 3.710155770064417*^9}, 
   3.710156950895701*^9, 3.7134073398087*^9}]
}, Open  ]],

Cell["For us:", "Text",
 CellChangeTimes->{{3.710153511616827*^9, 3.710153517064158*^9}, {
  3.7101557182870827`*^9, 3.710155719678792*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"my\[Beta]", "=", 
  RowBox[{
   FractionBox[
    RowBox[{"QinWF", "-", "QoutWF"}], 
    RowBox[{"1", "-", "QoutWF"}]], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.7101535909793243`*^9, 3.710153618436535*^9}, {
  3.710155736968443*^9, 3.710155754666039*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"din", "-", "dself"}], ")"}], "2"]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "d", " ", "m"}], "-", 
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       SuperscriptBox["m", "2"]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", 
    RowBox[{"2", " ", "\[Mu]"}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", "n"}], ")"}], " ", 
     "\[Mu]"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", "n"}], ")"}], " ", 
     SuperscriptBox["\[Mu]", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
       RowBox[{"2", " ", "\[Mu]"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", "n"}], ")"}], " ", 
        "\[Mu]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
        SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}], "+", 
    RowBox[{"2", " ", "d", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"din", "-", "dself"}], ")"}], "2"], "-", "m", "+", 
       RowBox[{"m", " ", "n"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", "m", "+", "n", 
          "-", 
          RowBox[{"m", " ", "n"}]}], ")"}], " ", "\[Mu]"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", "m", "+", "n", 
          "-", 
          RowBox[{"m", " ", "n"}]}], ")"}], " ", 
        SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.710153612255775*^9, 3.710153619120739*^9}, 
   3.7101539400130787`*^9, 3.710153994000152*^9, {3.710155755518497*^9, 
   3.710155771191538*^9}, 3.710156952359514*^9, 3.713407342261114*^9}]
}, Open  ]],

Cell["Compare the two -> same !", "Text",
 CellChangeTimes->{{3.710155774070763*^9, 3.710155783048971*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"my\[Beta]", "-", "\[Beta]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"nbdemes", "\[Rule]", "d"}], ",", 
     RowBox[{"demesize", "\[Rule]", "n"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.710153631178689*^9, 3.710153648804803*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"d", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
              " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}], ")"}]}], "+", 
         
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"d", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
           
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}], ")"}]}]]}], "+", 
    
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"din", "-", "dself"}], ")"}], "2"]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "d", " ", "m"}], "-", 
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SuperscriptBox["m", "2"]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", 
       RowBox[{"2", " ", "\[Mu]"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", "n"}], ")"}], 
        " ", "\[Mu]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", "n"}], ")"}], 
        " ", 
        SuperscriptBox["\[Mu]", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
          RowBox[{"2", " ", "\[Mu]"}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", "n"}], ")"}], 
           " ", "\[Mu]"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
           SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}], "+", 
       RowBox[{"2", " ", "d", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"din", "-", "dself"}], ")"}], "2"], "-", "m", "+", 
          RowBox[{"m", " ", "n"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", "m", "+", "n",
              "-", 
             RowBox[{"m", " ", "n"}]}], ")"}], " ", "\[Mu]"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"din", "-", "dself"}], ")"}], "2"], "+", "m", "+", "n",
              "-", 
             RowBox[{"m", " ", "n"}]}], ")"}], " ", 
           SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.710153644453782*^9, 3.710153649486642*^9}, {
   3.710153977518886*^9, 3.710153996770756*^9}, {3.710155757055417*^9, 
   3.710155772257462*^9}, 3.7101569568974047`*^9, 3.713407348314444*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]", "=."}], ";", 
  RowBox[{"my\[Beta]", "=."}], ";"}]], "Input",
 CellChangeTimes->{{3.710155827463566*^9, 3.710155833449524*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Without Self Replacement", "Subsubsection",
 CellChangeTimes->{{3.699713697718473*^9, 3.699713702474758*^9}, {
  3.6997140344242887`*^9, 3.6997140345381327`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QinWFw", "=", 
  RowBox[{
   RowBox[{"QinWF", "/.", "noselfreplacement"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699713715219798*^9, 3.699713729121462*^9}, {
   3.699714032451695*^9, 3.699714037934367*^9}, 3.699793818749946*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
   FractionBox["d", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox[
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.6997137205942917`*^9, 3.6997137296346273`*^9}, 
   3.699714039975412*^9, 3.699768653054854*^9, 3.699787652032732*^9, 
   3.6997938456645737`*^9, 3.699847467487503*^9, 3.6998481320938587`*^9, 
   3.6998489485357647`*^9, 3.699853748614737*^9, 3.699955357081094*^9, 
   3.702201318097715*^9, 3.702289676445603*^9, 3.704178962090172*^9, 
   3.7045177167620573`*^9, 3.705382220777729*^9, 3.7053871936452217`*^9, 
   3.70998991030722*^9, 3.7099905553194304`*^9, 3.7100464851628847`*^9, 
   3.71004969115324*^9, 3.7100540344483*^9, 3.710054504229106*^9, 
   3.710156958417386*^9, 3.7134073501330633`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QoutWFw", "=", 
  RowBox[{
   RowBox[{"QoutWF", "/.", "noselfreplacement"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.69971376959558*^9, 3.699713781778393*^9}, {
   3.699714043938485*^9, 3.699714047373885*^9}, 3.6997938202130213`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox[
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{3.699713782107119*^9, 3.699714048290897*^9, 
  3.6997686532808933`*^9, 3.699787652287928*^9, 3.6997938458919277`*^9, 
  3.699847467901083*^9, 3.6998481326015472`*^9, 3.699848948881896*^9, 
  3.699853748947424*^9, 3.699955357392652*^9, 3.7022013184846163`*^9, 
  3.70228967685288*^9, 3.704178962424152*^9, 3.7045177171525517`*^9, 
  3.705382220970962*^9, 3.7053871941159887`*^9, 3.70998991061347*^9, 
  3.709990555540123*^9, 3.7100464856492453`*^9, 3.710049691371263*^9, 
  3.7100540346669807`*^9, 3.710054504572701*^9, 3.7101569588867083`*^9, 
  3.71340735044776*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export to R the Q results", "Section",
 CellChangeTimes->{{3.702201500553801*^9, 3.702201503237453*^9}, {
  3.704803404476313*^9, 3.7048034064996977`*^9}}],

Cell["Rewrite the Greek letters", "Text",
 CellChangeTimes->{{3.702202576100587*^9, 3.702202585533182*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GreekTerms", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Omega]", "\[Rule]", "sel"}], ",", " ", 
    RowBox[{"\[Mu]", "\[Rule]", "mut"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.702201509383871*^9, 3.702201525212894*^9}, {
  3.704724390807227*^9, 3.70472439943757*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Omega]", "\[Rule]", "sel"}], ",", 
   RowBox[{"\[Mu]", "\[Rule]", "mut"}]}], "}"}]], "Output",
 CellChangeTimes->{3.70220152616304*^9, 3.7022030131218777`*^9, 
  3.7022897635244837`*^9, 3.704179086467165*^9, 3.7045177944473457`*^9, 
  3.704724393799959*^9, 3.7047246634923162`*^9, 3.704736510164259*^9, 
  3.710054037836182*^9, 3.710054504691545*^9, 3.7101569590860987`*^9, 
  3.713407350476017*^9}]
}, Open  ]],

Cell["Common parts to all functions", "Text",
 CellChangeTimes->{{3.7022025881711607`*^9, 3.7022025922143908`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "FunctionPartB", "=", 
   "\"\< <- function(p, sel, mut, m, g, n, d, Idself, Ieself){\n## Arguments:\
\n#  p   mutation bias\n#  sel intensity of selection\n#  mut mutation \
probability\n#  m   emigration probability\n#  g   proportion of interactions \
out of the group (interaction equivalent of m)\n#  n   deme size\n#  d   \
number of demes\n#  Idself whether reproduction in site where the parent is\n\
#  Ieself whether interactions with oneself\nreturn(\n\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FunctionPartE", "=", "\"\<)\n}\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.702201586590098*^9, 3.702201660652206*^9}, {
  3.702202515399782*^9, 3.70220251599327*^9}, {3.702202562602117*^9, 
  3.702202562914797*^9}, {3.702202598064639*^9, 3.702202697296604*^9}, {
  3.702202988690043*^9, 3.702203007885222*^9}, {3.704724417045898*^9, 
  3.7047244695037813`*^9}}],

Cell["Function to translate Mathematica to R", "Text",
 CellChangeTimes->{{3.702202703211164*^9, 3.702202713861825*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToRForm", "[", "x_", "]"}], ":=", 
  RowBox[{"ToString", "[", 
   RowBox[{
    RowBox[{"x", "/.", "GreekTerms"}], "//", "CForm"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.702201842966589*^9, 3.702201859620515*^9}}],

Cell["Do it for Q", "Text",
 CellChangeTimes->{{3.704724511134218*^9, 3.704724513442933*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RtxtQinM", "=", 
   RowBox[{"\"\<QinM \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{"QinM", "/.", "genericde"}], "//", "FullSimplify"}], "]"}], "<>",
     "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtQoutM", "=", 
   RowBox[{"\"\<QoutM \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{"QoutM", "/.", "genericde"}], "//", "FullSimplify"}], "]"}], "<>",
     "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtQinWF", "=", 
   RowBox[{"\"\<QinWF \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{"QinWF", "/.", "genericde"}], "//", "FullSimplify"}], "]"}], "<>",
     "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtQoutWF", "=", 
   RowBox[{"\"\<QoutWF \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{"QoutWF", "/.", "genericde"}], "//", "FullSimplify"}], "]"}], "<>",
     "FunctionPartE"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.704724517750942*^9, 3.704724604063252*^9}}],

Cell["Define Power function in R", "Text",
 CellChangeTimes->{{3.7022027318210173`*^9, 3.702202737612219*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PowerDef", "=", "\"\<Power <- function(a,b) return(a^b)\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.702201909153489*^9, 3.7022019359137297`*^9}, {
  3.7022019780679827`*^9, 3.702201985090732*^9}}],

Cell["Combine all texts", "Text",
 CellChangeTimes->{{3.702202739839615*^9, 3.702202745125101*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rtxt", "=", 
   RowBox[{
   "PowerDef", "<>", "\"\<\n\n\>\"", "<>", "RtxtQinM", "<>", "\"\<\n\n\>\"", "<>",
     "RtxtQoutM", "<>", "\"\<\n\n\>\"", "<>", "RtxtQinWF", "<>", 
    "\"\<\n\n\>\"", "<>", "RtxtQoutWF"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7022019405139227`*^9, 3.702201966147601*^9}, {
  3.7047246131819277`*^9, 3.704724637059588*^9}}],

Cell["Export to txt file (Mathematica did not want R)", "Text",
 CellChangeTimes->{{3.702202748144455*^9, 3.70220275825738*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"pathtosave", "<>", "\"\<Mathematica/analyticsQ.txt\>\""}], ",", 
    "Rtxt"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.702201967861699*^9, 3.702202007961507*^9}, {
   3.702202094017145*^9, 3.7022021946253023`*^9}, 3.7047246446676083`*^9, {
   3.710054058242139*^9, 3.710054064754195*^9}, 3.7100544433043947`*^9}],

Cell["Convert the file extension to R", "Text",
 CellChangeTimes->{{3.702202760522964*^9, 3.702202776867174*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cmd", "=", 
   RowBox[{
   "\"\<mv \>\"", "<>", "pathtosave", "<>", 
    "\"\<Mathematica/analyticsQ.txt \>\"", "<>", "pathtosave", "<>", 
    "\"\<Mathematica/analyticsQ.R\>\""}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7100540725428658`*^9, 3.710054132681882*^9}}],

Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{"\"\<!\>\"", "<>", "cmd"}], "]"}]], "Input",
 CellChangeTimes->{{3.71005413757959*^9, 3.710054140750166*^9}, {
  3.7100541794834137`*^9, 3.710054181106045*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2) Expected Frequency Equations", "Title",
 CellChangeTimes->{{3.699768851984043*^9, 3.699768858124469*^9}, {
  3.710048459761939*^9, 3.710048460391974*^9}}],

Cell[CellGroupData[{

Cell["Formulas for the different life-cycles", "Section",
 CellChangeTimes->{{3.699768859805334*^9, 3.699768867744869*^9}, {
  3.705387119787652*^9, 3.705387127043717*^9}}],

Cell["\<\
The formulas for each term is obtained by hand, by replacing the dispersal \
and interaction graphs by their formulas in a subdivided population, from the \
equations given in Appendix B1. In some cases (e.g., \[Beta]I for the Moran \
DB life-cycle), there is a large number of cases to consider when unpacking \
the sums. 
D corresponds to direct / primary effects,
I corresponds to indirect / secondary effects. \
\>", "Text",
 CellChangeTimes->{{3.705385172637076*^9, 3.705385179189186*^9}, {
  3.7099900011579723`*^9, 3.709990009774757*^9}, {3.709990043198502*^9, 
  3.70999004982239*^9}, {3.7100468534555197`*^9, 3.710046912245219*^9}, {
  3.710046964544293*^9, 3.710046983885819*^9}, {3.710047084744001*^9, 
  3.71004711913234*^9}}],

Cell[CellGroupData[{

Cell["Moran, Birth-Death", "Subsection",
 CellChangeTimes->{{3.699788303462345*^9, 3.699788307241809*^9}, {
  3.705387130107669*^9, 3.7053871363953457`*^9}}],

Cell[CellGroupData[{

Cell["\[Beta]", "Subsubsection",
 CellChangeTimes->{{3.699768872084917*^9, 3.699768873677112*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]BDD", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"eself", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "ein", " ", "Qin"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "eout", " ", "Qout"}]}], 
     ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699768876066028*^9, 3.699768891232036*^9}, {
  3.699768961189538*^9, 3.699768983541917*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]BDI", "=", 
   RowBox[{
    RowBox[{"dself", " ", "eself"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], "din", " ", "ein"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", "d"}], " ", "-", "n"}], " ", ")"}], "dout", " ", 
     "eout"}], 
    RowBox[{"(*", "\[IndentingNewLine]", "*)"}], "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"din", " ", "eself"}], " ", "+", " ", 
       RowBox[{"dself", " ", "ein"}], " ", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "2"}], ")"}], "din", " ", "ein"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], "dout", " ", 
        "eout"}]}], ")"}], "Qin"}], " ", 
    RowBox[{"(*", "\[IndentingNewLine]", "*)"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", "d"}], " ", "-", " ", "n"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dself", " ", "eout"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "din", " ", "eout"}], " ", "+", " ", 
       
       RowBox[{"dout", " ", "eself"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "ein"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "d"}], " ", "-", 
          RowBox[{"2", "n"}]}], ")"}], "dout", " ", "eout"}]}], ")"}], 
     "Qout"}], 
    RowBox[{"(*", "\[IndentingNewLine]", "*)"}], "-", 
    RowBox[{
     FractionBox["\[Mu]", 
      RowBox[{"n", " ", "d"}]], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "Qin"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], "Qout"}]}], ")"}], 
     
     RowBox[{"(", 
      RowBox[{"eself", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "ein"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "eout"}]}], ")"}]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.69976898989773*^9, 3.699769149062419*^9}, {
  3.699783552293282*^9, 3.699783562281807*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"factorBD", "=", 
  FractionBox[
   RowBox[{"p", 
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}]}], "\[Mu]"]}]], "Input",
 CellChangeTimes->{{3.6997810044037027`*^9, 3.699781013324629*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], " ", "p"}], "\[Mu]"]], "Output",
 CellChangeTimes->{3.699781014738659*^9, 3.6997838030770693`*^9, 
  3.699784269757339*^9, 3.6997877195844793`*^9, 3.699793866547782*^9, 
  3.699847509848752*^9, 3.6998489929737797`*^9, 3.699853749222508*^9, 
  3.699955357639187*^9, 3.702201318696995*^9, 3.702289677094816*^9, 
  3.7041789624936743`*^9, 3.7045177173812933`*^9, 3.7053855253985558`*^9, 
  3.705385746169188*^9, 3.709990054876704*^9, 3.709990584352785*^9, 
  3.710046995960639*^9, 3.7100496914174633`*^9, 3.710054304576977*^9, 
  3.710054510445734*^9, 3.710156967486904*^9, 3.713407360864963*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]BD", "=", 
   RowBox[{"factorBD", 
    RowBox[{"(", 
     RowBox[{"\[Beta]BDD", "-", "\[Beta]BDI"}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699781018565494*^9, 3.699781031469839*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Gamma]", "Subsubsection",
 CellChangeTimes->{{3.699787927626891*^9, 3.699787929439444*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]BDD", "=", 
   RowBox[{"1", "-", "\[Mu]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699787932024872*^9, 3.699787942256565*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]BDI", "=", 
   RowBox[{"dself", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], "din", " ", "Qin"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", "Qout"}], "-", 
    RowBox[{
     FractionBox["\[Mu]", 
      RowBox[{"n", " ", "d"}]], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "Qin"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "Qout"}]}], ")"}]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.6997879444913797`*^9, 3.6997879865015497`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]BD", "=", 
  RowBox[{
   RowBox[{"factorBD", 
    RowBox[{"(", 
     RowBox[{"\[Gamma]BDD", "-", "\[Gamma]BDI"}], ")"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699787990021633*^9, 3.699788004937168*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "dself", "+", 
        RowBox[{"din", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "dout", " ", "n", " ", 
         "Qout"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "Qin", "+", 
        RowBox[{"n", " ", 
         RowBox[{"(", 
          RowBox[{"d", "-", "Qin", "+", "Qout", "-", 
           RowBox[{"d", " ", "Qout"}]}], ")"}]}]}], ")"}], " ", "\[Mu]"}]}], 
    ")"}]}], 
  RowBox[{"d", " ", "n", " ", "\[Mu]"}]]], "Output",
 CellChangeTimes->{{3.6997880018981028`*^9, 3.699788005307209*^9}, 
   3.699793867687854*^9, 3.699847510539104*^9, 3.699848993407742*^9, 
   3.699853749752069*^9, 3.6999553580700197`*^9, 3.702201319343082*^9, 
   3.702289677567067*^9, 3.7041789628852587`*^9, 3.7045177179484787`*^9, 
   3.70538552563669*^9, 3.7053857493865147`*^9, 3.70999005510261*^9, 
   3.709990584634004*^9, 3.710047000000866*^9, 3.710049691737043*^9, 
   3.7100543048914223`*^9, 3.710054510902038*^9, 3.7101569679797*^9, 
   3.713407361156756*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moran, Death-Birth", "Subsection",
 CellChangeTimes->{{3.6997882937760963`*^9, 3.699788365013695*^9}}],

Cell[CellGroupData[{

Cell["\[Beta]", "Subsubsection",
 CellChangeTimes->{{3.6997883477895412`*^9, 3.69978834940098*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]DBD", "=", "\[Beta]BDD"}]], "Input",
 CellChangeTimes->{{3.699788350622011*^9, 3.699788367592432*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"eself", "+", 
    RowBox[{"ein", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
    RowBox[{"eout", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "n"}], "+", 
       RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", "\[Mu]"}], ")"}]}]], "Output",
 CellChangeTimes->{3.699788368875032*^9, 3.699793867805636*^9, 
  3.699847510687601*^9, 3.699848999986759*^9, 3.699853749950212*^9, 
  3.699955358165345*^9, 3.7022013195009747`*^9, 3.702289677727807*^9, 
  3.704178962940996*^9, 3.704517718153728*^9, 3.705385528716528*^9, 
  3.7053857544696503`*^9, 3.70999005511514*^9, 3.7099905846572647`*^9, 
  3.7100470023149157`*^9, 3.7100496917726088`*^9, 3.710054304921584*^9, 
  3.710054511039755*^9, 3.710156968077525*^9, 3.713407361186426*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]DBI", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1", "*", "dself", " ", "dself", " ", "eself", "*", "1"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "02", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dself", " ", "din", " ", "ein", " ", 
       "*", "1"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "03", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dself", " ", "dout", 
       " ", "eout", " ", "*", "1"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "04", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dself", " ", "dself", " ", "ein", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "05", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "dself", " ", "din", " ", 
       "eself", " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "06", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "dself", " ", "din", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "07", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], " ", "dself", " ", 
       "dout", " ", "eout", " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "08", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], "dself", " ", 
       "dself", " ", "eout", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "09", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "dself", " ", "din", " ", "eout",
        " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "10", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], "dself", " ", 
       "dout", " ", "eself", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "11", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "dself", " ", "dout", " ", "ein",
        " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "12", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], " ", "dself", " ", "dout", " ", "eout", 
       " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "13", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "din", " ", "dself", " ", "eself", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "14", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "din", " ", "din", " ", "ein", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "15", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "din", " ", "din", " ", "ein", " ", 
       "Qin"}], " ", 
      RowBox[{"(*", "\[IndentingNewLine]", "16", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], "din", " ", "dout", 
       " ", "eout", " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "17", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "din", " ", "dself", " ", "ein"}], 
      " ", 
      RowBox[{"(*", "\[IndentingNewLine]", "18", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "din", " ", "din", " ", "eself"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "19", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "din", " ", "din", " ", "ein"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "20", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "din", " ", "dout", " ", 
       "eout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "21", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "din", " ", "dself", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "22", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "din", " ", "din", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "23", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], " ", "din", " ", "din", " ", "eself", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "24", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "3"}], ")"}], "din", " ", "din", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "25", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "din", " ", "dout", " ", 
       "eout", " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "26", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "din", " ", "dself", " ",
        "eout", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "27", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "din", " ", "din", " ", 
       "eout", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "28", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "din", " ", "din", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "29", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "din", " ", "dout", " ", 
       "eself", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "30", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "din", " ", "dout", " ", "ein", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "31", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], " ", "din", " ", "dout", " ", "eout", 
       " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "32", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", "dself", 
       " ", "eself", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "33", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din", " ", "ein", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "34", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", "dout", " ",
        "eout", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "35", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "dout", " ", "dout", " ", "eout",
        " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "36", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "37", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dself", " ", "ein", " ",
        "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "38", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din", " ", "eself", " ",
        "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "39", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "dout", " ", "din", " ", "ein", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "40", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "eout", " ",
        "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "41", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "eout", " ",
        "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "42", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "43", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", "dself", 
       " ", "eout"}], " ", 
      RowBox[{"(*", "\[IndentingNewLine]", "44", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din", " ", "eout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "45", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", "dout", " ",
        "eself"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "46", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "ein"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "47", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "48", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dself", " ", "eout", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "49", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din", " ", "eout", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "50", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "51", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "eself", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "52", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "dout", " ", "dout", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "53", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "54", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dself", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "55", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "56", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "57", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "eout", " ",
        "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "58", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eself", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "59", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "ein", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "60", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"3", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout", " ", 
       "Qout"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699788370828354*^9, 3.6997883737861567`*^9}, {
  3.6997885910757103`*^9, 3.6997887279414787`*^9}, {3.699788766452323*^9, 
  3.69978887959624*^9}, {3.699789587279212*^9, 3.699789590128297*^9}, {
  3.6997897035456047`*^9, 3.699790157751882*^9}, {3.699790248805749*^9, 
  3.6997904719344053`*^9}, {3.6997909127859507`*^9, 3.699791106760395*^9}, {
  3.699791559504848*^9, 3.699791710511548*^9}, {3.69979191446669*^9, 
  3.6997919239386578`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"factorDB", "=", "factorBD"}]], "Input",
 CellChangeTimes->{{3.699791725220916*^9, 3.699791732023768*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], " ", "p"}], "\[Mu]"]], "Output",
 CellChangeTimes->{{3.699791726790472*^9, 3.699791732340192*^9}, 
   3.6997938682265463`*^9, 3.699847981983308*^9, 3.699849000076928*^9, 
   3.6998537501443233`*^9, 3.6999553584313593`*^9, 3.702201319689139*^9, 
   3.7022896779804573`*^9, 3.704178963019085*^9, 3.7045177183790417`*^9, 
   3.705385528792678*^9, 3.7053857545731573`*^9, 3.7099900551495123`*^9, 
   3.70999058469648*^9, 3.710047029070117*^9, 3.710049691820953*^9, 
   3.7100543049660788`*^9, 3.710054511148797*^9, 3.710156968281186*^9, 
   3.713407361244309*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]DB", "=", 
  RowBox[{
   RowBox[{"factorDB", 
    RowBox[{"(", 
     RowBox[{"\[Beta]DBD", "-", "\[Beta]DBI"}], ")"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699791734393208*^9, 3.6997917476423197`*^9}, {
  3.6997926117664433`*^9, 3.6997926138905087`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "\[Mu]"], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{"eself", "+", 
     RowBox[{"ein", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "eout", " ", "n", " ", 
      "Qout"}], "-", 
     RowBox[{
      SuperscriptBox["dself", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"eself", "+", 
        RowBox[{"ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "eout", " ", "n", " ", 
         "Qout"}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["din", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"eself", "+", 
        RowBox[{"eself", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
        RowBox[{"ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "n", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"3", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}], 
            " ", "Qin"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", "Qout"}]}], 
       ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
      SuperscriptBox["dout", "2"], " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"eself", "+", 
           RowBox[{"ein", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "eout", " ", 
            "n"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}]}], ")"}]}], 
        "+", 
        RowBox[{"n", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "eself"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "ein", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"3", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "3"}], "+", "d"}], ")"}], " ", "d"}]}], ")"}], 
            " ", "eout", " ", "n"}]}], ")"}], " ", "Qout"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "dout", " ", "dself", " ",
       "n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"eself", "+", 
           RowBox[{"ein", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", "Qout"}],
         "+", 
        RowBox[{"eout", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "n", " ", 
            "Qout"}]}], ")"}]}]}], ")"}]}], "-", 
     RowBox[{"2", " ", "din", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dself", " ", 
         RowBox[{"(", 
          RowBox[{"ein", "+", 
           RowBox[{"eself", " ", "Qin"}], "+", 
           RowBox[{"ein", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "eout", " ", "n", 
            " ", "Qout"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "dout", " ", "n", " ", 
         
         RowBox[{"(", 
          RowBox[{"eout", "+", 
           RowBox[{"eout", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"eself", "+", 
              RowBox[{"ein", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "eout", " ", 
               "n"}]}], ")"}], " ", "Qout"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
   " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "\[Mu]"}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.699791749004755*^9, 3.699791928140911*^9, 
  3.699792626181149*^9, 3.699793879672049*^9, 3.6998475283084784`*^9, 
  3.699849009846263*^9, 3.699853759446772*^9, 3.6999553665676394`*^9, 
  3.702201328485806*^9, 3.702289688938758*^9, 3.7041789784206753`*^9, 
  3.704517727201066*^9, 3.7053855375718317`*^9, 3.705385759703961*^9, 
  3.70999006205303*^9, 3.7099905943620863`*^9, 3.710047040104258*^9, 
  3.710049702228156*^9, 3.710054313368938*^9, 3.710054519456626*^9, 
  3.7101569805272512`*^9, 3.713407377816057*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Gamma]", "Subsubsection",
 CellChangeTimes->{{3.6997883477895412`*^9, 3.69978834940098*^9}, {
  3.699792669000319*^9, 3.699792670294528*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]DBD", "=", "\[Gamma]BDD"}]], "Input",
 CellChangeTimes->{{3.699792671742481*^9, 3.699792678668209*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", "\[Mu]"}]], "Output",
 CellChangeTimes->{3.6997926798829107`*^9, 3.699793879753723*^9, 
  3.699847528456636*^9, 3.6998490099380207`*^9, 3.699853759632382*^9, 
  3.699955366711424*^9, 3.702201328654451*^9, 3.702289689100259*^9, 
  3.704178978486375*^9, 3.7045177274160137`*^9, 3.7053855377473497`*^9, 
  3.705385759747951*^9, 3.709990062316594*^9, 3.7099905944100246`*^9, 
  3.710047042329115*^9, 3.710049702285987*^9, 3.710054313496426*^9, 
  3.7100545195890703`*^9, 3.710156980738796*^9, 3.713407377862473*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]DBI", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["dself", "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       SuperscriptBox["din", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       SuperscriptBox["dout", "2"]}], 
      RowBox[{"(*", "\[IndentingNewLine]", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", "din"}], "+", " ", 
         RowBox[{"din", " ", "dself"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}], "din", " ", "din"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", 
          "dout"}]}], ")"}], "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", "dout"}], " ", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "din", " ", "dout"}], "+", " ", 
         RowBox[{"dout", " ", "dself"}], "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"n", " ", "d"}], "-", 
            RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout"}]}], ")"}], 
       "Qout"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699792681385618*^9, 3.6997928220916023`*^9}, {
  3.6997931579841633`*^9, 3.699793164560968*^9}, {3.699793207548834*^9, 
  3.699793212788492*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]DB", "=", 
  RowBox[{"factorDB", 
   RowBox[{"(", 
    RowBox[{"\[Gamma]DBD", "-", "\[Gamma]DBI"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6997928247896*^9, 3.699792842326086*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "\[Mu]"], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["dself", "2"], "+", 
        RowBox[{
         SuperscriptBox["din", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["dout", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "din", " ", "dself"}], "+", 
           RowBox[{
            SuperscriptBox["din", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "n"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["dout", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "n"}], "+", 
              RowBox[{"d", " ", "n"}]}], ")"}]}]}], ")"}], " ", "Qin"}], "+", 
        
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "dout", " ", "dself"}], "+", 
           RowBox[{"2", " ", "din", " ", "dout", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["dout", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "n"}], "+", 
              RowBox[{"d", " ", "n"}]}], ")"}]}]}], ")"}], " ", "Qout"}]}], 
       ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}]}], "-", "\[Mu]"}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.699792843210064*^9, 3.6997931658091793`*^9, 
  3.699793214494582*^9, 3.699793879823855*^9, 3.699847528602282*^9, 
  3.699849009993635*^9, 3.699853759799317*^9, 3.699955366875863*^9, 
  3.702201328835555*^9, 3.7022896892128677`*^9, 3.7041789785551357`*^9, 
  3.704517727624941*^9, 3.705385537806016*^9, 3.7053857598273993`*^9, 
  3.709990062326001*^9, 3.7099905944497538`*^9, 3.710047043549039*^9, 
  3.7100497023242273`*^9, 3.71005431353528*^9, 3.7100545197590714`*^9, 
  3.710156980911428*^9, 3.7134073779281187`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wright - Fisher", "Subsection",
 CellChangeTimes->{{3.69979364538774*^9, 3.6997936505742283`*^9}}],

Cell["\<\
The formulas are the same as the Moran DB life-cycle, only the probabilities \
of identity by descent Q will differ. \
\>", "Text",
 CellChangeTimes->{{3.71004712599955*^9, 3.7100471537307873`*^9}}],

Cell[CellGroupData[{

Cell["\[Beta]", "Subsubsection",
 CellChangeTimes->{{3.699793660765585*^9, 3.699793662299658*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Beta]WFI", "=", "\[Beta]DBI"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]WFD", "=", "\[Beta]DBD"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]WF", "=", "\[Beta]DB"}], ";"}]}], "Input",
 CellChangeTimes->{{3.699793681804043*^9, 3.6997936868298264`*^9}, {
  3.7100516610266438`*^9, 3.7100516730745697`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Gamma]", "Subsubsection",
 CellChangeTimes->{{3.699793660765585*^9, 3.699793691772121*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Gamma]WF", "=", "\[Gamma]DB"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]WFD", "=", "\[Gamma]DBD"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]WFI", "=", "\[Gamma]DBI"}], ";"}]}], "Input",
 CellChangeTimes->{{3.699793681804043*^9, 3.699793695476061*^9}, {
  3.710054344520341*^9, 3.710054351104436*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check the results numerically", "Section",
 CellChangeTimes->{{3.69976960096646*^9, 3.699769610384227*^9}, {
  3.699850594091323*^9, 3.69985059613144*^9}, {3.705385403861724*^9, 
  3.705385410277524*^9}}],

Cell["\<\
We use generic equations valid for any life-cycle and any graph, and adapt \
them to our life-cycles and to a subdivided population. We compare the \
numerical results to the ones obtained with the equations written above. \
\>", "Text",
 CellChangeTimes->{{3.705385415146649*^9, 3.7053854805488234`*^9}}],

Cell[CellGroupData[{

Cell["Full functions, any life-cycle", "Subsection",
 CellChangeTimes->{{3.667805530329844*^9, 3.667805533236369*^9}, {
   3.667817240550598*^9, 3.6678172439254503`*^9}, 3.6703187116345387`*^9}],

Cell["\<\
\[Beta] and \[Gamma] were calculated by hand - these are generic equations \
value for any life-cycle and any regular graph. 
(see Appendix B1 for details, and Debarre 2017 JTB for even further details)\
\>", "Text",
 CellChangeTimes->{{3.679394260451545*^9, 3.679394277503475*^9}, 
   3.7053852236151247`*^9, {3.7053853495020123`*^9, 3.705385388886067*^9}, {
   3.710047168386541*^9, 3.7100471691967497`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetBeta", "[", 
    RowBox[{
    "sBf_", ",", "Df_", ",", "G_", ",", "GE_", ",", "Qmat_", ",", 
     "\[CapitalNu]_", ",", "graphdegree_", ",", "Bstar_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"part1", ",", "part2", ",", "factor"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"factor", "=", 
       FractionBox[
        RowBox[{"p", 
         RowBox[{"(", 
          RowBox[{"1", "-", "p"}], ")"}]}], 
        RowBox[{"\[Mu]", " ", "\[CapitalNu]", " ", "Bstar"}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"part1", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Mu]"}], ")"}], 
             RowBox[{"sBf", "[", 
              RowBox[{
              "G", ",", "\[CapitalNu]", ",", "graphdegree", ",", "j", ",", 
               "l"}], "]"}]}], "-", 
            RowBox[{"Df", "[", 
             RowBox[{
             "G", ",", "\[CapitalNu]", ",", "graphdegree", ",", "j", ",", 
              "l"}], "]"}]}], ")"}], "*", 
          RowBox[{"GE", "\[LeftDoubleBracket]", 
           RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}], "*", 
          RowBox[{"Qmat", "\[LeftDoubleBracket]", 
           RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"factor", "*", "part1"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetGamma", "[", 
   RowBox[{
   "sBf_", ",", "Df_", ",", "G_", ",", "GE_", ",", "Qmat_", ",", 
    "\[CapitalNu]_", ",", "graphdegree_", ",", "Bstar_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"part1", ",", "part2", ",", "factor"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"factor", "=", 
      FractionBox[
       RowBox[{"p", 
        RowBox[{"(", 
         RowBox[{"1", "-", "p"}], ")"}]}], 
       RowBox[{"\[Mu]", " ", "\[CapitalNu]", " ", "Bstar"}]]}], ";", 
     RowBox[{"part1", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Mu]"}], ")"}], 
            RowBox[{"sBf", "[", 
             RowBox[{
             "G", ",", "\[CapitalNu]", ",", "graphdegree", ",", "j", ",", 
              "k"}], "]"}]}], "-", 
           RowBox[{"Df", "[", 
            RowBox[{
            "G", ",", "\[CapitalNu]", ",", "graphdegree", ",", "j", ",", 
             "k"}], "]"}]}], ")"}], "*", 
         RowBox[{"Qmat", "\[LeftDoubleBracket]", 
          RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"factor", "*", "part1"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6767809663714542`*^9, 3.676781023510331*^9}, {
  3.676804537681356*^9, 3.676804544825398*^9}, {3.679396412220232*^9, 
  3.679396413286743*^9}, {3.699769980839834*^9, 3.699769997947857*^9}, {
  3.699778646203886*^9, 3.6997786598998013`*^9}, {3.699778713529934*^9, 
  3.6997788466070232`*^9}, {3.6997814408909063`*^9, 3.699781470396274*^9}, {
  3.6997873888540173`*^9, 3.69978742458986*^9}, {3.710044608058228*^9, 
  3.710044629109458*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moran DB", "Subsection",
 CellChangeTimes->{{3.667817266049498*^9, 3.667817267641507*^9}, {
  3.667829361694632*^9, 3.667829362862344*^9}, {3.670318555363709*^9, 
  3.67031856010742*^9}, {3.679394287560162*^9, 3.6793942988890533`*^9}}],

Cell[CellGroupData[{

Cell["Define \[Delta]B and \[Delta]D", "Subsubsection",
 CellChangeTimes->{{3.667817270639081*^9, 3.667817303563981*^9}}],

Cell["graphdegree is the degree of the graph, here equal to 1", "Text",
 CellChangeTimes->{{3.705385243294672*^9, 3.705385251443304*^9}, 
   3.710044631061921*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sBfDB", "[", 
    RowBox[{
    "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "j_", ",", "k_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Delta", "[", 
        RowBox[{"k", "-", "j"}], "]"}], 
       SuperscriptBox["graphdegree", "2"]}], "-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"G", "\[LeftDoubleBracket]", 
          RowBox[{"j", ",", "i"}], "\[RightDoubleBracket]"}], 
         RowBox[{"G", "\[LeftDoubleBracket]", 
          RowBox[{"k", ",", "i"}], "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], 
     ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"\[CapitalNu]", " ", 
      SuperscriptBox["graphdegree", "2"]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DfDB", "[", 
    RowBox[{
    "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "j_", ",", "k_"}], 
    "]"}], ":=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BstarDB", "=", 
   FractionBox["1", "\[CapitalNu]"]}], ";"}]}], "Input",
 CellChangeTimes->{{3.667805794031062*^9, 3.6678058049416933`*^9}, {
   3.667805883047532*^9, 3.667806013751638*^9}, {3.667806064496217*^9, 
   3.667806108193321*^9}, {3.6678067367929573`*^9, 3.667806737538381*^9}, {
   3.667806855132804*^9, 3.667806855241205*^9}, 3.6678069002815533`*^9, {
   3.6678178907809553`*^9, 3.6678178913089523`*^9}, {3.699778852523326*^9, 
   3.699778862434937*^9}, {3.6997874275513897`*^9, 3.699787463278324*^9}, {
   3.710044633532029*^9, 3.7100446369559927`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Beta]", "Subsubsection",
 CellChangeTimes->{{3.69978004306563*^9, 3.6997800470396347`*^9}, {
  3.699792857641252*^9, 3.6997928577847347`*^9}}],

Cell["Numerical comparison for the population of size 12", "Text",
 CellChangeTimes->{{3.710047191461318*^9, 3.710047206628955*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]DBexemple", "=", 
  RowBox[{
   RowBox[{"GetBeta", "[", 
    RowBox[{
    "sBfDB", ",", "DfDB", ",", "G12generic", ",", "GE12generic", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarDB", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997800509176693`*^9, 3.6997800766118813`*^9}, {
  3.699780227296484*^9, 3.699780254043705*^9}, {3.699781039145463*^9, 
  3.699781043696348*^9}, {3.6997811552598333`*^9, 3.699781156248343*^9}, {
  3.699791766659071*^9, 3.699791790258472*^9}, {3.705385777149726*^9, 
  3.705385779307852*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["dself", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"eself", "+", 
         RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
         RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["din", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"ein", "+", "eself", "+", 
         RowBox[{"3", " ", "ein", " ", "Qin"}], "+", 
         RowBox[{"eself", " ", "Qin"}], "+", 
         RowBox[{"18", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"18", " ", "dout", " ", "dself", " ", 
       RowBox[{"(", 
        RowBox[{"eout", "+", 
         RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
         RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
         RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
         RowBox[{"eself", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"9", " ", 
       SuperscriptBox["dout", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "ein"}], "+", 
            RowBox[{"6", " ", "eout"}], "+", "eself"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "Qin"}]}], ")"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "ein"}], "+", 
            RowBox[{"21", " ", "eout"}], "+", 
            RowBox[{"2", " ", "eself"}]}], ")"}], " ", "Qout"}]}], ")"}]}], 
      "+", 
      RowBox[{"4", " ", "din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", 
          RowBox[{"(", 
           RowBox[{"ein", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ein", "+", "eself"}], ")"}], " ", "Qin"}], "+", 
            RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
         RowBox[{"9", " ", "dout", " ", 
          RowBox[{"(", 
           RowBox[{"eout", "+", 
            RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
            RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
            RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
            RowBox[{"eself", " ", "Qout"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.69978024638573*^9, 3.699780256098102*^9}, 
   3.699781045273366*^9, 3.699781157642991*^9, 3.699781474913704*^9, 
   3.699783922853292*^9, 3.699787598717938*^9, {3.6997917699729023`*^9, 
   3.699791791253379*^9}, 3.6997938463840523`*^9, 3.6998474709052677`*^9, 
   3.699848136068221*^9, 3.6998506023560133`*^9, 3.699853761541006*^9, 
   3.699955368362294*^9, 3.7022013304406977`*^9, 3.702289690824561*^9, 
   3.704178980449655*^9, 3.704517729262532*^9, 3.705385501064349*^9, 
   3.705385711972087*^9, {3.70538577278124*^9, 3.705385780505777*^9}, 
   3.709990174748199*^9, 3.709990595225204*^9, 3.710047180131008*^9, 
   3.7100497031853237`*^9, 3.710054314797099*^9, 3.710054521349021*^9, 
   3.710156982949984*^9, 3.713407380491803*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]DBexemple", "-", "\[Beta]DB"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699791793075905*^9, 3.6997918142667027`*^9}, {
  3.704518414547575*^9, 3.704518424365841*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699791804334284*^9, 3.699791815023748*^9}, 
   3.699791940967175*^9, 3.699793849735236*^9, 3.699847473358466*^9, 
   3.699848138659239*^9, 3.6998506024698*^9, 3.699853761680664*^9, 
   3.699955368504578*^9, 3.702201330605775*^9, 3.702289690977955*^9, 
   3.704178980521405*^9, 3.704517729471529*^9, {3.704518416387002*^9, 
   3.704518424546892*^9}, 3.705385503251767*^9, {3.70538569358629*^9, 
   3.705385718349859*^9}, 3.7053857820865*^9, 3.709990183151667*^9, 
   3.709990595261455*^9, 3.710047181094242*^9, 3.7100497032193537`*^9, 
   3.710054314876215*^9, 3.710054521482843*^9, 3.7101569830927143`*^9, 
   3.713407380530377*^9}]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 3.7100472277111177`*^9}}],

Cell["Numerical comparison for the population of size 10", "Text",
 CellChangeTimes->{{3.710047191461318*^9, 3.710047216676303*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]DBexemple2", "=", 
  RowBox[{
   RowBox[{"GetBeta", "[", 
    RowBox[{
    "sBfDB", ",", "DfDB", ",", "G10generic", ",", "GE10generic", ",", 
     "Q10generic", ",", "10", ",", "1", ",", 
     RowBox[{"BstarDB", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "10"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997922176034184`*^9, 3.6997922333025217`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["dself", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"eself", "+", 
         RowBox[{"4", " ", "ein", " ", "Qin"}], "+", 
         RowBox[{"5", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["din", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"eself", "+", 
         RowBox[{"3", " ", "eself", " ", "Qin"}], "+", 
         RowBox[{"ein", " ", 
          RowBox[{"(", 
           RowBox[{"3", "+", 
            RowBox[{"13", " ", "Qin"}]}], ")"}]}], "+", 
         RowBox[{"20", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"5", " ", 
       SuperscriptBox["dout", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "ein"}], "+", "eself"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"4", " ", "Qin"}]}], ")"}]}], "+", 
         RowBox[{"25", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"10", " ", "dout", " ", "dself", " ", 
       RowBox[{"(", 
        RowBox[{"eout", "+", 
         RowBox[{"4", " ", "eout", " ", "Qin"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "ein"}], "+", "eself"}], ")"}], " ", "Qout"}]}],
         ")"}]}], "+", 
      RowBox[{"8", " ", "din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", 
          RowBox[{"(", 
           RowBox[{"ein", "+", 
            RowBox[{"3", " ", "ein", " ", "Qin"}], "+", 
            RowBox[{"eself", " ", "Qin"}], "+", 
            RowBox[{"5", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
         RowBox[{"5", " ", "dout", " ", 
          RowBox[{"(", 
           RowBox[{"eout", "+", 
            RowBox[{"4", " ", "eout", " ", "Qin"}], "+", 
            RowBox[{"4", " ", "ein", " ", "Qout"}], "+", 
            RowBox[{"eself", " ", "Qout"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.6997922351725397`*^9, 3.6997938504112864`*^9, 
  3.699847474799409*^9, 3.699848140390723*^9, 3.6998506041587563`*^9, 
  3.6998537629428673`*^9, 3.699955369423333*^9, 3.702201331633013*^9, 
  3.70228969212409*^9, 3.704178982196525*^9, 3.7045177304936438`*^9, 
  3.705385695022094*^9, 3.705385784128316*^9, 3.709990186222736*^9, 
  3.709990596312099*^9, 3.710047392762372*^9, 3.7100497046122913`*^9, 
  3.710054315795927*^9, 3.7100545225544653`*^9, 3.7101569844063683`*^9, 
  3.713407382219857*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]DBexemple2", "-", "\[Beta]DB"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "5"}], ",", 
     RowBox[{"d", "\[Rule]", "2"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699792241182529*^9, 3.699792249407493*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699792244617155*^9, 3.699792249502091*^9}, 
   3.6997938551855373`*^9, 3.699847477795148*^9, 3.699848143818454*^9, 
   3.699850604259791*^9, 3.699853763077199*^9, 3.699955369567561*^9, 
   3.7022013318022823`*^9, 3.70228969228119*^9, 3.704178982263274*^9, 
   3.704517730731916*^9, 3.7053856950796824`*^9, 3.705385785289909*^9, 
   3.709990190147925*^9, 3.709990596395607*^9, 3.710047393269868*^9, 
   3.710049704654264*^9, 3.7100543158352003`*^9, 3.7100545226815147`*^9, 
   3.71015698455232*^9, 3.713407382257227*^9}]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 3.7100472277111177`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Gamma]", "Subsubsection",
 CellChangeTimes->{{3.69978004306563*^9, 3.6997800470396347`*^9}, {
  3.699792857641252*^9, 3.6997928674291353`*^9}}],

Cell["Numerical comparison for the population of size 12", "Text",
 CellChangeTimes->{{3.710047191461318*^9, 3.710047216676303*^9}, {
  3.7100480367495193`*^9, 3.710048037368987*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]DBexemple", "=", 
  RowBox[{
   RowBox[{"GetGamma", "[", 
    RowBox[{
    "sBfDB", ",", "DfDB", ",", "G12generic", ",", "GE12generic", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarDB", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997800509176693`*^9, 3.6997800766118813`*^9}, {
  3.699780227296484*^9, 3.699780254043705*^9}, {3.699781039145463*^9, 
  3.699781043696348*^9}, {3.6997811552598333`*^9, 3.699781156248343*^9}, {
  3.699791766659071*^9, 3.699791790258472*^9}, {3.699792869185608*^9, 
  3.699792873215055*^9}, {3.705386121796611*^9, 3.705386123738603*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["dself", "2"], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["din", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "Qin"}], ")"}]}], "+", 
      RowBox[{"4", " ", "din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", "Qin"}], "+", 
         RowBox[{"9", " ", "dout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"9", " ", "dout", " ", 
       RowBox[{"(", 
        RowBox[{"dout", "+", 
         RowBox[{"2", " ", "dout", " ", "Qin"}], "+", 
         RowBox[{"6", " ", "dout", " ", "Qout"}], "+", 
         RowBox[{"2", " ", "dself", " ", "Qout"}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.69978024638573*^9, 3.699780256098102*^9}, 
   3.699781045273366*^9, 3.699781157642991*^9, 3.699781474913704*^9, 
   3.699783922853292*^9, 3.699787598717938*^9, {3.6997917699729023`*^9, 
   3.699791791253379*^9}, 3.6997928744168043`*^9, 3.699793225128313*^9, 
   3.6997938553436613`*^9, 3.6998474781335363`*^9, 3.6998481443005123`*^9, 
   3.6998506070961523`*^9, 3.699853763359934*^9, 3.6999553698191566`*^9, 
   3.702201332087606*^9, 3.7022896925574408`*^9, 3.704178982497615*^9, 
   3.704517731012682*^9, 3.705385789772509*^9, 3.7053861246182823`*^9, 
   3.709990192385351*^9, 3.709990596589851*^9, 3.710048038606057*^9, 
   3.7100497048101377`*^9, 3.710054316019289*^9, 3.7100545229004307`*^9, 
   3.7101569847769136`*^9, 3.713407382455076*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]DBexemple", "-", "\[Gamma]DB"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699791793075905*^9, 3.6997918142667027`*^9}, {
  3.699792876177504*^9, 3.6997928792173023`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699791804334284*^9, 3.699791815023748*^9}, 
   3.699791940967175*^9, 3.699792879944309*^9, 3.699793181383277*^9, 
   3.699793225184245*^9, 3.6997938556744423`*^9, 3.699847478511882*^9, 
   3.69984814491894*^9, 3.6998506090564632`*^9, 3.699853763529297*^9, 
   3.699955369950479*^9, 3.702201332286913*^9, 3.702289692727661*^9, 
   3.704178982565536*^9, 3.704517731180649*^9, 3.705386133224227*^9, 
   3.7099901943515453`*^9, 3.709990596596596*^9, 3.710048039355609*^9, 
   3.710049704837688*^9, 3.7100543160623617`*^9, 3.7100545229144917`*^9, 
   3.710156984806225*^9, 3.71340738247503*^9}]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 3.7100472277111177`*^9}}],

Cell["Numerical comparison for the population of size 10", "Text",
 CellChangeTimes->{{3.710047191461318*^9, 3.710047216676303*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]DBexemple2", "=", 
  RowBox[{
   RowBox[{"GetGamma", "[", 
    RowBox[{
    "sBfDB", ",", "DfDB", ",", "G10generic", ",", "GE10generic", ",", 
     "Q10generic", ",", "10", ",", "1", ",", 
     RowBox[{"BstarDB", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "10"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997922176034184`*^9, 3.6997922333025217`*^9}, {
  3.6997928836005917`*^9, 3.699792884605294*^9}, {3.6997931965600157`*^9, 
  3.6997931976610737`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["dself", "2"], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["din", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"3", " ", "Qin"}]}], ")"}]}], "+", 
      RowBox[{"8", " ", "din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", "Qin"}], "+", 
         RowBox[{"5", " ", "dout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"5", " ", "dout", " ", 
       RowBox[{"(", 
        RowBox[{"dout", "+", 
         RowBox[{"4", " ", "dout", " ", "Qin"}], "+", 
         RowBox[{"2", " ", "dself", " ", "Qout"}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "\[Mu]"]}]], "Output",
 CellChangeTimes->{
  3.6997922351725397`*^9, 3.699792888128591*^9, {3.699793182918476*^9, 
   3.6997932253132267`*^9}, 3.699793855883088*^9, 3.69984747883878*^9, 
   3.6998481453289337`*^9, 3.699850609714999*^9, 3.699853763776083*^9, 
   3.69995537019744*^9, 3.702201332538973*^9, 3.702289692983096*^9, 
   3.704178982832259*^9, 3.70451773145947*^9, 3.705386134677553*^9, 
   3.709990195901651*^9, 3.709990596765334*^9, 3.7100480415088997`*^9, 
   3.710049704981529*^9, 3.71005431621916*^9, 3.710054523095546*^9, 
   3.710156985057029*^9, 3.7134073826680117`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]DBexemple2", "-", "\[Gamma]DB"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "5"}], ",", 
     RowBox[{"d", "\[Rule]", "2"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699792241182529*^9, 3.699792249407493*^9}, {
  3.699792889401593*^9, 3.699792892793714*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699792244617155*^9, 3.699792249502091*^9}, 
   3.699792895322885*^9, {3.699793185251954*^9, 3.6997932253397837`*^9}, 
   3.6997938561037617`*^9, 3.699847479378138*^9, 3.699848145708249*^9, 
   3.699850610231893*^9, 3.699853763858077*^9, 3.699955370216586*^9, 
   3.7022013325889177`*^9, 3.70228969307031*^9, 3.704178982875839*^9, 
   3.704517731499671*^9, 3.70538613635847*^9, 3.709990197060823*^9, 
   3.709990596805367*^9, 3.710048042098637*^9, 3.71004970501007*^9, 
   3.71005431626306*^9, 3.710054523164699*^9, 3.710156985132773*^9, 
   3.7134073826897593`*^9}]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 3.7100472277111177`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moran BD", "Subsection",
 CellChangeTimes->{{3.667817266049498*^9, 3.667817267641507*^9}, {
   3.66782181858403*^9, 3.667821819675145*^9}, {3.66782936574275*^9, 
   3.667829366991437*^9}, 3.670318572988695*^9, {3.6793943239760017`*^9, 
   3.67939432588864*^9}}],

Cell["\<\
The structure is the same as for Moran DB above - comments are lighter here!\
\>", "Text",
 CellChangeTimes->{{3.710048063471426*^9, 3.710048080308312*^9}}],

Cell[CellGroupData[{

Cell["Define \[Delta]B and \[Delta]D", "Subsubsection",
 CellChangeTimes->{{3.667817270639081*^9, 3.667817303563981*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sBfBD", "[", 
    RowBox[{
    "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "j_", ",", "k_"}], 
    "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"Delta", "[", 
       RowBox[{"k", "-", "j"}], "]"}], "\[CapitalNu]"}], "-", "1"}], 
    SuperscriptBox["\[CapitalNu]", "2"]]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DfBD", "[", 
    RowBox[{
    "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "j_", ",", "k_"}], 
    "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"G", "\[LeftDoubleBracket]", 
      RowBox[{"k", ",", "j"}], "\[RightDoubleBracket]"}], 
     RowBox[{"\[CapitalNu]", " ", "graphdegree"}]], "-", 
    FractionBox["1", 
     SuperscriptBox["\[CapitalNu]", "2"]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BstarBD", "=", 
   FractionBox["1", "\[CapitalNu]"]}], ";"}]}], "Input",
 CellChangeTimes->{{3.667805794031062*^9, 3.6678058049416933`*^9}, {
   3.667805883047532*^9, 3.667806013751638*^9}, {3.667806064496217*^9, 
   3.667806108193321*^9}, {3.6678067367929573`*^9, 3.667806737538381*^9}, {
   3.667806855132804*^9, 3.667806855241205*^9}, 3.6678069002815533`*^9, {
   3.6678178907809553`*^9, 3.6678178913089523`*^9}, {3.6678218224839478`*^9, 
   3.667821926596066*^9}, {3.69977903377708*^9, 3.699779037288487*^9}, {
   3.699787474076399*^9, 3.699787478013597*^9}, {3.6997875245164633`*^9, 
   3.699787524675749*^9}, {3.710044637988566*^9, 3.710044639211814*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations \[Beta]", "Subsubsection",
 CellChangeTimes->{{3.69978004306563*^9, 3.6997800470396347`*^9}, {
  3.699788019288118*^9, 3.699788020367642*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]BDexemple", "=", 
  RowBox[{
   RowBox[{"GetBeta", "[", 
    RowBox[{
    "sBfBD", ",", "DfBD", ",", "G12generic", ",", "GE12generic", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarBD", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997800509176693`*^9, 3.6997800766118813`*^9}, {
   3.699780227296484*^9, 3.699780254043705*^9}, {3.699781039145463*^9, 
   3.699781043696348*^9}, {3.6997811552598333`*^9, 3.699781176230454*^9}, {
   3.6997814599873953`*^9, 3.699781463270492*^9}, 3.699787561723735*^9, {
   3.699787605440502*^9, 3.6997876067381372`*^9}, {3.6997876630669823`*^9, 
   3.699787667730566*^9}, {3.705386274883584*^9, 3.705386277097451*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"12", " ", "\[Mu]"}]], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"12", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "dself"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"eself", "+", 
           RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
           RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", "din", " ", 
         RowBox[{"(", 
          RowBox[{"ein", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ein", "+", "eself"}], ")"}], " ", "Qin"}], "+", 
           RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
        RowBox[{"9", " ", "dout", " ", 
         RowBox[{"(", 
          RowBox[{"eout", "+", 
           RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
           RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
           RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
           RowBox[{"eself", " ", "Qout"}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "9"}], " ", "eout"}], "+", 
        RowBox[{"11", " ", "eself"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"ein", "-", 
           RowBox[{"10", " ", "ein", " ", "Qin"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"9", " ", "eout"}], "+", "eself"}], ")"}], " ", 
            "Qin"}]}], ")"}]}], "-", 
        RowBox[{"9", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "ein"}], "-", 
           RowBox[{"3", " ", "eout"}], "+", "eself"}], ")"}], " ", "Qout"}]}],
        ")"}], " ", "\[Mu]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.699781180204089*^9, {3.699781446797988*^9, 3.699781479785037*^9}, 
   3.699787527248124*^9, {3.699787559397271*^9, 3.699787562336577*^9}, 
   3.6997876019039497`*^9, {3.699787663714706*^9, 3.6997876695101843`*^9}, 
   3.699793857302267*^9, 3.6998474811847258`*^9, 3.699848148104183*^9, 
   3.699850615293481*^9, 3.699853766085619*^9, 3.6999553719306917`*^9, 
   3.702201334540431*^9, 3.702289695066875*^9, 3.704178985781805*^9, 
   3.704517733491603*^9, 3.705386141655033*^9, 3.7053862795179243`*^9, 
   3.709990201244254*^9, 3.709990598061387*^9, 3.710048084022653*^9, 
   3.710049706553835*^9, 3.710054317893012*^9, 3.710054524579379*^9, 
   3.710156987840686*^9, 3.713407386662087*^9}]
}, Open  ]],

Cell["Check also the different terms separately", "Text",
 CellChangeTimes->{{3.7100481590332317`*^9, 3.7100481746310043`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]IBDtest", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["\[Mu]", 
           SuperscriptBox["\[CapitalNu]", "2"]], "-", 
          FractionBox[
           RowBox[{"G", "\[LeftDoubleBracket]", 
            RowBox[{"l", ",", "j"}], "\[RightDoubleBracket]"}], 
           "\[CapitalNu]"]}], ")"}], 
        RowBox[{"GE", "\[LeftDoubleBracket]", 
         RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}], 
        RowBox[{"Q", "\[LeftDoubleBracket]", 
         RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"G", "\[Rule]", "G12generic"}], ",", 
       RowBox[{"GE", "\[Rule]", "GE12generic"}], ",", 
       RowBox[{"Q", "\[Rule]", "Q12generic"}], ",", 
       RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}], "}"}]}], "//", 
    "FullSimplify"}], "//", "Quiet"}]}]], "Input",
 CellChangeTimes->{{3.699782870840354*^9, 3.699783001047284*^9}, {
  3.699783945553492*^9, 3.699783947090015*^9}, {3.705386306210133*^9, 
  3.7053863084189987`*^9}, {3.710048089207355*^9, 3.7100480900302362`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "dself"}], " ", 
   RowBox[{"(", 
    RowBox[{"eself", "+", 
     RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
     RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "-", 
  RowBox[{"2", " ", "din", " ", 
   RowBox[{"(", 
    RowBox[{"ein", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ein", "+", "eself"}], ")"}], " ", "Qin"}], "+", 
     RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "-", 
  RowBox[{"9", " ", "dout", " ", 
   RowBox[{"(", 
    RowBox[{"eout", "+", 
     RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
     RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
     RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
     RowBox[{"eself", " ", "Qout"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "12"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "ein"}], "+", 
     RowBox[{"9", " ", "eout"}], "+", "eself"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"2", " ", "Qin"}], "+", 
     RowBox[{"9", " ", "Qout"}]}], ")"}], " ", "\[Mu]"}]}]], "Output",
 CellChangeTimes->{
  3.699850626908044*^9, 3.69985377477147*^9, 3.69995537862757*^9, 
   3.702201342087907*^9, 3.7022897036459637`*^9, 3.704178998731361*^9, 
   3.704517741831716*^9, 3.7053863161025667`*^9, 3.709990212274704*^9, 
   3.709990598795203*^9, {3.7100480919870453`*^9, 3.710048096375235*^9}, 
   3.710049707222682*^9, 3.710054326783057*^9, 3.710054533899839*^9, 
   3.710156994807612*^9, 3.713407395873147*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]IBDtest", "+", "\[Beta]BDI"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699783020789446*^9, 3.699783038546137*^9}, 
   3.699783089340975*^9, {3.699783957941577*^9, 3.699783963099947*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699783026270259*^9, 3.699783039204505*^9}, 
   3.699783090301508*^9, 3.699783569034895*^9, {3.6997839494167013`*^9, 
   3.69978396360054*^9}, {3.699787700318171*^9, 3.699787726454076*^9}, 
   3.699793858230879*^9, 3.6998474919171143`*^9, 3.6998506272226458`*^9, 
   3.699853774989265*^9, 3.699955378817668*^9, 3.702201342294386*^9, 
   3.702289703879959*^9, 3.70417899891127*^9, 3.7045177421432943`*^9, 
   3.70538631770267*^9, 3.7099902164877*^9, 3.709990598835939*^9, 
   3.7100480970973253`*^9, 3.7100497072601223`*^9, 3.710054326895178*^9, 
   3.710054534204973*^9, 3.710156995064357*^9, 3.71340739596626*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]DBDtest", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "\[CapitalNu]"], 
        RowBox[{"GE", "\[LeftDoubleBracket]", 
         RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}], 
        RowBox[{"Q", "\[LeftDoubleBracket]", 
         RowBox[{"l", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"G", "\[Rule]", "G12generic"}], ",", 
       RowBox[{"GE", "\[Rule]", "GE12generic"}], ",", 
       RowBox[{"Q", "\[Rule]", "Q12generic"}], ",", 
       RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}], "}"}]}], "//", 
    "FullSimplify"}], "//", "Quiet"}]}]], "Input",
 CellChangeTimes->{{3.699783999036151*^9, 3.699784026470895*^9}, {
  3.705386321946117*^9, 3.70538632397878*^9}, {3.7100481003225203`*^9, 
  3.710048101278778*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{"eself", "+", 
     RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
     RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]], "Output",
 CellChangeTimes->{3.699784037424552*^9, 3.699787735289548*^9, 
  3.6997938582837276`*^9, 3.69984750347519*^9, 3.699850638367219*^9, 
  3.699853784041383*^9, 3.6999553855026217`*^9, 3.702201349396064*^9, 
  3.702289713059708*^9, 3.704179011634886*^9, 3.70451774950618*^9, 
  3.7053863310392017`*^9, 3.709990224577718*^9, 3.709990598917156*^9, 
  3.71004810892866*^9, 3.710049707307419*^9, 3.710054335698373*^9, 
  3.710054543084178*^9, 3.710157002124436*^9, 3.713407405004422*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]DBDtest", "-", "\[Beta]BDD"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699784038835702*^9, 3.69978404413303*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.699784045088913*^9, 3.6997877353512278`*^9, 
  3.6997938583591948`*^9, 3.699847503650477*^9, 3.699850638481913*^9, 
  3.699853784270899*^9, 3.699955385681616*^9, 3.702201349573618*^9, 
  3.702289713227303*^9, 3.704179011750761*^9, 3.7045177497505617`*^9, 
  3.705386331099812*^9, 3.709990236560951*^9, 3.709990598923615*^9, 
  3.710048109047861*^9, 3.710049707339924*^9, 3.7100543357814617`*^9, 
  3.7100545432558804`*^9, 3.7101570023209543`*^9, 3.713407405062214*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]BDtest", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"p", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p"}], ")"}]}], "\[Mu]"], 
     RowBox[{"(", 
      RowBox[{"\[Beta]DBDtest", "+", "\[Beta]IBDtest"}], ")"}]}], "//", 
    "FullSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6997840516560383`*^9, 3.699784066994879*^9}, {
   3.699784124706222*^9, 3.699784180324698*^9}, {3.699784434476344*^9, 
   3.699784438938961*^9}, 3.7100481939081993`*^9}],

Cell["\<\
Numerical comparison (the differences are zero: we are fine!)\
\>", "Text",
 CellChangeTimes->{{3.710048127222234*^9, 3.710048138020673*^9}, {
  3.7100481992860727`*^9, 3.71004820811012*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]BDtest", "-", "\[Beta]BD"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6997841387119617`*^9, 3.699784144916231*^9}, {
  3.6997841825084257`*^9, 3.699784184642168*^9}, {3.699784448322966*^9, 
  3.699784451265874*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699784145255732*^9, 3.699784186958892*^9}, 
   3.699784452682255*^9, 3.699787736958263*^9, 3.699793862518971*^9, 
   3.699847507948889*^9, 3.699850640346918*^9, 3.6998537858932962`*^9, 
   3.6999553869110813`*^9, 3.702201350832096*^9, 3.702289714792705*^9, 
   3.704179013976646*^9, 3.704517751616626*^9, 3.705386332362678*^9, 
   3.709990240896392*^9, 3.709990600096583*^9, 3.710048110910675*^9, 
   3.7100481967790203`*^9, 3.7100497074300737`*^9, 3.710054337243113*^9, 
   3.710054544484828*^9, 3.710157004058296*^9, 3.713407407251863*^9}]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 3.7100472277111177`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]BDD", "-", "\[Beta]DBDtest"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699784301329733*^9, 3.699784327843625*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699784315772072*^9, 3.699784328285502*^9}, 
   3.699787737025803*^9, 3.699793862734157*^9, 3.69984750811241*^9, 
   3.699850640429304*^9, 3.699853785979096*^9, 3.699955387013412*^9, 
   3.7022013509303293`*^9, 3.7022897148979387`*^9, 3.704179014096588*^9, 
   3.704517751800221*^9, 3.705386341001157*^9, 3.709990241790206*^9, 
   3.709990600143642*^9, 3.710048110954846*^9, 3.710049707461434*^9, 
   3.71005433724935*^9, 3.710054544572597*^9, 3.710157004139224*^9, 
   3.713407407274166*^9}]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 3.7100472277111177`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]BDI", "+", "\[Beta]IBDtest"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699784332794595*^9, 3.6997843402035503`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6997843371632423`*^9, 3.699784340651658*^9}, 
   3.6997877370675783`*^9, 3.699793863115623*^9, 3.699847508572557*^9, 
   3.69985064051857*^9, 3.699853786064782*^9, 3.699955387107954*^9, 
   3.702201351026763*^9, 3.702289714985482*^9, 3.704179014169434*^9, 
   3.704517751951542*^9, 3.705386341733025*^9, 3.709990242288851*^9, 
   3.7099906001897717`*^9, 3.71004811100462*^9, 3.710049707512568*^9, 
   3.710054337278998*^9, 3.710054544665125*^9, 3.7101570042156153`*^9, 
   3.713407407299868*^9}]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 3.7100472277111177`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations \[Gamma]", "Subsubsection",
 CellChangeTimes->{{3.69978004306563*^9, 3.6997800470396347`*^9}, {
  3.699788019288118*^9, 3.699788039145166*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]BDexemple", "=", 
  RowBox[{
   RowBox[{"GetGamma", "[", 
    RowBox[{
    "sBfBD", ",", "DfBD", ",", "G12generic", ",", "GE12generic", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarBD", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997800509176693`*^9, 3.6997800766118813`*^9}, {
   3.699780227296484*^9, 3.699780254043705*^9}, {3.699781039145463*^9, 
   3.699781043696348*^9}, {3.6997811552598333`*^9, 3.699781176230454*^9}, {
   3.6997814599873953`*^9, 3.699781463270492*^9}, 3.699787561723735*^9, {
   3.699787605440502*^9, 3.6997876067381372`*^9}, {3.6997876630669823`*^9, 
   3.699787667730566*^9}, {3.699788044392364*^9, 3.699788048476987*^9}, {
   3.705386355939402*^9, 3.705386358345911*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"12", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "dself", "+", 
        RowBox[{"2", " ", "din", " ", "Qin"}], "+", 
        RowBox[{"9", " ", "dout", " ", "Qout"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"11", "-", 
        RowBox[{"2", " ", "Qin"}], "-", 
        RowBox[{"9", " ", "Qout"}]}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
  RowBox[{"12", " ", "\[Mu]"}]]], "Output",
 CellChangeTimes->{
  3.699781180204089*^9, {3.699781446797988*^9, 3.699781479785037*^9}, 
   3.699787527248124*^9, {3.699787559397271*^9, 3.699787562336577*^9}, 
   3.6997876019039497`*^9, {3.699787663714706*^9, 3.6997876695101843`*^9}, 
   3.699788051319792*^9, 3.699793864949399*^9, 3.699847509644327*^9, 
   3.699850685973023*^9, 3.699853786497395*^9, 3.699955387562585*^9, 
   3.70220135154718*^9, 3.7022897154491863`*^9, 3.70417901455355*^9, 
   3.704517752570101*^9, {3.705386353950165*^9, 3.7053863587980022`*^9}, 
   3.70538654765583*^9, 3.709990246021771*^9, 3.709990600417149*^9, 
   3.710048215703889*^9, 3.71004970764592*^9, 3.71005433740177*^9, 
   3.7100545448285646`*^9, 3.710157004389598*^9, 3.7134074074413013`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]BDexemple", "-", "\[Gamma]BD"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.6997880588652267`*^9, 3.699788076656334*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699788066511174*^9, 3.6997880771213427`*^9}, 
   3.699793865313139*^9, 3.6998475097083883`*^9, 3.699850686611573*^9, 
   3.699853786579216*^9, 3.699955387656536*^9, 3.702201351583353*^9, 
   3.702289715530821*^9, 3.7041790146585817`*^9, 3.7045177527881517`*^9, 
   3.705386360358778*^9, 3.7053865484441767`*^9, 3.709990247084528*^9, 
   3.709990600462048*^9, 3.710048216095747*^9, 3.710049707701622*^9, 
   3.710054337456411*^9, 3.710054544909442*^9, 3.710157004516389*^9, 
   3.713407407464106*^9}]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 3.7100472277111177`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wright-Fisher", "Subsection",
 CellChangeTimes->{{3.667817266049498*^9, 3.667817267641507*^9}, {
   3.66782181858403*^9, 3.667821819675145*^9}, {3.66782936574275*^9, 
   3.6678293897729073`*^9}, 3.670318583924882*^9, {3.679394331716178*^9, 
   3.67939433186239*^9}}],

Cell["\<\
The structure is the same as for Moran DB above - comments are lighter here!\
\>", "Text",
 CellChangeTimes->{{3.710048063471426*^9, 3.710048080308312*^9}}],

Cell[CellGroupData[{

Cell["Define \[Delta]B and \[Delta]D", "Subsubsection",
 CellChangeTimes->{{3.667817270639081*^9, 3.667817303563981*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sBfWF", "[", 
    RowBox[{
    "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "j_", ",", "k_"}], 
    "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox["graphdegree", "2"]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Delta", "[", 
        RowBox[{"k", "-", "j"}], "]"}], 
       SuperscriptBox["graphdegree", "2"]}], "-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"G", "\[LeftDoubleBracket]", 
          RowBox[{"j", ",", "i"}], "\[RightDoubleBracket]"}], 
         RowBox[{"G", "\[LeftDoubleBracket]", 
          RowBox[{"k", ",", "i"}], "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], 
     ")"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DfWF", "[", 
    RowBox[{
    "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "j_", ",", "k_"}], 
    "]"}], ":=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BstarWF", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.667805794031062*^9, 3.6678058049416933`*^9}, {
   3.667805883047532*^9, 3.667806013751638*^9}, {3.667806064496217*^9, 
   3.667806108193321*^9}, {3.6678067367929573`*^9, 3.667806737538381*^9}, {
   3.667806855132804*^9, 3.667806855241205*^9}, 3.6678069002815533`*^9, {
   3.6678178907809553`*^9, 3.6678178913089523`*^9}, {3.6678218224839478`*^9, 
   3.667821926596066*^9}, {3.667829392668222*^9, 3.667829444078204*^9}, {
   3.699779079313068*^9, 3.699779084984041*^9}, {3.699787483271895*^9, 
   3.699787499548053*^9}, 3.6997875336757717`*^9, {3.710044640003652*^9, 
   3.710044641907976*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations \[Beta]", "Subsubsection",
 CellChangeTimes->{{3.704518466305232*^9, 3.704518471077755*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]WFexemple", "=", 
  RowBox[{
   RowBox[{"GetBeta", "[", 
    RowBox[{
    "sBfWF", ",", "DfWF", ",", "G12generic", ",", "GE12generic", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarWF", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.704518473149928*^9, 3.704518477106106*^9}, {
  3.704518525281973*^9, 3.704518525614408*^9}, {3.705386390297328*^9, 
  3.70538639242488*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["dself", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"eself", "+", 
         RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
         RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["din", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"ein", "+", "eself", "+", 
         RowBox[{"3", " ", "ein", " ", "Qin"}], "+", 
         RowBox[{"eself", " ", "Qin"}], "+", 
         RowBox[{"18", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"18", " ", "dout", " ", "dself", " ", 
       RowBox[{"(", 
        RowBox[{"eout", "+", 
         RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
         RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
         RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
         RowBox[{"eself", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"9", " ", 
       SuperscriptBox["dout", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "ein"}], "+", 
            RowBox[{"6", " ", "eout"}], "+", "eself"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "Qin"}]}], ")"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "ein"}], "+", 
            RowBox[{"21", " ", "eout"}], "+", 
            RowBox[{"2", " ", "eself"}]}], ")"}], " ", "Qout"}]}], ")"}]}], 
      "+", 
      RowBox[{"4", " ", "din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", 
          RowBox[{"(", 
           RowBox[{"ein", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ein", "+", "eself"}], ")"}], " ", "Qin"}], "+", 
            RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
         RowBox[{"9", " ", "dout", " ", 
          RowBox[{"(", 
           RowBox[{"eout", "+", 
            RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
            RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
            RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
            RowBox[{"eself", " ", "Qout"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.704518529446055*^9, 3.705386394172173*^9, 3.709990250496046*^9, 
   3.709990600623661*^9, {3.710048220351632*^9, 3.7100482284837847`*^9}, 
   3.710049708447452*^9, 3.710054337700239*^9, 3.710054545933804*^9, 
   3.710157005828615*^9, 3.713407408939728*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]WFexemple", "-", "\[Beta]WF"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.704518541723769*^9, 3.7045185466164417`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.704518548079015*^9, 3.705386395290873*^9, 
  3.70999025086061*^9, 3.70999060071074*^9, 3.710048229113312*^9, 
  3.710049708497816*^9, 3.710054337735457*^9, 3.7100545460946293`*^9, 
  3.7101570060424633`*^9, 3.713407408981235*^9}]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 3.7100472277111177`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations \[Gamma]", "Subsubsection",
 CellChangeTimes->{{3.704518466305232*^9, 3.704518471077755*^9}, {
  3.704518565295594*^9, 3.7045185659244537`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]WFexemple", "=", 
  RowBox[{
   RowBox[{"GetGamma", "[", 
    RowBox[{
    "sBfWF", ",", "DfWF", ",", "G12generic", ",", "GE12generic", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarWF", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.704518473149928*^9, 3.704518477106106*^9}, {
  3.704518525281973*^9, 3.704518525614408*^9}, {3.704518573841819*^9, 
  3.70451857849754*^9}, {3.7053863990730762`*^9, 3.705386401225338*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["dself", "2"], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["din", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "Qin"}], ")"}]}], "+", 
      RowBox[{"4", " ", "din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", "Qin"}], "+", 
         RowBox[{"9", " ", "dout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"9", " ", "dout", " ", 
       RowBox[{"(", 
        RowBox[{"dout", "+", 
         RowBox[{"2", " ", "dout", " ", "Qin"}], "+", 
         RowBox[{"6", " ", "dout", " ", "Qout"}], "+", 
         RowBox[{"2", " ", "dself", " ", "Qout"}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.704518529446055*^9, 3.704518586982461*^9, 
  3.70538640188498*^9, 3.709990252338045*^9, 3.709990600925812*^9, 
  3.7100482304906187`*^9, 3.7100497086671467`*^9, 3.71005433787577*^9, 
  3.710054546329961*^9, 3.7101570062810593`*^9, 3.713407409178536*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]WFexemple", "-", "\[Gamma]WF"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.704518541723769*^9, 3.7045185466164417`*^9}, {
  3.704518588888479*^9, 3.7045185931197243`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.7045185935188313`*^9, 3.705386404107149*^9, 
  3.709990253340064*^9, 3.70999060098426*^9, 3.710048230938107*^9, 
  3.7100497087072163`*^9, 3.710054337911253*^9, 3.710054546363802*^9, 
  3.710157006309971*^9, 3.713407409201877*^9}]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 3.7100472277111177`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Expected frequencies of altruists in the population", "Section",
 CellChangeTimes->{{3.699793899806631*^9, 3.699793901911666*^9}, {
  3.710048355732325*^9, 3.710048363875052*^9}}],

Cell[CellGroupData[{

Cell["Moran BD", "Subsection",
 CellChangeTimes->{{3.7100483656347847`*^9, 3.7100483687841043`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EXBD", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"p", "+", 
      RowBox[{"\[Delta]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Beta]BD", " ", "b"}], " ", "-", " ", 
         RowBox[{"\[Gamma]BD", " ", "c"}]}], ")"}]}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
       RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", "genericde"}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.699794103164796*^9, 3.699794182877057*^9}, {
   3.699847658278121*^9, 3.69984768206605*^9}, {3.6998478842384787`*^9, 
   3.69984789314879*^9}, 3.699847955062521*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", "\[Mu]",
        " ", 
       RowBox[{"(", 
        RowBox[{"m", "-", "n", "+", 
         RowBox[{"Idself", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
         RowBox[{"m", " ", "\[Mu]"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "c"}], " ", "Idself", " ", "m", " ", "n", " ", 
          "\[Delta]"}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "\[Delta]"}], "+", 
         RowBox[{"c", " ", "Idself", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "\[Delta]"}], "+", 
         RowBox[{"c", " ", "m", " ", 
          SuperscriptBox["n", "2"], " ", "\[Delta]"}], "+", 
         RowBox[{
         "c", " ", "Idself", " ", "m", " ", "n", " ", "p", " ", "\[Delta]"}], 
         "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "p", " ", "\[Delta]"}], 
         "-", 
         RowBox[{"c", " ", "Idself", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "p", " ", "\[Delta]"}], 
         "-", 
         RowBox[{"c", " ", "m", " ", 
          SuperscriptBox["n", "2"], " ", "p", " ", "\[Delta]"}], "+", 
         RowBox[{"Idself", " ", "\[Mu]"}], "-", 
         RowBox[{"Idself", " ", "m", " ", "\[Mu]"}], "-", 
         RowBox[{"n", " ", "\[Mu]"}], "+", 
         RowBox[{"2", " ", "m", " ", "n", " ", "\[Mu]"}], "-", 
         RowBox[{"m", " ", 
          SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
         RowBox[{
         "2", " ", "c", " ", "Idself", " ", "\[Delta]", " ", "\[Mu]"}], "-", 
         RowBox[{
         "2", " ", "c", " ", "Idself", " ", "m", " ", "\[Delta]", " ", 
          "\[Mu]"}], "-", 
         RowBox[{"2", " ", "c", " ", "n", " ", "\[Delta]", " ", "\[Mu]"}], 
         "-", 
         RowBox[{
         "c", " ", "Idself", " ", "n", " ", "\[Delta]", " ", "\[Mu]"}], "+", 
         RowBox[{
         "2", " ", "c", " ", "m", " ", "n", " ", "\[Delta]", " ", "\[Mu]"}], 
         "+", 
         RowBox[{
         "2", " ", "c", " ", "Idself", " ", "m", " ", "n", " ", "\[Delta]", 
          " ", "\[Mu]"}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "\[Delta]", " ", "\[Mu]"}],
          "-", 
         RowBox[{"c", " ", "Idself", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "\[Delta]", " ", "\[Mu]"}],
          "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["n", "2"], " ", "\[Delta]", " ", "\[Mu]"}], "-", 
         RowBox[{"2", " ", "c", " ", "m", " ", 
          SuperscriptBox["n", "2"], " ", "\[Delta]", " ", "\[Mu]"}], "-", 
         RowBox[{
         "2", " ", "c", " ", "Idself", " ", "p", " ", "\[Delta]", " ", 
          "\[Mu]"}], "+", 
         RowBox[{
         "2", " ", "c", " ", "Idself", " ", "m", " ", "p", " ", "\[Delta]", 
          " ", "\[Mu]"}], "+", 
         RowBox[{
         "2", " ", "c", " ", "n", " ", "p", " ", "\[Delta]", " ", "\[Mu]"}], 
         "+", 
         RowBox[{
         "c", " ", "Idself", " ", "n", " ", "p", " ", "\[Delta]", " ", 
          "\[Mu]"}], "-", 
         RowBox[{
         "2", " ", "c", " ", "m", " ", "n", " ", "p", " ", "\[Delta]", " ", 
          "\[Mu]"}], "-", 
         RowBox[{
         "2", " ", "c", " ", "Idself", " ", "m", " ", "n", " ", "p", " ", 
          "\[Delta]", " ", "\[Mu]"}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "p", " ", "\[Delta]", " ", 
          "\[Mu]"}], "+", 
         RowBox[{"c", " ", "Idself", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "p", " ", "\[Delta]", " ", 
          "\[Mu]"}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["n", "2"], " ", "p", " ", "\[Delta]", " ", "\[Mu]"}],
          "+", 
         RowBox[{"2", " ", "c", " ", "m", " ", 
          SuperscriptBox["n", "2"], " ", "p", " ", "\[Delta]", " ", "\[Mu]"}],
          "-", 
         RowBox[{"Idself", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"Idself", " ", "m", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"2", " ", "n", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"2", " ", "m", " ", "n", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["n", "2"], " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"m", " ", 
          SuperscriptBox["n", "2"], " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"c", " ", "Idself", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"c", " ", "Idself", " ", "m", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"2", " ", "c", " ", "n", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"2", " ", "c", " ", "m", " ", "n", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["n", "2"], " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"c", " ", "m", " ", 
          SuperscriptBox["n", "2"], " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"c", " ", "Idself", " ", "p", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"c", " ", "Idself", " ", "m", " ", "p", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"2", " ", "c", " ", "n", " ", "p", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{
         "2", " ", "c", " ", "m", " ", "n", " ", "p", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["n", "2"], " ", "p", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"c", " ", "m", " ", 
          SuperscriptBox["n", "2"], " ", "p", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "Ieself"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", "\[Mu]"}],
               ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", "\[Mu]"}],
               ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "n", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}], "+", 
            RowBox[{"Idself", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Ieself", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"m", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
                  "\[Mu]"}], ")"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}],
               ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["m", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"c", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]"}], "+", 
            
            RowBox[{"b", " ", 
             RowBox[{"(", 
              RowBox[{"\[Delta]", "-", 
               RowBox[{"p", " ", "\[Delta]"}]}], ")"}]}], "+", "\[Mu]"}], 
           ")"}]}], "+", 
         RowBox[{"\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"c", "+", 
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", "Ieself"}]}], 
                 ")"}]}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
             "\[Mu]"}], "+", 
            RowBox[{"n", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"3", " ", "c", " ", "\[Delta]"}], "-", 
               RowBox[{"3", " ", "c", " ", "p", " ", "\[Delta]"}], "-", 
               RowBox[{"2", " ", "\[Mu]"}], "-", 
               RowBox[{"2", " ", "c", " ", "\[Delta]", " ", "\[Mu]"}], "+", 
               RowBox[{
               "2", " ", "c", " ", "p", " ", "\[Delta]", " ", "\[Mu]"}], "-", 
               
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", "Ieself", "+", 
                  RowBox[{"g", " ", 
                   RowBox[{"(", 
                    RowBox[{"2", "+", 
                    RowBox[{"Ieself", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
                    "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
                  RowBox[{"Ieself", " ", "\[Mu]"}]}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["n", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"\[Mu]", "+", 
               RowBox[{"c", " ", "\[Delta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "p", "+", "\[Mu]", "-", 
                  RowBox[{"p", " ", "\[Mu]"}]}], ")"}]}]}], ")"}]}]}], 
           ")"}]}], "+", 
         RowBox[{"m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"n", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Delta]", "-", 
                  RowBox[{"p", " ", "\[Delta]"}]}], ")"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"c", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
                   "\[Delta]"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
             "\[Mu]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "c", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "-", "Ieself", "-", 
                  RowBox[{"2", " ", "\[Mu]"}], "+", 
                  RowBox[{"g", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "Ieself", "+", "\[Mu]"}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"Idself", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]"}], 
               "+", 
               RowBox[{"c", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Delta]", "-", 
                  RowBox[{"p", " ", "\[Delta]"}]}], ")"}]}], "-", "\[Mu]"}], 
              ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
            RowBox[{"\[Mu]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Mu]", "+", 
               RowBox[{"c", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", "n", "+", 
                  RowBox[{"2", " ", "\[Mu]"}]}], ")"}]}], "+", 
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
                RowBox[{"(", 
                 RowBox[{"3", "-", "Ieself", "-", 
                  RowBox[{"2", " ", "\[Mu]"}], "+", 
                  RowBox[{"g", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "Ieself", "+", "\[Mu]"}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
      RowBox[{"Idself", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
         RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
      "+", 
      RowBox[{"m", " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
        ")"}]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.699847950839044*^9, 3.699847957073048*^9}, 
   3.699850696950412*^9, 3.699853788663226*^9, 3.699955389774281*^9, 
   3.702201353655032*^9, 3.702218213982106*^9, 3.70228971785221*^9, 
   3.7041790172637997`*^9, 3.70451775497647*^9, 3.7053869313432703`*^9, 
   3.705387257551435*^9, 3.709990257453497*^9, 3.7099906025612917`*^9, 
   3.7100497104966097`*^9, 3.710054339658348*^9, 3.710054547929489*^9, 
   3.710157008043213*^9, 3.713407411466063*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moran DB", "Subsection",
 CellChangeTimes->{{3.710048383474581*^9, 3.7100483857029552`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EXDB", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"p", "+", 
      RowBox[{"\[Delta]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Beta]DB", " ", "b"}], " ", "-", " ", 
         RowBox[{"\[Gamma]DB", " ", "c"}]}], ")"}]}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
       RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", "genericde"}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.699794103164796*^9, 3.699794182877057*^9}, {
   3.699847658278121*^9, 3.69984768206605*^9}, {3.6998478842384787`*^9, 
   3.6998479101499863`*^9}, {3.6998479617010317`*^9, 3.699847962342051*^9}, 
   3.7100483811403723`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"n", "-", 
          RowBox[{"d", " ", "n"}]}], ")"}], "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["m", "2"]}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
         RowBox[{"Idself", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
            RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]", 
          " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
           ")"}]}], "-", 
         RowBox[{"m", " ", "n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
           ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
       SuperscriptBox["n", "3"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p"}], ")"}], " ", "\[Delta]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m", " ", "n", " ", 
             RowBox[{"(", 
              RowBox[{"2", "+", 
               RowBox[{"d", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"n", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
                  RowBox[{"2", " ", "\[Mu]"}]}], ")"}]}]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "n", " ", 
             "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["m", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", 
               RowBox[{"d", " ", "n"}], "+", "\[Mu]"}], ")"}]}], "-", 
            RowBox[{
             SuperscriptBox["Idself", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"m", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
                  "\[Mu]"}], ")"}]}], "+", "\[Mu]"}], ")"}]}], "+", 
            RowBox[{"Idself", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", " ", 
                SuperscriptBox["m", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]"}], "+", 
               
               RowBox[{"m", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "-", 
                  RowBox[{"2", " ", "d", " ", "\[Mu]"}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["m", "2"]}], "-", 
            RowBox[{"2", " ", "d", " ", 
             SuperscriptBox["m", "2"]}], "-", 
            RowBox[{"2", " ", "d", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "Ieself", " ", 
             SuperscriptBox["m", "2"]}], "+", 
            RowBox[{"2", " ", "d", " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"]}], "+", 
            RowBox[{"d", " ", "g", " ", 
             SuperscriptBox["m", "3"]}], "+", 
            RowBox[{"d", " ", "Ieself", " ", 
             SuperscriptBox["m", "3"]}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "Ieself", " ", 
             SuperscriptBox["m", "3"]}], "-", 
            RowBox[{"d", " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "3"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "3"]}], "-", 
            RowBox[{"2", " ", "m", " ", "n"}], "+", 
            RowBox[{"2", " ", "d", " ", "m", " ", "n"}], "+", 
            RowBox[{"2", " ", "d", " ", "Ieself", " ", "m", " ", "n"}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "Ieself", " ", "m", " ", "n"}], 
            "-", 
            RowBox[{
            "2", " ", "d", " ", "g", " ", "Ieself", " ", "m", " ", "n"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", "m", " ",
              "n"}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["m", "2"], " ", "n"}], "+", 
            RowBox[{"3", " ", "d", " ", 
             SuperscriptBox["m", "2"], " ", "n"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["m", "2"], " ", "n"}], "-", 
            RowBox[{"2", " ", "d", " ", "g", " ", 
             SuperscriptBox["m", "2"], " ", "n"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", 
             SuperscriptBox["m", "2"], " ", "n"}], "-", 
            RowBox[{"d", " ", 
             SuperscriptBox["m", "3"], " ", "n"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["m", "3"], " ", "n"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", 
             SuperscriptBox["m", "3"], " ", "n"}], "+", 
            RowBox[{"2", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "-", 
            RowBox[{"3", " ", "d", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{"d", " ", "g", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "-", 
            RowBox[{"d", " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{"d", " ", "g", " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{"d", " ", 
             SuperscriptBox["m", "2"], " ", 
             SuperscriptBox["n", "2"]}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["m", "2"], " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", 
             SuperscriptBox["m", "2"], " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{"2", " ", "g", " ", "m", " ", "\[Mu]"}], "-", 
            RowBox[{"2", " ", "d", " ", "g", " ", "m", " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", "Ieself", " ", "m", " ", "\[Mu]"}], "-", 
            RowBox[{"4", " ", "d", " ", "Ieself", " ", "m", " ", "\[Mu]"}], 
            "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "Ieself", " ", "m", " ", 
             "\[Mu]"}], "-", 
            RowBox[{"2", " ", "g", " ", "Ieself", " ", "m", " ", "\[Mu]"}], 
            "+", 
            RowBox[{
            "4", " ", "d", " ", "g", " ", "Ieself", " ", "m", " ", "\[Mu]"}], 
            "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", "m", " ",
              "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"d", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"g", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", "d", " ", "g", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"Ieself", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"4", " ", "d", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["d", "2"], " ", "Ieself", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"g", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"4", " ", "d", " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"3", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"d", " ", "g", " ", 
             SuperscriptBox["m", "3"], " ", "\[Mu]"}], "-", 
            RowBox[{"d", " ", "Ieself", " ", 
             SuperscriptBox["m", "3"], " ", "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "Ieself", " ", 
             SuperscriptBox["m", "3"], " ", "\[Mu]"}], "+", 
            RowBox[{"d", " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "3"], " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "3"], " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{"4", " ", "d", " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{"2", " ", "g", " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"4", " ", "d", " ", "g", " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "n", " ", "\[Mu]"}], 
            "-", 
            RowBox[{"2", " ", "Ieself", " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"4", " ", "d", " ", "Ieself", " ", "n", " ", "\[Mu]"}], 
            "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "Ieself", " ", "n", " ", 
             "\[Mu]"}], "+", 
            RowBox[{"2", " ", "g", " ", "Ieself", " ", "n", " ", "\[Mu]"}], 
            "-", 
            RowBox[{
            "4", " ", "d", " ", "g", " ", "Ieself", " ", "n", " ", "\[Mu]"}], 
            "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", "n", " ",
              "\[Mu]"}], "-", 
            RowBox[{"2", " ", "m", " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"6", " ", "d", " ", "m", " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["d", "2"], " ", "m", " ", "n", " ", "\[Mu]"}], 
            "-", 
            RowBox[{
            "4", " ", "d", " ", "g", " ", "m", " ", "n", " ", "\[Mu]"}], "+", 
            
            RowBox[{"4", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "m", " ", "n", " ", 
             "\[Mu]"}], "-", 
            RowBox[{
            "2", " ", "d", " ", "Ieself", " ", "m", " ", "n", " ", "\[Mu]"}], 
            "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "Ieself", " ", "m", " ", "n", " ",
              "\[Mu]"}], "+", 
            RowBox[{
            "2", " ", "d", " ", "g", " ", "Ieself", " ", "m", " ", "n", " ", 
             "\[Mu]"}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", "m", " ",
              "n", " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["m", "2"], " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{"5", " ", "d", " ", 
             SuperscriptBox["m", "2"], " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"3", " ", 
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["m", "2"], " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", "d", " ", "g", " ", 
             SuperscriptBox["m", "2"], " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", 
             SuperscriptBox["m", "2"], " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"d", " ", 
             SuperscriptBox["m", "3"], " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["m", "3"], " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", 
             SuperscriptBox["m", "3"], " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", "d", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"g", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"2", " ", "d", " ", "g", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"Ieself", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"2", " ", "d", " ", "Ieself", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "Ieself", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"g", " ", "Ieself", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", "d", " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"d", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"d", " ", "g", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"d", " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"d", " ", "g", " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", 
             SuperscriptBox["Idself", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "Ieself"}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"m", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
                  "\[Mu]"}], ")"}]}], "+", "\[Mu]"}], ")"}]}], "+", 
            RowBox[{"Idself", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", " ", 
                SuperscriptBox["m", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "-", 
                  RowBox[{"2", " ", "g", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Ieself"}], ")"}]}], "+", 
                  RowBox[{"2", " ", "Ieself"}], "+", 
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "Ieself"}], "-", "n"}], ")"}]}], "-", 
                  "n"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "Ieself"}], ")"}], " ", "\[Mu]"}], 
               "-", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "m", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "n", "+", 
                  RowBox[{"g", " ", "\[Mu]"}], "+", 
                  RowBox[{"Ieself", " ", "\[Mu]"}], "-", 
                  RowBox[{"g", " ", "Ieself", " ", "\[Mu]"}], "-", 
                  RowBox[{"n", " ", "\[Mu]"}], "-", 
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"Ieself", "+", 
                    RowBox[{"n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]",
                     "-", 
                    RowBox[{"2", " ", "Ieself", " ", "\[Mu]"}]}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
  "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"n", "-", 
       RowBox[{"d", " ", "n"}]}], ")"}], "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
      RowBox[{"Idself", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
         RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
      "-", 
      RowBox[{"m", " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
        ")"}]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.69984796692839*^9, 3.6998480003521223`*^9, 
  3.699850704564148*^9, 3.699853794552924*^9, 3.6999553946642847`*^9, 
  3.702201359294602*^9, 3.70228972401832*^9, 3.7041790259883947`*^9, 
  3.704517760316613*^9, 3.7053872631482477`*^9, 3.709990262320902*^9, 
  3.709990608073999*^9, 3.710049716465612*^9, 3.710054345134987*^9, 
  3.7100545532419252`*^9, 3.710157012991042*^9, 3.713407418498376*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wright - Fisher", "Subsection",
 CellChangeTimes->{{3.7100483889694242`*^9, 3.7100483963311768`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EXWF", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"p", "+", 
      RowBox[{"\[Delta]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Beta]WF", " ", "b"}], " ", "-", " ", 
         RowBox[{"\[Gamma]WF", " ", "c"}]}], ")"}]}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Qin", "\[Rule]", "QinWF"}], ",", 
       RowBox[{"Qout", "\[Rule]", "QoutWF"}]}], "}"}]}], "/.", "genericde"}], 
   "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.699794103164796*^9, 3.699794182877057*^9}, {
  3.699847658278121*^9, 3.69984768206605*^9}, {3.6998478842384787`*^9, 
  3.6998479101499863`*^9}, {3.6998479656376753`*^9, 3.699847966301961*^9}}],

Cell[BoxData[
 RowBox[{"p", "+", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}], " ", "p", " ", "\[Delta]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{
              SuperscriptBox["Idself", "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"]}], 
             SuperscriptBox["n", "2"]], "+", 
            FractionBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"Idself", "-", "n"}], ")"}], "2"]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
              SuperscriptBox["n", "2"]}]], "+", 
            FractionBox[
             SuperscriptBox["m", "2"], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n"}]], "-", 
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "+", 
                RowBox[{"d", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2"}], "+", "m"}], ")"}]}]}], ")"}], " ", "m",
               " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["1", 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                FractionBox["1", 
                 RowBox[{
                  RowBox[{"2", " ", "\[Mu]"}], "-", 
                  SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                FractionBox[
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "d"}], 
                 RowBox[{"1", "-", 
                  FractionBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                FractionBox[
                 RowBox[{"d", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                 RowBox[{"1", "-", 
                  FractionBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                FractionBox["1", 
                 RowBox[{
                  RowBox[{"2", " ", "\[Mu]"}], "-", 
                  SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "Idself", " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
                  SuperscriptBox["Idself", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "n"}], "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "m", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "n"}], "+", 
                 RowBox[{
                  SuperscriptBox["m", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "n"}]}], 
                   ")"}]}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                 FractionBox["d", 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                 FractionBox[
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}], "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"Ieself", "-", 
           RowBox[{"g", " ", "Ieself"}]}], "n"], "+", 
         FractionBox[
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", 
               RowBox[{"1", "-", 
                FractionBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                  " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
             FractionBox["1", 
              RowBox[{
               RowBox[{"2", " ", "\[Mu]"}], "-", 
               SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"-", "1"}], "+", "d"}], 
            RowBox[{"1", "-", 
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
               " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
           FractionBox[
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
            RowBox[{"1", "-", 
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
           FractionBox["1", 
            RowBox[{
             RowBox[{"2", " ", "\[Mu]"}], "-", 
             SuperscriptBox["\[Mu]", "2"]}]]}]], "-", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Ieself", "-", "n"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                 " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
             FractionBox["d", 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
             FractionBox["1", 
              RowBox[{
               RowBox[{"2", " ", "\[Mu]"}], "-", 
               SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
          RowBox[{"n", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                 " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
             FractionBox[
              RowBox[{"d", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
             FractionBox["1", 
              RowBox[{
               RowBox[{"2", " ", "\[Mu]"}], "-", 
               SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]], "-", 
         RowBox[{
          FractionBox["1", 
           SuperscriptBox["n", "2"]], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Idself", "-", 
              RowBox[{"Idself", " ", "m"}]}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"Ieself", "-", 
               RowBox[{"g", " ", "Ieself"}]}], "n"], "+", 
             FractionBox[
              RowBox[{"g", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["1", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "1"}], "+", "d"}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                   " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
               FractionBox[
                RowBox[{"d", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
               FractionBox["1", 
                RowBox[{
                 RowBox[{"2", " ", "\[Mu]"}], "-", 
                 SuperscriptBox["\[Mu]", "2"]}]]}]], "-", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "g"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"Ieself", "-", "n"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                 FractionBox["d", 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
              RowBox[{"n", " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                 FractionBox[
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]]}], ")"}]}]}], 
         "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", "n"}]], 
          RowBox[{
           SuperscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "-", 
                 RowBox[{"3", " ", "d"}], "+", 
                 SuperscriptBox["d", "2"], "+", "g"}], ")"}], " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["1", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "1"}], "+", "d"}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                   " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
               FractionBox[
                RowBox[{"d", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
               FractionBox["1", 
                RowBox[{
                 RowBox[{"2", " ", "\[Mu]"}], "-", 
                 SuperscriptBox["\[Mu]", "2"]}]]}]], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d", "-", "g"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                FractionBox[
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                    FractionBox["d", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                  FractionBox[
                   RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                  FractionBox["1", 
                   RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}]]}], ")"}]}]}], 
            ")"}]}]}], "-", 
         RowBox[{
          FractionBox["1", "n"], 
          RowBox[{"2", " ", "Idself", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "m"}], ")"}], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "g"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["1", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "1"}], "+", "d"}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                   " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
               FractionBox[
                RowBox[{"d", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
               FractionBox["1", 
                RowBox[{
                 RowBox[{"2", " ", "\[Mu]"}], "-", 
                 SuperscriptBox["\[Mu]", "2"]}]]}]], "+", 
             RowBox[{
              FractionBox["1", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n"}]], 
              RowBox[{"g", " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "n", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                   FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                   FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}]], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                    FractionBox["d", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                   FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                   FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}]]}], ")"}]}]}]}], 
            ")"}]}]}], "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
            SuperscriptBox["n", "2"]}]], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Idself", "-", "n"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"Ieself", "-", 
               RowBox[{"g", " ", "Ieself"}]}], "n"], "+", 
             FractionBox[
              RowBox[{"g", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["1", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "1"}], "+", "d"}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                   " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
               FractionBox[
                RowBox[{"d", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
               FractionBox["1", 
                RowBox[{
                 RowBox[{"2", " ", "\[Mu]"}], "-", 
                 SuperscriptBox["\[Mu]", "2"]}]]}]], "+", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "g"}], ")"}], " ", "Ieself", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                 FractionBox["d", 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
              RowBox[{"n", " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                 FractionBox[
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "g"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"Ieself", "-", "n"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "n", "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"3", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", "n"}]}], 
                    ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                    FractionBox["d", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                   FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                   FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}]]}], ")"}]}], 
              RowBox[{"n", "-", 
               SuperscriptBox["n", "2"]}]]}], ")"}]}]}], "+", 
         RowBox[{
          FractionBox["1", "n"], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "m"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Idself", "-", "n"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["1", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}]], 
              RowBox[{"m", " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox["g", "n"], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d", "-", "g"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                   FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                   FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}]], "+", 
                 FractionBox[
                  RowBox[{"g", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                    FractionBox["d", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{"n", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                    FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]]}], ")"}]}]}], 
             "+", 
             RowBox[{
              FractionBox["1", "n"], 
              RowBox[{"Idself", " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", "m"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"Ieself", "-", "n"}], ")"}]}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]], "+", 
                 FractionBox[
                  RowBox[{"g", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                   FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                   FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}]], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "g"}], ")"}], " ", "Ieself", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                    FractionBox["d", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{"n", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                    FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "g"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"Ieself", "-", "n"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                    FractionBox["d", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"n", "-", 
                    SuperscriptBox["n", "2"]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                    FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]]}], 
                ")"}]}]}]}], ")"}]}]}]}], ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.6998479732848587`*^9, 3.699848060824608*^9, 
  3.6998507474099894`*^9, 3.6998538313784227`*^9, 3.699955425644464*^9, 
  3.7022013904600773`*^9, 3.702289763161767*^9, 3.7041790863427*^9, 
  3.704517794173602*^9, 3.705387298191299*^9, 3.709990299963561*^9, 
  3.709990640396688*^9, 3.710049751502159*^9, 3.710054379436544*^9, 
  3.710054587014152*^9, 3.7101570439856453`*^9, 3.713407464767517*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export to R", "Section",
 CellChangeTimes->{{3.710054285978345*^9, 3.710054288785317*^9}}],

Cell[CellGroupData[{

Cell["Export the EX formulas to R", "Subsubsection",
 CellChangeTimes->{{3.702201500553801*^9, 3.702201503237453*^9}, {
  3.710048406724223*^9, 3.710048409155136*^9}, {3.7100542275051394`*^9, 
  3.710054227856474*^9}}],

Cell["Rewrite the Greek letters", "Text",
 CellChangeTimes->{{3.702202576100587*^9, 3.702202585533182*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GreekTerms", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Delta]", "\[Rule]", "sel"}], ",", " ", 
    RowBox[{"\[Mu]", "\[Rule]", "mut"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.702201509383871*^9, 3.702201525212894*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Delta]", "\[Rule]", "sel"}], ",", 
   RowBox[{"\[Mu]", "\[Rule]", "mut"}]}], "}"}]], "Output",
 CellChangeTimes->{3.70220152616304*^9, 3.7022030131218777`*^9, 
  3.7022897635244837`*^9, 3.704179086467165*^9, 3.7045177944473457`*^9, 
  3.709990534196932*^9, 3.709990640508429*^9, 3.71004975160399*^9, 
  3.7100545872346973`*^9, 3.710157044181634*^9, 3.7134074649711103`*^9}]
}, Open  ]],

Cell["Common parts to all functions", "Text",
 CellChangeTimes->{{3.7022025881711607`*^9, 3.7022025922143908`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "FunctionPartB", "=", 
   "\"\< <- function(b, c, p, sel, mut, m, g, n, d, Idself, Ieself){\n## \
Arguments:\n#  b   benefit of interaction\n#  c   cost of interaction\n#  p   \
mutation bias\n#  sel intensity of selection\n#  mut mutation probability\n#  \
m   emigration probability\n#  g   proportion of interactions out of the \
group (interaction equivalent of m)\n#  n   deme size\n#  d   number of demes\
\n#  Idself whether reproduction in site where the parent is\n#  Ieself \
whether interactions with oneself\nreturn(\n\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FunctionPartE", "=", "\"\<)\n}\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.702201586590098*^9, 3.702201660652206*^9}, {
  3.702202515399782*^9, 3.70220251599327*^9}, {3.702202562602117*^9, 
  3.702202562914797*^9}, {3.702202598064639*^9, 3.702202697296604*^9}, {
  3.702202988690043*^9, 3.702203007885222*^9}}],

Cell["Function to translate Mathematica to R", "Text",
 CellChangeTimes->{{3.702202703211164*^9, 3.702202713861825*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToRForm", "[", "x_", "]"}], ":=", 
  RowBox[{"ToString", "[", 
   RowBox[{
    RowBox[{"x", "/.", "GreekTerms"}], "//", "CForm"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.702201842966589*^9, 3.702201859620515*^9}}],

Cell["Do it for all life cycles", "Text",
 CellChangeTimes->{{3.70220271595133*^9, 3.70220272896882*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RtxtBD", "=", 
   RowBox[{"\"\<pBD \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", "EXBD", "]"}], "<>", "FunctionPartE"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtDB", "=", 
   RowBox[{"\"\<pDB \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", "EXDB", "]"}], "<>", "FunctionPartE"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtWF", "=", 
   RowBox[{"\"\<pWF \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", "EXWF", "]"}], "<>", "FunctionPartE"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.702201679506662*^9, 3.702201723635545*^9}, {
  3.7022018328117237`*^9, 3.702201832929533*^9}, {3.702201871610055*^9, 
  3.702201903052576*^9}}],

Cell["Define Power function in R", "Text",
 CellChangeTimes->{{3.7022027318210173`*^9, 3.702202737612219*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PowerDef", "=", "\"\<Power <- function(a,b) return(a^b)\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.702201909153489*^9, 3.7022019359137297`*^9}, {
  3.7022019780679827`*^9, 3.702201985090732*^9}}],

Cell["Combine all texts", "Text",
 CellChangeTimes->{{3.702202739839615*^9, 3.702202745125101*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rtxt", "=", 
   RowBox[{
   "PowerDef", "<>", "\"\<\n\n\>\"", "<>", "RtxtBD", "<>", "\"\<\n\n\>\"", "<>",
     "RtxtDB", "<>", "\"\<\n\n\>\"", "<>", "RtxtWF"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7022019405139227`*^9, 3.702201966147601*^9}}],

Cell["Export to txt file (Mathematica did not want R)", "Text",
 CellChangeTimes->{{3.702202748144455*^9, 3.70220275825738*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"pathtosave", "<>", "\"\<Mathematica/analytics.txt\>\""}], ",", 
    "Rtxt"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.702201967861699*^9, 3.702202007961507*^9}, {
   3.702202094017145*^9, 3.7022021946253023`*^9}, {3.705388016090308*^9, 
   3.705388027352977*^9}, 3.705388096352022*^9}],

Cell["Convert the file extension to R", "Text",
 CellChangeTimes->{{3.702202760522964*^9, 3.702202776867174*^9}, {
  3.709990758298483*^9, 3.7099907595872707`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cmd", "=", 
   RowBox[{
   "\"\<mv\>\"", "<>", "\"\< \>\"", "<>", " ", "pathtosave", "<>", 
    "\"\<Mathematica/analytics.txt \>\"", "<>", "pathtosave", "<>", 
    "\"\<Mathematica/analytics.R\>\""}]}], ";"}]], "Input",
 CellChangeTimes->{{3.709991369942276*^9, 3.709991373128109*^9}, 
   3.7099914070907507`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"\"\<!\>\"", "<>", "cmd"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.709991066140975*^9, 3.709991076975725*^9}, 
   3.7099911333551807`*^9, {3.70999138465051*^9, 3.7099913991181173`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export to R the \[Beta] and \[Gamma] functions", "Subsubsection",
 CellChangeTimes->{{3.702201500553801*^9, 3.702201503237453*^9}, {
  3.704803404476313*^9, 3.7048034241860743`*^9}}],

Cell["Rewrite the Greek letters", "Text",
 CellChangeTimes->{{3.702202576100587*^9, 3.702202585533182*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GreekTerms", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Omega]", "\[Rule]", "sel"}], ",", " ", 
    RowBox[{"\[Mu]", "\[Rule]", "mut"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.702201509383871*^9, 3.702201525212894*^9}, {
  3.704724390807227*^9, 3.70472439943757*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Omega]", "\[Rule]", "sel"}], ",", 
   RowBox[{"\[Mu]", "\[Rule]", "mut"}]}], "}"}]], "Output",
 CellChangeTimes->{3.70220152616304*^9, 3.7022030131218777`*^9, 
  3.7022897635244837`*^9, 3.704179086467165*^9, 3.7045177944473457`*^9, 
  3.704724393799959*^9, 3.7047246634923162`*^9, 3.704736510164259*^9, 
  3.704803775109002*^9, 3.7100545877607107`*^9, 3.7101570448356543`*^9, 
  3.7134074650996113`*^9}]
}, Open  ]],

Cell["Common parts to all functions", "Text",
 CellChangeTimes->{{3.7022025881711607`*^9, 3.7022025922143908`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "FunctionPartB", "=", 
   "\"\< <- function(p, sel, mut, m, g, n, d, Idself, Ieself){\n## Arguments:\
\n#  p   mutation bias\n#  sel intensity of selection\n#  mut mutation \
probability\n#  m   emigration probability\n#  g   proportion of interactions \
out of the group (interaction equivalent of m)\n#  n   deme size\n#  d   \
number of demes\n#  Idself whether reproduction in site where the parent is\n\
#  Ieself whether interactions with oneself\nreturn(\n\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FunctionPartE", "=", "\"\<)\n}\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.702201586590098*^9, 3.702201660652206*^9}, {
  3.702202515399782*^9, 3.70220251599327*^9}, {3.702202562602117*^9, 
  3.702202562914797*^9}, {3.702202598064639*^9, 3.702202697296604*^9}, {
  3.702202988690043*^9, 3.702203007885222*^9}, {3.704724417045898*^9, 
  3.7047244695037813`*^9}}],

Cell["Function to translate Mathematica to R", "Text",
 CellChangeTimes->{{3.702202703211164*^9, 3.702202713861825*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToRForm", "[", "x_", "]"}], ":=", 
  RowBox[{"ToString", "[", 
   RowBox[{
    RowBox[{"x", "/.", "GreekTerms"}], "//", "CForm"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.702201842966589*^9, 3.702201859620515*^9}}],

Cell["Do it for \[Beta] and \[Gamma]", "Text",
 CellChangeTimes->{{3.704724511134218*^9, 3.704724513442933*^9}, {
  3.704803452274454*^9, 3.704803455115556*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RtxtbBDD", "=", 
   RowBox[{"\"\<bBDD \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]BDD", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
    "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtbBDI", "=", 
   RowBox[{"\"\<bBDI \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]BDI", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
    "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtcBDD", "=", 
   RowBox[{"\"\<cBDD \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Gamma]BDD", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
    "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtcBDI", "=", 
   RowBox[{"\"\<cBDI \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Gamma]BDI", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
    "FunctionPartE"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.704724517750942*^9, 3.704724604063252*^9}, {
   3.704803463935075*^9, 3.704803684371352*^9}, 3.704803938490445*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"RtxtbDBD", "=", 
     RowBox[{"\"\<bDBD \>\"", "<>", "FunctionPartB", "<>", 
      RowBox[{"ToRForm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Beta]DBD", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
            RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
         "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
      "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RtxtbDBI", "=", 
     RowBox[{"\"\<bDBI \>\"", "<>", "FunctionPartB", "<>", 
      RowBox[{"ToRForm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Beta]DBI", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
            RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
         "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
      "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RtxtcDBD", "=", 
     RowBox[{"\"\<cDBD \>\"", "<>", "FunctionPartB", "<>", 
      RowBox[{"ToRForm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Gamma]DBD", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
            RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
         "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
      "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RtxtcDBI", "=", 
     RowBox[{"\"\<cDBI \>\"", "<>", "FunctionPartB", "<>", 
      RowBox[{"ToRForm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Gamma]DBI", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
            RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
         "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
      "FunctionPartE"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.704724517750942*^9, 3.704724604063252*^9}, {
  3.704803463935075*^9, 3.704803684371352*^9}, {3.704803938490445*^9, 
  3.7048039400125237`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RtxtbWFD", "=", 
   RowBox[{"\"\<bWFD \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]WFD", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinWF"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutWF"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "Simplify"}], "]"}], "<>", "FunctionPartE"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtbWFI", "=", 
   RowBox[{"\"\<bWFI \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]WFI", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinWF"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutWF"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "Simplify"}], "]"}], "<>", "FunctionPartE"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtcWFD", "=", 
   RowBox[{"\"\<cWFD \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Gamma]WFD", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinWF"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutWF"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "Simplify"}], "]"}], "<>", "FunctionPartE"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.704724517750942*^9, 3.704724604063252*^9}, {
   3.704803463935075*^9, 3.704803684371352*^9}, {3.704803938490445*^9, 
   3.7048039400125237`*^9}, 3.7048042118459272`*^9, {3.704804392342845*^9, 
   3.70480439722366*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RtxtcWFI", "=", 
    RowBox[{"\"\<cWFI \>\"", "<>", "FunctionPartB", "<>", 
     RowBox[{"ToRForm", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Gamma]WFI", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Qin", "\[Rule]", "QinWF"}], ",", 
           RowBox[{"Qout", "\[Rule]", "QoutWF"}]}], "}"}]}], "/.", 
        "genericde"}], "//", "Simplify"}], "]"}], "<>", "FunctionPartE"}]}], 
   ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.704724517750942*^9, 3.704724604063252*^9}, {
   3.704803463935075*^9, 3.704803684371352*^9}, {3.704803938490445*^9, 
   3.7048039400125237`*^9}, 3.7048042118459272`*^9, 3.7048043981410503`*^9}],

Cell["Define Power function in R", "Text",
 CellChangeTimes->{{3.7022027318210173`*^9, 3.702202737612219*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PowerDef", "=", "\"\<Power <- function(a,b) return(a^b)\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.702201909153489*^9, 3.7022019359137297`*^9}, {
  3.7022019780679827`*^9, 3.702201985090732*^9}}],

Cell["Combine all texts", "Text",
 CellChangeTimes->{{3.702202739839615*^9, 3.702202745125101*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rtxt", "=", 
   RowBox[{
   "PowerDef", "<>", "\"\<\n\n\>\"", "<>", "RtxtbBDD", "<>", "\"\<\n\n\>\"", "<>",
     "RtxtbBDI", "<>", "\"\<\n\n\>\"", "<>", "RtxtcBDD", "<>", "\"\<\n\n\>\"",
     "<>", "RtxtcBDI", "<>", "\"\<\n\n\>\"", "<>", "RtxtbDBD", "<>", 
    "\"\<\n\n\>\"", "<>", "RtxtbDBI", "<>", "\"\<\n\n\>\"", "<>", "RtxtcDBD", 
    "<>", "\"\<\n\n\>\"", "<>", "RtxtcDBI", "<>", "\"\<\n\n\>\"", "<>", 
    "RtxtbWFD", "<>", "\"\<\n\n\>\"", "<>", "RtxtbWFI", "<>", "\"\<\n\n\>\"", 
    "<>", "RtxtcWFD", "<>", "\"\<\n\n\>\"", "<>", "RtxtcWFI"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7022019405139227`*^9, 3.702201966147601*^9}, {
  3.7047246131819277`*^9, 3.704724637059588*^9}, {3.704803694719769*^9, 
  3.704803749843987*^9}}],

Cell["Export to txt file (Mathematica did not want R)", "Text",
 CellChangeTimes->{{3.702202748144455*^9, 3.70220275825738*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"pathtosave", "<>", "\"\<Mathematica/analyticsBC.txt\>\""}], ",", 
    "Rtxt"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.702201967861699*^9, 3.702202007961507*^9}, {
   3.702202094017145*^9, 3.7022021946253023`*^9}, 3.7047246446676083`*^9, {
   3.7048037577002163`*^9, 3.704803757783225*^9}, {3.710054369552413*^9, 
   3.7100543764643507`*^9}, 3.710054449473357*^9}],

Cell["Convert the file extension to R", "Text",
 CellChangeTimes->{{3.702202760522964*^9, 3.702202776867174*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cmd", "=", 
  RowBox[{
  "\"\<mv \>\"", "<>", "pathtosave", "<>", 
   "\"\<Mathematica/analyticsBC.txt \>\"", "<>", "pathtosave", "<>", 
   "\"\<Mathematica/analyticsBC.R\>\""}]}]], "Input",
 CellChangeTimes->{{3.710054379829246*^9, 3.7100544084086437`*^9}}],

Cell[BoxData["\<\"mv \
~/Documents/Work/Projects/2016_SocEvolSubdivPop/Programs/Mathematica/\
analyticsBC.txt \
~/Documents/Work/Projects/2016_SocEvolSubdivPop/Programs/Mathematica/\
analyticsBC.R\"\>"], "Output",
 CellChangeTimes->{3.710054642095193*^9, 3.710157118088244*^9, 
  3.713407557544063*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"\"\<!\>\"", "<>", "cmd"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7022022612757597`*^9, 3.702202281727586*^9}, {
  3.7047246545885*^9, 3.7047246565359173`*^9}, {3.7048037640761023`*^9, 
  3.704803767929439*^9}, {3.710054411496415*^9, 3.7100544300801153`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "3) Changes with ",
 StyleBox["m",
  FontSlant->"Italic"]
}], "Title",
 CellChangeTimes->{{3.709991800522709*^9, 3.709991804386573*^9}, {
   3.7099923923209877`*^9, 3.709992395104917*^9}, 3.709992650942894*^9, 
   3.709996947904046*^9, {3.7100484741036367`*^9, 3.7100484748909483`*^9}}],

Cell["\<\
Here, we consider a population structure 
- with no social interactions with oneself (eself = 0), 
- such that an offspring can establish at the very site of its parent and \
replace it (dself > 0),
- with social interactions strictly within a deme (g = 0).
(i.e., the structure used in the manuscript).\
\>", "Text",
 CellChangeTimes->{{3.7099924056899014`*^9, 3.709992481766397*^9}, {
  3.710049444210531*^9, 3.710049454981187*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mychange", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"genericde", "/.", 
      RowBox[{"Idself", "\[Rule]", "1"}]}], "/.", 
     RowBox[{"Ieself", "\[Rule]", "0"}]}], "/.", 
    RowBox[{"g", "\[Rule]", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplyParms", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"x", "/.", "genericde"}], "/.", 
     RowBox[{"Idself", "\[Rule]", "1"}]}], "/.", 
    RowBox[{"Ieself", "\[Rule]", "0"}]}], "/.", 
   RowBox[{"g", "\[Rule]", "0"}]}]}]}], "Input",
 CellChangeTimes->{{3.704713417637911*^9, 3.704713442784624*^9}, 
   3.709991817873847*^9, {3.7099945089329567`*^9, 3.70999454073952*^9}}],

Cell["Parameters values used in figure 2", "Text",
 CellChangeTimes->{{3.710052504254443*^9, 3.71005251037885*^9}, {
  3.710053514621092*^9, 3.71005351547766*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"figparms", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"b", "\[Rule]", "15"}], ",", " ", 
     RowBox[{"c", "\[Rule]", "1"}], ",", " ", 
     RowBox[{"d", "\[Rule]", "15"}], ",", " ", 
     RowBox[{"n", "\[Rule]", "4"}], ",", " ", 
     RowBox[{"p", "\[Rule]", "0.45"}], ",", " ", 
     RowBox[{"\[Delta]", "\[Rule]", "0.005"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7100524882358522`*^9, 3.710052512219421*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Probabilities of identity by descent change with the emigration probability \
",
 StyleBox["m",
  FontSlant->"Italic"]
}], "Section",
 CellChangeTimes->{{3.709991966934476*^9, 3.709991969883013*^9}, {
  3.709992488440322*^9, 3.709992518312326*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Moran: derivatives with respect to ",
 StyleBox["m",
  FontSlant->"Italic"]
}], "Subsection",
 CellChangeTimes->{{3.7099921383277617`*^9, 3.709992147057674*^9}, {
  3.7100495285059137`*^9, 3.7100495341711807`*^9}}],

Cell[CellGroupData[{

Cell["Qin", "Subsubsection",
 CellChangeTimes->{{3.710049515619185*^9, 3.7100495177116423`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"QinMs", ",", "m"}], "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.7099921215212097`*^9, 3.709992130452181*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", "n", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
   SuperscriptBox["\[Mu]", "2"]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
     "-", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}],
     ")"}], "2"]]], "Output",
 CellChangeTimes->{{3.709992123951235*^9, 3.709992130975418*^9}, 
   3.709992528280448*^9, 3.710049610273323*^9, 3.710054642769799*^9, 
   3.7101571187000847`*^9, 3.713407557921959*^9}]
}, Open  ]],

Cell["-> The slope is negative for Qin", "Text",
 CellChangeTimes->{{3.70999215066022*^9, 3.709992153385898*^9}, {
  3.7099925310326033`*^9, 3.709992550624234*^9}, {3.710053429741583*^9, 
  3.71005345067865*^9}},
 Background->RGBColor[0.94, 0.91, 0.88]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Qout", "Subsubsection",
 CellChangeTimes->{{3.710049519719858*^9, 3.710049521761959*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"QoutMs", ",", "m"}], "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.709992537523048*^9, 3.709992538518298*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
      "-", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
        ")"}]}]}], ")"}], "2"]]}]], "Output",
 CellChangeTimes->{3.709992539261372*^9, 3.710049610389324*^9, 
  3.71005464289782*^9, 3.710157118842834*^9, 3.713407558086042*^9}]
}, Open  ]],

Cell["-> It is positive for Qout.", "Text",
 CellChangeTimes->{{3.709992552567528*^9, 3.709992557511806*^9}, {
  3.7100534527976513`*^9, 3.710053453246252*^9}},
 Background->RGBColor[0.94, 0.91, 0.88]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Wright - Fisher: derivatives with respect to ",
 StyleBox["m",
  FontSlant->"Italic"]
}], "Subsection",
 CellChangeTimes->{{3.709992155294166*^9, 3.7099921607527037`*^9}, {
  3.710049544517017*^9, 3.7100495490025263`*^9}}],

Cell[CellGroupData[{

Cell["Qin", "Subsubsection",
 CellChangeTimes->{{3.7099925600547333`*^9, 3.709992567573578*^9}, {
  3.710049553716906*^9, 3.7100495539906273`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dqw", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"QinWFs", ",", "m"}], "]"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.709992162246917*^9, 3.709992194899646*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], "3"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], " ", "n", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
    SuperscriptBox["\[Mu]", "2"]}], ")"}], "/", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "m", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}], "+", 
     RowBox[{"d", " ", 
      SuperscriptBox["m", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}]}], ")"}], "2"]}]], "Output",
 CellChangeTimes->{{3.7099921764226294`*^9, 3.709992195881008*^9}, 
   3.7099925702194157`*^9, 3.710049611452898*^9, 3.710054644094577*^9, 
   3.7101571199843388`*^9, 3.713407559931448*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"dqw", "\[Equal]", "0"}], ",", "m"}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.709992196668887*^9, 3.709992204405383*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"m", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], "d"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.7099922012595997`*^9, 3.709992204789147*^9}, 
   3.710049611562909*^9, 3.710054644343069*^9, 3.710157120222096*^9, 
   3.713407560043777*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dqw", "/.", 
   RowBox[{"m", "\[Rule]", "0"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dqw", "/.", 
   RowBox[{"m", "\[Rule]", "1"}]}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.7099922497591457`*^9, 3.709992270427369*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", "n", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], ")"}], 
    "2"]]}]], "Output",
 CellChangeTimes->{{3.70999225661775*^9, 3.709992270764991*^9}, 
   3.710049611628518*^9, 3.71005464440163*^9, 3.710157120271299*^9, 
   3.7134075600966*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], "3"], " ", "n", " ", 
   SuperscriptBox["\[Mu]", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"2", "-", 
      RowBox[{"3", " ", "\[Mu]"}], "+", 
      SuperscriptBox["\[Mu]", "2"]}], ")"}], "2"]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "-", 
     RowBox[{
      SuperscriptBox["d", "2"], " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "3"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}], "+", 
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "n"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}]}], ")"}], "2"]]], "Output",
 CellChangeTimes->{{3.70999225661775*^9, 3.709992270764991*^9}, 
   3.710049611628518*^9, 3.71005464440163*^9, 3.710157120271299*^9, 
   3.7134075606576223`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"->", 
    RowBox[{
    "The", " ", "slope", " ", "of", " ", "QinWF", " ", "is", " ", "negative", 
     " ", "until", " ", "mc"}]}], "=", 
   FractionBox[
    RowBox[{"d", "-", "1"}], "d"]}], ",", " ", 
  RowBox[{"positive", " ", 
   RowBox[{"after", "."}]}]}]], "Text",
 CellChangeTimes->{{3.709992228361392*^9, 3.709992245576262*^9}, {
  3.709992369930008*^9, 3.709992376722148*^9}, {3.709992580264571*^9, 
  3.7099925860647717`*^9}, {3.710053402409388*^9, 3.710053402614469*^9}},
 FontFamily->"Nimbus Sans L",
 Background->RGBColor[0.94, 0.91, 0.88]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Qout", "Subsubsection",
 CellChangeTimes->{{3.7100495621169043`*^9, 3.7100495640471992`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dqwo", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"QoutWFs", ",", "m"}], "]"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.7099925948495893`*^9, 3.709992599641437*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}], ")"}], "/", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
         ")"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "m", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
         ")"}]}], "+", 
       RowBox[{"d", " ", 
        SuperscriptBox["m", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
         ")"}]}]}], ")"}], "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{3.709992600245452*^9, 3.7100496127667503`*^9, 
  3.710054646046956*^9, 3.71015712174049*^9, 3.7134075618671494`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"dqwo", "\[Equal]", "0"}], ",", "m"}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{3.709992613209543*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"m", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], "d"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.7099926137193737`*^9, 3.7100496128893967`*^9, 
  3.710054646279912*^9, 3.710157122011243*^9, 3.7134075619873037`*^9}]
}, Open  ]],

Cell["\<\

-> And it is the opposite for QoutWF.
\
\>", "Text",
 CellChangeTimes->{{3.709992615741311*^9, 3.70999264136655*^9}, {
  3.710053413974145*^9, 3.7100534255025053`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "BD life-cycle, changes with ",
 StyleBox["m",
  FontSlant->"Italic"]
}], "Section",
 CellChangeTimes->{{3.709991808059176*^9, 3.709991809902101*^9}, {
  3.7099926538714027`*^9, 3.7099926588636703`*^9}, {3.710052527067726*^9, 
  3.7100525293717813`*^9}}],

Cell[CellGroupData[{

Cell["Indirect/secondary term", "Subsection",
 CellChangeTimes->{{3.709992660401154*^9, 3.709992664955244*^9}, {
  3.7099927270714827`*^9, 3.709992728334756*^9}, {3.7100496296848*^9, 
  3.71004963738836*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bi", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Beta]BDI", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Qin", "\[Rule]", "QinM"}], ",", " ", 
       RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", "mychange"}], "//",
    "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.709992684506249*^9, 3.709992722344799*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "d"}], " ", "m"}], "+", 
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}]}], "+", "m"}], ")"}], " ", 
    "\[Mu]"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d", "-", 
      RowBox[{"d", " ", "m"}]}], ")"}], " ", 
    SuperscriptBox["\[Mu]", "2"]}]}], 
  RowBox[{"d", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
     "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}],
     ")"}]}]]], "Output",
 CellChangeTimes->{{3.709992689489194*^9, 3.709992738290503*^9}, 
   3.710049639403565*^9, 3.710054646503388*^9, 3.710157122466681*^9, 
   3.713407562301462*^9}]
}, Open  ]],

Cell[TextData[{
 "Derivative with respect to ",
 StyleBox["m",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.7100496420780497`*^9, 3.7100496482064667`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dbi", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"bi", ",", "m"}], "]"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.709992740062263*^9, 3.709992758164859*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", "n"}], "-", "\[Mu]"}], ")"}], " ", 
    SuperscriptBox["\[Mu]", "2"]}], 
   RowBox[{"d", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}],
        "-", 
       RowBox[{"m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
         ")"}]}]}], ")"}], "2"]}]]}]], "Output",
 CellChangeTimes->{{3.709992743620757*^9, 3.709992758937481*^9}, 
   3.7100496514812*^9, 3.710054646859806*^9, 3.710157122809639*^9, 
   3.71340756270265*^9}]
}, Open  ]],

Cell["\<\

-> \[Beta]BDI decreases with m
\
\>", "Text",
 CellChangeTimes->{{3.709992948310007*^9, 3.7099929627734327`*^9}, {
  3.710049652917144*^9, 3.7100496712022333`*^9}, {3.71005339530243*^9, 
  3.71005339610185*^9}},
 Background->RGBColor[0.94, 0.91, 0.88]]
}, Open  ]],

Cell[CellGroupData[{

Cell["EX", "Subsection",
 CellChangeTimes->{{3.7099943878642607`*^9, 3.709994391648737*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ex", "=", 
  RowBox[{
   RowBox[{"EXBD", "//", "ApplyParms"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.70999439696058*^9, 3.709994405415493*^9}, {
  3.709994546182214*^9, 3.7099945569046583`*^9}, {3.70999460635781*^9, 
  3.709994606681038*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"b", "-", "c"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
         "\[Mu]"}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"b", "-", "c"}], ")"}], " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]"}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", "m", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"3", " ", "b"}], "+", 
                 RowBox[{"c", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "3"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]"}]}], 
             ")"}], " ", "\[Mu]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "n", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"b", "+", 
                 RowBox[{"c", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]"}]}], 
             ")"}], " ", 
            SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", "m", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]"}], "+", 
           "\[Mu]", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"m", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"b", "-", "c"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}], "+", 
                 RowBox[{"c", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "m"}]}], ")"}], " ", "n"}]}], ")"}], 
               " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]"}]}], 
             ")"}], " ", "\[Mu]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "n", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"b", "+", 
                 RowBox[{"c", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]"}]}], 
             ")"}], " ", 
            SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
    
    RowBox[{"(", 
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
          ")"}]}], "+", 
        RowBox[{"m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
          ")"}]}]}], ")"}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.709994400594858*^9, 3.7099944058519993`*^9}, 
   3.709994481123599*^9, {3.709994550296914*^9, 3.7099945708405237`*^9}, 
   3.7099946085726223`*^9, 3.710049675148596*^9, 3.7100497591169786`*^9, 
   3.710054658035433*^9, 3.710157134998672*^9, 3.71340758371807*^9}]
}, Open  ]],

Cell[TextData[{
 "Derivative with respect to ",
 StyleBox["m",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.7100496420780497`*^9, 3.7100496482064667`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dex", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"ex", ",", "m"}], "]"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.709994615756215*^9, 3.709994625739416*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", "\[Delta]", " ", 
   "\[Mu]", " ", 
   RowBox[{"(", 
    RowBox[{"c", "+", 
     RowBox[{"c", " ", "d", " ", "n"}], "-", 
     RowBox[{"c", " ", "\[Mu]"}], "+", 
     RowBox[{"b", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}]}]}], ")"}], " ", 
         "\[Mu]"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{"d", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
      "-", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
        ")"}]}]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{{3.7099946188909082`*^9, 3.709994626693906*^9}, 
   3.710049759645368*^9, 3.710054658704153*^9, 3.71015713555792*^9, 
   3.713407584564529*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"dex", "\[Equal]", "0"}], ",", "m"}], "]"}]], "Input",
 CellChangeTimes->{{3.709994638165847*^9, 3.709994641787463*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.7099946423611107`*^9, 3.710049759731194*^9, 
  3.710054658782543*^9, 3.710157135712706*^9, 3.7134075846683598`*^9}]
}, Open  ]],

Cell["\<\
EX is a monotonic function of m. Is it increasing or decreasing? This depends \
on \[Mu]:\
\>", "Text",
 CellChangeTimes->{{3.709995129905006*^9, 3.709995150681396*^9}, {
  3.710049742138772*^9, 3.710049742858735*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"muc", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"dex", "\[Equal]", "0"}], ",", "\[Mu]"}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.709994657633581*^9, 3.709994667308379*^9}, {
  3.7099947366492443`*^9, 3.709994737163229*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"b", "-", "c", "-", 
        RowBox[{"2", " ", "b", " ", "d", " ", "n"}], "+", 
        SqrtBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"b", "-", "c"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"b", "-", "c", "+", 
            RowBox[{"4", " ", "b", " ", 
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["n", "2"]}]}], ")"}]}]]}], 
       RowBox[{"2", " ", "b", " ", "d", " ", "n"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", 
     FractionBox[
      RowBox[{"c", "+", 
       RowBox[{"b", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "d", " ", "n"}]}], ")"}]}], "+", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"b", "-", "c"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"b", "-", "c", "+", 
           RowBox[{"4", " ", "b", " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["n", "2"]}]}], ")"}]}]]}], 
      RowBox[{"2", " ", "b", " ", "d", " ", "n"}]]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.709994662908053*^9, 3.709994669028651*^9}, 
   3.709994738374353*^9, 3.710049788991055*^9, 3.710054660067782*^9, 
   3.710157136831196*^9, 3.7134075862597322`*^9}]
}, Open  ]],

Cell["We want the middle one (admissibility)", "Text",
 CellChangeTimes->{{3.709994950047749*^9, 3.7099949544139147`*^9}, {
  3.70999501443946*^9, 3.709995017056706*^9}, {3.7100497761135273`*^9, 
  3.7100497841546717`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mucBD", "=", 
   RowBox[{
    RowBox[{"\[Mu]", "/.", 
     RowBox[{"muc", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
    "//", "FullSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7099950186970654`*^9, 3.709995029572616*^9}, {
   3.7099950709279127`*^9, 3.709995076206974*^9}, 3.7099951553777103`*^9, {
   3.710049887668618*^9, 3.71004988817787*^9}}],

Cell["Simplify in more human form", "Text",
 CellChangeTimes->{{3.709995083490326*^9, 3.709995089838985*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "-", 
   FractionBox[
    RowBox[{"b", "-", "c", "+", 
     SqrtBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"b", "-", "c", "+", 
         RowBox[{"4", " ", "b", " ", 
          SuperscriptBox["d", "2"], " ", 
          SuperscriptBox["n", "2"]}]}], ")"}]}]]}], 
    RowBox[{"2", " ", "b", " ", "d", " ", "n"}]], "-", "mucBD"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.7099950930515413`*^9, 3.7099951043880157`*^9}, 
   3.710049894548684*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.70999502996749*^9, 3.709995072359768*^9, 
  3.709995104741953*^9, 3.710049797649207*^9, 3.710049897730555*^9, 
  3.7100546603354273`*^9, 3.71015713713129*^9, 3.71340758635396*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dex", "/.", 
   RowBox[{"\[Mu]", "\[Rule]", "1"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.709995162134904*^9, 3.7099951765710278`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"b", "-", "c"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", "\[Delta]"}], 
   "n"]}]], "Output",
 CellChangeTimes->{{3.709995165901613*^9, 3.709995176742215*^9}, 
   3.710049799537725*^9, 3.710049898524007*^9, 3.7100546604226723`*^9, 
   3.710157137213991*^9, 3.713407586414198*^9}]
}, Open  ]],

Cell[TextData[{
 "\n-> E[",
 Cell[BoxData[
  FormBox[
   OverscriptBox["X", "_"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "] is increasing with ",
 StyleBox["m",
  FontSlant->"Italic"],
 " when \[Mu] > ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Mu]", "c"], "BD"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", decreasing otherwise (but flat when \[Mu] = 0).\n\n",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Mu]", "c"], "BD"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " = ",
 Cell[BoxData[
  RowBox[{"1", "-", 
   FractionBox[
    RowBox[{"b", "-", "c", "+", 
     SqrtBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"b", "-", "c", "+", 
         RowBox[{"4", " ", "b", " ", 
          SuperscriptBox["d", "2"], " ", 
          SuperscriptBox["n", "2"]}]}], ")"}]}]]}], 
    RowBox[{"2", " ", "b", " ", "d", " ", "n"}]]}]], "Input",
  CellChangeTimes->{{3.7099950930515413`*^9, 3.7099951043880157`*^9}, 
    3.710049894548684*^9}],
 "\n"
}], "Text",
 CellChangeTimes->{{3.7099952048551483`*^9, 3.709995227923274*^9}, {
   3.710049803321292*^9, 3.710049851385672*^9}, {3.710049900114703*^9, 
   3.7100499163723373`*^9}, 3.710053384344131*^9},
 Background->RGBColor[0.94, 0.91, 0.88]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "DB life - cycle, changes with ",
 StyleBox["m",
  FontSlant->"Italic"]
}], "Section",
 CellChangeTimes->{{3.709992972091024*^9, 3.7099929755790377`*^9}, 
   3.710052535427019*^9}],

Cell[CellGroupData[{

Cell["Indirect/secondary term", "Subsection",
 CellChangeTimes->{{3.709992977518441*^9, 3.7099929839257317`*^9}, 
   3.71005091441189*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bi", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Beta]DBI", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Qin", "\[Rule]", "QinM"}], ",", " ", 
       RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", "mychange"}], "//",
    "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.709992684506249*^9, 3.709992722344799*^9}, {
  3.7099929958081427`*^9, 3.7099929965685997`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"m", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.709992689489194*^9, 3.709992738290503*^9}, 
   3.709992997842662*^9, 3.710049943057563*^9, 3.710054660698354*^9, 
   3.710157137485149*^9, 3.710157256507059*^9, 3.713407586646163*^9}]
}, Open  ]],

Cell[TextData[{
 "Derivative with respect to ",
 StyleBox["m",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.7100499453229628`*^9, 3.710049950041224*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dbi", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"bi", ",", "m"}], "]"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.709992740062263*^9, 3.709992758164859*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{"m", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "\[Mu]"}]}], ")"}], 
       " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
      "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "d", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], " ", 
          "\[Mu]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
           ")"}]}], "+", 
         RowBox[{"m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
           ")"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
     "-", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}],
     ")"}], "2"]}]], "Output",
 CellChangeTimes->{{3.709992743620757*^9, 3.709992758937481*^9}, 
   3.709992999080152*^9, 3.710049952274254*^9, 3.710054661148018*^9, 
   3.7101571378476343`*^9, 3.710157257061739*^9, 3.7134075871933126`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mcs", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"dbi", "\[Equal]", "0"}], ",", "m"}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.709993002706428*^9, 3.709993018838801*^9}, {
  3.709993092668695*^9, 3.709993093455174*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}],
        "-", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", "d", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", "\[Mu]", 
         " ", 
         RowBox[{"(", 
          RowBox[{"n", "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], "+", 
           RowBox[{"d", " ", 
            SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
           RowBox[{"n", " ", 
            SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}]]}], 
      RowBox[{"d", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
        ")"}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"m", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}],
        "+", 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", "d", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", "\[Mu]", 
         " ", 
         RowBox[{"(", 
          RowBox[{"n", "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], "+", 
           RowBox[{"d", " ", 
            SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
           RowBox[{"n", " ", 
            SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}]]}], 
      RowBox[{"d", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
        ")"}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.709993006748354*^9, 3.709993021082218*^9}, 
   3.7099930946041937`*^9, 3.709993340927586*^9, 3.710049955293816*^9, 
   3.710054662531601*^9, 3.710157139032689*^9, 3.710157258281294*^9, 
   3.713407588899169*^9}]
}, Open  ]],

Cell["the first term is negative -> not solution", "Text",
 CellChangeTimes->{{3.709993845757435*^9, 3.7099938650946493`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mcDBI", "=", 
   RowBox[{"m", "/.", 
    RowBox[{"mcs", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{3.709993871854796*^9}],

Cell[TextData[{
 "Second derivative of \[Beta]DBI with respect to ",
 StyleBox["m",
  FontSlant->"Italic"],
 ", evaluated at the critical value of ",
 StyleBox["m",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.709993971139061*^9, 3.7099939738988047`*^9}, {
  3.710049961379126*^9, 3.710049976169087*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"bi", ",", "m", ",", "m"}], "]"}], "/.", 
   RowBox[{"m", "\[Rule]", "mcDBI"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.709993939657954*^9, 3.7099939558378267`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SuperscriptBox["d", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", "\[Mu]"}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", "d", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"n", "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], "+", 
      RowBox[{"d", " ", 
       SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
      RowBox[{"n", " ", 
       SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}]]]], "Output",
 CellChangeTimes->{{3.7099939458113327`*^9, 3.70999395624279*^9}, 
   3.710054663019351*^9, 3.71015713935806*^9, 3.710157258750392*^9, 
   3.713407589258128*^9}]
}, Open  ]],

Cell["-> It is a minimum.", "Text",
 CellChangeTimes->{{3.709993975840665*^9, 3.7099939898568487`*^9}, {
  3.710049983513421*^9, 3.710049984016595*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{"mcDBI", ",", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.709994257833177*^9, 3.709994264862733*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.7099942658914623`*^9, 3.710054663784717*^9, 
  3.710157139942544*^9, 3.710157258868018*^9, 3.7134075900102873`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Compare", " ", "the", " ", "value", " ", "of", " ", "this", " ", 
  "critical", " ", "value", " ", "to", " ", 
  FractionBox[
   RowBox[{"d", "-", "1"}], "d"]}]], "Text",
 CellChangeTimes->{{3.710049994155052*^9, 3.710050006646369*^9}},
 FontFamily->"Nimbus Sans L"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ddd", "=", 
  RowBox[{
   RowBox[{"mcDBI", "-", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{"d", "-", "1"}], ")"}], "d"]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.709994045635545*^9, 3.709994055568544*^9}, {
  3.709994100870471*^9, 3.70999410130989*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "+", 
   FractionBox[
    RowBox[{
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", "d", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", "\[Mu]", " ", 
       
       RowBox[{"(", 
        RowBox[{"n", "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], "+", 
         RowBox[{"d", " ", 
          SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
         RowBox[{"n", " ", 
          SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}]], "+", 
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"\[Mu]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           RowBox[{"d", " ", "n"}], "+", "\[Mu]", "-", 
           RowBox[{"n", " ", "\[Mu]"}]}], ")"}]}]}], ")"}]}]}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]]}],
   "d"]], "Output",
 CellChangeTimes->{{3.709994052845982*^9, 3.7099940584771957`*^9}, 
   3.7099941017475243`*^9, 3.7100500196513157`*^9, 3.7100546676710873`*^9, 
   3.710157143768075*^9, 3.710157261867536*^9, 3.713407595735098*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{"ddd", "\[Equal]", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.709994102351989*^9, 3.709994106549885*^9}, {
  3.709994223610035*^9, 3.709994224278531*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"d", "\[Rule]", "1"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.709994107474493*^9, 3.710050019726019*^9, 
  3.710054668037507*^9, 3.710157144041325*^9, 3.710157262124511*^9, 
  3.713407595854773*^9}]
}, Open  ]],

Cell[TextData[{
 "ddd has a constant sign (because d > 1); it is the same sign as when \
\[Mu]->0, i.e. it is negative\nThis means that mcDBI < ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"d", "-", "1"}], "d"], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.709994231249288*^9, 3.709994284277322*^9}, {
  3.710050051355443*^9, 3.710050071581224*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"->", 
      RowBox[{
      "\[Beta]DBI", " ", "reaches", " ", "a", " ", "minimum", " ", "when", 
       " ", "m"}]}], " ", "=", " ", "mcDBI"}], ",", " ", 
    RowBox[{
     RowBox[{"with", " ", "mcDBI"}], "<", 
     RowBox[{
      RowBox[{
       FormBox[
        FractionBox[
         RowBox[{"d", "-", "1"}], "d"],
        TraditionalForm], ".", " ", "In"}], " ", "the", " ", "manuscript"}]}],
     ",", " ", 
    RowBox[{
    "we", " ", "denote", " ", "mcDBI", " ", "by", " ", "the", " ", "symbol", 
     " ", 
     RowBox[{
      RowBox[{
       SubscriptBox["m", "c"], "'"}], " ", ".", " ", "\[IndentingNewLine]", 
      "The"}], " ", "formula", " ", "for", " ", 
     RowBox[{
      SubscriptBox["m", "c"], "'"}], " ", "is"}]}], 
   "\[IndentingNewLine]"}]}]], "Text",
 CellChangeTimes->{{3.710050096859373*^9, 3.7100501395083513`*^9}, {
  3.710050241169819*^9, 3.710050269443548*^9}, {3.710053088320019*^9, 
  3.710053089184162*^9}, {3.710053361238531*^9, 3.710053366551642*^9}},
 FontFamily->"Nimbus Sans L",
 Background->RGBColor[0.94, 0.91, 0.88]],

Cell[CellGroupData[{

Cell[BoxData["mcDBI"], "Input",
 CellChangeTimes->{{3.710053099380678*^9, 3.710053122409205*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", "d", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", "\[Mu]", " ", 
     RowBox[{"(", 
      RowBox[{"n", "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], "+", 
       RowBox[{"d", " ", 
        SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
       RowBox[{"n", " ", 
        SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}]]}], 
  RowBox[{"d", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{3.710053100812417*^9, 3.7100546681175003`*^9, 
  3.710157144125202*^9, 3.710157262232215*^9, 3.713407595908926*^9},
 Background->RGBColor[0.94, 0.91, 0.88]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["EX", "Subsection",
 CellChangeTimes->{{3.709995255068224*^9, 3.709995256635714*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ex", "=", 
  RowBox[{
   RowBox[{"EXDB", "//", "ApplyParms"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.70999439696058*^9, 3.709994405415493*^9}, {
  3.709994546182214*^9, 3.7099945569046583`*^9}, {3.70999460635781*^9, 
  3.709994606681038*^9}, {3.709995272204258*^9, 3.709995273202733*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "c"}], ")"}], " ", "d", " ", 
       SuperscriptBox["m", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
         RowBox[{"n", " ", "\[Mu]"}]}], ")"}]}], "-", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"d", " ", "\[Mu]"}], "-", 
         RowBox[{"d", " ", "n", " ", "\[Mu]"}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "d", "+", 
            RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}], "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
          RowBox[{"(", 
           RowBox[{"2", "-", 
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "n"}], ")"}]}], "+", 
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
           ")"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
    "+", 
    RowBox[{"m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.709994400594858*^9, 3.7099944058519993`*^9}, 
   3.709994481123599*^9, {3.709994550296914*^9, 3.7099945708405237`*^9}, 
   3.7099946085726223`*^9, 3.709995287260372*^9, 3.710050288144979*^9, 
   3.710052621557755*^9, 3.71005468302143*^9, 3.7101571571736307`*^9, 
   3.710157274263948*^9, 3.713407616068873*^9}]
}, Open  ]],

Cell[TextData[{
 "Derivative with respect to ",
 StyleBox["m",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.710050283510955*^9, 3.710050290418746*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dex", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"ex", ",", "m"}], "]"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.709994615756215*^9, 3.709994625739416*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", "\[Delta]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", 
          SuperscriptBox["m", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "-", "n", "+", 
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "m"}], " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", "m"}], ")"}]}], "+", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "n"}], ")"}]}], "+", 
               RowBox[{"d", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"m", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", "n"}], 
                 ")"}]}]}], ")"}]}]}], ")"}], " ", "\[Mu]"}], "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"d", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
          SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}], "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "d"}], " ", 
          SuperscriptBox["m", "2"]}], "+", "\[Mu]", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", 
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{"2", "+", "m"}], ")"}]}], "+", 
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"m", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "m", "-", 
                  RowBox[{"m", " ", "n"}]}], ")"}]}]}], ")"}]}]}], ")"}], " ",
           "\[Mu]"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"d", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"]}], 
            "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "+", 
               RowBox[{"2", " ", "d", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "m"}], ")"}]}], "+", 
               RowBox[{
                SuperscriptBox["d", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m"}]}], 
                 ")"}]}]}], ")"}], " ", "n"}]}], ")"}], " ", 
          SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
     "-", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}],
     ")"}], "2"]}]], "Output",
 CellChangeTimes->{{3.7099946188909082`*^9, 3.709994626693906*^9}, 
   3.709995302849152*^9, 3.710050297737996*^9, 3.710052633970167*^9, 
   3.710054703258395*^9, 3.710157175250884*^9, 3.710157291075263*^9, 
   3.713407642502441*^9}]
}, Open  ]],

Cell[TextData[{
 "Here the formulas are more complicated, so we first concentrate on the \
initial changes, i.e., on changes when ",
 StyleBox["m",
  FontSlant->"Italic"],
 " is close to 0."
}], "Text",
 CellChangeTimes->{{3.710050296819034*^9, 3.710050323010078*^9}}],

Cell[CellGroupData[{

Cell["Initial increase?", "Subsubsection",
 CellChangeTimes->{{3.709996071192608*^9, 3.7099960751390657`*^9}}],

Cell["Close to m=0", "Text",
 CellChangeTimes->{{3.709995485168475*^9, 3.709995488650667*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dex0", "=", 
  RowBox[{
   RowBox[{"dex", "/.", 
    RowBox[{"m", "\[Rule]", "0"}]}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.709995491196129*^9, 3.7099954980769367`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", "\[Delta]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"b", "+", 
     RowBox[{"b", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "n"}]}], ")"}], " ", "\[Mu]"}], "-", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "n", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}],
     ")"}]}], 
  RowBox[{"\[Mu]", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}], 
    "2"]}]]], "Output",
 CellChangeTimes->{3.7099954984822683`*^9, 3.710050340286812*^9, 
  3.710052634224209*^9, 3.71005470349857*^9, 3.710157175564197*^9, 
  3.71015729132303*^9, 3.7134076427855167`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"muc0", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"dex0", "\[Equal]", "0"}], ",", "\[Mu]"}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.709995507849168*^9, 3.709995544644693*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "b"}], "+", "c", "+", 
       RowBox[{"c", " ", "n"}]}], 
      RowBox[{"c", "-", 
       RowBox[{"c", " ", "n"}], "+", 
       RowBox[{"b", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "n"}]}], ")"}]}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7099955127393913`*^9, 3.709995545080799*^9}, 
   3.710050346156741*^9, 3.7100526344098387`*^9, 3.710054703592362*^9, 
   3.710157175728099*^9, 3.7101572914819927`*^9, 3.713407642961433*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Mu]", "/.", 
      RowBox[{
      "muc0", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ")"}],
     "\[Equal]", "0"}], ",", "b"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"b", "\[Rule]", 
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "n"}], ")"}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.710050631206129*^9, 3.710050654230365*^9}, 
   3.7100526347062273`*^9, 3.710054703607884*^9, 3.710157175877262*^9, 
   3.710157291593336*^9, 3.71340764303027*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"\[Mu]", "/.", 
     RowBox[{"muc0", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
     ")"}], ",", 
   RowBox[{"b", "\[Rule]", "\[Infinity]"}]}], "]"}]], "Input"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"1", "-", 
   RowBox[{"2", " ", "n"}]}]]], "Output",
 CellChangeTimes->{3.710050654955285*^9, 3.710052634910171*^9, 
  3.7100547036899014`*^9, 3.710157176037244*^9, 3.710157291696271*^9, 
  3.713407643189198*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{"dex0", ",", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.710050354048852*^9, 3.710050363640936*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", "\[Delta]", " ", 
  RowBox[{"DirectedInfinity", "[", 
   RowBox[{
    RowBox[{"-", "b"}], "+", "c", "+", 
    RowBox[{"c", " ", "n"}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.7100503572386837`*^9, 3.710050364126989*^9}, 
   3.71005263513265*^9, 3.710054703821075*^9, 3.710157176143939*^9, 
   3.710157291807218*^9, 3.713407643352541*^9}]
}, Open  ]],

Cell[TextData[{
 "\n-> E[",
 Cell[BoxData[
  FormBox[
   OverscriptBox["X", "_"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "] increases initially with ",
 StyleBox["m",
  FontSlant->"Italic"],
 " if \[Mu]>\[Mu]c, and \[Mu]c<0 if b>c(n+1). \n\nIn other words, \n-  if \
b>c(n+1), E[",
 Cell[BoxData[
  FormBox[
   OverscriptBox["X", "_"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "] increases initially with ",
 StyleBox["m",
  FontSlant->"Italic"],
 " for any value of \[Mu],\n-  otherwise, E[",
 Cell[BoxData[
  FormBox[
   OverscriptBox["X", "_"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "] increases initially with ",
 StyleBox["m ",
  FontSlant->"Italic"],
 "if ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Mu]", ">", 
    SuperscriptBox[
     SubscriptBox["\[Mu]", "c"], "BD"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", with \n   ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    SubscriptBox["\[Mu]", "c"], "BD"], TraditionalForm]]],
 "=",
 Cell[BoxData[
  FractionBox[
   RowBox[{
    RowBox[{"-", "b"}], "+", "c", "+", 
    RowBox[{"c", " ", "n"}]}], 
   RowBox[{"c", "-", 
    RowBox[{"c", " ", "n"}], "+", 
    RowBox[{"b", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "n"}]}], ")"}]}]}]]], "Output",
  CellChangeTimes->{{3.7099955127393913`*^9, 3.709995545080799*^9}, 
    3.710050346156741*^9}],
 ".\n   "
}], "Text",
 CellChangeTimes->{{3.7099960273001347`*^9, 3.7099960538685017`*^9}, {
  3.710050408255887*^9, 3.710050544975933*^9}, {3.710053049365238*^9, 
  3.7100530639838333`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88]],

Cell["With our parameters, b>c(n+1).", "Text",
 CellChangeTimes->{{3.710052589652134*^9, 3.7100525969951477`*^9}, {
  3.710052651499617*^9, 3.710052666794401*^9}},
 Background->RGBColor[0.94, 0.91, 0.88]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Maximum value of EX", "Subsubsection",
 CellChangeTimes->{{3.709996080159061*^9, 3.7099960826987333`*^9}, {
  3.7100507400227118`*^9, 3.710050741894928*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mcs", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"dex", "\[Equal]", "0"}], ",", "m"}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.709994638165847*^9, 3.709994641787463*^9}, {
  3.709995333917602*^9, 3.709995339081213*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", "\[Rule]", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
         ")"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
          ")"}]}], "-", 
        RowBox[{
         FractionBox["1", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"b", "-", "c"}], ")"}], " ", "d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "p"}], ")"}]}]], 
         RowBox[{"(", 
          RowBox[{"\[Sqrt]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"b", "-", "c"}], ")"}]}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", "d", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "p"}], ")"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", "\[Mu]",
              " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "n"}], ")"}]}], "+", 
               RowBox[{"c", " ", "\[Mu]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", 
                  RowBox[{"d", " ", 
                   SuperscriptBox["n", "2"]}], "+", "\[Mu]", "-", 
                  RowBox[{"n", " ", "\[Mu]"}]}], ")"}]}], "+", 
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"\[Mu]", " ", 
                   RowBox[{"(", 
                    RowBox[{"2", "-", "\[Mu]", "+", 
                    RowBox[{"n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", 
                    "\[Mu]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
              ")"}]}], ")"}]}], ")"}]}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"m", "\[Rule]", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
         ")"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
          ")"}]}], "+", 
        RowBox[{
         FractionBox["1", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"b", "-", "c"}], ")"}], " ", "d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "p"}], ")"}]}]], 
         RowBox[{"(", 
          RowBox[{"\[Sqrt]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"b", "-", "c"}], ")"}]}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", "d", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "p"}], ")"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", "\[Mu]",
              " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "n"}], ")"}]}], "+", 
               RowBox[{"c", " ", "\[Mu]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", 
                  RowBox[{"d", " ", 
                   SuperscriptBox["n", "2"]}], "+", "\[Mu]", "-", 
                  RowBox[{"n", " ", "\[Mu]"}]}], ")"}]}], "+", 
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"\[Mu]", " ", 
                   RowBox[{"(", 
                    RowBox[{"2", "-", "\[Mu]", "+", 
                    RowBox[{"n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", 
                    "\[Mu]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
              ")"}]}], ")"}]}], ")"}]}]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7099946423611107`*^9, 3.709995303066593*^9, 
  3.709995365486812*^9, 3.710050768501782*^9, 3.710052648138747*^9, 
  3.710052694623702*^9, 3.710054726879847*^9, 3.710157197673173*^9, 
  3.7101573124711437`*^9, 3.713407683225719*^9}]
}, Open  ]],

Cell[TextData[{
 "\n-> The admissible solution is the first one (note (-1+p) at the \
denominator).\nThis is the critical value of ",
 StyleBox["m",
  FontSlant->"Italic"],
 ", at which the maximum value of E[",
 Cell[BoxData[
  FormBox[
   OverscriptBox["X", "_"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "] is attained. Its formula is given by\n"
}], "Text",
 CellChangeTimes->{{3.709996250638623*^9, 3.709996274099669*^9}, {
  3.7100527080338*^9, 3.710052730193438*^9}, {3.710052901937451*^9, 
  3.7100529034492064`*^9}, {3.710053034843934*^9, 3.710053035695643*^9}, {
  3.7100533376777163`*^9, 3.710053348925706*^9}},
 Background->RGBColor[0.94, 0.91, 0.88]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mmax", "=", 
  RowBox[{
   RowBox[{"m", "/.", 
    RowBox[{"mcs", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "//",
    "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.709996276846759*^9, 3.709996285672999*^9}, {
  3.710052833610779*^9, 3.710052835337782*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
    "-", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "c"}], ")"}], " ", "d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "p"}], ")"}]}]], 
     RowBox[{"(", 
      RowBox[{"\[Sqrt]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"b", "-", "c"}], ")"}]}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", "d", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "p"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", "\[Mu]", 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "n"}], ")"}]}], "+", 
           RowBox[{"c", " ", "\[Mu]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", 
              RowBox[{"d", " ", 
               SuperscriptBox["n", "2"]}], "+", "\[Mu]", "-", 
              RowBox[{"n", " ", "\[Mu]"}]}], ")"}]}], "+", 
           RowBox[{"b", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"\[Mu]", " ", 
               RowBox[{"(", 
                RowBox[{"2", "-", "\[Mu]", "+", 
                 RowBox[{"n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", 
                    "\[Mu]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], ")"}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.710052839740409*^9, 3.710054731029573*^9, 
  3.7101572023015537`*^9, 3.710157317374196*^9, 3.713407691567256*^9},
 Background->RGBColor[0.94, 0.91, 0.88]]
}, Open  ]],

Cell["\<\
Numerically check threshold value, i.e. that = 0 when \[Mu] = muc (formula \
too big to simplify...)\
\>", "Text",
 CellChangeTimes->{{3.710157918678001*^9, 3.7101579420779877`*^9}, {
  3.710158004741465*^9, 3.710158015688897*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"myRound", "[", "x_", "]"}], ":=", 
   RowBox[{"Round", "[", 
    RowBox[{"x", ",", "12"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mmax", "/.", 
    RowBox[{"muc0", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
   "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"b", "\[Rule]", "2"}], ",", 
     RowBox[{"c", "\[Rule]", "1"}], ",", 
     RowBox[{"d", "\[Rule]", "15"}], ",", 
     RowBox[{"n", "\[Rule]", "4"}], ",", 
     RowBox[{"p", "\[Rule]", "0.45"}]}], "}"}]}], "//", 
  "myRound"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mmax", "/.", 
    RowBox[{"muc0", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
   "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"b", "\[Rule]", "4"}], ",", 
     RowBox[{"c", "\[Rule]", "1"}], ",", 
     RowBox[{"d", "\[Rule]", "15"}], ",", 
     RowBox[{"n", "\[Rule]", "4"}], ",", 
     RowBox[{"p", "\[Rule]", "0.45"}]}], "}"}]}], "//", 
  "myRound"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mmax", "/.", 
   RowBox[{"muc0", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"b", "\[Rule]", "4"}], ",", 
    RowBox[{"c", "\[Rule]", "1"}], ",", 
    RowBox[{"d", "\[Rule]", "2"}], ",", 
    RowBox[{"n", "\[Rule]", "4"}], ",", 
    RowBox[{"p", "\[Rule]", "0.45"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.710157966633729*^9, 3.710157978242837*^9}, {
  3.7101580202773533`*^9, 3.710158116769302*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.7101580402743273`*^9, 3.71015811684214*^9}, 
   3.7134076917626143`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.7101580402743273`*^9, 3.71015811684214*^9}, 
   3.713407691767046*^9}],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{{3.7101580402743273`*^9, 3.71015811684214*^9}, 
   3.713407691772711*^9}]
}, Open  ]],

Cell["Check value for low mutation", "Text",
 CellChangeTimes->{{3.7101579461225967`*^9, 3.7101579514808607`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{"mmax", ",", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.709995447913541*^9, 3.709995461229952*^9}, {
  3.709996098514688*^9, 3.709996105278631*^9}, {3.709996291046315*^9, 
  3.709996291438326*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.709995478495467*^9, 3.709996109375462*^9, 
  3.709996291743623*^9, 3.710050772386808*^9, 3.7100547348960733`*^9, 
  3.7101572062064123`*^9, 3.7101573175621367`*^9, 3.713407695897729*^9}]
}, Open  ]],

Cell[TextData[{
 "\n-> When \[Mu] -> 0, this argmax gets closer to 0: at the limit, E[",
 Cell[BoxData[
  FormBox[
   OverscriptBox["X", "_"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "] just decreases with ",
 StyleBox["m.\n",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.7100508337771883`*^9, 3.7100508841648417`*^9}, {
  3.710052829385385*^9, 3.710052829865364*^9}, {3.7100530282111073`*^9, 
  3.7100530290013437`*^9}},
 Background->RGBColor[0.94, 0.91, 0.88]],

Cell["With our parameters, ", "Text",
 CellChangeTimes->{{3.710052732376135*^9, 3.710052736749484*^9}},
 Background->RGBColor[0.94, 0.91, 0.88]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mfig", "=", 
   RowBox[{"mmax", "/.", "figparms"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<\[Mu]\>\"", ",", " ", "0.001", ",", " ", "0.01", ",", " ", "0.1", 
       ",", " ", "0.25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<\!\(\*SubscriptBox[\(m\), \(max\)]\)\>\"", ",", 
       RowBox[{"mfig", "/.", 
        RowBox[{"\[Mu]", "\[Rule]", "0.001"}]}], ",", 
       RowBox[{"mfig", "/.", 
        RowBox[{"\[Mu]", "\[Rule]", "0.01"}]}], ",", 
       RowBox[{"mfig", "/.", 
        RowBox[{"\[Mu]", "\[Rule]", "0.1"}]}], ",", 
       RowBox[{"mfig", "/.", 
        RowBox[{"\[Mu]", "\[Rule]", "0.25"}]}]}], "}"}]}], "}"}], "//", 
   "Transpose"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.710052747055502*^9, 3.710052818043478*^9}, {
  3.7100532482237797`*^9, 3.710053311462964*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"\[Mu]\"\>", "\<\"\\!\\(\\*SubscriptBox[\\(m\\), \\(max\\)]\\)\"\>"},
     {"0.001`", "0.0825308661560524`"},
     {"0.01`", "0.1854503221073996`"},
     {"0.1`", "0.3506975263821558`"},
     {"0.25`", "0.493519415835509`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.710052755096362*^9, 3.710052818306714*^9}, 
   3.710053257133703*^9, 3.710053312233652*^9, 3.710054735030488*^9, 
   3.710157206404828*^9, 3.7101573176646967`*^9, 3.7134076960843153`*^9},
 Background->RGBColor[0.94, 0.91, 0.88]]
}, Open  ]],

Cell[TextData[{
 "And the maximum value attained by E[",
 Cell[BoxData[
  FormBox[
   OverscriptBox["X", "_"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "] is"
}], "Text",
 CellChangeTimes->{{3.7100510317106323`*^9, 3.710051044432754*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"exmax", "=", 
   RowBox[{"ex", "/.", 
    RowBox[{"m", "\[Rule]", "mmax"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7099962990974407`*^9, 3.709996309674233*^9}, 
   3.709996390833296*^9, {3.710050997479954*^9, 3.7100509987763567`*^9}, {
   3.7100510301437063`*^9, 3.7100510304474983`*^9}}],

Cell["\<\
It seems that (exmax - p) is positive when \[Mu] < \[Mu]C and negative \
otherwise, but the formula is too complicated so cannot show this. \
\>", "Text",
 CellChangeTimes->{{3.7100515500063057`*^9, 3.7100515864313383`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LogLinearPlot", "[", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"exmax", "-", "p"}], "\[Delta]"], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"b", "\[Rule]", "10"}], ",", 
      RowBox[{"c", "\[Rule]", "1"}], ",", 
      RowBox[{"d", "\[Rule]", "15"}], ",", 
      RowBox[{"n", "\[Rule]", "4"}], ",", 
      RowBox[{"p", "\[Rule]", "0.45"}], ",", 
      RowBox[{"\[Delta]", "\[Rule]", "0.005"}]}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Small"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.710051357367374*^9, 3.7100515288988533`*^9}, {
  3.710053217227373*^9, 3.7100532249885693`*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwV1nk8VOsbAPAzYyzZjX0pQiXJ2qKNCZX6qRRZonJToYjKHtdeuCUKSZZJ
aJEl6VKW57VUFLIbMpyRZCuSvVl+5/41n+/nOfOe53nP8y5rz3ofP0/GMEyc
hGH//bLid77ufKOMHhhxw51E1GkN+t2e+eXK6IOi6OK8kDotv8dbM+i1Mmr5
6Y8lCqjTLqrn3VvzUhlt9fNtqSOp0+beSFz1eKqM1tvFW2ssraUJjI/o8lKV
0cBZY97nkbU07QN3nmr7KqMElpoGo3ot7RrfyMMIXWVk7JDyPffyWlqSZUhg
wH0llGUt7LWlWo12Qo1T4C2shAqdxWJzJdVo5ZbScjrhiij4ktCnB3VraHl7
FPz1JxRQTULCvPmO1bQd7/g3bz+tgOTnvNMVQZnmqDjcF/NeHol7pq4tUFKi
ydfYVKcZyKNEFdrf874KtOvzhYuF+XKoLaJv9No3Odql5YUNIpJyqCK7NL5b
T5ZGStQqvhgliywOyDYGp0jTtgZMeyYsyyC52TXzvXxU2rx2ntqKqwwKnL/j
d9tGkuZ0xXyTO0MatTb9OmZyS4x2OLpt05q90khBcnhr6l5hGvP77Nm0F1Rk
v9Fk0EtVkCY9yJmRUaeinRxuS+URCq2bvujb948Uir9ttvDblUTbs9B3lM6T
RD3D/h/DsjmmBgoFasVuksh27vdwlcuSaYyshjUlTwLZTc/NPnnw23ROtVa0
OEEcVQTk20b9+WkaUr/79biLGAqMyxD4u3/U9OitOJGNB0RRYwdT4C4JNz21
gH2eMRRBaVt0mVPLnabRyyf+thQURj5XjCT2jCHTxbUhX3KnhRCWcj3cO+MW
cPXpt8YmCGt2pbY/SQQKrWGPzqgQCn8VF8Pi3QXJ06L0VwNEvIhbfq7gPmil
Z5yraxJCtO2DE7wAOpykVv8Yekx4IuL88P1nUE3m8pQchBDK62gcyHkNUV/D
NJOQIKJtnXe9qFAP4pkOixOVggjfcq7Ry64e0u0MPlqUC6K2Wxd/mCfXQ0nT
sPdSIRHf1ZjlLtEAA8X7Ks88FEQ+xs/yk/newZYQkeO6/oJI8rVKetjX9zAq
cz/s0yZBpJZAjhqJ+AiH9hf1898XQNbGSx7xmW1w0cIEFd8VQMYySVTb120Q
b9aa55gggHy2U9eKtLTBJ5OfPoUxAgi72hK+l90GVtt1BU/4CiChyMC6z47t
cESryCj3mABSSKoX85fqABvholtmosR4/FL8Qtc6wVfI5OqUoACid/9CN2I7
IVmg1T6VTwCp/eXg9TuzE7rIP9UnVvgRbeGvZ6mNnWD3Z/ObpHF+NNZ3Upt/
dRc4TBV+w9/zI+OmCKMbdV3g3FpoEhbBj8JvQvV2rAdYZj9cP4XwI2tFO8HV
sj1woVwnTj6QH+k/Ha76sbEHvOkFncWX+VFij0bUMZseiLz6zB134keS16JU
NfJ64Ilc3t292/iRu7vTv78temH2dMYo3yQFSap9Tr/mxwD/zi8i1qMUtPT8
W337TQb8OaBskMGiIKTUIquSzgCKQfr1LQwKKtlPtvKrYYA8X5rk+XcUVLFq
7tlOgT7Y/eTezvfZFBSY5OQtd7cPbk7HJ8TaUhCN4h24+2E/0J9GvNe0pqBE
S4XXKs/74e1fgVz0PwoSmjtuPVXRDz87z19eNqMguoTXv449/WBXQTty0YCC
fOpnm70kv4BmxIKYlTgFWVuXRIVFfIE66tnbEo18SGGD415P+wEY+OTwrqCe
D1WszxIwOzcAC9FHOQeAD9HTT34SvDIA2ou7vcL/5UMOUtFurvEDkPRF/vCv
XD5krV8f6FQ1AC65LaKdEXxILcr8qs1qJnC37riVuosPMeZjgm90MiHzwcg3
y+3EeJnKZ/UGmbCbc8f0jyEfwieHY5rGmBDUMDp7RpsPYdFuKe0cJswdT3bc
qMiH9P1XORtsGIQJ7+n1VQtkhFM2fTAKGITeZ3m1rJdkFKjEWH9BdAj8xY4p
JxeSUcnzZp6p7BDIXGH77n9GRkJHmkpE1gzBcWMbrQI6Gc34eRcF6g1B63vs
ju8dMmoruvvo2bEhaPjq5CzoRUaW69xfXro3BCWrqYs6WmREgSeeBwVweLXo
mRihQUbJBn91rxPG4d/2Dxt71pCRe5XHvhUxHKpjQp3DZIn3BZMt/5HF4eOP
sdp2MpFfZLLeEU0cvlbDLX8mCTVMtB46ScNh9L7S+k8MwlPfcirMcZi44geq
XSSk/+rDFokDOMys2zTb+JGIR96h5h3GgX071V65goTSqK/EfU/iIHfaSx3d
JaGR8vctj67ioGjcWCmTQELWrSSTGD8cVKgaJzziSCjXOU/pr0Ac1N8zblLD
SciH2r6O/DcOeroWP855kdALm8sD47E4WHKVKlZZkpDk4ceJxzNx+B/D79hp
cxJK9H1sXpONw5HStolSE+L/MXUp6jk4nLhwY7XzViKeIKbZnY/D2dZfkUXq
JJRhVbB3uBiH61mNh204GPJJazuQjXCQqe5fXlzCkKTYgWnfOhxefJnKy5jD
UG7oNTuLBhwGFKS43yYxRCsxudz2AQeTe45Fgf3E81/aRbJaceh5eenk6h4M
Me5sWt7bhsPltlCBunYMWboOvB1qxyFbLOe0SBOGAncmvxPqxgGLnRDPKsfQ
SNJdmtQXHNLy2W/NXmGoWeuLQvQADgbvxN2+FxHxFJX+GSaRP9kI9PMxVNbR
v7YCx6E+5Lp3fTLhpGBx7jccblwRbRu7giGrA1OZHtM4rElcE3Lbi8jffvuu
kBkcyov0tQw9MPTiQvVE7C8cxiZtw6+7YEj0zMf4xN84HLyQqS9+FEMlB2Xl
HRdxGI4uHig9hKEG0oWE3Us4BD+ujbXfT7g4UUdpGYfn+DecvofIr6Hue/0K
DqJOuklGOkR91+BROweH3CDaHsYGDKVV8qfd4OKwJ+34eIgGhij36pq28oj5
6fbf+14JQ42nfoxHYiwQmIv9cVEOQxXfI5hqJBZkUR8+kKAS9en1y70h/Pko
/HJYhSGdu+rnGWQWuF9uz+RQiPx7jcPO8LEAu/31YA5GjK9zZhwn7JIsYdE7
zQPs9YaKDgoLktqNMtS+82DqwfRac34W1Ik7zHkM8oDykzpaSFgjjp7LbuZB
871/b14VYIHKK42Q+HoiXqZe3klYjplvo/CWBxlNfNa6giyQFNTelF/Cg5BM
+olIwqsMCslbnvBAaMD002fCZCf9/tpMHqQpaZXJCbGAHf3q5dFkHlR1ZUvb
E14o2hbHjOeBrfuPqUTC04w3LpcieDCgaG/eQHiMvMd4OYAHapIaSr8ID+sg
iZuXeaDpcN9XfhULBuzMv8uc54Hl0PKJ7YS7w9/X5DjxwN0/sdaacOvzg6n6
x3kw9pn+1pVwY1ezV40lDxTCfSx8CNdxj+6zMuWBJ9virD/hSq1Olf6tRD0P
XeX/c9lxuzk3HR5UJEq5eRMuCun7NK/OA4vZe7ZnCT/Nd34cpcgj5knv6xHC
j9qGgqUkecDO3yi3lXD6ytnj2QI8iA55PyNDOFlzdONmDheiaw/5/yTqSTji
Qar8zQVP1sqzWsI3A6cYlhNcSFRXvpNAODzHu6QH54JW/rTWCcLBzbM3z/Vy
wedSVbAsYd8FvzOzLVxIPvTu5n/z7aW2vC28gQtblg7bRBG+cChEXLySC5q8
B7g+YRdf3reHL7nA+DBlyCC+p00jf0p5FhdmfF4ZyRC2mo313JfCBUuHwrGn
RD/sVxG16PyHCyUSb723E97hQ/39M5ALmKEcyYzoJ8P0lI8h3lwYOD0hVUP0
m06DQo7wBS40d/STthBWVVA9tt6GC5KmCrfEiH5VMMvRKjvIhbn0MZ0rRD9T
PddhZjTCQgNvWon+50ebik9t5oLain5eALE+Jt2MxVIEuWC7vUAlgo3DSFLl
iDqXAyWnCoPK/uAwWGlSVTLHAbW03gEWsf7aJfZdamZxQMbocZ02sT7Ly481
8VVxwKec4uY3j0MJq4ueVMqBZJ9t1kFzxPoVcQhUfcaBMnasYwCx/jPPnN6w
K5UDLxTj+v4i9ocowUsxV304gDm+Hp+ZwiH/rXMk3Y0DotPy6/onifPD60hY
62kO7F7ItK+ZwIHaZRCkfZgDU/ZZLwLGcMihL3kOb+RA+IqOS9FXHGp33LA9
/pUNgdqdO3X7iHqmAo6F97MhTWKPZmMvDkJ0jyNF7WyQkR7UPdWDg7XAYUth
xIa5ZfPSwE4c8A7p3XUZbLC1Eq70a8GBd+mRhqEdG3zLtqjGE/u3uuo9NZfD
hC1D7XprcNjfEb06wYINM7Y4Q7UahwRjd/kJQzaUJbs15bwh9kd+PZEcCTbQ
VuJzfEqJ/Smralaq6Q/EfpoN0X1MnA9tvbW/dhG2ZVP2ReDwlGFItjL6A10/
ymRFw4j9Hr9tlq/9B15obpxpDcHB8Jd5/UnFP3DOGhO1JM6zMamShvqFFZiT
D9cQ8sbBzib2Q8rLFWjcVvar1ol4vse4ZceGFRhLRhwdQxxcBu+JJa9ZAdvz
vktX9Ih8R38e/im7AslwWPiVDg7jC7mtOZQVYF8VC924AQe6vFSbyPAyDHQv
sb4r4yDmON7BzFgGuvqZuhcU4v1fHjAiqMuQOLle53P+EAy22aSprVoGHG1b
xcwegu53Yg7AW4KxYiu34bQhqCuO6GVPLYFDdnlNZ/wQZER59AR8WAJGX0rU
sctDYL1pR5dXyBLMyKgV1BgNQXkw47Pj6CKUPKq6GlcxCDcU5T8YvF0A6zAx
ad0CJjy5b/rC5+UCVHx6rPc1hwmNsu5JxU8XINzMVf9uOhOEqW+cNt9fAJ+W
//1ixjHhtrDTjJbvAgi5rJ7XcWdC8p8sRTXdBbA8sH5doQYTHjHXe4rnzEOj
MSLbpw5A1aNtUpNxc6D/I0z6xCXi/ugsZdSgPQvGrWkdMjnEfbY08rRz4TTM
2JXua6J3wzRtg7j5iUlonNjYG/mkA0y2mHl5ZI9C24VVLdtyWqGq6lFUzo5h
mFkcjgw+1giHku0zVzq/ACIdMk7TroORAIe7ekEdgPL4v/rZlUOFyLtJ6dB6
CH/eNU/NfgJH5Lrpqnr1gG5Qe3N3PYERtW8nNrHqgOaW3+jIyAdJ4m5utq8O
MLs1HzZT88HdZV/yFbFawCZXnkbfzAXDi/8EZe2qBlrMmxL1oEcwV3VLWTb0
FYR/P5Rf8DsV1DpexOiwSiE8d2Y8YlsqWH1vnjbfRzhxZl1RUArkSok1XBV7
CVhvUKkwKRmeNyv10XcVQnjT9dCv0kngqapyXT70MWCDQhEaKTeg4aDz0f37
cgDTyR2RWR8DKr4ZGn5ijwBLGnFtKI+C9KQdaXm7MgEz2B11lhkOp0Z27lQJ
vQeYZUNFsKs/iO+oHA4SSwJM8qBVVNI1CFEOkCvedRuw3R3VyrU+YHo5sGJd
aBQRX/1O9NAFoOnNUut2hQIm43axstQFyJG/y4xDrwEWHn1v9x47iHs2Xng6
1BUw+qTHxLb9sD+gXvo6O7IGw7Dmp5nna/4PcUn9pA==
       "]]},
     Annotation[#, "Charting`Private`Tag$433499#1"]& ]}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{-6.931471664140845, 0},
  CoordinatesToolOptions:>{"DisplayFunction" -> ({
      Exp[
       Part[#, 1]], 
      Part[#, 2]}& ), "CopiedValueFunction" -> ({
      Exp[
       Part[#, 1]], 
      Part[#, 2]}& )},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {
     Charting`ScaledTicks[{Log, Exp}], 
     Charting`ScaledFrameTicks[{Log, Exp}]}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->Small,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Log, Exp}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Log, Exp}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Log, Exp}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Log, Exp}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{All, All},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->FrontEndValueCache[{
     Charting`ScaledTicks[{Log, Exp}], Automatic}, {{{-6.907755278982137, 
       FormBox["0.001`", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {-5.298317366548036, 
       FormBox[
        TagBox[
         InterpretationBox["\"0.005\"", 0.005, AutoDelete -> True], 
         NumberForm[#, {
           DirectedInfinity[1], 3.}]& ], TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {-4.605170185988091, 
       FormBox[
        TagBox[
         InterpretationBox["\"0.010\"", 0.01, AutoDelete -> True], 
         NumberForm[#, {
           DirectedInfinity[1], 3.}]& ], TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {-2.995732273553991, 
       FormBox[
        TagBox[
         InterpretationBox["\"0.050\"", 0.05, AutoDelete -> True], 
         NumberForm[#, {
           DirectedInfinity[1], 3.}]& ], TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {-2.3025850929940455`, 
       FormBox[
        TagBox[
         InterpretationBox["\"0.100\"", 0.1, AutoDelete -> True], 
         NumberForm[#, {
           DirectedInfinity[1], 3.}]& ], TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {-0.6931471805599453, 
       FormBox[
        TagBox[
         InterpretationBox["\"0.500\"", 0.5, AutoDelete -> True], 
         NumberForm[#, {
           DirectedInfinity[1], 3.}]& ], TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {0., 
       FormBox["1", TraditionalForm], {0.01, 0.}, {
        AbsoluteThickness[0.1]}}, {-7.600902459542082, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-7.418580902748128, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-7.264430222920869, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-7.1308988302963465`, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-7.013115794639964, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-6.214608098422191, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-5.809142990314028, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-5.521460917862246, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-5.115995809754082, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-4.961845129926823, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-4.8283137373023015`, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-4.710530701645918, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-3.912023005428146, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-3.506557897319982, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-3.2188758248682006`, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-2.8134107167600364`, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-2.659260036932778, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-2.5257286443082556`, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-2.4079456086518722`, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-1.6094379124341003`, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-1.2039728043259361`, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-0.916290731874155, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-0.5108256237659907, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-0.35667494393873245`, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-0.2231435513142097, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {-0.10536051565782628`, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {0.6931471805599453, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {1.0986122886681098`, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {1.3862943611198906`, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {1.6094379124341003`, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {1.791759469228055, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}, {1.9459101490553132`, 
       FormBox[
        InterpretationBox[
         StyleBox[
          
          GraphicsBox[{}, ImageSize -> {0., 0.}, BaselinePosition -> 
           Baseline], "CacheGraphics" -> False], 
         Spacer[{0., 0.}]], TraditionalForm], {0.005, 0.}, {
        AbsoluteThickness[0.1]}}}, Automatic}]]], "Output",
 CellChangeTimes->{{3.71005137196447*^9, 3.710051529265329*^9}, 
   3.710053225360528*^9, 3.710054735287053*^9, 3.710157206897375*^9, 
   3.710157317960278*^9, 3.7134076965242643`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "WF life-cycle, changes with ",
 StyleBox["m",
  FontSlant->"Italic"]
}], "Section",
 CellChangeTimes->{{3.709991808059176*^9, 3.709991809902101*^9}, {
   3.7099926538714027`*^9, 3.7099926588636703`*^9}, {3.709994308556666*^9, 
   3.709994308868649*^9}, 3.71005253728268*^9}],

Cell[CellGroupData[{

Cell["Indirect/secondary term", "Subsection",
 CellChangeTimes->{{3.709992660401154*^9, 3.709992664955244*^9}, {
   3.7099927270714827`*^9, 3.709992728334756*^9}, 3.710050920188869*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bi", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Beta]WFI", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Qin", "\[Rule]", "QinWF"}], ",", " ", 
       RowBox[{"Qout", "\[Rule]", "QoutWF"}]}], "}"}]}], "/.", "mychange"}], "//",
    "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.709992684506249*^9, 3.709992722344799*^9}, {
  3.70999431335295*^9, 3.7099943176281147`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "m"}], ")"}]}]}], ")"}], " ", "m"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       "\[Mu]"}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
      ")"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "m", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
      ")"}]}], "+", 
    RowBox[{"d", " ", 
     SuperscriptBox["m", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.709992689489194*^9, 3.709992738290503*^9}, 
   3.7099943194002657`*^9, {3.7100515961300163`*^9, 3.710051598758604*^9}, 
   3.710051703511916*^9, 3.7100547367265244`*^9, 3.710157208236252*^9, 
   3.713407698153101*^9}]
}, Open  ]],

Cell[TextData[{
 "Derivative with respect to ",
 StyleBox["m",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.7100517691345177`*^9, 3.710051772735767*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dbi", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"bi", ",", "m"}], "]"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.709992740062263*^9, 3.709992758164859*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "3"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], " ", "n", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
      SuperscriptBox["\[Mu]", "2"]}], ")"}], "/", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
         ")"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "m", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
         ")"}]}], "+", 
       RowBox[{"d", " ", 
        SuperscriptBox["m", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
         ")"}]}]}], ")"}], "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.709992743620757*^9, 3.709992758937481*^9}, 
   3.709994321003579*^9, 3.710051705096772*^9, 3.7100547370772257`*^9, 
   3.710157208693563*^9, 3.713407698616851*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"dbi", "\[Equal]", "0"}], ",", "m"}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.7099943257092037`*^9, 3.709994332489066*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"m", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], "d"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.709994329352385*^9, 3.709994332834153*^9}, 
   3.71005170645*^9, 3.7100547371328506`*^9, 3.7101572087632523`*^9, 
   3.71340769877022*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dbi", "/.", 
   RowBox[{"m", "\[Rule]", "0"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.709994336457981*^9, 3.709994341452919*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "n", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], ")"}], 
   "2"]]], "Output",
 CellChangeTimes->{{3.709994339397717*^9, 3.709994341794547*^9}, 
   3.710051707668467*^9, 3.7100547372311707`*^9, 3.7101572088994093`*^9, 
   3.713407698869268*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"->", 
     RowBox[{"\[Beta]WFI", " ", "decreases", " ", "until", " ", "m"}]}], "=", 
    
    FractionBox[
     RowBox[{"d", "-", "1"}], "d"]}], ",", " ", 
   RowBox[{"then", " ", 
    RowBox[{"increases", ".", "\[IndentingNewLine]"}]}]}]}]], "Text",
 CellChangeTimes->{{3.7099943535914392`*^9, 3.7099943676693983`*^9}, {
  3.71005171060788*^9, 3.710051715711771*^9}, {3.710053012072406*^9, 
  3.7100530215679703`*^9}},
 FontFamily->"Nimbus Sans L",
 Background->RGBColor[0.94, 0.91, 0.88]]
}, Open  ]],

Cell[CellGroupData[{

Cell["EX", "Subsection",
 CellChangeTimes->{{3.709996518061741*^9, 3.7099965195198298`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ex", "=", 
   RowBox[{"EXWF", "//", "ApplyParms"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.70999439696058*^9, 3.709994405415493*^9}, {
   3.709994546182214*^9, 3.7099945569046583`*^9}, {3.70999460635781*^9, 
   3.709994606681038*^9}, {3.7099965223945723`*^9, 3.709996522455662*^9}, 
   3.709996561277812*^9}],

Cell[TextData[{
 "Derivative with respect to ",
 StyleBox["m",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.7100517691345177`*^9, 3.710051772735767*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dex", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"ex", ",", "m"}], "]"}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.709994615756215*^9, 3.709994625739416*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], "3"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], " ", "n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", "\[Delta]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"c", "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], ")"}]}],
    ")"}], "/", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "m", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}], "+", 
     RowBox[{"d", " ", 
      SuperscriptBox["m", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}]}], ")"}], "2"]}]], "Output",
 CellChangeTimes->{3.709996566023678*^9, 3.710051721229195*^9, 
  3.710051783126565*^9, 3.71005473972503*^9, 3.710157210848214*^9, 
  3.713407701685404*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mcc", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"dex", "\[Equal]", "0"}], ",", "m"}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.709996568347855*^9, 3.7099966445018663`*^9}, {
  3.710051794840701*^9, 3.710051799454904*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"m", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], "d"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.710051804817286*^9, 3.7100547399874163`*^9, 
  3.710157211129669*^9, 3.7134077020076647`*^9}]
}, Open  ]],

Cell[TextData[{
 "Second derivative with respect to ",
 StyleBox["m",
  FontSlant->"Italic"],
 ", evaluated at the critical ",
 StyleBox["m",
  FontSlant->"Italic"]
}], "Text",
 CellChangeTimes->{{3.710051805729261*^9, 3.710051817551724*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ddex", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"ex", ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "2"}], "}"}]}], "]"}], "/.", 
    RowBox[{"mcc", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.709996568347855*^9, 3.7099966445018663`*^9}, {
  3.710051794840701*^9, 3.710051830315584*^9}}],

Cell["When does this second derivative change signs?", "Text",
 CellChangeTimes->{{3.7100518422076902`*^9, 3.710051852742999*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"ddex", "\[Equal]", "0"}], ",", "\[Mu]"}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.709996627844253*^9, 3.70999665372458*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", 
     RowBox[{"1", "-", 
      FractionBox[
       SqrtBox[
        RowBox[{"b", " ", 
         RowBox[{"(", 
          RowBox[{"b", "-", "c"}], ")"}]}]], "b"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", 
     FractionBox[
      RowBox[{"b", "+", 
       SqrtBox[
        RowBox[{"b", " ", 
         RowBox[{"(", 
          RowBox[{"b", "-", "c"}], ")"}]}]]}], "b"]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.709996641951585*^9, 3.7099966543299437`*^9}, {
   3.710051827763281*^9, 3.710051832132584*^9}, 3.710054740395288*^9, 
   3.710157211555909*^9, 3.7134077025882*^9}]
}, Open  ]],

Cell[TextData[{
 "It is either a minimum or a maximum depending on \[Mu]. To know whether it \
is a min or a max, let\[CloseCurlyQuote]s look at the initial change of EX \
with ",
 StyleBox["m",
  FontSlant->"Italic"],
 ", and see whether it is increasing (-> max) or decreasing (->min)."
}], "Text",
 CellChangeTimes->{{3.71005198575049*^9, 3.71005203674174*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dex0", "=", 
  RowBox[{
   RowBox[{"dex", "/.", 
    RowBox[{"m", "\[Rule]", "0"}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Mu]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Limit", "[", 
  RowBox[{"dex0", ",", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7099967608476353`*^9, 3.709996787902912*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", "n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", "\[Delta]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"c", "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   RowBox[{"\[Mu]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], ")"}], 
     "2"]}]]}]], "Output",
 CellChangeTimes->{{3.7099967644239473`*^9, 3.709996788440493*^9}, 
   3.7100518940220423`*^9, 3.710054740641012*^9, 3.71015721174963*^9, 
   3.713407702834461*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", 
     FractionBox[
      RowBox[{"b", "-", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["b", "2"], "-", 
         RowBox[{"b", " ", "c"}]}]]}], "b"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", 
     FractionBox[
      RowBox[{"b", "+", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["b", "2"], "-", 
         RowBox[{"b", " ", "c"}]}]]}], "b"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7099967644239473`*^9, 3.709996788440493*^9}, 
   3.7100518940220423`*^9, 3.710054740641012*^9, 3.71015721174963*^9, 
   3.71340770284127*^9}],

Cell[BoxData[
 RowBox[{"n", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", "\[Delta]", " ", 
  RowBox[{"DirectedInfinity", "[", "c", "]"}]}]], "Output",
 CellChangeTimes->{{3.7099967644239473`*^9, 3.709996788440493*^9}, 
   3.7100518940220423`*^9, 3.710054740641012*^9, 3.71015721174963*^9, 
   3.7134077029102907`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"->", 
      RowBox[{
       RowBox[{
        RowBox[{"-", " ", "When"}], " ", "\[Mu]"}], "<", 
       SuperscriptBox[
        SubscriptBox["\[Mu]", "c"], "WF"]}]}], "=", 
     RowBox[{"1", "-", 
      FractionBox[
       SqrtBox[
        RowBox[{"b", " ", 
         RowBox[{"(", 
          RowBox[{"b", "-", "c"}], ")"}]}]], "b"]}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"E", "[", 
       FormBox[
        OverscriptBox["X", "_"],
        TraditionalForm], "]"}], " ", "reaches", " ", "a", " ", "minimum", 
      " ", "at", " ", 
      SuperscriptBox[
       SubscriptBox["m", "c"], "WF"]}], " ", "=", " ", 
     FractionBox[
      RowBox[{"d", "-", "1"}], "d"]}], ",", " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{
     RowBox[{"initially", " ", "decreases", " ", "with", " ", 
      RowBox[{
       StyleBox["m",
        FontSlant->"Italic"], 
       StyleBox[".",
        FontSlant->"Plain"]}]}], 
     StyleBox[";",
      FontSlant->"Plain"]}]}], 
   StyleBox["\[IndentingNewLine]",
    FontSlant->"Plain"], 
   StyleBox["        ",
    FontSlant->"Plain"], 
   RowBox[{
    StyleBox[
     RowBox[{"-", "Otherwise"}],
     FontSlant->"Plain"], 
    StyleBox[",",
     FontSlant->"Plain"], 
    StyleBox[" ",
     FontSlant->"Plain"], 
    RowBox[{
     RowBox[{
      RowBox[{"E", "[", 
       FormBox[
        OverscriptBox["X", "_"],
        TraditionalForm], "]"}], " ", "reaches", " ", "a", " ", "maximum", 
      " ", "at", " ", 
      SuperscriptBox[
       SubscriptBox["m", "c"], "WF"]}], "=", 
     FractionBox[
      RowBox[{"d", "-", "1"}], "d"]}], ",", " ", 
    RowBox[{"i", ".", "e", "."}], ",", " ", 
    RowBox[{"initially", " ", "increases", " ", "with", " ", 
     RowBox[{
      StyleBox["m",
       FontSlant->"Italic"], 
      StyleBox[".",
       FontSlant->"Plain"], 
      StyleBox["\[IndentingNewLine]",
       FontSlant->"Plain"]}]}]}]}]}]], "Text",
 CellChangeTimes->{{3.7100520958090267`*^9, 3.710052210372398*^9}, {
  3.710052977752256*^9, 3.710052997221224*^9}, {3.710053170480444*^9, 
  3.710053183336671*^9}},
 FontFamily->"Nimbus Sans L",
 Background->RGBColor[0.94, 0.91, 0.88]],

Cell[TextData[{
 "With our parameters, the critical value of \[Mu] is ",
 Cell[BoxData[
  SuperscriptBox[
   SubscriptBox["\[Mu]", "c"], "WF"]], "Text",
  CellChangeTimes->{{3.7100520958090267`*^9, 3.710052210372398*^9}, {
   3.710052977752256*^9, 3.710052997221224*^9}, {3.710053170480444*^9, 
   3.710053183336671*^9}},
  FontFamily->"Nimbus Sans L",
  Background->RGBColor[0.94, 0.91, 0.88]],
 "="
}], "Text",
 CellChangeTimes->{{3.7100525435267353`*^9, 3.710052547691865*^9}, {
  3.7100531894714117`*^9, 3.710053201254859*^9}},
 Background->RGBColor[0.94, 0.91, 0.88]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"1", "-", 
    FractionBox[
     SqrtBox[
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{"b", "-", "c"}], ")"}]}]], "b"]}], "/.", "figparms"}], "//", 
  "N"}]], "Input",
 CellChangeTimes->{{3.710052559683139*^9, 3.710052565010685*^9}}],

Cell[BoxData["0.033908216920704115`"], "Output",
 CellChangeTimes->{{3.710052562271955*^9, 3.710052565398692*^9}, 
   3.7100547407423763`*^9, 3.710157211843985*^9, 3.7134077031107073`*^9},
 Background->RGBColor[0.94, 0.91, 0.88]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1062, 1028},
WindowMargins->{{7, Automatic}, {0, Automatic}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 301, 8, 56, "Text"],
Cell[862, 30, 1770, 36, 453, "Text"],
Cell[2635, 68, 1132, 21, 162, "Text"],
Cell[3770, 91, 174, 2, 33, "Text"],
Cell[3947, 95, 224, 6, 32, "Input"],
Cell[4174, 103, 232, 5, 33, "Text"],
Cell[4409, 110, 318, 8, 34, "Input"],
Cell[CellGroupData[{
Cell[4752, 122, 215, 3, 93, "Title"],
Cell[CellGroupData[{
Cell[4992, 129, 149, 2, 65, "Section"],
Cell[5144, 133, 240, 5, 33, "Text"],
Cell[5387, 140, 361, 12, 61, "Input"],
Cell[5751, 154, 96, 1, 33, "Text"],
Cell[5850, 157, 178, 5, 34, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6065, 167, 373, 5, 65, "Section"],
Cell[CellGroupData[{
Cell[6463, 176, 120, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[6608, 181, 235, 3, 35, "Subsubsection"],
Cell[6846, 186, 169, 2, 33, "Text"],
Cell[7018, 190, 1802, 35, 289, "Input"],
Cell[8823, 227, 165, 2, 33, "Text"],
Cell[8991, 231, 1043, 24, 192, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10071, 260, 231, 3, 35, "Subsubsection"],
Cell[10305, 265, 796, 20, 57, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11138, 290, 162, 2, 35, "Subsubsection"],
Cell[11303, 294, 252, 5, 33, "Text"],
Cell[11558, 301, 993, 31, 96, "Input"],
Cell[12554, 334, 203, 4, 33, "Text"],
Cell[12760, 340, 709, 21, 96, "Input"],
Cell[13472, 363, 181, 4, 33, "Text"],
Cell[13656, 369, 955, 30, 96, "Input"],
Cell[14614, 401, 254, 5, 33, "Text"],
Cell[14871, 408, 1535, 48, 104, "Input"],
Cell[16409, 458, 93, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[16527, 463, 693, 23, 55, "Input"],
Cell[17223, 488, 290, 5, 32, "Output"],
Cell[17516, 495, 290, 5, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17867, 507, 133, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[18025, 512, 213, 4, 35, "Subsubsection"],
Cell[18241, 518, 90, 1, 33, "Text"],
Cell[18334, 521, 1463, 29, 228, "Input"],
Cell[19800, 552, 90, 1, 33, "Text"],
Cell[19893, 555, 995, 23, 192, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[20961, 586, 256, 3, 93, "Title"],
Cell[CellGroupData[{
Cell[21242, 593, 90, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[21357, 598, 162, 2, 45, "Subsection"],
Cell[21522, 602, 384, 7, 55, "Text"],
Cell[21909, 611, 1446, 45, 74, "Input"],
Cell[23358, 658, 2563, 85, 145, "Input"],
Cell[25924, 745, 115, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[26064, 750, 385, 10, 34, "Input"],
Cell[26452, 762, 2072, 57, 53, "Output"]
}, Open  ]],
Cell[28539, 822, 133, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[28697, 827, 474, 12, 55, "Input"],
Cell[29174, 841, 2181, 61, 53, "Output"],
Cell[31358, 904, 1941, 53, 53, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33348, 963, 107, 1, 45, "Subsection"],
Cell[33458, 966, 291, 5, 55, "Text"],
Cell[33752, 973, 5812, 150, 566, "Input"],
Cell[39567, 1125, 345, 6, 55, "Text"],
Cell[39915, 1133, 2169, 55, 194, "Input"],
Cell[42087, 1190, 117, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[42229, 1195, 831, 21, 57, "Input"],
Cell[CellGroupData[{
Cell[43085, 1220, 984, 22, 59, "Print"],
Cell[44072, 1244, 983, 22, 59, "Print"]
}, Open  ]]
}, Open  ]],
Cell[45082, 1270, 119, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[45226, 1275, 831, 21, 57, "Input"],
Cell[CellGroupData[{
Cell[46082, 1300, 956, 22, 59, "Print"],
Cell[47041, 1324, 953, 22, 59, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48055, 1353, 105, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[48185, 1358, 282, 3, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[48492, 1365, 395, 10, 55, "Input"],
Cell[48890, 1377, 1708, 48, 53, "Output"],
Cell[50601, 1427, 1423, 39, 52, "Output"]
}, Open  ]],
Cell[52039, 1469, 307, 6, 33, "Text"],
Cell[CellGroupData[{
Cell[52371, 1479, 1090, 34, 32, "Input"],
Cell[53464, 1515, 694, 10, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54195, 1530, 859, 27, 32, "Input"],
Cell[55057, 1559, 639, 9, 32, "Output"]
}, Open  ]],
Cell[55711, 1571, 151, 2, 33, "Text"],
Cell[55865, 1575, 188, 5, 77, "Text"],
Cell[CellGroupData[{
Cell[56078, 1584, 547, 15, 57, "Input"],
Cell[56628, 1601, 690, 10, 32, "Output"],
Cell[57321, 1613, 690, 10, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58048, 1628, 427, 10, 56, "Input"],
Cell[58478, 1640, 657, 18, 52, "Output"],
Cell[59138, 1660, 428, 11, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59603, 1676, 423, 10, 57, "Input"],
Cell[60029, 1688, 721, 10, 32, "Output"],
Cell[60753, 1700, 723, 10, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61513, 1715, 217, 5, 34, "Input"],
Cell[61733, 1722, 1000, 21, 34, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62782, 1749, 238, 3, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[63045, 1756, 392, 10, 55, "Input"],
Cell[63440, 1768, 1965, 59, 60, "Output"],
Cell[65408, 1829, 1706, 50, 52, "Output"]
}, Open  ]],
Cell[67129, 1882, 117, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[67271, 1887, 1550, 47, 64, "Input"],
Cell[68824, 1936, 693, 10, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69554, 1951, 1269, 40, 64, "Input"],
Cell[70826, 1993, 664, 9, 32, "Output"]
}, Open  ]],
Cell[71505, 2005, 96, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[71626, 2010, 438, 12, 57, "Input"],
Cell[72067, 2024, 1120, 26, 52, "Output"],
Cell[73190, 2052, 832, 16, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74059, 2073, 366, 8, 57, "Input"],
Cell[74428, 2083, 623, 9, 32, "Output"],
Cell[75054, 2094, 621, 9, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[75748, 2111, 100, 1, 65, "Section"],
Cell[75851, 2114, 194, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[76070, 2122, 113, 1, 45, "Subsection"],
Cell[76186, 2125, 243, 4, 55, "Text"],
Cell[76432, 2131, 3202, 105, 222, "Input"],
Cell[79637, 2238, 113, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[79775, 2243, 367, 9, 34, "Input"],
Cell[80145, 2254, 1722, 48, 76, "Output"]
}, Open  ]],
Cell[81882, 2305, 116, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[82023, 2310, 464, 12, 55, "Input"],
Cell[82490, 2324, 2780, 87, 104, "Output"],
Cell[85273, 2413, 2455, 75, 104, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[87777, 2494, 107, 1, 45, "Subsection"],
Cell[87887, 2497, 5649, 146, 574, "Input"],
Cell[93539, 2645, 2139, 56, 194, "Input"],
Cell[CellGroupData[{
Cell[95703, 2705, 1411, 39, 103, "Input"],
Cell[CellGroupData[{
Cell[97139, 2748, 1049, 23, 59, "Print"],
Cell[98191, 2773, 1050, 23, 59, "Print"],
Cell[99244, 2798, 1047, 23, 59, "Print"],
Cell[100294, 2823, 1049, 23, 59, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[101404, 2853, 105, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[101534, 2858, 112, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[101671, 2863, 234, 6, 32, "Input"],
Cell[101908, 2871, 2213, 67, 103, "Output"]
}, Open  ]],
Cell[104136, 2941, 112, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[104273, 2946, 1379, 47, 215, "Input"],
Cell[105655, 2995, 192, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105884, 3003, 233, 6, 32, "Input"],
Cell[106120, 3011, 2129, 64, 103, "Output"]
}, Open  ]],
Cell[108264, 3078, 114, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[108403, 3083, 548, 17, 93, "Input"],
Cell[108954, 3102, 213, 3, 32, "Output"]
}, Open  ]],
Cell[109182, 3108, 95, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[109302, 3113, 308, 7, 57, "Input"],
Cell[109613, 3122, 284, 4, 32, "Output"],
Cell[109900, 3128, 282, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110219, 3137, 411, 11, 79, "Input"],
Cell[110633, 3150, 1330, 42, 57, "Output"],
Cell[111966, 3194, 683, 19, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112686, 3218, 233, 6, 34, "Input"],
Cell[112922, 3226, 314, 4, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[113285, 3236, 130, 1, 35, "Subsubsection"],
Cell[113418, 3239, 180, 2, 33, "Text"],
Cell[113601, 3243, 601, 17, 80, "Input"],
Cell[114205, 3262, 192, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[114422, 3270, 732, 19, 56, "Input"],
Cell[115157, 3291, 1985, 66, 71, "Output"]
}, Open  ]],
Cell[117157, 3360, 140, 2, 33, "Text"],
Cell[CellGroupData[{
Cell[117322, 3366, 295, 7, 57, "Input"],
Cell[117620, 3375, 3977, 123, 119, "Output"]
}, Open  ]],
Cell[121612, 3501, 107, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[121744, 3506, 318, 9, 34, "Input"],
Cell[122065, 3517, 6062, 183, 244, "Output"]
}, Open  ]],
Cell[128142, 3703, 172, 4, 34, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128351, 3712, 168, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[128544, 3718, 276, 6, 32, "Input"],
Cell[128823, 3726, 3101, 98, 104, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131961, 3829, 279, 6, 32, "Input"],
Cell[132243, 3837, 2610, 81, 104, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[134926, 3926, 161, 2, 65, "Section"],
Cell[135090, 3930, 107, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[135222, 3935, 301, 7, 34, "Input"],
Cell[135526, 3944, 453, 9, 34, "Output"]
}, Open  ]],
Cell[135994, 3956, 115, 1, 33, "Text"],
Cell[136112, 3959, 930, 17, 344, "Input"],
Cell[137045, 3978, 120, 1, 33, "Text"],
Cell[137168, 3981, 250, 6, 34, "Input"],
Cell[137421, 3989, 93, 1, 33, "Text"],
Cell[137517, 3992, 1183, 29, 103, "Input"],
Cell[138703, 4023, 110, 1, 33, "Text"],
Cell[138816, 4026, 237, 5, 34, "Input"],
Cell[139056, 4033, 99, 1, 33, "Text"],
Cell[139158, 4036, 388, 8, 210, "Input"],
Cell[139549, 4046, 128, 1, 33, "Text"],
Cell[139680, 4049, 393, 8, 34, "Input"],
Cell[140076, 4059, 113, 1, 33, "Text"],
Cell[140192, 4062, 302, 7, 34, "Input"],
Cell[140497, 4071, 206, 4, 32, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[140752, 4081, 163, 2, 93, "Title"],
Cell[CellGroupData[{
Cell[140940, 4087, 172, 2, 65, "Section"],
Cell[141115, 4091, 748, 13, 121, "Text"],
Cell[CellGroupData[{
Cell[141888, 4108, 157, 2, 44, "Subsection"],
Cell[CellGroupData[{
Cell[142070, 4114, 98, 1, 36, "Subsubsection"],
Cell[142171, 4117, 564, 17, 34, "Input"],
Cell[142738, 4136, 2446, 76, 116, "Input"],
Cell[CellGroupData[{
Cell[145209, 4216, 219, 6, 55, "Input"],
Cell[145431, 4224, 685, 12, 51, "Output"]
}, Open  ]],
Cell[146131, 4239, 236, 6, 34, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146404, 4250, 99, 1, 36, "Subsubsection"],
Cell[146506, 4253, 171, 4, 34, "Input"],
Cell[146680, 4259, 740, 24, 50, "Input"],
Cell[CellGroupData[{
Cell[147445, 4287, 260, 7, 32, "Input"],
Cell[147708, 4296, 1456, 38, 52, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[149225, 4341, 108, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[149358, 4346, 99, 1, 36, "Subsubsection"],
Cell[CellGroupData[{
Cell[149482, 4351, 133, 2, 32, "Input"],
Cell[149618, 4355, 909, 21, 32, "Output"]
}, Open  ]],
Cell[150542, 4379, 18085, 498, 1332, "Input"],
Cell[CellGroupData[{
Cell[168652, 4881, 129, 2, 32, "Input"],
Cell[168784, 4885, 651, 12, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169472, 4902, 312, 8, 32, "Input"],
Cell[169787, 4912, 6362, 188, 190, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[176198, 5106, 149, 2, 36, "Subsubsection"],
Cell[CellGroupData[{
Cell[176372, 5112, 135, 2, 32, "Input"],
Cell[176510, 5116, 544, 8, 32, "Output"]
}, Open  ]],
Cell[177069, 5127, 1959, 57, 94, "Input"],
Cell[CellGroupData[{
Cell[179053, 5188, 216, 5, 32, "Input"],
Cell[179272, 5195, 2601, 72, 79, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[181934, 5274, 104, 1, 45, "Subsection"],
Cell[182041, 5277, 208, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[182274, 5285, 98, 1, 36, "Subsubsection"],
Cell[182375, 5288, 378, 8, 80, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182790, 5301, 99, 1, 36, "Subsubsection"],
Cell[182892, 5304, 378, 8, 80, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[183331, 5319, 210, 3, 65, "Section"],
Cell[183544, 5324, 315, 5, 55, "Text"],
Cell[CellGroupData[{
Cell[183884, 5333, 194, 2, 45, "Subsection"],
Cell[184081, 5337, 420, 7, 55, "Text"],
Cell[184504, 5346, 3847, 98, 315, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[188388, 5449, 241, 3, 44, "Subsection"],
Cell[CellGroupData[{
Cell[188654, 5456, 121, 1, 35, "Subsubsection"],
Cell[188778, 5459, 163, 2, 33, "Text"],
Cell[188944, 5463, 1674, 43, 137, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[190655, 5511, 150, 2, 36, "Subsubsection"],
Cell[190808, 5515, 132, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[190965, 5520, 662, 14, 34, "Input"],
Cell[191630, 5536, 3360, 83, 123, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[195027, 5624, 365, 10, 34, "Input"],
Cell[195395, 5636, 683, 10, 32, "Output"]
}, Open  ]],
Cell[196093, 5649, 120, 1, 33, "Text"],
Cell[196216, 5652, 132, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[196373, 5657, 419, 10, 34, "Input"],
Cell[196795, 5669, 2897, 76, 101, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[199729, 5750, 315, 9, 34, "Input"],
Cell[200047, 5761, 570, 8, 32, "Output"]
}, Open  ]],
Cell[200632, 5772, 120, 1, 33, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[200789, 5778, 151, 2, 36, "Subsubsection"],
Cell[200943, 5782, 183, 2, 33, "Text"],
Cell[CellGroupData[{
Cell[201151, 5788, 710, 14, 34, "Input"],
Cell[201864, 5804, 1750, 40, 101, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[203651, 5849, 369, 10, 34, "Input"],
Cell[204023, 5861, 640, 9, 32, "Output"]
}, Open  ]],
Cell[204678, 5873, 120, 1, 33, "Text"],
Cell[204801, 5876, 132, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[204958, 5881, 525, 12, 34, "Input"],
Cell[205486, 5895, 1501, 37, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[207024, 5937, 366, 10, 34, "Input"],
Cell[207393, 5949, 616, 9, 32, "Output"]
}, Open  ]],
Cell[208024, 5961, 120, 1, 33, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[208193, 5968, 267, 4, 44, "Subsection"],
Cell[208463, 5974, 166, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[208654, 5981, 121, 1, 35, "Subsubsection"],
Cell[208778, 5984, 1519, 36, 148, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210334, 6025, 158, 2, 36, "Subsubsection"],
Cell[CellGroupData[{
Cell[210517, 6031, 790, 15, 34, "Input"],
Cell[211310, 6048, 2623, 66, 97, "Output"]
}, Open  ]],
Cell[213948, 6117, 127, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[214100, 6122, 1467, 35, 103, "Input"],
Cell[215570, 6159, 1492, 38, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[217099, 6202, 385, 10, 34, "Input"],
Cell[217487, 6214, 664, 9, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[218188, 6228, 1136, 28, 98, "Input"],
Cell[219327, 6258, 765, 16, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[220129, 6279, 312, 9, 34, "Input"],
Cell[220444, 6290, 518, 7, 32, "Output"]
}, Open  ]],
Cell[220977, 6300, 518, 14, 55, "Input"],
Cell[221498, 6316, 201, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[221724, 6324, 413, 11, 34, "Input"],
Cell[222140, 6337, 592, 8, 32, "Output"]
}, Open  ]],
Cell[222747, 6348, 120, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[222892, 6353, 313, 9, 34, "Input"],
Cell[223208, 6364, 542, 8, 32, "Output"]
}, Open  ]],
Cell[223765, 6375, 120, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[223910, 6380, 315, 9, 34, "Input"],
Cell[224228, 6391, 546, 8, 32, "Output"]
}, Open  ]],
Cell[224789, 6402, 120, 1, 33, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[224946, 6408, 159, 2, 36, "Subsubsection"],
Cell[CellGroupData[{
Cell[225130, 6414, 842, 16, 34, "Input"],
Cell[225975, 6432, 1339, 30, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227351, 6467, 311, 8, 34, "Input"],
Cell[227665, 6477, 550, 8, 32, "Output"]
}, Open  ]],
Cell[228230, 6488, 120, 1, 33, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[228399, 6495, 272, 4, 45, "Subsection"],
Cell[228674, 6501, 166, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[228865, 6508, 121, 1, 35, "Subsubsection"],
Cell[228989, 6511, 1720, 42, 105, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[230746, 6558, 108, 1, 36, "Subsubsection"],
Cell[CellGroupData[{
Cell[230879, 6563, 511, 12, 34, "Input"],
Cell[231393, 6577, 2883, 77, 123, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[234313, 6659, 309, 8, 34, "Input"],
Cell[234625, 6669, 279, 4, 32, "Output"]
}, Open  ]],
Cell[234919, 6676, 120, 1, 33, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[235076, 6682, 160, 2, 36, "Subsubsection"],
Cell[CellGroupData[{
Cell[235261, 6688, 561, 12, 34, "Input"],
Cell[235825, 6702, 1256, 33, 101, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[237118, 6740, 362, 9, 34, "Input"],
Cell[237483, 6751, 280, 4, 32, "Output"]
}, Open  ]],
Cell[237778, 6758, 120, 1, 33, "Text"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[237959, 6766, 185, 2, 65, "Section"],
Cell[CellGroupData[{
Cell[238169, 6772, 100, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[238294, 6777, 666, 18, 34, "Input"],
Cell[238963, 6797, 16590, 418, 423, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[255602, 7221, 98, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[255725, 7226, 723, 19, 34, "Input"],
Cell[256451, 7247, 23036, 550, 658, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[279536, 7803, 107, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[279668, 7808, 695, 18, 34, "Input"],
Cell[280366, 7828, 79957, 2039, 3641, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[360384, 9874, 96, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[360505, 9879, 218, 3, 35, "Subsubsection"],
Cell[360726, 9884, 107, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[360858, 9889, 253, 6, 34, "Input"],
Cell[361114, 9897, 427, 8, 34, "Output"]
}, Open  ]],
Cell[361556, 9908, 115, 1, 33, "Text"],
Cell[361674, 9911, 946, 17, 388, "Input"],
Cell[362623, 9930, 120, 1, 33, "Text"],
Cell[362746, 9933, 250, 6, 34, "Input"],
Cell[362999, 9941, 105, 1, 33, "Text"],
Cell[363107, 9944, 758, 18, 80, "Input"],
Cell[363868, 9964, 110, 1, 33, "Text"],
Cell[363981, 9967, 237, 5, 34, "Input"],
Cell[364221, 9974, 99, 1, 33, "Text"],
Cell[364323, 9977, 282, 6, 166, "Input"],
Cell[364608, 9985, 128, 1, 33, "Text"],
Cell[364739, 9988, 366, 8, 34, "Input"],
Cell[365108, 9998, 164, 2, 33, "Text"],
Cell[365275, 10002, 349, 8, 34, "Input"],
Cell[365627, 10012, 250, 5, 34, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[365914, 10022, 188, 2, 36, "Subsubsection"],
Cell[366105, 10026, 107, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[366237, 10031, 301, 7, 34, "Input"],
Cell[366541, 10040, 457, 9, 34, "Output"]
}, Open  ]],
Cell[367013, 10052, 115, 1, 33, "Text"],
Cell[367131, 10055, 930, 17, 344, "Input"],
Cell[368064, 10074, 120, 1, 33, "Text"],
Cell[368187, 10077, 250, 6, 34, "Input"],
Cell[368440, 10085, 161, 2, 33, "Text"],
Cell[368604, 10089, 1997, 54, 195, "Input"],
Cell[370604, 10145, 2175, 57, 217, "Input"],
Cell[372782, 10204, 1623, 43, 149, "Input"],
Cell[374408, 10249, 724, 17, 79, "Input"],
Cell[375135, 10268, 110, 1, 33, "Text"],
Cell[375248, 10271, 237, 5, 34, "Input"],
Cell[375488, 10278, 99, 1, 33, "Text"],
Cell[375590, 10281, 776, 14, 562, "Input"],
Cell[376369, 10297, 128, 1, 33, "Text"],
Cell[376500, 10300, 446, 9, 34, "Input"],
Cell[376949, 10311, 113, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[377087, 10316, 282, 6, 32, "Input"],
Cell[377372, 10324, 302, 6, 55, "Output"]
}, Open  ]],
Cell[377689, 10333, 325, 6, 34, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[378075, 10346, 303, 7, 93, "Title"],
Cell[378381, 10355, 444, 9, 121, "Text"],
Cell[378828, 10366, 709, 19, 57, "Input"],
Cell[379540, 10387, 163, 2, 33, "Text"],
Cell[379706, 10391, 464, 11, 34, "Input"],
Cell[CellGroupData[{
Cell[380195, 10406, 266, 7, 65, "Section"],
Cell[CellGroupData[{
Cell[380486, 10417, 232, 6, 45, "Subsection"],
Cell[CellGroupData[{
Cell[380743, 10427, 96, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[380864, 10432, 185, 4, 34, "Input"],
Cell[381052, 10438, 1162, 38, 57, "Output"]
}, Open  ]],
Cell[382229, 10479, 253, 4, 49, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[382519, 10488, 95, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[382639, 10493, 184, 4, 34, "Input"],
Cell[382826, 10499, 1272, 42, 53, "Output"]
}, Open  ]],
Cell[384113, 10544, 201, 3, 49, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[384363, 10553, 240, 6, 45, "Subsection"],
Cell[CellGroupData[{
Cell[384628, 10563, 147, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[384800, 10569, 211, 5, 34, "Input"],
Cell[385014, 10576, 2554, 83, 92, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[387605, 10664, 220, 6, 34, "Input"],
Cell[387828, 10672, 338, 9, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[388203, 10686, 308, 8, 55, "Input"],
Cell[388514, 10696, 676, 22, 57, "Output"],
Cell[389193, 10720, 1564, 50, 63, "Output"]
}, Open  ]],
Cell[390772, 10773, 599, 15, 70, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[391408, 10793, 99, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[391532, 10798, 215, 5, 34, "Input"],
Cell[391750, 10805, 2951, 93, 92, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[394738, 10903, 197, 6, 34, "Input"],
Cell[394938, 10911, 313, 8, 50, "Output"]
}, Open  ]],
Cell[395266, 10922, 220, 7, 93, "Text"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[395547, 10936, 271, 7, 65, "Section"],
Cell[CellGroupData[{
Cell[395843, 10947, 208, 3, 45, "Subsection"],
Cell[CellGroupData[{
Cell[396076, 10954, 360, 10, 34, "Input"],
Cell[396439, 10966, 1372, 47, 57, "Output"]
}, Open  ]],
Cell[397826, 11016, 167, 5, 34, "Text"],
Cell[CellGroupData[{
Cell[398018, 11025, 207, 5, 34, "Input"],
Cell[398228, 11032, 1244, 40, 57, "Output"]
}, Open  ]],
Cell[399487, 11075, 263, 8, 93, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[399787, 11088, 92, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[399904, 11093, 286, 6, 32, "Input"],
Cell[400193, 11101, 4886, 138, 117, "Output"]
}, Open  ]],
Cell[405094, 11242, 167, 5, 34, "Text"],
Cell[CellGroupData[{
Cell[405286, 11251, 207, 5, 34, "Input"],
Cell[405496, 11258, 1679, 55, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[407212, 11318, 180, 4, 34, "Input"],
Cell[407395, 11324, 182, 3, 32, "Output"]
}, Open  ]],
Cell[407592, 11330, 228, 5, 33, "Text"],
Cell[CellGroupData[{
Cell[407845, 11339, 304, 8, 34, "Input"],
Cell[408152, 11349, 1507, 43, 78, "Output"]
}, Open  ]],
Cell[409674, 11395, 223, 3, 33, "Text"],
Cell[409900, 11400, 407, 9, 34, "Input"],
Cell[410310, 11411, 109, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[410444, 11416, 579, 17, 66, "Input"],
Cell[411026, 11435, 229, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[411292, 11443, 189, 4, 32, "Input"],
Cell[411484, 11449, 431, 12, 50, "Output"]
}, Open  ]],
Cell[411930, 11464, 1342, 43, 171, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[413321, 11513, 197, 6, 65, "Section"],
Cell[CellGroupData[{
Cell[413543, 11523, 138, 2, 45, "Subsection"],
Cell[CellGroupData[{
Cell[413706, 11529, 413, 11, 34, "Input"],
Cell[414122, 11542, 1307, 44, 53, "Output"]
}, Open  ]],
Cell[415444, 11589, 165, 5, 34, "Text"],
Cell[CellGroupData[{
Cell[415634, 11598, 207, 5, 34, "Input"],
Cell[415844, 11605, 2988, 97, 81, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[418869, 11707, 298, 8, 34, "Input"],
Cell[419170, 11717, 3501, 108, 163, "Output"]
}, Open  ]],
Cell[422686, 11828, 126, 1, 33, "Text"],
Cell[422815, 11831, 212, 6, 34, "Input"],
Cell[423030, 11839, 316, 9, 34, "Text"],
Cell[CellGroupData[{
Cell[423371, 11852, 252, 6, 34, "Input"],
Cell[423626, 11860, 977, 30, 82, "Output"]
}, Open  ]],
Cell[424618, 11893, 152, 2, 33, "Text"],
Cell[CellGroupData[{
Cell[424795, 11899, 185, 4, 34, "Input"],
Cell[424983, 11905, 165, 2, 32, "Output"]
}, Open  ]],
Cell[425163, 11910, 290, 6, 54, "Text"],
Cell[CellGroupData[{
Cell[425478, 11920, 308, 9, 54, "Input"],
Cell[425789, 11931, 1698, 52, 84, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[427524, 11988, 205, 4, 32, "Input"],
Cell[427732, 11994, 261, 6, 32, "Output"]
}, Open  ]],
Cell[428008, 12003, 375, 10, 64, "Text"],
Cell[428386, 12015, 1154, 32, 144, "Text"],
Cell[CellGroupData[{
Cell[429565, 12051, 97, 1, 32, "Input"],
Cell[429665, 12054, 1544, 51, 98, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[431258, 12111, 90, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[431373, 12116, 332, 6, 32, "Input"],
Cell[431708, 12124, 3420, 101, 86, "Output"]
}, Open  ]],
Cell[435143, 12228, 163, 5, 34, "Text"],
Cell[CellGroupData[{
Cell[435331, 12237, 207, 5, 34, "Input"],
Cell[435541, 12244, 4490, 133, 113, "Output"]
}, Open  ]],
Cell[440046, 12380, 268, 7, 34, "Text"],
Cell[CellGroupData[{
Cell[440339, 12391, 110, 1, 35, "Subsubsection"],
Cell[440452, 12394, 94, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[440571, 12399, 213, 5, 32, "Input"],
Cell[440787, 12406, 1079, 35, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[441903, 12446, 255, 7, 34, "Input"],
Cell[442161, 12455, 724, 20, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[442922, 12480, 254, 8, 34, "Input"],
Cell[443179, 12490, 366, 9, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[443582, 12504, 253, 7, 34, "Input"],
Cell[443838, 12513, 255, 6, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[444130, 12524, 184, 4, 34, "Input"],
Cell[444317, 12530, 451, 11, 32, "Output"]
}, Open  ]],
Cell[444783, 12544, 1650, 58, 218, "Text"],
Cell[446436, 12604, 204, 3, 49, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[446677, 12612, 163, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[446865, 12618, 298, 8, 34, "Input"],
Cell[447166, 12628, 7273, 205, 224, "Output"]
}, Open  ]],
Cell[454454, 12836, 676, 16, 117, "Text"],
Cell[CellGroupData[{
Cell[455155, 12856, 302, 7, 32, "Input"],
Cell[455460, 12865, 3295, 99, 111, "Output"]
}, Open  ]],
Cell[458770, 12967, 241, 5, 33, "Text"],
Cell[CellGroupData[{
Cell[459036, 12976, 1528, 43, 103, "Input"],
Cell[460567, 13021, 123, 2, 32, "Output"],
Cell[460693, 13025, 121, 2, 32, "Output"],
Cell[460817, 13029, 123, 2, 32, "Output"]
}, Open  ]],
Cell[460955, 13034, 114, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[461094, 13039, 282, 6, 34, "Input"],
Cell[461379, 13047, 236, 3, 32, "Output"]
}, Open  ]],
Cell[461630, 13053, 488, 13, 96, "Text"],
Cell[462121, 13068, 144, 2, 49, "Text"],
Cell[CellGroupData[{
Cell[462290, 13074, 933, 24, 79, "Input"],
Cell[463226, 13100, 1037, 24, 132, "Output"]
}, Open  ]],
Cell[464278, 13127, 251, 8, 35, "Text"],
Cell[464532, 13137, 327, 7, 34, "Input"],
Cell[464862, 13146, 234, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[465121, 13154, 763, 19, 82, "Input"],
Cell[465887, 13175, 18987, 434, 127, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[484947, 13617, 292, 7, 65, "Section"],
Cell[CellGroupData[{
Cell[485264, 13628, 185, 2, 45, "Subsection"],
Cell[CellGroupData[{
Cell[485474, 13634, 412, 11, 34, "Input"],
Cell[485889, 13647, 2847, 94, 65, "Output"]
}, Open  ]],
Cell[488751, 13744, 165, 5, 34, "Text"],
Cell[CellGroupData[{
Cell[488941, 13753, 207, 5, 34, "Input"],
Cell[489151, 13760, 2719, 84, 65, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[491907, 13849, 222, 6, 34, "Input"],
Cell[492132, 13857, 335, 9, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[492504, 13871, 183, 4, 32, "Input"],
Cell[492690, 13877, 621, 20, 52, "Output"]
}, Open  ]],
Cell[493326, 13900, 573, 15, 120, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[493936, 13920, 92, 1, 44, "Subsection"],
Cell[494031, 13923, 345, 7, 34, "Input"],
Cell[494379, 13932, 165, 5, 34, "Text"],
Cell[CellGroupData[{
Cell[494569, 13941, 207, 5, 34, "Input"],
Cell[494779, 13948, 2768, 91, 92, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[497584, 14044, 300, 8, 34, "Input"],
Cell[497887, 14054, 289, 8, 50, "Output"]
}, Open  ]],
Cell[498191, 14065, 242, 8, 34, "Text"],
Cell[498436, 14075, 398, 11, 34, "Input"],
Cell[498837, 14088, 130, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[498992, 14093, 224, 6, 34, "Input"],
Cell[499219, 14101, 972, 30, 54, "Output"]
}, Open  ]],
Cell[500206, 14134, 364, 8, 56, "Text"],
Cell[CellGroupData[{
Cell[500595, 14146, 458, 13, 79, "Input"],
Cell[501056, 14161, 992, 31, 53, "Output"],
Cell[502051, 14194, 740, 23, 60, "Output"],
Cell[502794, 14219, 364, 8, 32, "Output"]
}, Open  ]],
Cell[503173, 14230, 2247, 74, 183, "Text"],
Cell[505423, 14306, 572, 14, 49, "Text"],
Cell[CellGroupData[{
Cell[506020, 14324, 296, 10, 60, "Input"],
Cell[506319, 14336, 229, 3, 48, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

