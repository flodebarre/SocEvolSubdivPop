(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    150115,       4925]
NotebookOptionsPosition[    140870,       4617]
NotebookOutlinePosition[    141209,       4632]
CellTagsIndexPosition[    141166,       4629]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Generic", "Section",
 CellChangeTimes->{{3.699707400698104*^9, 3.699707402905987*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PtoQ", "[", "P_", "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"P", "-", 
      SuperscriptBox["p", "2"]}], 
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}]}]], "//", "FullSimplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6997074055269413`*^9, 3.699707418282507*^9}}],

Cell[CellGroupData[{

Cell["Subdivided populations", "Subsection",
 CellChangeTimes->{{3.668999943448367*^9, 3.668999951062648*^9}, {
  3.669090333143214*^9, 3.6690903447306433`*^9}, {3.6690903789232073`*^9, 
  3.6690903841955957`*^9}, {3.6702349799301558`*^9, 3.670234987354018*^9}}],

Cell[CellGroupData[{

Cell["Island model, dispersal graph", "Subsubsection",
 CellChangeTimes->{{3.6702357682102127`*^9, 3.6702357769730186`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"G12IM", "=", 
   RowBox[{"(", GridBox[{
      {
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "3"]}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nin", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ndemes", "=", "4"}], ";"}]}], "Input",
 CellChangeTimes->{{3.668999966108613*^9, 3.668999984048553*^9}, {
  3.669000027438491*^9, 3.669000197449211*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Island model, dispersal graph without self interactions", \
"Subsubsection",
 CellChangeTimes->{{3.699710891317618*^9, 3.69971090161314*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"G12IMnoself", "=", 
   RowBox[{"(", GridBox[{
      {"0", 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], "0", 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], "0", 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], "0", 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], "0", 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], "0", 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], "0", 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], "0", 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], "0", 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], "0", 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], "0", 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"]},
      {
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox["m", "9"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], 
       FractionBox[
        RowBox[{"1", "-", "m"}], "2"], "0"}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.668999966108613*^9, 3.668999984048553*^9}, {
  3.669000027438491*^9, 3.669000197449211*^9}, {3.699710904345536*^9, 
  3.699710932759603*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Island model, Interaction graph : only within demes, with self interactions\
\>", "Subsubsection",
 CellChangeTimes->{{3.6702357682102127`*^9, 3.670235798983179*^9}, {
  3.6793921183521442`*^9, 3.679392124586197*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GEIM", "=", 
   RowBox[{"(", GridBox[{
      {
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
      {
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
      {
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"]},
      {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"]},
      {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
       FractionBox["1", "3"], 
       FractionBox["1", "3"], 
       FractionBox["1", "3"]}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.669006462140751*^9, 3.6690065637333603`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GEIMnoself", "=", 
   RowBox[{"(", GridBox[{
      {"0", 
       FractionBox["1", "2"], 
       FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
      {
       FractionBox["1", "2"], "0", 
       FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", "0", "0", "0"},
      {
       FractionBox["1", "2"], 
       FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", "0", "0", "0", 
       "0"},
      {"0", "0", "0", "0", 
       FractionBox["1", "2"], 
       FractionBox["1", "2"], "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", 
       FractionBox["1", "2"], "0", 
       FractionBox["1", "2"], "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", 
       FractionBox["1", "2"], 
       FractionBox["1", "2"], "0", "0", "0", "0", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", "0", 
       FractionBox["1", "2"], 
       FractionBox["1", "2"], "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", 
       FractionBox["1", "2"], "0", 
       FractionBox["1", "2"], "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", 
       FractionBox["1", "2"], 
       FractionBox["1", "2"], "0", "0", "0", "0"},
      {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
       FractionBox["1", "2"], 
       FractionBox["1", "2"]},
      {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
       FractionBox["1", "2"], "0", 
       FractionBox["1", "2"]},
      {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
       FractionBox["1", "2"], 
       FractionBox["1", "2"], "0"}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.679392136687027*^9, 3.679392176855454*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moran", "Section",
 CellChangeTimes->{{3.699707345527932*^9, 3.699707348878216*^9}}],

Cell[CellGroupData[{

Cell["Previous results", "Subsection",
 CellChangeTimes->{{3.699707476217271*^9, 3.6997074792828503`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PinM", "=", 
   FractionBox[
    RowBox[{"p", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"n", " ", "p"}]}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
       RowBox[{"m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"n", " ", "p"}]}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}], 
      ")"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
     "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.699707431583239*^9, 3.699707448097393*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PoutM", "=", 
   FractionBox[
    RowBox[{"p", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "p", " ", "\[Mu]", 
        " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}],
        "+", 
       RowBox[{"m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "p", " ", 
           "\[Mu]"}]}], ")"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
     "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.69970744016848*^9, 3.699707446737241*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"QinM", "=", 
   RowBox[{
    RowBox[{"PtoQ", "[", "PinM", "]"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QoutM", "=", 
   RowBox[{
    RowBox[{"PtoQ", "[", "PoutM", "]"}], "//", "FullSimplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.699707453085848*^9, 3.6997074718086863`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["New stuff", "Subsection",
 CellChangeTimes->{{3.699707491660097*^9, 3.699707495419426*^9}}],

Cell[CellGroupData[{

Cell["Generic", "Subsubsection",
 CellChangeTimes->{{3.699707497377432*^9, 3.699707499684057*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"noselfreplacement", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dself", "\[Rule]", "0"}], ",", 
     RowBox[{"din", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "m"}], 
       RowBox[{"n", "-", "1"}]]}], ",", 
     RowBox[{"dout", "\[Rule]", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"d", " ", "n"}], " ", "-", " ", "n"}]]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"withselfreplacement", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dself", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "m"}], "n"]}], ",", 
     RowBox[{"din", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "m"}], "n"]}], ",", 
     RowBox[{"dout", "\[Rule]", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"d", " ", "n"}], " ", "-", " ", "n"}]]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6997075039255657`*^9, 3.699707552648037*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QselfM2", "=", 
  RowBox[{
   FractionBox[
    RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
    RowBox[{"n", " ", "d"}]], 
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", "\[Mu]"], " ", "+", " ", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}]}], "+", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", "m", "-", 
           FractionBox["m", 
            RowBox[{"d", "-", "1"}]]}], ")"}]}]}]], 
      RowBox[{"(", 
       RowBox[{"d", "-", "1"}], ")"}]}], "+", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
      RowBox[{"(", 
       RowBox[{"d", "-", "1"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.699707557939262*^9, 3.69970763486366*^9}, {
  3.6997106026698093`*^9, 3.6997106056848392`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[Lambda]", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "din"}], "+", "dself"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Mu]"}], ")"}]}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "din"}], "+", "dself"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Mu]"}], ")"}]}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "m", "-", 
          FractionBox["m", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}]]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Mu]"}], ")"}]}]}]], "+", 
     FractionBox["1", "\[Mu]"]}], ")"}], " ", "\[Mu]"}], 
  RowBox[{"d", " ", "n"}]]], "Output",
 CellChangeTimes->{3.69970764026941*^9, 3.699710621307968*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"QinM2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "\[Mu]"], " ", "+", " ", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "m", "-", 
            FractionBox["m", 
             RowBox[{"d", "-", "1"}]]}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QoutM2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "\[Mu]"], " ", "+", " ", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "m", "-", 
            FractionBox["m", 
             RowBox[{"d", "-", "1"}]]}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}], "+", 
      FractionBox["1", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"dself", "-", "din"}], ")"}]}]}]]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.699707683180396*^9, 3.699707713960421*^9}, {
  3.699710614334208*^9, 3.699710618463037*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"the\[Lambda]M", "=", 
  RowBox[{
   RowBox[{"\[Lambda]", "/.", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"QselfM2", "\[Equal]", "1"}], ",", "\[Lambda]"}], "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699707717272316*^9, 3.699707738311771*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"n", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "din", "+", 
      RowBox[{"dself", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
      RowBox[{"din", " ", "\[Mu]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "d"}], " ", "m"}], "+", "\[Mu]", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "din", "-", "dself", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "din"}], "+", "dself", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
        "\[Mu]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "dself", "+", 
       RowBox[{"din", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"dself", "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.69970772408389*^9, 3.699707738698215*^9}, 
   3.699710621593836*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QinM3", "=", 
  RowBox[{
   RowBox[{"QinM2", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", " ", "the\[Lambda]M"}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"QoutM3", "=", 
  RowBox[{
   RowBox[{"QoutM2", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", " ", "the\[Lambda]M"}]}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.6997077421873693`*^9, 3.699707784984331*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "din", "-", "dself"}], ")"}], " ", "\[Mu]"}], "+", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "din", "-", "dself", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d", "+", "din", "-", "dself"}], ")"}], " ", "\[Mu]"}]}], 
        ")"}]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "din", "-", "dself", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "din"}], "+", "dself", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
        "\[Mu]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "dself", "+", 
       RowBox[{"din", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"dself", "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.6997077647180653`*^9, 3.6997077855738363`*^9}, 
   3.699710621747601*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "din", "+", 
      RowBox[{"dself", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
      RowBox[{"din", " ", "\[Mu]"}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "din", "-", "dself", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "din"}], "+", "dself", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
        "\[Mu]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "dself", "+", 
       RowBox[{"din", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"dself", "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.6997077647180653`*^9, 3.6997077855738363`*^9}, 
   3.6997106218486977`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["With self replacement", "Subsubsection",
 CellChangeTimes->{{3.699707797145195*^9, 3.699707800750886*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QinMs", "=", 
  RowBox[{
   RowBox[{"QinM3", "/.", "withselfreplacement"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"QoutMs", "=", 
  RowBox[{
   RowBox[{"QoutM3", "/.", "withselfreplacement"}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.699707806640571*^9, 3.699707829687098*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Mu]", "-", 
      RowBox[{"d", " ", "\[Mu]"}], "+", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}]}], ")"}]}], 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
    "+", 
    RowBox[{"m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
      ")"}]}]}]]}]], "Output",
 CellChangeTimes->{{3.699707822487941*^9, 3.6997078300797243`*^9}, 
   3.699710623036839*^9, 3.699711328310384*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.699707822487941*^9, 3.6997078300797243`*^9}, 
   3.699710623036839*^9, 3.6997113283129663`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QinMs", "-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", "\[Mu]", 
        RowBox[{"(", 
         RowBox[{"1", "-", "m"}], ")"}]}], "-", "\[Mu]", "+", "m"}], " ", 
      ")"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d", "-", "1"}], ")"}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}]]}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6997113031664057`*^9, 3.699711312567246*^9}, {
  3.699711368217142*^9, 3.69971148194987*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699711306964435*^9, 3.699711330449128*^9}, {
  3.699711405295108*^9, 3.699711501403634*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QoutMs", "-", 
   FractionBox[
    RowBox[{"m", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Mu]"}], ")"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d", "-", "1"}], ")"}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}]]}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.69971150684383*^9, 3.699711545927258*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699711511809864*^9, 3.699711546280471*^9}}]
}, Open  ]],

Cell["Check that this is the same as previously", "Text",
 CellChangeTimes->{{3.6997106515492773`*^9, 3.699710655871216*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QinMs", "-", "QinM"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699710636543291*^9, 3.699710639824566*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.6997106401846457`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QoutMs", "-", "QoutM"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699710636543291*^9, 3.699710647275017*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.699710647693612*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QoutMs", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699708994901635*^9, 3.699709018760296*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6997090038532143`*^9, 3.699709012966531*^9}, 
   3.699710624218858*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QinMs", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.699709024470386*^9, 3.699709032489929*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "1"}], "+", "m", "+", "\[Mu]", "-", 
   RowBox[{"m", " ", "\[Mu]"}]}], 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
   RowBox[{"n", " ", "\[Mu]"}]}]]], "Output",
 CellChangeTimes->{{3.6997090210092278`*^9, 3.69970903277978*^9}, 
   3.69971062653979*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "-", "m"}], 
  RowBox[{"1", "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.6997090210092278`*^9, 3.69970903277978*^9}, 
   3.699710626541431*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QinMs", ",", 
    RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699709434403644*^9, 3.6997094359320993`*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.6997094362553997`*^9, 3.69971062819491*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{"QinMs", ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.699709522250888*^9, 3.6997095278721046`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "-", 
   RowBox[{"d", " ", "n", " ", "\[Mu]"}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
    SeriesData[$CellContext`\[Mu], 0, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Mu], 0, {1, -$CellContext`d $CellContext`n}, 0, 2,
    1],
  Editable->False]], "Output",
 CellChangeTimes->{3.699709528137528*^9, 3.699710628816844*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{"QinM", ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{3.699709551291127*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "-", 
   RowBox[{"d", " ", "n", " ", "\[Mu]"}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
    SeriesData[$CellContext`\[Mu], 0, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Mu], 0, {1, -$CellContext`d $CellContext`n}, 0, 2,
    1],
  Editable->False]], "Output",
 CellChangeTimes->{3.699709551667964*^9, 3.699710629746097*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Without Self - replacement", "Subsubsection",
 CellChangeTimes->{{3.699711579833871*^9, 3.699711584927043*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QinMw", "=", 
  RowBox[{
   RowBox[{"QinM3", "/.", "noselfreplacement"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"QoutMw", "=", 
  RowBox[{
   RowBox[{"QoutM3", "/.", "noselfreplacement"}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.699711592836095*^9, 3.699711601325761*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["m", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]"}], "+", 
     
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{"n", "-", 
        RowBox[{"d", " ", "n", " ", "\[Mu]"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["m", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   RowBox[{"m", " ", "n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{3.6997116019468412`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{"n", "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", "\[Mu]"}], ")"}], 
   " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["m", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   RowBox[{"m", " ", "n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{3.6997116019739513`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QinMw", "-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", "n", " ", "\[Mu]", 
        RowBox[{"(", 
         RowBox[{"1", "-", "m"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"m", "-", "\[Mu]"}], ")"}], " ", "n"}], "-", 
       RowBox[{
        SuperscriptBox["m", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Mu]"}], ")"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"+", 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}], " ", "n", " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "2"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
     RowBox[{"m", " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"n", "-", "2"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["m", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]}]]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699711609067724*^9, 3.699711686309361*^9}, {
  3.699711723919117*^9, 3.699711751542611*^9}, {3.699711797895731*^9, 
  3.699711864734956*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.699711686662211*^9, 3.699711751870494*^9, {3.699711816592347*^9, 
   3.699711865845346*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QoutMw", "-", 
   FractionBox[
    RowBox[{"m", " ", 
     RowBox[{"(", 
      RowBox[{"n", "+", 
       RowBox[{"m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", "\[Mu]"}], ")"}], 
     " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Mu]"}], ")"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"+", 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}], " ", "n", " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "2"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
     RowBox[{"m", " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{"n", "-", "2"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["m", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]}]]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699711882991263*^9, 3.6997119306666183`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699711887715342*^9, 3.699711931186315*^9}, 
   3.6997119658647413`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QinMw", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699712140320222*^9, 3.699712144381168*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "1"}], "+", "m", "+", "\[Mu]", "-", 
   RowBox[{"m", " ", "\[Mu]"}]}], 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}]]], "Output",
 CellChangeTimes->{{3.699712141760172*^9, 3.6997121446551123`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{"QoutMw", ",", 
   RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.699712130826983*^9, 3.699712135993896*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.699712136340899*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerical version", "Subsection",
 CellChangeTimes->{{3.699709707187845*^9, 3.699709711187148*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NGetQM", "[", 
   RowBox[{"G_", ",", "\[CapitalNu]_", ",", "n_", ",", "p_", ",", "\[Mu]_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"QT", ",", "eqs", ",", "vars", ",", "sols", ",", "QTs"}], "}"}], 
    ",", 
    RowBox[{"(*", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", " ", "is", " ", "the", " ", "dispersal", " ", "graph"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
      "\[CapitalNu]", " ", "is", " ", "the", " ", "size", " ", "of", " ", 
       "the", " ", "population"}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "n", " ", "is", " ", "the", " ", "degree", " ", "of", " ", "the", " ", 
       "graph"}], ",", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "is", " ", "the", " ", "mutation", " ", "biais"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]", " ", "is", " ", "the", " ", "mutation", " ", 
       RowBox[{"probability", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Initialize", " ", "the", " ", "PT", " ", "matrix"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], "=", "0"}], ";", 
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], "=."}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"QT", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        SubscriptBox["Q", 
         RowBox[{"i", ",", "j"}]], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QT", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], "=", "1"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       SubscriptBox["Q", 
        RowBox[{"i", ",", "i"}]], "=", " ", "1"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QT", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
        SubscriptBox["Q", 
         RowBox[{"j", ",", "i"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"j", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Because", " ", "Q", " ", "is", " ", "symmetric"}], " ", "*)"}],
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["Q", 
           RowBox[{"i", ",", "j"}]], "\[Equal]", 
          RowBox[{
           FractionBox[
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Mu]"}], ")"}], 
            RowBox[{"2", " ", "n"}]], 
           RowBox[{"(", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"G", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "j"}], "\[RightDoubleBracket]"}], 
                RowBox[{"QT", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "i"}], "\[RightDoubleBracket]"}]}], "+", 
               RowBox[{
                RowBox[{"G", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "i"}], "\[RightDoubleBracket]"}], 
                RowBox[{"QT", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "j"}], "\[RightDoubleBracket]"}]}]}], ",", 
              
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
            ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sols", "=", 
      RowBox[{"NSolve", "[", 
       RowBox[{"eqs", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"QTs", "=", 
      RowBox[{"QT", "/.", 
       RowBox[{
       "sols", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", "QTs"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.665746344148189*^9, 3.665746357499515*^9}, {
  3.667629110150731*^9, 3.667629117546748*^9}, {3.667629254770275*^9, 
  3.667629258225225*^9}, {3.667630603278612*^9, 3.667630605327855*^9}, {
  3.6676306528447523`*^9, 3.6676306545659657`*^9}, {3.69970971562999*^9, 
  3.6997097787966833`*^9}, {3.699709809338958*^9, 3.6997098138847713`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.699707489692213*^9, 3.6997074897492332`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"them", "=", "0.3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"thep", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"the\[Mu]", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"prms", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"d", "\[Rule]", "4"}], ",", 
    RowBox[{"n", "\[Rule]", "3"}], ",", 
    RowBox[{"p", "\[Rule]", "thep"}], ",", 
    RowBox[{"\[Mu]", "\[Rule]", "the\[Mu]"}], ",", 
    RowBox[{"m", "\[Rule]", "them"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q12M", "=", 
   RowBox[{"NGetQM", "[", 
    RowBox[{
     RowBox[{"G12IM", "/.", 
      RowBox[{"m", "\[Rule]", "them"}]}], ",", "12", ",", "1", ",", "thep", 
     ",", "the\[Mu]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Q12inM", "=", 
  RowBox[{"Q12M", "\[LeftDoubleBracket]", 
   RowBox[{"1", ",", "2"}], 
   "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QinM3", "/.", "withselfreplacement"}], "/.", 
  "prms"}], "\[IndentingNewLine]", 
 RowBox[{"QinM", "/.", "prms"}]}], "Input",
 CellChangeTimes->{{3.699709863130365*^9, 3.699709902352488*^9}, {
  3.699709935026679*^9, 3.699710076151829*^9}, {3.699710952534171*^9, 
  3.6997109529524317`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"d", "\[Rule]", "4"}], ",", 
   RowBox[{"n", "\[Rule]", "3"}], ",", 
   RowBox[{"p", "\[Rule]", "0.2`"}], ",", 
   RowBox[{"\[Mu]", "\[Rule]", "0.1`"}], ",", 
   RowBox[{"m", "\[Rule]", "0.3`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.699710014756632*^9, 3.6997100201625223`*^9}, {
   3.6997100524247713`*^9, 3.699710076554229*^9}, 3.69971095384976*^9}],

Cell[BoxData["0.5106382978723403`"], "Output",
 CellChangeTimes->{{3.699710014756632*^9, 3.6997100201625223`*^9}, {
   3.6997100524247713`*^9, 3.699710076554229*^9}, 3.6997109538713093`*^9}],

Cell[BoxData["0.5106382978723405`"], "Output",
 CellChangeTimes->{{3.699710014756632*^9, 3.6997100201625223`*^9}, {
   3.6997100524247713`*^9, 3.699710076554229*^9}, 3.699710953872892*^9}],

Cell[BoxData["0.5106382978723405`"], "Output",
 CellChangeTimes->{{3.699710014756632*^9, 3.6997100201625223`*^9}, {
   3.6997100524247713`*^9, 3.699710076554229*^9}, 3.699710953874076*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q12Mns", "=", 
   RowBox[{"NGetQM", "[", 
    RowBox[{
     RowBox[{"G12IMnoself", "/.", 
      RowBox[{"m", "\[Rule]", "them"}]}], ",", "12", ",", "1", ",", "thep", 
     ",", "the\[Mu]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Q12inMns", "=", 
  RowBox[{"Q12Mns", "\[LeftDoubleBracket]", 
   RowBox[{"1", ",", "2"}], 
   "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QinM3", "/.", "noselfreplacement"}], "/.", "prms"}]}], "Input",
 CellChangeTimes->{{3.699710966632681*^9, 3.6997109821283484`*^9}}],

Cell[BoxData["0.5963141728828432`"], "Output",
 CellChangeTimes->{3.69971098261451*^9}],

Cell[BoxData["0.5963141728828435`"], "Output",
 CellChangeTimes->{3.6997109826162443`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Delta", "[", "x_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"x", "\[Equal]", "0"}], ",", "1", ",", "0"}], "]"}]}]], "Input"],

Cell["Formula", "Text",
 CellChangeTimes->{{3.66909044558764*^9, 3.669090448806027*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PIM", "[", 
   RowBox[{"r1_", ",", "r2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["CC", 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "\[Mu]"], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "m", "-", 
            FractionBox["m", 
             RowBox[{"d", "-", "1"}]]}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Delta", "[", "r2", "]"}], "d"}], "-", "1"}], ")"}]}], "+", 
      
      RowBox[{
       RowBox[{"Delta", "[", "r2", "]"}], "d", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Delta", "[", "r1", "]"}], "n"}], "-", "1"}], ")"}]}]}], 
     ")"}]}], "+", 
   SuperscriptBox["p", "2"]}]}]], "Input",
 CellChangeTimes->{{3.668998515980857*^9, 3.668998612353025*^9}, {
   3.668998700641614*^9, 3.668998703464724*^9}, 3.668999011355136*^9}],

Cell["Find the constant term", "Text",
 CellChangeTimes->{{3.668999868188258*^9, 3.668999872252976*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solCC", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"PIM", "[", 
       RowBox[{"0", ",", "0"}], "]"}], "\[Equal]", "p"}], ",", "CC"}], "]"}], 
   "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.668998614920752*^9, 3.668998628272805*^9}, {
  3.6689987116668997`*^9, 3.6689987160583563`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"CC", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "d"}], " ", "m"}], "+", "\[Mu]", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
      
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}],
        "+", 
       RowBox[{"m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
         ")"}]}]}]]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.668998617190145*^9, 3.668998619755321*^9}, 
   3.668998716648732*^9, 3.668999018185816*^9, 3.669030137415769*^9, 
   3.669111530218768*^9, 3.669557858841135*^9, 3.6695623937620564`*^9, 
   3.669723661690803*^9, 3.670240163921278*^9, 3.670310041945553*^9, 
   3.67031894465689*^9, 3.6739641932458467`*^9, 3.6766971901224537`*^9, 
   3.67800615149545*^9, 3.67851170423204*^9, 3.6785209976638002`*^9, 
   3.679036300589634*^9, 3.6791426837986183`*^9, 3.6791961201747713`*^9, 
   3.6791961520649652`*^9, 3.679397534429119*^9, 3.679400653206706*^9, 
   3.679636666736599*^9, 3.679654001167485*^9, 3.679891741228135*^9, 
   3.699707374159047*^9}]
}, Open  ]],

Cell["Formula with explicit constant term", "Text",
 CellChangeTimes->{{3.669090454337757*^9, 3.669090464364923*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PPIM", "[", 
   RowBox[{"r1_", ",", "r2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"PIM", "[", 
    RowBox[{"r1", ",", "r2"}], "]"}], "/.", 
   RowBox[{
   "solCC", "\[LeftDoubleBracket]", "1", 
    "\[RightDoubleBracket]"}]}]}]], "Input",
 CellChangeTimes->{{3.668998728377359*^9, 3.66899874667542*^9}}],

Cell["Define Pin and Pout", "Text",
 CellChangeTimes->{{3.669090470381428*^9, 3.669090477716969*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"PPIM", "[", 
   RowBox[{"0", ",", "0"}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"PinM", "=", 
  RowBox[{
   RowBox[{"PPIM", "[", 
    RowBox[{"2", ",", "0"}], "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"PoutM", "=", 
  RowBox[{
   RowBox[{"PPIM", "[", 
    RowBox[{"2", ",", "1"}], "]"}], "//", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.668998751104868*^9, 3.668998786789109*^9}, {
  3.668999042576312*^9, 3.668999047138834*^9}, {3.66899989338525*^9, 
  3.6689998946412086`*^9}}],

Cell[BoxData["p"], "Output",
 CellChangeTimes->{{3.6689987549407043`*^9, 3.668998787141518*^9}, {
   3.668999020361058*^9, 3.6689990478821077`*^9}, 3.668999896127304*^9, 
   3.6690301374672327`*^9, 3.669111530298719*^9, 3.6695578588928337`*^9, 
   3.669562393855172*^9, 3.6697236617965193`*^9, 3.6702401639938393`*^9, 
   3.670310042057867*^9, 3.6703189447068777`*^9, 3.6739641933142347`*^9, 
   3.676697190721612*^9, 3.678006151552297*^9, 3.678511704281946*^9, 
   3.678520997720108*^9, 3.679036300654037*^9, 3.67914268385251*^9, 
   3.6791961202154016`*^9, 3.679196152106144*^9, 3.679397537569604*^9, 
   3.679400653267861*^9, 3.679636666776816*^9, 3.679654001211866*^9, 
   3.679891741297748*^9, 3.699707377164094*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"n", " ", "p"}]}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"n", " ", "p"}]}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}], 
    ")"}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.6689987549407043`*^9, 3.668998787141518*^9}, {
   3.668999020361058*^9, 3.6689990478821077`*^9}, 3.668999896127304*^9, 
   3.6690301374672327`*^9, 3.669111530298719*^9, 3.6695578588928337`*^9, 
   3.669562393855172*^9, 3.6697236617965193`*^9, 3.6702401639938393`*^9, 
   3.670310042057867*^9, 3.6703189447068777`*^9, 3.6739641933142347`*^9, 
   3.676697190721612*^9, 3.678006151552297*^9, 3.678511704281946*^9, 
   3.678520997720108*^9, 3.679036300654037*^9, 3.67914268385251*^9, 
   3.6791961202154016`*^9, 3.679196152106144*^9, 3.679397537569604*^9, 
   3.679400653267861*^9, 3.679636666776816*^9, 3.679654001211866*^9, 
   3.679891741297748*^9, 3.6997073772671213`*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "p", " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
     "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "p", " ", "\[Mu]"}]}], 
       ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.6689987549407043`*^9, 3.668998787141518*^9}, {
   3.668999020361058*^9, 3.6689990478821077`*^9}, 3.668999896127304*^9, 
   3.6690301374672327`*^9, 3.669111530298719*^9, 3.6695578588928337`*^9, 
   3.669562393855172*^9, 3.6697236617965193`*^9, 3.6702401639938393`*^9, 
   3.670310042057867*^9, 3.6703189447068777`*^9, 3.6739641933142347`*^9, 
   3.676697190721612*^9, 3.678006151552297*^9, 3.678511704281946*^9, 
   3.678520997720108*^9, 3.679036300654037*^9, 3.67914268385251*^9, 
   3.6791961202154016`*^9, 3.679196152106144*^9, 3.679397537569604*^9, 
   3.679400653267861*^9, 3.679636666776816*^9, 3.679654001211866*^9, 
   3.679891741297748*^9, 3.699707377321484*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "+", 
   RowBox[{"(", 
    RowBox[{"n", "-", "2"}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{"n", "-", "1"}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{"n", "-", "2"}], ")"}], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"n", "-", "2"}], ")"}], "2"], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"NN", "-", "n"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"n", "-", "1"}], ")"}]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.698743953753397*^9, 3.698743977663515*^9}, 
   3.698744138942225*^9, {3.698748672879407*^9, 3.6987486764369583`*^9}, 
   3.698748758344095*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "NN"}]], "Output",
 CellChangeTimes->{{3.698743972095105*^9, 3.698743978048662*^9}, {
   3.698744139134427*^9, 3.698744142127646*^9}, 3.698748676972443*^9, 
   3.698748758567506*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"n", 
    RowBox[{"(", 
     RowBox[{"n", "-", "1"}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"NN", "-", "n"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"n", "-", "1"}], ")"}]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6987440710273314`*^9, 3.698744082319943*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "NN"}]], "Output",
 CellChangeTimes->{3.698744082827035*^9, 3.698744139934454*^9, 
  3.698748678603231*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"NN", "-", "n"}], ")"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"NN", "-", "n"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"n", "-", "1"}], ")"}]}], "+", 
   RowBox[{"(", 
    RowBox[{"NN", "-", "n"}], ")"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"NN", "-", "n"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"n", "-", "1"}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"NN", "-", "n"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"NN", "-", 
      RowBox[{"2", "n"}]}], ")"}]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6987526064786797`*^9, 3.698752642624421*^9}}],

Cell[BoxData[
 RowBox[{"NN", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "n"}], "+", "NN"}], ")"}]}]], "Output",
 CellChangeTimes->{{3.698752637876206*^9, 3.698752643051927*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "+", 
   RowBox[{"2", 
    RowBox[{"(", 
     RowBox[{"n", "-", "2"}], ")"}]}], "+", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["n", "2"], "-", 
     RowBox[{"3", "n"}], "+", "3"}], ")"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"NN", "-", "n"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"n", "-", "1"}], ")"}]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6987529213456173`*^9, 3.698752951178521*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "NN"}]], "Output",
 CellChangeTimes->{3.698752951579734*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"2", 
    RowBox[{"(", 
     RowBox[{"n", "-", "1"}], ")"}]}], "+", 
   RowBox[{"2", 
    RowBox[{"(", 
     RowBox[{"n", "-", "1"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"n", "-", "1"}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"NN", "-", 
      RowBox[{"2", "n"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"n", "-", "1"}], ")"}]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.698753984265971*^9, 3.698754001076537*^9}, 
   3.6987540863293343`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "NN"}]], "Output",
 CellChangeTimes->{3.698754001577889*^9, 3.6987540866158533`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "+", 
   RowBox[{"(", 
    RowBox[{"n", "-", "1"}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{"NN", "-", 
     RowBox[{"2", "n"}]}], ")"}], "+", 
   RowBox[{"(", 
    RowBox[{"n", "-", "1"}], ")"}], "+", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"n", "-", "1"}], ")"}], "2"], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"n", "-", "1"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"NN", "-", 
      RowBox[{"2", "n"}]}], ")"}]}], "+", 
   RowBox[{"(", 
    RowBox[{"NN", "-", "n"}], ")"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"NN", "-", "n"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"n", "-", "1"}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"NN", "-", "n"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"NN", "-", 
      RowBox[{"2", "n"}]}], ")"}]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6987545573430977`*^9, 3.69875460592268*^9}}],

Cell[BoxData[
 RowBox[{"NN", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "n"}], "+", "NN"}], ")"}]}]], "Output",
 CellChangeTimes->{3.698754606452076*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.698752630160479*^9, 3.698752631336817*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wright - Fisher", "Section",
 CellChangeTimes->{{3.698755041677388*^9, 3.698755047045236*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eQinWF", "=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "din", " ", "dself"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "2"}], ")"}], " ", 
        SuperscriptBox["din", "2"]}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[CapitalNu]", "-", "n"}], ")"}], " ", 
        SuperscriptBox["dout", "2"]}]}], ")"}], "+", 
     RowBox[{"(*", "\[IndentingNewLine]", "*)"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["dself", "2"], "+", 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{"n", "-", "2"}], ")"}], " ", "dself", " ", "din"}], " ", 
        "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["n", "2"], "-", 
           RowBox[{"3", "n"}], "+", "3"}], ")"}], " ", 
         SuperscriptBox["din", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[CapitalNu]", "-", "n"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], 
         SuperscriptBox["dout", "2"]}]}], ")"}], "Qin"}], "+", 
     RowBox[{"(*", "\[IndentingNewLine]", "*)"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[CapitalNu]", "-", "n"}], ")"}], "dout", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "dself"}], " ", "+", " ", 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], " ", "din"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[CapitalNu]", "-", 
           RowBox[{"2", "n"}]}], ")"}], " ", "dout"}]}], ")"}], "Qout"}]}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.698755051308588*^9, 3.698755185411098*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "din", " ", "dself"}], "+", 
    RowBox[{
     SuperscriptBox["din", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "n"}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["dout", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "n"}], "+", "\[CapitalNu]"}], ")"}]}], "+", 
    RowBox[{"dout", " ", "Qout", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "n"}], "+", "\[CapitalNu]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "dself"}], "+", 
       RowBox[{"2", " ", "din", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
       RowBox[{"dout", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "n"}], "+", "\[CapitalNu]"}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{"Qin", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["dself", "2"], "+", 
       RowBox[{"2", " ", "din", " ", "dself", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "n"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["din", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{"3", " ", "n"}], "+", 
          SuperscriptBox["n", "2"]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["dout", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "n"}], "+", "\[CapitalNu]"}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.698755188454566*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eQoutWF", "=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "dself", " ", "dout"}], " ", "+", " ", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "din", " ", "dout"}], " ", "+", " ", 
       
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[CapitalNu]", "-", 
          RowBox[{"2", "n"}]}], ")"}], 
        SuperscriptBox["dout", "2"]}]}], ")"}], "+", 
     RowBox[{"(*", "\[IndentingNewLine]", "*)"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], " ", "dself", " ", "dout"}], " ", 
        "+", " ", 
        RowBox[{"2", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "2"], "din", " ", "dout"}], " ", 
        "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[CapitalNu]", "-", 
           RowBox[{"2", "n"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], 
         SuperscriptBox["dout", "2"]}]}], ")"}], "Qin"}], "+", 
     RowBox[{"(*", "\[IndentingNewLine]", "*)"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["dself", "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], "dself", " ", "din"}], " ", "+", 
        " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[CapitalNu]", "-", 
           RowBox[{"2", "n"}]}], ")"}], "dself", " ", "dout"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], "din", 
         RowBox[{"(", 
          RowBox[{"dself", " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}], "din"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[CapitalNu]", "-", 
              RowBox[{"2", "n"}]}], ")"}], "dout"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[CapitalNu]", "-", "n"}], ")"}], "dout", 
         RowBox[{"(", 
          RowBox[{"dself", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}], "din"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[CapitalNu]", "-", 
              RowBox[{"2", "n"}]}], ")"}], "dout"}]}], ")"}]}]}], ")"}], 
      "Qout"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.698755193348115*^9, 3.6987553463232613`*^9}, {
  3.6987554879948587`*^9, 3.6987554884111757`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "dout", " ", "dself"}], "+", 
    RowBox[{"2", " ", "din", " ", "dout", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["dout", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "n"}], "+", "\[CapitalNu]"}], ")"}]}], "+", 
    RowBox[{"Qin", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "dout", " ", "dself", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
       RowBox[{"2", " ", "din", " ", "dout", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox["dout", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "n"}], "+", "\[CapitalNu]"}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{"Qout", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["dself", "2"], "+", 
       RowBox[{"din", " ", "dself", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
       RowBox[{"dout", " ", "dself", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "n"}], "+", "\[CapitalNu]"}], ")"}]}], 
       "+", 
       RowBox[{"din", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"dself", "+", 
          RowBox[{"din", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
          RowBox[{"dout", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "n"}], "+", "\[CapitalNu]"}], 
            ")"}]}]}], ")"}]}], "+", 
       RowBox[{"dout", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "n"}], "+", "\[CapitalNu]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"dself", "+", 
          RowBox[{"din", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
          RowBox[{"dout", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "n"}], "+", "\[CapitalNu]"}], 
            ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.698755353263668*^9, 3.698755492527285*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sols", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Qin", "\[Equal]", "eQinWF"}], ",", " ", 
         RowBox[{"Qout", "\[Equal]", "eQoutWF"}]}], "}"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"dself", "\[Rule]", 
          FractionBox[
           RowBox[{"1", "-", "m"}], "n"]}], ",", 
         RowBox[{"din", "\[Rule]", 
          FractionBox[
           RowBox[{"1", "-", "m"}], "n"]}], ",", " ", 
         RowBox[{"dout", "\[Rule]", 
          FractionBox["m", 
           RowBox[{"\[CapitalNu]", "-", "n"}]]}]}], "}"}]}], "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", 
       RowBox[{"n", " ", "d"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"Qin", ",", "Qout"}], "}"}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.69875535996423*^9, 3.698755431691368*^9}, {
  3.6987554999604397`*^9, 3.698755500925955*^9}, {3.6987558404733562`*^9, 
  3.698755850078169*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Qin", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "3"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "d", " ", 
             SuperscriptBox["m", "3"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["m", "4"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}], ")"}], "3"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
             SuperscriptBox["m", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}],
               ")"}]}], "+", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", "m", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"2", " ", "d"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}],
               ")"}]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"d", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
           
           SuperscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "4"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"m", " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
            ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "m", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}], 
             "+", 
             RowBox[{"d", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "-", 
                RowBox[{"2", " ", "m", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
                RowBox[{
                 SuperscriptBox["m", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", 
                 "\[Mu]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], ",", 
    RowBox[{"Qout", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "m"}], ")"}]}]}], ")"}], " ", "m", " ", 
        
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "d", " ", 
         SuperscriptBox["m", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "4"]}], "+", 
        RowBox[{
         SuperscriptBox["d", "2"], " ", 
         SuperscriptBox["m", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "4"]}], "-", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
         SuperscriptBox["m", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
          ")"}]}], "-", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
          ")"}]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", "m", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"2", " ", "d"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
          ")"}]}]}], ")"}]}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.69875542080507*^9, 3.698755438178865*^9}, {
   3.69875549505556*^9, 3.6987555018348503`*^9}, 3.698755863763846*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sols", "/.", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6987555030723124`*^9, 3.698755516485056*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Qin", "\[Rule]", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"n", "-", "\[CapitalNu]"}], ")"}], "2"], "+", 
       RowBox[{"2", " ", "m", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"n", "-", "\[CapitalNu]"}], ")"}], "2"]}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["m", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"n", "-", "\[CapitalNu]"}], ")"}], " ", "\[CapitalNu]"}], 
       "+", 
       RowBox[{
        SuperscriptBox["m", "3"], " ", 
        SuperscriptBox["\[CapitalNu]", "2"]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "m"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "n"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "\[CapitalNu]"}]}], 
          ")"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "\[CapitalNu]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "m", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", "n"}], 
          "-", "\[CapitalNu]", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[CapitalNu]"}]}], 
         ")"}]}]}]]}], ",", 
    RowBox[{"Qout", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "\[CapitalNu]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "n"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "\[CapitalNu]"}]}], 
         ")"}]}], 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
         SuperscriptBox["n", "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{"m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "4"}], "+", 
              RowBox[{"3", " ", "m"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", "n", " ",
          "\[CapitalNu]"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
         SuperscriptBox["\[CapitalNu]", "2"]}]}]]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.698755513214713*^9, 3.69875551736067*^9}}]
}, Closed]],

Cell["Previous version", "Text",
 CellChangeTimes->{{3.698755690202565*^9, 3.698755693965942*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PinWF", "=", 
   RowBox[{"p", " ", 
    RowBox[{"(", 
     RowBox[{"p", "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "d"}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"d", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
              " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
          FractionBox["1", 
           RowBox[{
            RowBox[{"2", " ", "\[Mu]"}], "-", 
            SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
       RowBox[{
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"d", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"2", " ", "\[Mu]"}], "-", 
          SuperscriptBox["\[Mu]", "2"]}]]}]]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.69875569512002*^9, 3.698755708744803*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PoutWF", "=", 
   RowBox[{"p", " ", 
    RowBox[{"(", 
     RowBox[{"p", "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", 
            RowBox[{"1", "-", 
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
               " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
          FractionBox["1", 
           RowBox[{
            RowBox[{"2", " ", "\[Mu]"}], "-", 
            SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
       RowBox[{
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], 
         RowBox[{"1", "-", 
          FractionBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"d", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
        FractionBox["1", 
         RowBox[{
          RowBox[{"2", " ", "\[Mu]"}], "-", 
          SuperscriptBox["\[Mu]", "2"]}]]}]]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6987557014113092`*^9, 3.6987557070560427`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.698755704749275*^9, 3.6987557047575502`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"QinWF0", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"PinWF", "-", 
      SuperscriptBox["p", "2"]}], 
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}]}]], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QoutWF0", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"PoutWF", "-", 
      SuperscriptBox["p", "2"]}], 
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}]}]], "//", "FullSimplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.698755717808531*^9, 3.6987557206215754`*^9}, {
  3.6987557598450203`*^9, 3.698755780828889*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"QselfWF", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", " ", "-", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"dself", "-", "din"}], ")"}], "2"]}]}]], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "d"}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "m", "-", 
             FractionBox["m", 
              RowBox[{"d", "-", "1"}]]}], ")"}], "2"]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QinWF", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", " ", "-", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]], "-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"dself", "-", "din"}], ")"}], "2"]}]}]], "d"}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "m", "-", 
             FractionBox["m", 
              RowBox[{"d", "-", "1"}]]}], ")"}], "2"]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QoutWF", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", " ", "-", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]], "-", 
      FractionBox["1", 
       RowBox[{"1", "-", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "m", "-", 
            FractionBox["m", 
             RowBox[{"d", "-", "1"}]]}], ")"}], "2"]}]}]]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6997135185821047`*^9, 3.699713651029313*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Lambda]WF", "=", 
  RowBox[{"\[Lambda]", "/.", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"QselfWF", "\[Equal]", "1"}], ",", "\[Lambda]"}], "]"}], 
    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}]], "Input",
 CellChangeTimes->{{3.6997136534525347`*^9, 3.699713667340845*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"d", " ", "n"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"1", "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]], "+", 
     FractionBox[
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
      RowBox[{"1", "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "din"}], "+", "dself"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], 
      RowBox[{"1", "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "m", "-", 
           FractionBox["m", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "d"}]]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]}]]}], ")"}], " ", 
   "\[Mu]"}]]], "Output",
 CellChangeTimes->{{3.699713663992773*^9, 3.699713667644438*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QinWF2", "=", 
  RowBox[{
   RowBox[{"QinWF", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", "\[Lambda]WF"}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"QoutWF2", "=", 
  RowBox[{
   RowBox[{"QoutWF", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", "\[Lambda]WF"}]}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.699713671535714*^9, 3.699713691587577*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox["d", 
     RowBox[{"1", "-", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"din", "-", "dself"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}]}]]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
    RowBox[{"1", "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"din", "-", "dself"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.699713678348674*^9, 3.699713692055463*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
    RowBox[{"1", "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"din", "-", "dself"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.699713678348674*^9, 3.699713692326676*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["With Self Replacement", "Subsection",
 CellChangeTimes->{{3.699713697718473*^9, 3.699713702474758*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QinWFs", "=", 
  RowBox[{
   RowBox[{"QinWF2", "/.", "withselfreplacement"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699713715219798*^9, 3.699713729121462*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "d"}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.6997137205942917`*^9, 3.6997137296346273`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QinWFs", "-", "QinWF0"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6997137321950417`*^9, 3.699713746573717*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699713749692712*^9, 3.699713762515503*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QoutWFs", "=", 
  RowBox[{
   RowBox[{"QoutWF2", "/.", "withselfreplacement"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.69971376959558*^9, 3.699713781778393*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{3.699713782107119*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QoutWFs", "-", "QoutWF0"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699713783474031*^9, 3.6997137923236094`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.699713792659212*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Without Self Replacement", "Subsection",
 CellChangeTimes->{{3.699713697718473*^9, 3.699713702474758*^9}, {
  3.6997140344242887`*^9, 3.6997140345381327`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QinWFw", "=", 
  RowBox[{
   RowBox[{"QinWF2", "/.", "noselfreplacement"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699713715219798*^9, 3.699713729121462*^9}, {
  3.699714032451695*^9, 3.699714037934367*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
   FractionBox["d", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox[
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.6997137205942917`*^9, 3.6997137296346273`*^9}, 
   3.699714039975412*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QoutWFw", "=", 
  RowBox[{
   RowBox[{"QoutWF2", "/.", "noselfreplacement"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.69971376959558*^9, 3.699713781778393*^9}, {
  3.699714043938485*^9, 3.699714047373885*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox[
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{3.699713782107119*^9, 3.699714048290897*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerically", "Subsection",
 CellChangeTimes->{{3.699713892190802*^9, 3.699713895150977*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NGetQWF", "[", 
   RowBox[{"G_", ",", "\[CapitalNu]_", ",", "n_", ",", "p_", ",", "\[Mu]_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"QT", ",", "eqs", ",", "vars", ",", "sols", ",", "QTs"}], "}"}], 
    ",", 
    RowBox[{"(*", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", " ", "is", " ", "the", " ", "dispersal", " ", "graph"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
      "\[CapitalNu]", " ", "is", " ", "the", " ", "size", " ", "of", " ", 
       "the", " ", "population"}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "n", " ", "is", " ", "the", " ", "degree", " ", "of", " ", "the", " ", 
       "graph"}], ",", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "is", " ", "the", " ", "mutation", " ", "biais"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]", " ", "is", " ", "the", " ", "mutation", " ", 
       RowBox[{"probability", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Initialize", " ", "the", " ", "QT", " ", "matrix"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], "=", "0"}], ";", 
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], "=."}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"QT", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        SubscriptBox["Q", 
         RowBox[{"i", ",", "j"}]], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QT", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], "=", "1"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       SubscriptBox["Q", 
        RowBox[{"i", ",", "i"}]], "=", "1"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QT", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
        SubscriptBox["Q", 
         RowBox[{"j", ",", "i"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"j", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Because", " ", "Q", " ", "is", " ", "symmetric"}], " ", "*)"}],
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["Q", 
           RowBox[{"i", ",", "j"}]], "\[Equal]", 
          RowBox[{
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
            SuperscriptBox["n", "2"]], 
           RowBox[{"(", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"G", "\[LeftDoubleBracket]", 
                RowBox[{"l", ",", "j"}], "\[RightDoubleBracket]"}], 
               RowBox[{"G", "\[LeftDoubleBracket]", 
                RowBox[{"k", ",", "i"}], "\[RightDoubleBracket]"}], 
               RowBox[{"QT", "\[LeftDoubleBracket]", 
                RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
            ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sols", "=", 
      RowBox[{"NSolve", "[", 
       RowBox[{"eqs", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"QTs", "=", 
      RowBox[{"QT", "/.", 
       RowBox[{
       "sols", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", "QTs"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.665746344148189*^9, 3.665746357499515*^9}, {
  3.667629110150731*^9, 3.667629117546748*^9}, {3.667629254770275*^9, 
  3.667629258225225*^9}, {3.667630603278612*^9, 3.667630605327855*^9}, {
  3.6676306528447523`*^9, 3.6676306545659657`*^9}, {3.667828419196966*^9, 
  3.6678284340957117`*^9}, {3.699713899117086*^9, 3.699713956988244*^9}}],

Cell["With self replacement", "Text",
 CellChangeTimes->{{3.69971396939288*^9, 3.699713974576749*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tmp", "=", 
   RowBox[{"NGetQWF", "[", 
    RowBox[{
     RowBox[{"G12IM", "/.", 
      RowBox[{"m", "\[Rule]", "them"}]}], ",", "12", ",", "1", ",", "thep", 
     ",", "the\[Mu]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699713964899124*^9, 3.699714004604657*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp", "\[LeftDoubleBracket]", 
  RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]], "Input",
 CellChangeTimes->{{3.699714006344316*^9, 3.699714009515492*^9}}],

Cell[BoxData["0.314209432193372`"], "Output",
 CellChangeTimes->{3.699714010822144*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QinWFs", "/.", "prms"}]], "Input",
 CellChangeTimes->{{3.699714014395958*^9, 3.6997140179382963`*^9}, {
  3.699714052836297*^9, 3.699714060069831*^9}}],

Cell[BoxData["0.31420943219337216`"], "Output",
 CellChangeTimes->{{3.699714055548519*^9, 3.699714060895534*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"tmp", "\[LeftDoubleBracket]", 
  RowBox[{"1", ",", "10"}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"QoutWFs", "/.", "prms"}]}], "Input",
 CellChangeTimes->{{3.6997140657829027`*^9, 3.699714076421811*^9}}],

Cell[BoxData["0.22011168630008535`"], "Output",
 CellChangeTimes->{3.699714076693431*^9}],

Cell[BoxData["0.22011168630008562`"], "Output",
 CellChangeTimes->{3.699714076695978*^9}]
}, Open  ]],

Cell["Without self replacement", "Text",
 CellChangeTimes->{{3.6997140797332783`*^9, 3.699714085800799*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tmp2", "=", 
   RowBox[{"NGetQWF", "[", 
    RowBox[{
     RowBox[{"G12IMnoself", "/.", 
      RowBox[{"m", "\[Rule]", "them"}]}], ",", "12", ",", "1", ",", "thep", 
     ",", "the\[Mu]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699713964899124*^9, 3.699714004604657*^9}, {
  3.699714094130377*^9, 3.699714099787663*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tmp2", "\[LeftDoubleBracket]", 
  RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]], "Input",
 CellChangeTimes->{{3.699714006344316*^9, 3.699714009515492*^9}, 
   3.6997141020180492`*^9}],

Cell[BoxData["0.27517012871174684`"], "Output",
 CellChangeTimes->{3.699714010822144*^9, 3.699714104694887*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QinWFw", "/.", "prms"}]], "Input",
 CellChangeTimes->{{3.699714014395958*^9, 3.6997140179382963`*^9}, {
  3.699714052836297*^9, 3.699714060069831*^9}, {3.6997141065142517`*^9, 
  3.699714106658258*^9}}],

Cell[BoxData["0.2751701287117468`"], "Output",
 CellChangeTimes->{{3.699714055548519*^9, 3.699714060895534*^9}, 
   3.699714106896331*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"tmp2", "\[LeftDoubleBracket]", 
  RowBox[{"1", ",", "10"}], 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"QoutWFw", "/.", "prms"}]}], "Input",
 CellChangeTimes->{{3.6997140657829027`*^9, 3.699714076421811*^9}, {
  3.6997141101412897`*^9, 3.699714112193549*^9}}],

Cell[BoxData["0.20955788210480272`"], "Output",
 CellChangeTimes->{3.699714076693431*^9, 3.69971411245328*^9}],

Cell[BoxData["0.20955788210480267`"], "Output",
 CellChangeTimes->{3.699714076693431*^9, 3.699714112455226*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Other", "Section",
 CellChangeTimes->{{3.6997137122391787`*^9, 3.699713713783063*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Qin", "/.", 
      RowBox[{
      "sols", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "/.", 
     
     RowBox[{"\[CapitalNu]", "\[Rule]", " ", 
      RowBox[{"n", " ", "d"}]}]}], ")"}], "-", "QinWF0"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.698755785901092*^9, 3.698755800887302*^9}, {
  3.6987561425795717`*^9, 3.698756153927031*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "d"}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"2", " ", "\[Mu]"}], "-", 
       SuperscriptBox["\[Mu]", "2"]}]]}], 
    RowBox[{
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"2", " ", "\[Mu]"}], "-", 
       SuperscriptBox["\[Mu]", "2"]}]]}]]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "d", " ", 
        SuperscriptBox["m", "3"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SuperscriptBox["m", "4"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
        SuperscriptBox["m", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
         ")"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "d"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
         ")"}]}]}], ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"2", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
      SuperscriptBox["m", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "4"]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"m", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], ")"}],
       " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "-", 
           RowBox[{"2", " ", "m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
           RowBox[{
            SuperscriptBox["m", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
          ")"}]}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.6987558253435287`*^9, {3.698756143992382*^9, 3.6987561543781137`*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.698755698861434*^9, 3.698755698876425*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QinWF0", "/.", 
  RowBox[{"\[Mu]", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.698756163164096*^9, 3.698756166514716*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Power","infy",
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \\\"0\\\"]\\) \
encountered.\"",2,44,1,25639121145884435504,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.6987561673670464`*^9}],

Cell[BoxData[
 TemplateBox[{
  "Power","infy",
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \\\"0\\\"]\\) \
encountered.\"",2,44,2,25639121145884435504,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.698756167368197*^9}],

Cell[BoxData[
 TemplateBox[{
  "Infinity","indet",
   "\"Indeterminate expression \\!\\(\\*RowBox[{\\\"0\\\", \\\" \\\", \
\\\"ComplexInfinity\\\"}]\\) encountered.\"",2,44,3,25639121145884435504,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.6987561673735847`*^9}],

Cell[BoxData["Indeterminate"], "Output",
 CellChangeTimes->{3.69875616737927*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Qin", "/.", 
   RowBox[{"sols", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "/.", 
  RowBox[{"\[Mu]", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.698756173986155*^9, 3.698756181329809*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", "m"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
     SuperscriptBox["m", "2"]}], "-", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "d", " ", 
     SuperscriptBox["m", "3"]}], "+", 
    RowBox[{
     SuperscriptBox["d", "2"], " ", 
     SuperscriptBox["m", "4"]}]}], 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "m", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "-", 
          RowBox[{"2", " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"2", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"2", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
     SuperscriptBox["m", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}]]}]], "Output",
 CellChangeTimes->{3.698756181802299*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 911},
WindowMargins->{{71, Automatic}, {47, Automatic}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 92, 1, 65, "Section"],
Cell[675, 25, 361, 12, 61, "Input"],
Cell[CellGroupData[{
Cell[1061, 41, 262, 3, 45, "Subsection"],
Cell[CellGroupData[{
Cell[1348, 48, 124, 1, 35, "Subsubsection"],
Cell[1475, 51, 5972, 202, 433, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7484, 258, 147, 2, 35, "Subsubsection"],
Cell[7634, 262, 5222, 175, 372, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12893, 442, 227, 4, 35, "Subsubsection"],
Cell[13123, 448, 1927, 53, 372, "Input"],
Cell[15053, 503, 1627, 42, 372, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16741, 552, 90, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[16856, 557, 106, 1, 44, "Subsection"],
Cell[16965, 560, 1642, 55, 57, InheritFromParent],
Cell[18610, 617, 1616, 55, 57, InheritFromParent],
Cell[20229, 674, 363, 11, 57, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20629, 690, 97, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[20751, 695, 98, 1, 35, "Subsubsection"],
Cell[20852, 698, 944, 30, 96, "Input"],
Cell[CellGroupData[{
Cell[21821, 732, 1364, 44, 168, "Input"],
Cell[23188, 778, 1333, 44, 71, "Output"]
}, Open  ]],
Cell[24536, 825, 2563, 85, 329, "Input"],
Cell[CellGroupData[{
Cell[27124, 914, 385, 10, 34, "Input"],
Cell[27512, 926, 1618, 53, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29167, 984, 427, 11, 55, "Input"],
Cell[29597, 997, 1704, 55, 77, "Output"],
Cell[31304, 1054, 1460, 47, 77, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32813, 1107, 112, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[32950, 1112, 349, 9, 55, "Input"],
Cell[33302, 1123, 1162, 40, 53, "Output"],
Cell[34467, 1165, 879, 31, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35383, 1201, 1009, 32, 57, "Input"],
Cell[36395, 1235, 143, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36575, 1242, 784, 25, 56, "Input"],
Cell[37362, 1269, 94, 1, 32, "Output"]
}, Open  ]],
Cell[37471, 1273, 125, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[37621, 1278, 157, 3, 32, "Input"],
Cell[37781, 1283, 72, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37890, 1289, 159, 3, 32, "Input"],
Cell[38052, 1294, 70, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38159, 1300, 232, 6, 34, "Input"],
Cell[38394, 1308, 122, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38553, 1315, 353, 9, 56, "Input"],
Cell[38909, 1326, 512, 16, 52, "Output"],
Cell[39424, 1344, 284, 9, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39745, 1358, 227, 6, 34, "Input"],
Cell[39975, 1366, 93, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40105, 1372, 217, 5, 34, "Input"],
Cell[40325, 1379, 447, 12, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40809, 1396, 190, 5, 34, "Input"],
Cell[41002, 1403, 447, 12, 34, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41498, 1421, 117, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[41640, 1426, 345, 9, 55, "Input"],
Cell[41988, 1437, 1413, 51, 60, "Output"],
Cell[43404, 1490, 1154, 42, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44595, 1537, 1460, 45, 89, "Input"],
Cell[46058, 1584, 145, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46240, 1592, 1184, 38, 81, "Input"],
Cell[47427, 1632, 122, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47586, 1639, 231, 6, 34, "Input"],
Cell[47820, 1647, 547, 18, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48404, 1670, 192, 4, 34, "Input"],
Cell[48599, 1676, 70, 1, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48730, 1684, 105, 1, 44, "Subsection"],
Cell[48838, 1687, 5834, 147, 585, "Input"],
Cell[54675, 1836, 148, 2, 77, "Input"],
Cell[CellGroupData[{
Cell[54848, 1842, 1249, 32, 193, "Input"],
Cell[56100, 1876, 407, 9, 34, "Output"],
Cell[56510, 1887, 190, 2, 32, "Output"],
Cell[56703, 1891, 188, 2, 32, "Output"],
Cell[56894, 1895, 188, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57119, 1902, 576, 14, 79, "Input"],
Cell[57698, 1918, 87, 1, 32, "Output"],
Cell[57788, 1921, 90, 1, 32, "Output"]
}, Open  ]],
Cell[57893, 1925, 178, 5, 34, "Input"],
Cell[58074, 1932, 88, 1, 33, "Text"],
Cell[58165, 1935, 1084, 35, 101, "Input"],
Cell[59252, 1972, 104, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[59381, 1977, 365, 10, 34, "Input"],
Cell[59749, 1989, 1935, 52, 53, "Output"]
}, Open  ]],
Cell[61699, 2044, 117, 1, 33, "Text"],
Cell[61819, 2047, 337, 10, 34, "Input"],
Cell[62159, 2059, 101, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[62285, 2064, 581, 16, 80, "Input"],
Cell[62869, 2082, 721, 10, 32, "Output"],
Cell[63593, 2094, 2125, 62, 53, "Output"],
Cell[65721, 2158, 2088, 61, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67846, 2224, 635, 19, 34, "Input"],
Cell[68484, 2245, 282, 7, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68803, 2257, 344, 11, 32, "Input"],
Cell[69150, 2270, 207, 6, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69394, 2281, 671, 23, 32, "Input"],
Cell[70068, 2306, 185, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70290, 2316, 471, 15, 41, "Input"],
Cell[70764, 2333, 160, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70961, 2343, 528, 18, 32, "Input"],
Cell[71492, 2363, 184, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71713, 2373, 927, 32, 57, "Input"],
Cell[72643, 2407, 161, 5, 32, "Output"]
}, Open  ]],
Cell[72819, 2415, 92, 1, 32, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[72960, 2422, 100, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[73085, 2427, 1861, 55, 101, "Input"],
Cell[74949, 2484, 1803, 58, 86, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76789, 2547, 2673, 79, 177, "Input"],
Cell[79465, 2628, 2789, 86, 139, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82291, 2719, 1036, 29, 106, "Input"],
Cell[83330, 2750, 9323, 270, 270, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92690, 3025, 190, 4, 32, "Input"],
Cell[92883, 3031, 3547, 110, 157, "Output"]
}, Closed]],
Cell[96445, 3144, 98, 1, 30, "Text"],
Cell[96546, 3147, 2300, 70, 145, "Input"],
Cell[98849, 3219, 2255, 68, 145, "Input"],
Cell[101107, 3289, 94, 1, 32, "Input"],
Cell[101204, 3292, 660, 22, 114, "Input"],
Cell[101867, 3316, 3148, 104, 248, "Input"],
Cell[CellGroupData[{
Cell[105040, 3424, 340, 8, 34, "Input"],
Cell[105383, 3434, 1194, 40, 76, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106614, 3479, 413, 11, 55, "Input"],
Cell[107030, 3492, 2252, 79, 104, "Output"],
Cell[109285, 3573, 1927, 67, 104, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111249, 3645, 109, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[111383, 3650, 207, 5, 32, "Input"],
Cell[111593, 3657, 1686, 59, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113316, 3721, 162, 3, 32, "Input"],
Cell[113481, 3726, 94, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113612, 3732, 208, 5, 32, "Input"],
Cell[113823, 3739, 1621, 57, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115481, 3801, 164, 3, 32, "Input"],
Cell[115648, 3806, 70, 1, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[115767, 3813, 165, 2, 45, "Subsection"],
Cell[CellGroupData[{
Cell[115957, 3819, 254, 6, 32, "Input"],
Cell[116214, 3827, 2577, 91, 104, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118828, 3923, 255, 6, 32, "Input"],
Cell[119086, 3931, 2087, 73, 104, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[121222, 4010, 99, 1, 45, "Subsection"],
Cell[121324, 4013, 5765, 145, 593, "Input"],
Cell[127092, 4160, 102, 1, 33, "Text"],
Cell[127197, 4163, 309, 8, 34, "Input"],
Cell[CellGroupData[{
Cell[127531, 4175, 184, 3, 34, "Input"],
Cell[127718, 4180, 87, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127842, 4186, 175, 3, 32, "Input"],
Cell[128020, 4191, 113, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128170, 4197, 252, 5, 56, "Input"],
Cell[128425, 4204, 89, 1, 32, "Output"],
Cell[128517, 4207, 89, 1, 32, "Output"]
}, Open  ]],
Cell[128621, 4211, 108, 1, 33, "Text"],
Cell[128732, 4214, 365, 9, 34, "Input"],
Cell[CellGroupData[{
Cell[129122, 4227, 213, 4, 34, "Input"],
Cell[129338, 4233, 111, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129486, 4239, 226, 4, 32, "Input"],
Cell[129715, 4245, 138, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129890, 4252, 304, 6, 56, "Input"],
Cell[130197, 4260, 110, 1, 32, "Output"],
Cell[130310, 4263, 111, 1, 65, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[130482, 4271, 92, 1, 65, "Section"],
Cell[CellGroupData[{
Cell[130599, 4276, 451, 13, 55, "Input"],
Cell[131053, 4291, 6562, 212, 246, "Output"]
}, Open  ]],
Cell[137630, 4506, 92, 1, 32, "Input"],
Cell[CellGroupData[{
Cell[137747, 4511, 154, 3, 32, "Input"],
Cell[137904, 4516, 259, 6, 43, "Message"],
Cell[138166, 4524, 257, 6, 43, "Message"],
Cell[138426, 4532, 294, 7, 23, "Message"],
Cell[138723, 4541, 81, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138841, 4547, 246, 5, 32, "Input"],
Cell[139090, 4554, 1752, 59, 60, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

