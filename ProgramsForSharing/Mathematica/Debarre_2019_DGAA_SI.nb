(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    538015,      14397]
NotebookOptionsPosition[    483266,      13530]
NotebookOutlinePosition[    483603,      13545]
CellTagsIndexPosition[    483560,      13542]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Supplementary Mathematica file. ", "Text",
 CellChangeTimes->{{3.7053817047370768`*^9, 3.705381712931221*^9}, {
  3.709989523473722*^9, 3.7099895240254107`*^9}, {3.710053640860198*^9, 
  3.710053650141354*^9}, {3.714231818022501*^9, 3.714231819080662*^9}, {
  3.776138127453281*^9, 3.776138128023179*^9}},
 FontWeight->"Bold",ExpressionUUID->"4d122144-68f5-4dd6-89d3-e7a0d56980e8"],

Cell[TextData[{
 StyleBox["CONTENTS: \n\nPart 0",
  FontWeight->"Bold"],
 ": \[OpenCurlyDoubleQuote]Housekeeping\[CloseCurlyDoubleQuote], definitions \
of functions, matrices and replacement rules that will be used throughout the \
file. \n\n",
 StyleBox["Part 1",
  FontWeight->"Bold"],
 ": Probabilities of identity by descent (related to Appendix B). \n          \
  We compare the formulas calculated by hand to the ones obtained numerically \
for special structures, to check that the formulas are correct (they are).\n\n\
",
 StyleBox["Part 2",
  FontWeight->"Bold"],
 ": Expected Frequencies Functions (related to Appendix A and formulas in the \
main text)\n            - Computation of E[X] for each life-cycle, written as \
factor * (R B - C),\n            - Signs of the B term, and of the \
competition terms,\n            - Effects of m on E[X] for each life-cycle,\n \
           - Qualitative effects of m for Moran DB.\n            \n",
 StyleBox["Part 3",
  FontWeight->"Bold"],
 ": Expected Frequencies Functions, generic method (i.e. not restricted to \
the type of subdivided population that we consider in the main text) -> \
related to the Supplementary Figures\n             - We simplify the formulas \
obtained by hand by replacing the dispersal (d) and interaction (e) graphs by \
their formulas in subdivided populations. \n             - We compare the \
formulas calculated by hand to the ones obtained numerically for special \
structures, to check that the formulas are correct (they are).\n             \
- We export the formulas to R for further use. \n\n                           "
}], "Text",
 CellChangeTimes->{{3.7100486122993307`*^9, 3.7100486691530867`*^9}, {
  3.710048701304635*^9, 3.7100487152290573`*^9}, {3.7100487622241507`*^9, 
  3.710048897825068*^9}, {3.71004916081533*^9, 3.710049303512838*^9}, {
  3.7142256106892233`*^9, 3.7142256188600473`*^9}, {3.714225675269268*^9, 
  3.714225773199293*^9}, {3.7142309042902517`*^9, 3.714230990419134*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"14ea3af3-d465-4f5c-af36-99619e21b63f"],

Cell[TextData[{
 StyleBox["Please note:\n",
  FontWeight->"Bold"],
 "-  In this file, the mutation bias is sometimes denoted by p (as in Tarnita \
and Taylor 2014 and Debarre 2017), instead of \[Nu] as in the manuscript. \n  \
 The letter \[Nu] was chosen in the manuscript because p was sometimes \
mistaken by others as average frequency of altruists in the population (",
 Cell[BoxData[
  FormBox[
   OverscriptBox["X", "_"], TraditionalForm]],ExpressionUUID->
  "409444ec-78b1-4819-ba13-62cc0cdcaac2"],
 " in the manuscript)... But this file was written before the change, and it \
is too complicated to change every instance of \[OpenCurlyDoubleQuote]p\
\[CloseCurlyDoubleQuote].\n   \n-  In this file, the number of demes is \
denoted by d instead of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["N", "D"], TraditionalForm]],ExpressionUUID->
  "67d80f3f-0f5d-4223-90ac-b16b9e2ecc70"],
 " in the article. \n   \n-  Make sure to change `pathtosave` with the path \
to the folder containing the codes. "
}], "Text",
 CellChangeTimes->{{3.709989667224828*^9, 3.7099897100888243`*^9}, {
   3.7099900953347473`*^9, 3.7099901568227654`*^9}, 3.7100445466381598`*^9, {
   3.710044653324129*^9, 3.710044653923409*^9}, {3.71004470069179*^9, 
   3.710044776161139*^9}, {3.710048561933441*^9, 3.710048606698984*^9}, {
   3.7100492887766237`*^9, 3.7100493957508297`*^9}, {3.714226249887731*^9, 
   3.7142262739693403`*^9}, {3.714231715321127*^9, 3.714231724584405*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"fb901ea2-6ef0-4b91-8646-6ed3770e796d"],

Cell["Before doing anything, clean the memory", "Text",
 CellChangeTimes->{{3.7099894867598257`*^9, 3.709989496506331*^9}, {
  3.7100493755278254`*^9, 
  3.710049379170722*^9}},ExpressionUUID->"46e8e511-d008-4ebf-9a4b-\
e730a4fefb52"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"Evaluate", "[", 
   RowBox[{
    RowBox[{"Context", "[", "]"}], "<>", "\"\<*\>\""}], "]"}], "]"}]], "Input",\

 CellChangeTimes->{{3.699768620256393*^9, 
  3.69976863906523*^9}},ExpressionUUID->"7dbdee60-53e4-496c-a4b9-\
7a1a2e990d3e"],

Cell["\<\
Set path to folder where outputs should be saved (otherwise it is the default \
Mathematica one)\
\>", "Text",
 CellChangeTimes->{{3.709989499062375*^9, 3.70998951336238*^9}, {
  3.71004479279252*^9, 
  3.71004481852061*^9}},ExpressionUUID->"b26eefa8-1f0f-479a-9750-\
39f651f214ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pathtosave", "=", "\"\<\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.705387996764245*^9, 3.7053879984325037`*^9}, {
   3.705388032144833*^9, 3.705388039805272*^9}, {3.709990745446624*^9, 
   3.7099907457090263`*^9}, {3.725281734921309*^9, 3.7252817433161793`*^9}, 
   3.7761381678558197`*^9},ExpressionUUID->"410807c3-190e-41db-9fb8-\
efa3cbdabd8f"],

Cell[CellGroupData[{

Cell["0) Generalities - Initializations", "Title",
 CellChangeTimes->{{3.6998481203326683`*^9, 3.699848124351286*^9}, {
  3.70538498351235*^9, 3.705384986975419*^9}, {3.710048447708098*^9, 
  3.710048448254251*^9}},ExpressionUUID->"4cf9ebfe-7fd7-4be0-9b24-\
f399073f702b"],

Cell[CellGroupData[{

Cell["Some functions", "Section",
 CellChangeTimes->{{3.69976195851033*^9, 3.6997619606822844`*^9}, {
  3.705381692643553*^9, 
  3.705381694507731*^9}},ExpressionUUID->"6470b1dc-c55e-42d2-a648-\
1b6ada46a445"],

Cell["\<\
Function to turn P (expected state of pairs of sites) into Q (probabilities \
of identity by descent)\
\>", "Text",
 CellChangeTimes->{{3.699761638267042*^9, 3.699761643190976*^9}, {
  3.710044987970128*^9, 
  3.710045000889764*^9}},ExpressionUUID->"a35f7219-586c-4d81-b1a7-\
cf33223a07e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PtoQ", "[", "P_", "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"P", "-", 
      SuperscriptBox["p", "2"]}], 
     RowBox[{"p", 
      RowBox[{"(", 
       RowBox[{"1", "-", "p"}], ")"}]}]], "//", "FullSimplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6997074055269413`*^9, 3.699707418282507*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"1b43948b-fd57-42ad-8edb-95e6d9a8c16a"],

Cell["Delta function", "Text",
 CellChangeTimes->{{3.699761981659233*^9, 
  3.699761983664853*^9}},ExpressionUUID->"0408952b-d00d-4b27-abcb-\
5c8498f679b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Delta", "[", "x_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"x", "\[Equal]", "0"}], ",", "1", ",", "0"}], "]"}]}]], "Input",
 CellLabel->"In[4]:=",ExpressionUUID->"b74b4fc2-ed1b-4e18-9c79-b5e67acc4d70"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define graphs for numerical evaluation", "Section",
 CellChangeTimes->{{3.668999943448367*^9, 3.668999951062648*^9}, {
  3.669090333143214*^9, 3.6690903447306433`*^9}, {3.6690903789232073`*^9, 
  3.6690903841955957`*^9}, {3.6702349799301558`*^9, 3.670234987354018*^9}, {
  3.699761597799471*^9, 3.699761603112997*^9}, {3.705381823275504*^9, 
  3.705381826586681*^9}},ExpressionUUID->"e54fbb92-27f1-474c-b9b0-\
1ab298eedac9"],

Cell[CellGroupData[{

Cell["Dispersal and Interaction Graphs", "Subsection",
 CellChangeTimes->{{3.710045015347454*^9, 
  3.710045025005965*^9}},ExpressionUUID->"14b6fb56-e1e7-4517-9d94-\
ff8cefeee6d7"],

Cell[CellGroupData[{

Cell["Island model, dispersal graph, generic", "Subsubsection",
 CellChangeTimes->{{3.6702357682102127`*^9, 3.6702357769730186`*^9}, {
  3.6997616053042727`*^9, 3.699761610197031*^9}, {3.699779221556974*^9, 
  3.6997792225091047`*^9}},ExpressionUUID->"9fc285f0-c72c-4808-9fee-\
6f66b9ab8bb9"],

Cell["N = 12, 4 demes of 3 individuals", "Text",
 CellChangeTimes->{{3.7053816073690863`*^9, 3.705381610787718*^9}, {
  3.7100450872081947`*^9, 
  3.7100450924090233`*^9}},ExpressionUUID->"686e6e0d-eb2c-4d12-ad4d-\
43fe233137e2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"G12generic", "=", 
   RowBox[{"(", GridBox[{
      {"dself", "din", "din", "dout", "dout", "dout", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"din", "dself", "din", "dout", "dout", "dout", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"din", "din", "dself", "dout", "dout", "dout", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "dself", "din", "din", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "din", "dself", "din", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "din", "din", "dself", "dout", "dout", "dout", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "dself", "din", "din", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "din", "dself", "din", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "din", "din", "dself", 
       "dout", "dout", "dout"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout",
        "dself", "din", "din"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout",
        "din", "dself", "din"},
      {"dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout", "dout",
        "din", "din", "dself"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nin", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ndemes", "=", "4"}], ";"}]}], "Input",
 CellChangeTimes->{{3.668999966108613*^9, 3.668999984048553*^9}, {
  3.669000027438491*^9, 3.669000197449211*^9}, {3.699779227001737*^9, 
  3.699779365815967*^9}, {3.705382335922227*^9, 3.7053823360656347`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"779b13f5-773e-45e1-a031-f79d73dbae3b"],

Cell["N = 10, 2 demes of 5 individuals", "Text",
 CellChangeTimes->{{3.7053816073690863`*^9, 3.705381617268631*^9}, {
  3.710045094361265*^9, 
  3.710045098800516*^9}},ExpressionUUID->"b43962b9-e73f-4b71-bd3c-\
3a9353ca0424"],

Cell[BoxData[
 RowBox[{
  RowBox[{"G10generic", "=", 
   RowBox[{"(", GridBox[{
      {"dself", "din", "din", "din", "din", "dout", "dout", "dout", "dout", 
       "dout"},
      {"din", "dself", "din", "din", "din", "dout", "dout", "dout", "dout", 
       "dout"},
      {"din", "din", "dself", "din", "din", "dout", "dout", "dout", "dout", 
       "dout"},
      {"din", "din", "din", "dself", "din", "dout", "dout", "dout", "dout", 
       "dout"},
      {"din", "din", "din", "din", "dself", "dout", "dout", "dout", "dout", 
       "dout"},
      {"dout", "dout", "dout", "dout", "dout", "dself", "din", "din", "din", 
       "din"},
      {"dout", "dout", "dout", "dout", "dout", "din", "dself", "din", "din", 
       "din"},
      {"dout", "dout", "dout", "dout", "dout", "din", "din", "dself", "din", 
       "din"},
      {"dout", "dout", "dout", "dout", "dout", "din", "din", "din", "dself", 
       "din"},
      {"dout", "dout", "dout", "dout", "dout", "din", "din", "din", "din", 
       "dself"}
     }], ")"}]}], ";"}]], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"a78b7931-6d27-4690-aef0-853d717cd5ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Island model, interaction graph, generic", "Subsubsection",
 CellChangeTimes->{{3.699761622641583*^9, 3.699761631727844*^9}, {
  3.699762000382402*^9, 3.699762003637082*^9}, {3.6997793522666693`*^9, 
  3.699779354892267*^9}},ExpressionUUID->"fcd4e3a5-b587-4c5d-905c-\
2b18c24c35f6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GE12generic", "=", 
   RowBox[{"G12generic", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dself", "\[Rule]", "eself"}], ",", 
      RowBox[{"dout", "\[Rule]", "eout"}], ",", 
      RowBox[{"din", "\[Rule]", "ein"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GE10generic", "=", 
   RowBox[{"G10generic", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dself", "\[Rule]", "eself"}], ",", 
      RowBox[{"dout", "\[Rule]", "eout"}], ",", 
      RowBox[{"din", "\[Rule]", "ein"}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.679392136687027*^9, 3.679392176855454*^9}, {
  3.699779361234367*^9, 3.699779471181334*^9}, {3.705381642158368*^9, 
  3.705381650694024*^9}, {3.7053823499146967`*^9, 3.705382353401075*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"231e340c-941e-496e-9eb5-71f4b9ace8ed"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Formulas for d and e", "Subsubsection",
 CellChangeTimes->{{3.7053847971199408`*^9, 3.705384811375741*^9}, {
  3.705386643590569*^9, 
  3.705386651654303*^9}},ExpressionUUID->"92c404cf-8ac4-46d4-84a2-\
9e02b38995cf"],

Cell["\<\
Replacements for the generic dispersal probabilities, depending on whether \
there is self-replacement or not\
\>", "Text",
 CellChangeTimes->{{3.6997616658203783`*^9, 3.699761687567214*^9}, {
  3.705384783688675*^9, 
  3.7053847850708513`*^9}},ExpressionUUID->"6d9b872d-6028-4ea1-b878-\
11c0d133571c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"noselfreplacement", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dself", "\[Rule]", "0"}], ",", 
     RowBox[{"din", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "m"}], 
       RowBox[{"n", "-", "1"}]]}], ",", 
     RowBox[{"dout", "\[Rule]", 
      FractionBox["m", 
       RowBox[{
        RowBox[{"d", " ", "n"}], " ", "-", " ", "n"}]]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"withselfreplacement", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dself", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "m"}], "n"]}], ",", 
     RowBox[{"din", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "m"}], "n"]}], ",", 
     RowBox[{"dout", "\[Rule]", 
      FractionBox["m", 
       RowBox[{
        RowBox[{"d", " ", "n"}], " ", "-", " ", "n"}]]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6997075039255657`*^9, 3.699707552648037*^9}, {
  3.699794949387794*^9, 3.699794952038497*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"b0de730f-7b8e-470f-b642-885eaf843a40"],

Cell["\<\
Replacements for the generic interaction probabilities, depending on whether \
there is self - interaction or not\
\>", "Text",
 CellChangeTimes->{{3.7053866725645*^9, 
  3.7053866854887857`*^9}},ExpressionUUID->"b1624d0e-7129-46c8-ad48-\
4efddc8744b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"groupnoself", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"eself", "\[Rule]", "0"}], ",", 
     RowBox[{"ein", "\[Rule]", 
      FractionBox["1", 
       RowBox[{"n", "-", "1"}]]}], ",", 
     RowBox[{"eout", "\[Rule]", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"groupwithself", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"eself", "\[Rule]", 
      FractionBox["1", "n"]}], ",", 
     RowBox[{"ein", "\[Rule]", 
      FractionBox["1", "n"]}], ",", 
     RowBox[{"eout", "\[Rule]", "0"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.699794001410203*^9, 3.6997940825421743`*^9}, 
   3.705386614026968*^9, 3.705386696609133*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"365ccce7-344a-4976-9a81-27b2e9b90b55"],

Cell["\<\
We can even assume that there are a proportion g of interactions outside of \
the group\
\>", "Text",
 CellChangeTimes->{{3.7053866988119307`*^9, 
  3.7053867171153393`*^9}},ExpressionUUID->"2c95eb0b-ff6c-428c-8c7b-\
3548e2eb779e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"widewithself", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"eself", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "g"}], "n"]}], ",", 
     RowBox[{"ein", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "g"}], "n"]}], ",", 
     RowBox[{"eout", "\[Rule]", 
      FractionBox["g", 
       RowBox[{
        RowBox[{"n", " ", "d"}], "-", "n"}]]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"widenoself", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"eself", "\[Rule]", "0"}], ",", 
     RowBox[{"ein", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "g"}], 
       RowBox[{"n", "-", "1"}]]}], ",", 
     RowBox[{"eout", "\[Rule]", 
      FractionBox["g", 
       RowBox[{
        RowBox[{"n", " ", "d"}], "-", "n"}]]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.699794001410203*^9, 3.6997940825421743`*^9}, 
   3.705386614026968*^9, 3.705386696609133*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"533ba1b4-44c2-4bcf-9508-911a773a35eb"],

Cell["\<\
Combine these using Idself and Ieself, indicator variables for whether there \
is dispersal/interaction with self\
\>", "Text",
 CellChangeTimes->{{3.705386722588567*^9, 3.7053867328708897`*^9}, {
  3.705386774295669*^9, 
  3.705386796017934*^9}},ExpressionUUID->"6874b1e8-b3f4-437c-9ea0-\
c07db7b16f01"],

Cell[BoxData[
 RowBox[{
  RowBox[{"genericde", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dself", "\[Rule]", 
      RowBox[{"Idself", " ", 
       FractionBox[
        RowBox[{"1", "-", "m"}], "n"]}]}], ",", 
     RowBox[{"din", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "m"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"n", "-", "1"}]], "-", 
         RowBox[{"Idself", " ", 
          FractionBox["1", 
           RowBox[{"n", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}]]}]}], ")"}]}]}], ",", 
     RowBox[{"dout", "\[Rule]", 
      FractionBox["m", 
       RowBox[{
        RowBox[{"n", " ", "d"}], "-", "n"}]]}], ",", 
     RowBox[{"(*", "\[IndentingNewLine]", "*)"}], 
     RowBox[{"eself", "\[Rule]", 
      RowBox[{"Ieself", " ", 
       FractionBox[
        RowBox[{"1", "-", "g"}], "n"]}]}], ",", 
     RowBox[{"ein", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "g"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"n", "-", "1"}]], "-", 
         RowBox[{"Ieself", " ", 
          FractionBox["1", 
           RowBox[{"n", 
            RowBox[{"(", 
             RowBox[{"n", "-", "1"}], ")"}]}]]}]}], ")"}]}]}], ",", 
     RowBox[{"eout", "\[Rule]", 
      FractionBox["g", 
       RowBox[{
        RowBox[{"n", " ", "d"}], "-", "n"}]]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699847700264285*^9, 3.699847847432616*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"bc246c1e-3b7e-4232-9a07-94e266b7602b"],

Cell["Quick check", "Text",
 CellChangeTimes->{{3.710045112069128*^9, 
  3.710045114517186*^9}},ExpressionUUID->"afbf62b9-1584-4c1b-bef3-\
3ff22a76e25e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"eself", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], "ein"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "eout"}]}], "/.", 
   "genericde"}], "//", "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dself", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], "din"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout"}]}], "/.", 
   "genericde"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.6998478529415617`*^9, 3.6998478741336203`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"9727f1a0-8aa5-400d-af11-6869472481f6"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.705386835798964*^9, 3.7099895977242107`*^9, 3.709990547431911*^9, 
   3.710045154959765*^9, 3.710049683670619*^9, {3.7100540128343143`*^9, 
   3.71005401875179*^9}, 3.7100544959334183`*^9, 3.710156937313199*^9, 
   3.713407332357637*^9, 3.714227890121348*^9, 3.714231871163528*^9, {
   3.7195522744595747`*^9, 3.719552279136121*^9}, 3.725281755098012*^9, 
   3.77613838838783*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"c921c7b0-44df-4217-919d-9c9e948279d8"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.705386835798964*^9, 3.7099895977242107`*^9, 3.709990547431911*^9, 
   3.710045154959765*^9, 3.710049683670619*^9, {3.7100540128343143`*^9, 
   3.71005401875179*^9}, 3.7100544959334183`*^9, 3.710156937313199*^9, 
   3.713407332357637*^9, 3.714227890121348*^9, 3.714231871163528*^9, {
   3.7195522744595747`*^9, 3.719552279136121*^9}, 3.725281755098012*^9, 
   3.776138388391589*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"4ed3488c-31fa-4493-9640-ebb28318bd72"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Probabilities of identity by descent matrices", "Subsection",
 CellChangeTimes->{{3.710045034592218*^9, 
  3.710045049896731*^9}},ExpressionUUID->"c01e6cf6-7984-446a-b81a-\
7f67a14a0415"],

Cell[CellGroupData[{

Cell["\<\
Generic Q matrix corresponding to the populations defined above\
\>", "Subsubsection",
 CellChangeTimes->{{3.699780083079438*^9, 3.699780089064321*^9}, {
  3.710045053816822*^9, 
  3.7100450723451557`*^9}},ExpressionUUID->"2d17cb7a-23a4-4189-976e-\
728a51c1cf34"],

Cell["N = 12", "Text",
 CellChangeTimes->{{3.7053816637626743`*^9, 
  3.705381672787184*^9}},ExpressionUUID->"08409582-176d-4743-b821-\
2aa19df9425c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q12generic", "=", 
   RowBox[{"(", GridBox[{
      {"1", "Qin", "Qin", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qin", "1", "Qin", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qin", "Qin", "1", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "1", "Qin", "Qin", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qin", "1", "Qin", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qin", "Qin", "1", "Qout", "Qout", "Qout", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "1", "Qin", "Qin", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "1", "Qin", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "Qin", "1", 
       "Qout", "Qout", "Qout"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout",
        "1", "Qin", "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout",
        "Qin", "1", "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout", "Qout",
        "Qin", "Qin", "1"}
     }], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699780094260882*^9, 3.699780213049553*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"f41fff88-c1e7-48df-96e1-08e6d3e25f42"],

Cell["N = 10", "Text",
 CellChangeTimes->{{3.7053816637626743`*^9, 
  3.705381667315893*^9}},ExpressionUUID->"7e88402e-fa3a-405b-8b40-\
dfa13475ded9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Q10generic", "=", 
   RowBox[{"(", GridBox[{
      {"1", "Qin", "Qin", "Qin", "Qin", "Qout", "Qout", "Qout", "Qout", 
       "Qout"},
      {"Qin", "1", "Qin", "Qin", "Qin", "Qout", "Qout", "Qout", "Qout", 
       "Qout"},
      {"Qin", "Qin", "1", "Qin", "Qin", "Qout", "Qout", "Qout", "Qout", 
       "Qout"},
      {"Qin", "Qin", "Qin", "1", "Qin", "Qout", "Qout", "Qout", "Qout", 
       "Qout"},
      {"Qin", "Qin", "Qin", "Qin", "1", "Qout", "Qout", "Qout", "Qout", 
       "Qout"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "1", "Qin", "Qin", "Qin", 
       "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "1", "Qin", "Qin", 
       "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "Qin", "1", "Qin", 
       "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "Qin", "Qin", "1", 
       "Qin"},
      {"Qout", "Qout", "Qout", "Qout", "Qout", "Qin", "Qin", "Qin", "Qin", "1"}
     }], ")"}]}], ";"}]], "Input",
 CellLabel->"In[21]:=",ExpressionUUID->"0a733bee-0359-4343-93aa-300f5980601a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["1) Probabilities of identity by descent (Q)", "Title",
 CellChangeTimes->{{3.6997615711578712`*^9, 3.6997615782063017`*^9}, 
   3.705381722579816*^9, {3.705384972132237*^9, 3.7053849776404448`*^9}, {
   3.7100484523695393`*^9, 
   3.710048452937963*^9}},ExpressionUUID->"cebf8764-d7a2-4d77-a8ba-\
6f878c03d40c"],

Cell[CellGroupData[{

Cell["Moran", "Section",
 CellChangeTimes->{{3.699707345527932*^9, 
  3.699707348878216*^9}},ExpressionUUID->"f96d3728-443f-43e8-9405-\
13cada515dc3"],

Cell[CellGroupData[{

Cell["Simplify QinM and QoutM", "Subsection",
 CellChangeTimes->{{3.705384837006383*^9, 3.7053848450598097`*^9}, {
  3.705384918344077*^9, 
  3.705384919135845*^9}},ExpressionUUID->"688f17ab-c723-421a-a95d-\
2d2de423de3c"],

Cell["\<\
See Appendix B2 for calculation details on how Qself, Qin and Qout were \
obtained using a formula presented in the appendix of Debarre 2017 JTB for \
\[OpenCurlyDoubleQuote]2D graphs\[CloseCurlyDoubleQuote]. Here we just copy \
these formulas. \
\>", "Text",
 CellChangeTimes->{{3.705384701614676*^9, 3.705384767903507*^9}, {
  3.710045185256304*^9, 
  3.710045212024458*^9}},ExpressionUUID->"4184761c-67ff-45a5-b049-\
d974d4158e93"],

Cell[BoxData[
 RowBox[{
  RowBox[{"QselfM2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "\[Mu]"], " ", "+", " ", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "m", "-", 
            FractionBox["m", 
             RowBox[{"d", "-", "1"}]]}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699707557939262*^9, 3.69970763486366*^9}, {
   3.6997106026698093`*^9, 3.6997106056848392`*^9}, 
   3.705381789237061*^9},ExpressionUUID->"f55b96bf-181a-41e4-b2bc-\
1f16fb0d5513"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"QinM2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "\[Mu]"], " ", "+", " ", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "m", "-", 
            FractionBox["m", 
             RowBox[{"d", "-", "1"}]]}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QoutM2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", "\[Mu]"], " ", "+", " ", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"dself", "-", "din"}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "m", "-", 
            FractionBox["m", 
             RowBox[{"d", "-", "1"}]]}], ")"}]}]}]], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}], "+", 
      FractionBox["1", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"dself", "-", "din"}], ")"}]}]}]]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.699707683180396*^9, 3.699707713960421*^9}, {
  3.699710614334208*^9, 
  3.699710618463037*^9}},ExpressionUUID->"4d2e9453-02ff-4c2f-9ccd-\
9753be189985"],

Cell["Find \[Lambda] using Qself == 1", "Text",
 CellChangeTimes->{{3.6997617343192577`*^9, 
  3.699761741343073*^9}},ExpressionUUID->"afbedef6-1143-4b6e-82c5-\
fd91784f165c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"the\[Lambda]M", "=", 
  RowBox[{
   RowBox[{"\[Lambda]", "/.", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"QselfM2", "\[Equal]", "1"}], ",", "\[Lambda]"}], "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699707717272316*^9, 
  3.699707738311771*^9}},ExpressionUUID->"04d10033-58d9-4896-a08a-\
5c6588314092"],

Cell[BoxData[
 FractionBox[
  RowBox[{"n", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "din", "+", 
     RowBox[{"dself", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
     RowBox[{"din", " ", "\[Mu]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "d"}], " ", "m"}], "+", "\[Mu]", "+", 
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
  RowBox[{
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "din", "-", "dself", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "din"}], "+", "dself", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
       "\[Mu]"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "dself", "+", 
      RowBox[{"din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"dself", "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.69970772408389*^9, 3.699707738698215*^9}, 
   3.699710621593836*^9, 3.6997686437904377`*^9, 3.699787643568434*^9, 
   3.699793830771269*^9, 3.6998474518868103`*^9, 3.699848116000793*^9, 
   3.699848919108547*^9, 3.6998537361374397`*^9, 3.699955345715513*^9, 
   3.70220130432386*^9, 3.702289662990987*^9, 3.704178947628963*^9, 
   3.70451770389784*^9, 3.705381803222721*^9, 3.7053871868134527`*^9, 
   3.7099896361553926`*^9, {3.709990550342622*^9, 3.709990558553536*^9}, 
   3.7100452223244133`*^9, 3.710049684287039*^9, 3.7100540244959297`*^9, 
   3.7100544967705727`*^9, 3.710156941308593*^9, 3.713407333063487*^9, 
   3.714227893978518*^9, 3.7142318730588284`*^9, 3.71955228359838*^9, 
   3.725281759239142*^9},ExpressionUUID->"74f894e7-aa93-475b-8931-\
282b131097d5"]
}, Open  ]],

Cell["Replace \[Lambda] in the equations for Qin and Qout", "Text",
 CellChangeTimes->{{3.699761747312605*^9, 
  3.699761756389374*^9}},ExpressionUUID->"0a7ce679-47e9-4524-a16d-\
834f0517ce6f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QinM", "=", 
  RowBox[{
   RowBox[{"QinM2", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", " ", "the\[Lambda]M"}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"QoutM", "=", 
  RowBox[{
   RowBox[{"QoutM2", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", " ", "the\[Lambda]M"}]}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.6997077421873693`*^9, 3.699707784984331*^9}, {
  3.699793746074094*^9, 
  3.699793747396491*^9}},ExpressionUUID->"9948b7fc-71a4-4761-a3eb-\
961a77f350b4"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "din", "-", "dself"}], ")"}], " ", "\[Mu]"}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "din", "-", "dself", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d", "+", "din", "-", "dself"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "din", "-", "dself", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "din"}], "+", "dself", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
       "\[Mu]"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "dself", "+", 
      RowBox[{"din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"dself", "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.6997077647180653`*^9, 3.6997077855738363`*^9}, 
   3.699710621747601*^9, 3.699768643934836*^9, 3.699787643727768*^9, 
   3.699793748652389*^9, 3.699793831243638*^9, 3.6998474522920237`*^9, 
   3.699848116415012*^9, 3.6998489194040213`*^9, 3.699853736523282*^9, 
   3.699955346045332*^9, 3.702201304718186*^9, 3.702289663254939*^9, 
   3.7041789478680773`*^9, 3.704517704162591*^9, 3.705381804447599*^9, 
   3.705387187037231*^9, 3.709989638164032*^9, {3.709990550674816*^9, 
   3.7099905588175917`*^9}, 3.710045224036543*^9, 3.710049684677297*^9, 
   3.710054024680799*^9, 3.710054497021096*^9, 3.710156941540985*^9, 
   3.7134073333554697`*^9, 3.7142278942139053`*^9, 3.71423187487844*^9, 
   3.719552283883185*^9, 
   3.7252817595019827`*^9},ExpressionUUID->"3ca3f2d9-4648-4aa5-8926-\
727e2ab9b54a"],

Cell[BoxData[
 FractionBox[
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "din", "+", 
     RowBox[{"dself", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
     RowBox[{"din", " ", "\[Mu]"}]}], ")"}]}], 
  RowBox[{
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "din", "-", "dself", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "din"}], "+", "dself", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", 
       "\[Mu]"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "dself", "+", 
      RowBox[{"din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"dself", "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.6997077647180653`*^9, 3.6997077855738363`*^9}, 
   3.699710621747601*^9, 3.699768643934836*^9, 3.699787643727768*^9, 
   3.699793748652389*^9, 3.699793831243638*^9, 3.6998474522920237`*^9, 
   3.699848116415012*^9, 3.6998489194040213`*^9, 3.699853736523282*^9, 
   3.699955346045332*^9, 3.702201304718186*^9, 3.702289663254939*^9, 
   3.7041789478680773`*^9, 3.704517704162591*^9, 3.705381804447599*^9, 
   3.705387187037231*^9, 3.709989638164032*^9, {3.709990550674816*^9, 
   3.7099905588175917`*^9}, 3.710045224036543*^9, 3.710049684677297*^9, 
   3.710054024680799*^9, 3.710054497021096*^9, 3.710156941540985*^9, 
   3.7134073333554697`*^9, 3.7142278942139053`*^9, 3.71423187487844*^9, 
   3.719552283883185*^9, 
   3.7252817595781603`*^9},ExpressionUUID->"abb28a5e-30ee-42d7-b289-\
f99869492f79"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check numerically", "Subsection",
 CellChangeTimes->{{3.705382410622026*^9, 
  3.7053824143751183`*^9}},ExpressionUUID->"de96c862-0ce2-4c44-a157-\
66f36e147f16"],

Cell["\<\
Here we evaluate the probabilities of identity by descent numerically, using \
the recursion formula (\[OpenCurlyDoubleQuote]eqs\[CloseCurlyDoubleQuote] in \
the function below), with specific graphs. \
\>", "Text",
 CellChangeTimes->{{3.710045361619101*^9, 
  3.710045403286997*^9}},ExpressionUUID->"1f2fe9da-5e6d-4a49-8db3-\
c9b33f2ba7b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NGetQM", "[", 
   RowBox[{
   "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "p_", ",", 
    "\[Mu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"QT", ",", "eqs", ",", "vars", ",", "sols", ",", "QTs"}], "}"}], 
    ",", 
    RowBox[{"(*", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", " ", "is", " ", "the", " ", "dispersal", " ", "graph"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
      "\[CapitalNu]", " ", "is", " ", "the", " ", "size", " ", "of", " ", 
       "the", " ", "population"}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "graphdegree", " ", "is", " ", "the", " ", "degree", " ", "of", " ", 
       "the", " ", "graph", " ", 
       RowBox[{"(", 
        RowBox[{"=", 
         RowBox[{
         "1", " ", "in", " ", "a", " ", "subdivided", " ", "population"}]}], 
        ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "is", " ", "the", " ", "mutation", " ", "biais"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]", " ", "is", " ", "the", " ", "mutation", " ", 
       RowBox[{"probability", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Initialize", " ", "the", " ", "QT", " ", "matrix"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], "=", "0"}], ";", 
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], "=."}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"QT", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        SubscriptBox["Q", 
         RowBox[{"i", ",", "j"}]], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QT", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], "=", "1"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       SubscriptBox["Q", 
        RowBox[{"i", ",", "i"}]], "=", " ", "1"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QT", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
        SubscriptBox["Q", 
         RowBox[{"j", ",", "i"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"j", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Because", " ", "Q", " ", "is", " ", "symmetric"}], " ", "*)"}],
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["Q", 
           RowBox[{"i", ",", "j"}]], "\[Equal]", 
          RowBox[{
           FractionBox[
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Mu]"}], ")"}], 
            RowBox[{"2", " ", "graphdegree"}]], 
           RowBox[{"(", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"G", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "j"}], "\[RightDoubleBracket]"}], 
                RowBox[{"QT", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "i"}], "\[RightDoubleBracket]"}]}], "+", 
               RowBox[{
                RowBox[{"G", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "i"}], "\[RightDoubleBracket]"}], 
                RowBox[{"QT", "\[LeftDoubleBracket]", 
                 RowBox[{"l", ",", "j"}], "\[RightDoubleBracket]"}]}]}], ",", 
              
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
            ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sols", "=", 
      RowBox[{"NSolve", "[", 
       RowBox[{"eqs", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"QTs", "=", 
      RowBox[{"QT", "/.", 
       RowBox[{
       "sols", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", "QTs"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7053848697994337`*^9, 3.7053848780155973`*^9}, {
   3.710046771770358*^9, 3.7100467772587967`*^9}, 
   3.710046826103231*^9},ExpressionUUID->"9266974c-2cdf-46b5-8a0e-\
bdfe497dafe5"],

Cell["\<\
This function compares the numerical version to the analytical one, for \
specific graph structures. If the numerical values are the same, we are fine! \
(and we are, otherwise there would not be a paper)\
\>", "Text",
 CellChangeTimes->{{3.7100454323796387`*^9, 3.710045461466309*^9}, {
  3.710045859794882*^9, 
  3.710045869034852*^9}},ExpressionUUID->"0ff33317-199a-435f-923e-\
21d83cbcfcfe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"prs", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CheckQM", "[", 
   RowBox[{"prs_", ",", "dvalues_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NG", ",", "NQin", ",", "NQout", ",", "NQinMatrix"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NG", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<G\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"d", " ", "n"}], "/.", "prs"}], "]"}], "<>", 
          "\"\<generic\>\""}], "]"}], "/.", "dvalues"}], "/.", "prs"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"NQinMatrix", "=", 
      RowBox[{"NGetQM", "[", 
       RowBox[{"NG", ",", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "/.", "prs"}], ",", "1", ",", "0.5", ",", 
        RowBox[{"\[Mu]", "/.", "prs"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NQin", "=", 
      RowBox[{"NQinMatrix", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NQout", "=", 
      RowBox[{"NQinMatrix", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "/.", "prs"}]}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Qin\>\"", ",", "NQin", ",", 
            RowBox[{
             RowBox[{"QinM", "/.", "dvalues"}], "/.", "prs"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Qout\>\"", ",", "NQout", ",", 
            RowBox[{
             RowBox[{"QoutM", "/.", "dvalues"}], "/.", "prs"}]}], "}"}]}], 
         "}"}], "//", "Transpose"}], "//", "MatrixForm"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.705382415477868*^9, 3.7053825416943493`*^9}, {
  3.705382574036092*^9, 3.705382818529418*^9}, {3.710045481283993*^9, 
  3.710045543949483*^9}, {3.710045661117234*^9, 
  3.710045848195723*^9}},ExpressionUUID->"833ab85a-1694-4664-ad79-\
a9c5086559e4"],

Cell["Check for the population of size 12", "Text",
 CellChangeTimes->{{3.710045770824685*^9, 
  3.710045778810508*^9}},ExpressionUUID->"36732b6f-3678-4c17-9bd9-\
1b2febd5c86c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"CheckQM", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}], ",", 
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", 
   "withselfreplacement"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"CheckQM", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}], ",", 
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", "noselfreplacement"}],
   "]"}]}], "Input",
 CellChangeTimes->{{3.705382415477868*^9, 3.7053825416943493`*^9}, {
  3.705382574036092*^9, 3.705382818529418*^9}, {3.710045481283993*^9, 
  3.710045543949483*^9}, {3.710045661117234*^9, 
  3.71004578309207*^9}},ExpressionUUID->"97fee035-5c8d-4062-a6be-\
d2c40ac7f455"],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.4076433121019112`", "0.12738853503184724`"},
     {"0.40764331210191085`", "0.12738853503184713`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.71004580185327*^9, 3.710045818527726*^9}, {
   3.7100458496621733`*^9, 3.710045872175068*^9}, {3.710046804979011*^9, 
   3.7100468303769608`*^9}, 3.710049684959083*^9, 3.7100540248957777`*^9, 
   3.710054497393442*^9, 3.710156942151408*^9, 3.7134073335485477`*^9, 
   3.714227894515362*^9, 3.714231875885293*^9, 3.719552284367371*^9, 
   3.725281760039352*^9},ExpressionUUID->"9ef99fc9-065c-4bea-9722-\
b967fb4fc295"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.5037353255069373`", "0.14087513340448243`"},
     {"0.5037353255069368`", "0.14087513340448238`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.71004580185327*^9, 3.710045818527726*^9}, {
   3.7100458496621733`*^9, 3.710045872175068*^9}, {3.710046804979011*^9, 
   3.7100468303769608`*^9}, 3.710049684959083*^9, 3.7100540248957777`*^9, 
   3.710054497393442*^9, 3.710156942151408*^9, 3.7134073335485477`*^9, 
   3.714227894515362*^9, 3.714231875885293*^9, 3.719552284367371*^9, 
   3.725281760123087*^9},ExpressionUUID->"7e29c7d1-a9b8-46a0-bd27-\
6d2a3804aaf7"]
}, Open  ]]
}, Open  ]],

Cell["Check for the population of size 10", "Text",
 CellChangeTimes->{{3.7100457840799427`*^9, 
  3.710045789765402*^9}},ExpressionUUID->"2cbe3a75-f82b-46d5-9906-\
5ce526438afe"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"CheckQM", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "2"}], ",", 
     RowBox[{"n", "\[Rule]", "5"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", 
   "withselfreplacement"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"CheckQM", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "2"}], ",", 
     RowBox[{"n", "\[Rule]", "5"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", "noselfreplacement"}],
   "]"}]}], "Input",
 CellChangeTimes->{{3.705382415477868*^9, 3.7053825416943493`*^9}, {
  3.705382574036092*^9, 3.705382818529418*^9}, {3.710045481283993*^9, 
  3.710045543949483*^9}, {3.710045661117234*^9, 
  3.71004578309207*^9}},ExpressionUUID->"0ebb094d-2603-4e40-9907-\
8286f19fd2ec"],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.329896907216495`", "0.20618556701030943`"},
     {"0.32989690721649484`", "0.2061855670103093`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.710045737188779*^9, 3.710045790980493*^9}, {
   3.710045822282939*^9, 3.710045873189179*^9}, 3.7100468323201847`*^9, 
   3.710049685041671*^9, 3.71005402499269*^9, 3.710054497489567*^9, 
   3.7101569423007517`*^9, 3.7134073336129847`*^9, 3.7142278946305103`*^9, 
   3.714231876134884*^9, 3.719552284589007*^9, 
   3.7252817602206173`*^9},ExpressionUUID->"95a9337c-2804-4d0d-9a63-\
4241bfa52c97"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.3761996161228409`", "0.2226487523992325`"},
     {"0.3761996161228407`", "0.2226487523992322`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.710045737188779*^9, 3.710045790980493*^9}, {
   3.710045822282939*^9, 3.710045873189179*^9}, 3.7100468323201847`*^9, 
   3.710049685041671*^9, 3.71005402499269*^9, 3.710054497489567*^9, 
   3.7101569423007517`*^9, 3.7134073336129847`*^9, 3.7142278946305103`*^9, 
   3.714231876134884*^9, 3.719552284589007*^9, 
   3.7252817602229424`*^9},ExpressionUUID->"b8a4bdc7-f8ac-4a8b-a2e8-\
8e69e1647339"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Particular cases", "Subsection",
 CellChangeTimes->{{3.7099899437833014`*^9, 
  3.70998994895147*^9}},ExpressionUUID->"24d4d857-dff8-498e-b5d2-\
b2365c110474"],

Cell[CellGroupData[{

Cell["Equations with self replacement (dself = din)", "Subsubsection",
 CellChangeTimes->{{3.699707797145195*^9, 3.699707800750886*^9}, {
  3.699761769703529*^9, 3.699761771556242*^9}, {3.7053818632907352`*^9, 
  3.705381867297986*^9}, {3.705384908592659*^9, 
  3.705384908783701*^9}},ExpressionUUID->"bb12b16f-d17e-4799-b1a4-\
7b2fbced10bd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QinMs", "=", 
  RowBox[{
   RowBox[{"QinM", "/.", "withselfreplacement"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"QoutMs", "=", 
  RowBox[{
   RowBox[{"QoutM", "/.", "withselfreplacement"}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.699707806640571*^9, 3.699707829687098*^9}, {
  3.69979375286362*^9, 
  3.699793753996879*^9}},ExpressionUUID->"5d6b4bfe-a489-4b61-ace3-\
12928ef33758"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"\[Mu]", "-", 
      RowBox[{"d", " ", "\[Mu]"}], "+", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}]}], ")"}]}], 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
    "+", 
    RowBox[{"m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
      ")"}]}]}]]}]], "Output",
 CellChangeTimes->{{3.699707822487941*^9, 3.6997078300797243`*^9}, 
   3.699710623036839*^9, 3.699711328310384*^9, 3.699768644054297*^9, 
   3.6997876439009438`*^9, 3.6997938314317703`*^9, 3.699847452538445*^9, 
   3.699848116650117*^9, 3.699848919649077*^9, 3.699853736709804*^9, 
   3.699955346222619*^9, 3.702201304927656*^9, 3.702289663410713*^9, 
   3.704178948032831*^9, 3.704517704496286*^9, 3.7053818969921217`*^9, 
   3.705387187476713*^9, 3.709989817244776*^9, {3.709990551191963*^9, 
   3.70999055919449*^9}, 3.710045876700582*^9, 3.710049685191901*^9, 
   3.710054025153308*^9, 3.71005449771804*^9, 3.7101569425406923`*^9, 
   3.713407333770465*^9, 3.71422789484529*^9, 3.7142318766498127`*^9, 
   3.719552284852483*^9, 
   3.7252817604303913`*^9},ExpressionUUID->"ce008850-232f-4d97-a0eb-\
e5f0355e1c99"],

Cell[BoxData[
 FractionBox[
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}]}], " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.699707822487941*^9, 3.6997078300797243`*^9}, 
   3.699710623036839*^9, 3.699711328310384*^9, 3.699768644054297*^9, 
   3.6997876439009438`*^9, 3.6997938314317703`*^9, 3.699847452538445*^9, 
   3.699848116650117*^9, 3.699848919649077*^9, 3.699853736709804*^9, 
   3.699955346222619*^9, 3.702201304927656*^9, 3.702289663410713*^9, 
   3.704178948032831*^9, 3.704517704496286*^9, 3.7053818969921217`*^9, 
   3.705387187476713*^9, 3.709989817244776*^9, {3.709990551191963*^9, 
   3.70999055919449*^9}, 3.710045876700582*^9, 3.710049685191901*^9, 
   3.710054025153308*^9, 3.71005449771804*^9, 3.7101569425406923`*^9, 
   3.713407333770465*^9, 3.71422789484529*^9, 3.7142318766498127`*^9, 
   3.719552284852483*^9, 
   3.725281760456345*^9},ExpressionUUID->"85523ebe-01da-4eab-a45f-\
45df7bc0a221"]
}, Open  ]],

Cell["\<\
Simplify the way the equations are written (human - friendly versions), and \
check that the formulas remain correct\
\>", "Text",
 CellChangeTimes->{{3.699761775008071*^9, 3.69976179237366*^9}, {
  3.705381811547044*^9, 3.7053818119865637`*^9}, {3.705381903377886*^9, 
  3.7053819107714367`*^9}},ExpressionUUID->"523ef6d9-cca5-4b81-b192-\
6268a91cfe38"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QinMs", "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", "\[Mu]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "m"}], ")"}]}], "-", "\[Mu]", "+", "m"}], " ", 
       ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}], " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}], 
     ")"}]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6997113031664057`*^9, 3.699711312567246*^9}, {
  3.699711368217142*^9, 
  3.69971148194987*^9}},ExpressionUUID->"4e36d259-056d-4d0d-940d-\
1c772b6c8804"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699711306964435*^9, 3.699711330449128*^9}, {
   3.699711405295108*^9, 3.699711501403634*^9}, 3.699768644077819*^9, 
   3.699787643923314*^9, 3.699793831480157*^9, 3.699847452660646*^9, 
   3.699848116752124*^9, 3.6998489197130423`*^9, 3.699853736916744*^9, 
   3.69995534633053*^9, 3.7022013051187*^9, 3.7022896635798073`*^9, 
   3.7041789480787897`*^9, 3.704517704688941*^9, 3.705381898245832*^9, 
   3.7053871875219584`*^9, 3.709989819509569*^9, {3.709990551224366*^9, 
   3.709990559243415*^9}, 3.71004587800937*^9, 3.710049685228863*^9, 
   3.710054025267234*^9, 3.7100544977550898`*^9, 3.7101569426100616`*^9, 
   3.7134073337992907`*^9, 3.714227894877342*^9, 3.7142318770507183`*^9, 
   3.719552284960434*^9, 
   3.725281760640066*^9},ExpressionUUID->"03e01d3a-1acb-4a79-9a1a-\
d163482e64f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QoutMs", "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}], " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}], 
     ")"}]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.69971150684383*^9, 
  3.699711545927258*^9}},ExpressionUUID->"4828fdf5-3b7e-40cd-a1b2-\
a446737f45de"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699711511809864*^9, 3.699711546280471*^9}, 
   3.699768644102571*^9, 3.6997876439352217`*^9, 3.6997938315034237`*^9, 
   3.699847452770508*^9, 3.699848116860183*^9, 3.699848919721965*^9, 
   3.699853737057955*^9, 3.6999553464342012`*^9, 3.702201305216506*^9, 
   3.70228966369522*^9, 3.704178948091934*^9, 3.704517704726959*^9, 
   3.705381899750991*^9, 3.705387187658793*^9, 3.709989820518887*^9, {
   3.70999055124793*^9, 3.7099905592497807`*^9}, 3.710045879528764*^9, 
   3.710049685258443*^9, 3.710054025301811*^9, 3.71005449782145*^9, 
   3.710156942730199*^9, 3.713407333818192*^9, 3.71422789490689*^9, 
   3.7142318772985497`*^9, 3.719552285249906*^9, 
   3.7252817608493958`*^9},ExpressionUUID->"f4f586e9-9978-44d2-a5b8-\
7d43947ab217"]
}, Open  ]],

Cell["Check limit behavior:", "Text",
 CellChangeTimes->{{3.699761804937606*^9, 3.699761810525722*^9}, 
   3.705381914092618*^9, 
   3.710045889491081*^9},ExpressionUUID->"8fadfc03-e7f1-4ab8-a02b-\
9ce325b12f93"],

Cell["\<\
First infinite population, then zero mutation 
vs.
First zero mutation, then infinite population\
\>", "Text",
 CellChangeTimes->{{3.7100458907978363`*^9, 
  3.710045923323934*^9}},ExpressionUUID->"89a409f1-9061-4b05-a402-\
52d33171b45e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QoutMs", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{
    RowBox[{"Limit", "[", 
     RowBox[{"QoutMs", ",", 
      RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}], ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.699708994901635*^9, 3.699709018760296*^9}, {
  3.705381924595291*^9, 
  3.705381939234544*^9}},ExpressionUUID->"b6078900-99b4-405f-a04f-\
c3a0afc422da"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6997090038532143`*^9, 3.699709012966531*^9}, 
   3.699710624218858*^9, 3.69976864421404*^9, 3.699787644053496*^9, 
   3.699793831590859*^9, 3.699847453243531*^9, 3.699848117304596*^9, 
   3.6998489198823643`*^9, 3.6998537373803596`*^9, 3.699955346792079*^9, 
   3.702201305800952*^9, 3.702289664021549*^9, 3.704178948298765*^9, 
   3.704517704957149*^9, 3.705381940123757*^9, 3.705387187711927*^9, 
   3.7099898222878647`*^9, {3.709990551273045*^9, 3.70999055927314*^9}, 
   3.710045881455665*^9, 3.710045924657275*^9, 3.710049685308382*^9, 
   3.710054025374247*^9, 3.7100544979436417`*^9, 3.710156943119441*^9, 
   3.713407333882366*^9, 3.714227894977618*^9, 3.7142318775416727`*^9, 
   3.719552285449535*^9, 
   3.725281761034088*^9},ExpressionUUID->"09a950b1-1dc1-4f8f-81f6-\
dd7949a50711"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.6997090038532143`*^9, 3.699709012966531*^9}, 
   3.699710624218858*^9, 3.69976864421404*^9, 3.699787644053496*^9, 
   3.699793831590859*^9, 3.699847453243531*^9, 3.699848117304596*^9, 
   3.6998489198823643`*^9, 3.6998537373803596`*^9, 3.699955346792079*^9, 
   3.702201305800952*^9, 3.702289664021549*^9, 3.704178948298765*^9, 
   3.704517704957149*^9, 3.705381940123757*^9, 3.705387187711927*^9, 
   3.7099898222878647`*^9, {3.709990551273045*^9, 3.70999055927314*^9}, 
   3.710045881455665*^9, 3.710045924657275*^9, 3.710049685308382*^9, 
   3.710054025374247*^9, 3.7100544979436417`*^9, 3.710156943119441*^9, 
   3.713407333882366*^9, 3.714227894977618*^9, 3.7142318775416727`*^9, 
   3.719552285449535*^9, 
   3.725281761068346*^9},ExpressionUUID->"04f0eb42-5216-41d6-9da4-\
c823166667ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QinMs", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.699709024470386*^9, 3.699709032489929*^9}, {
   3.7053819512260942`*^9, 3.705381968403285*^9}, 
   3.709989834560059*^9},ExpressionUUID->"f2f8743c-acc1-40d6-8036-\
f02e946653a5"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "1"}], "+", "m", "+", "\[Mu]", "-", 
   RowBox[{"m", " ", "\[Mu]"}]}], 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
   RowBox[{"n", " ", "\[Mu]"}]}]]], "Output",
 CellChangeTimes->{
  3.709989835594761*^9, {3.709990551335326*^9, 3.7099905593324757`*^9}, 
   3.710045882961616*^9, 3.710049685388282*^9, 3.710054025531011*^9, 
   3.7100544980909367`*^9, 3.7101569432513866`*^9, 3.713407333971468*^9, 
   3.714227895078969*^9, 3.7142318778082657`*^9, 3.719552285674273*^9, 
   3.725281761259842*^9},ExpressionUUID->"278f1b7a-f58e-412a-8c8e-\
02a2cdd6603f"],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "-", "m"}], 
  RowBox[{"1", "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.709989835594761*^9, {3.709990551335326*^9, 3.7099905593324757`*^9}, 
   3.710045882961616*^9, 3.710049685388282*^9, 3.710054025531011*^9, 
   3.7100544980909367`*^9, 3.7101569432513866`*^9, 3.713407333971468*^9, 
   3.714227895078969*^9, 3.7142318778082657`*^9, 3.719552285674273*^9, 
   3.725281761284461*^9},ExpressionUUID->"675d03e8-4cd2-4181-99b3-\
e84f1674bb7a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Limit", "[", 
  RowBox[{"QinMs", ",", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"%", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.699709024470386*^9, 3.699709032489929*^9}, {
   3.7053819512260942`*^9, 3.705381968403285*^9}, 
   3.709989834560059*^9},ExpressionUUID->"933e2532-8291-4ba6-aac4-\
4fd7b0a19a07"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.6997090210092278`*^9, 3.69970903277978*^9}, 
   3.69971062653979*^9, 3.6997686442727537`*^9, 3.6997876441319523`*^9, 
   3.699793831695056*^9, 3.6998474533978977`*^9, 3.699848117481538*^9, 
   3.699848919995821*^9, 3.699853737514176*^9, 3.699955347039455*^9, 
   3.7022013059393*^9, 3.702289664091626*^9, 3.704178948396358*^9, 
   3.704517705179842*^9, {3.70538195535952*^9, 3.705381969324675*^9}, 
   3.7053871878032713`*^9, {3.7099898250017147`*^9, 3.709989836762285*^9}, {
   3.709990551370511*^9, 3.7099905593424892`*^9}, 3.710045884479703*^9, 
   3.7100496854278107`*^9, 3.710054025571554*^9, 3.710054498173779*^9, 
   3.7101569434079103`*^9, 3.713407334009355*^9, 3.71422789515598*^9, 
   3.7142318781002607`*^9, 3.7195522857231283`*^9, 
   3.725281761393711*^9},ExpressionUUID->"7426e49e-2fab-4d86-aae7-\
049cf0499436"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.6997090210092278`*^9, 3.69970903277978*^9}, 
   3.69971062653979*^9, 3.6997686442727537`*^9, 3.6997876441319523`*^9, 
   3.699793831695056*^9, 3.6998474533978977`*^9, 3.699848117481538*^9, 
   3.699848919995821*^9, 3.699853737514176*^9, 3.699955347039455*^9, 
   3.7022013059393*^9, 3.702289664091626*^9, 3.704178948396358*^9, 
   3.704517705179842*^9, {3.70538195535952*^9, 3.705381969324675*^9}, 
   3.7053871878032713`*^9, {3.7099898250017147`*^9, 3.709989836762285*^9}, {
   3.709990551370511*^9, 3.7099905593424892`*^9}, 3.710045884479703*^9, 
   3.7100496854278107`*^9, 3.710054025571554*^9, 3.710054498173779*^9, 
   3.7101569434079103`*^9, 3.713407334009355*^9, 3.71422789515598*^9, 
   3.7142318781002607`*^9, 3.7195522857231283`*^9, 
   3.7252817613951073`*^9},ExpressionUUID->"8afd94e1-98ca-4133-97f9-\
b6ffc00f95ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{"QinMs", ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.699709522250888*^9, 
  3.6997095278721046`*^9}},ExpressionUUID->"2ce9b3ea-5ac8-47ee-9c3f-\
8fbd912e8032"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "-", 
   RowBox[{"d", " ", "n", " ", "\[Mu]"}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Mu]", "]"}], "2"],
    SeriesData[$CellContext`\[Mu], 0, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Mu], 0, {1, (-$CellContext`d) $CellContext`n}, 0, 
   2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.699709528137528*^9, 3.699710628816844*^9, 3.699768644340559*^9, 
   3.6997876442139177`*^9, 3.699793831783923*^9, 3.699847453618741*^9, 
   3.6998481177477207`*^9, 3.6998489201632957`*^9, 3.699853737777616*^9, 
   3.699955347297236*^9, 3.702201306310264*^9, 3.702289664332473*^9, 
   3.704178948535757*^9, 3.7045177056573*^9, 3.7053819754795647`*^9, 
   3.7053871878887367`*^9, 3.709989838511971*^9, {3.709990551394704*^9, 
   3.709990559363714*^9}, 3.710045885750225*^9, 3.710049685460968*^9, 
   3.7100540255983458`*^9, 3.710054498245143*^9, 3.710156943564168*^9, 
   3.713407334032131*^9, 3.7142278952644043`*^9, 3.714231878425647*^9, 
   3.719552285921775*^9, 
   3.725281761537408*^9},ExpressionUUID->"ff79bf8e-fe06-4876-b393-\
ffc7a4cdab13"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations without Self - replacement (dself = 0)", "Subsubsection",
 CellChangeTimes->{{3.699711579833871*^9, 3.699711584927043*^9}, {
  3.699761821670733*^9, 3.699761827557994*^9}, {3.7053849023043747`*^9, 
  3.70538490546406*^9}},ExpressionUUID->"e631c25b-d551-4b5d-ba21-\
833e17cbadcd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QinMw", "=", 
  RowBox[{
   RowBox[{"QinM", "/.", "noselfreplacement"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"QoutMw", "=", 
  RowBox[{
   RowBox[{"QoutM", "/.", "noselfreplacement"}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.699711592836095*^9, 3.699711601325761*^9}, {
  3.699793767821855*^9, 
  3.699793768748652*^9}},ExpressionUUID->"d87d31c7-932b-4d4a-bd18-\
e8106597c46c"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["m", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]"}], "+", 
     
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{"n", "-", 
        RowBox[{"d", " ", "n", " ", "\[Mu]"}]}], ")"}]}]}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["m", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   RowBox[{"m", " ", "n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.6997116019468412`*^9, 3.699768644533671*^9, 3.699787644417185*^9, 
   3.69979383204049*^9, 3.699847454036537*^9, 3.6998481181339483`*^9, 
   3.699848920540834*^9, 3.699853738101304*^9, 3.6999553475849333`*^9, 
   3.702201306731875*^9, 3.7022896646408653`*^9, 3.704178948882905*^9, 
   3.7045177059345617`*^9, 3.705382083512805*^9, 3.7053871881299458`*^9, 
   3.709989869429002*^9, {3.7099905516280603`*^9, 3.7099905595853243`*^9}, 
   3.710046272076508*^9, 3.710049685721094*^9, 3.710054025887533*^9, 
   3.710054498606215*^9, 3.710156943880591*^9, 3.713407334292684*^9, 
   3.7142278955827703`*^9, 3.714231878910118*^9, 3.7195522863404503`*^9, 
   3.725281761883873*^9},ExpressionUUID->"6bebd342-45b8-4377-9482-\
d71c25889724"],

Cell[BoxData[
 FractionBox[
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{"n", "+", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", "\[Mu]"}], ")"}], 
   " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["m", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
   "+", 
   RowBox[{"m", " ", "n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
     ")"}]}]}]]], "Output",
 CellChangeTimes->{
  3.6997116019468412`*^9, 3.699768644533671*^9, 3.699787644417185*^9, 
   3.69979383204049*^9, 3.699847454036537*^9, 3.6998481181339483`*^9, 
   3.699848920540834*^9, 3.699853738101304*^9, 3.6999553475849333`*^9, 
   3.702201306731875*^9, 3.7022896646408653`*^9, 3.704178948882905*^9, 
   3.7045177059345617`*^9, 3.705382083512805*^9, 3.7053871881299458`*^9, 
   3.709989869429002*^9, {3.7099905516280603`*^9, 3.7099905595853243`*^9}, 
   3.710046272076508*^9, 3.710049685721094*^9, 3.710054025887533*^9, 
   3.710054498606215*^9, 3.710156943880591*^9, 3.713407334292684*^9, 
   3.7142278955827703`*^9, 3.714231878910118*^9, 3.7195522863404503`*^9, 
   3.725281761908807*^9},ExpressionUUID->"2ea9899a-3c7a-413c-9cd6-\
72894a078b89"]
}, Open  ]],

Cell["Simplify the way they are written", "Text",
 CellChangeTimes->{{3.699761833396513*^9, 
  3.6997618399413424`*^9}},ExpressionUUID->"10b274e4-bfdc-4fd9-896d-\
0cdb0c88ad5a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QinMw", "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", "n", " ", "\[Mu]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "m"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "-", "\[Mu]"}], ")"}], " ", "n"}], "-", 
        RowBox[{
         SuperscriptBox["m", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"+", 
        RowBox[{"(", 
         RowBox[{"d", "-", "1"}], ")"}]}], " ", "n", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
      RowBox[{"m", " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]}], ")"}]}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699711609067724*^9, 3.699711686309361*^9}, {
  3.699711723919117*^9, 3.699711751542611*^9}, {3.699711797895731*^9, 
  3.699711864734956*^9}},ExpressionUUID->"08ad0c2a-7ee7-4bc1-93a5-\
8c7dc2931f5e"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.699711686662211*^9, 3.699711751870494*^9, {3.699711816592347*^9, 
   3.699711865845346*^9}, 3.699768644600362*^9, 3.699787644466792*^9, 
   3.699793832110257*^9, 3.699847454256627*^9, 3.699848118360941*^9, 
   3.699848920677671*^9, 3.6998537381867332`*^9, 3.6999553476635313`*^9, 
   3.7022013069615297`*^9, 3.702289664866558*^9, 3.704178948975071*^9, 
   3.704517706039962*^9, 3.705382086381508*^9, 3.7053871881938877`*^9, 
   3.709989870934738*^9, {3.70999055167981*^9, 3.7099905596367064`*^9}, 
   3.7100462735697193`*^9, 3.710049685793274*^9, 3.7100540259570208`*^9, 
   3.71005449868565*^9, 3.710156944157042*^9, 3.713407334372147*^9, 
   3.714227895716914*^9, 3.714231879301087*^9, 3.719552286656837*^9, 
   3.7252817621743193`*^9},ExpressionUUID->"7f1d6789-fa0f-43fe-8b56-\
d5f51c6294ca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QoutMw", "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{"n", "+", 
        RowBox[{"m", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", "\[Mu]"}], ")"}],
       " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"+", 
        RowBox[{"(", 
         RowBox[{"d", "-", "1"}], ")"}]}], " ", "n", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "+", 
      RowBox[{"m", " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]}], ")"}]}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699711882991263*^9, 
  3.6997119306666183`*^9}},ExpressionUUID->"40b4c263-cab8-4165-aa08-\
45b10681f5a4"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699711887715342*^9, 3.699711931186315*^9}, 
   3.6997119658647413`*^9, 3.6997686446717653`*^9, 3.699787644491955*^9, 
   3.699793832136303*^9, 3.699847454363967*^9, 3.699848118497181*^9, 
   3.6998489207195683`*^9, 3.699853738308305*^9, 3.6999553477646217`*^9, 
   3.702201307137039*^9, 3.702289664955021*^9, 3.704178949023452*^9, 
   3.704517706089518*^9, 3.705382087722787*^9, 3.705387188283839*^9, 
   3.709989872699587*^9, {3.709990551701099*^9, 3.709990559655723*^9}, 
   3.710046275025535*^9, 3.710049685833633*^9, 3.71005402599236*^9, 
   3.71005449875325*^9, 3.710156944268029*^9, 3.7134073343879757`*^9, 
   3.714227895760038*^9, 3.714231879589013*^9, 3.7195522868520193`*^9, 
   3.725281762277856*^9},ExpressionUUID->"b15ce35d-4db5-4a4c-87dd-\
a6878ae3e86a"]
}, Open  ]],

Cell["Limit behavior", "Text",
 CellChangeTimes->{{3.699761843004692*^9, 
  3.699761846775701*^9}},ExpressionUUID->"f5bce0a3-3c46-4232-b5c6-\
bce11ef0497c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QinMw", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"%", ",", 
    RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.699712140320222*^9, 3.699712144381168*^9}, {
  3.705382091882864*^9, 
  3.705382102661297*^9}},ExpressionUUID->"ab33bfc0-b503-40f7-9630-\
98682384510e"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "1"}], "+", "m", "+", "\[Mu]", "-", 
   RowBox[{"m", " ", "\[Mu]"}]}], 
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}]]], "Output",
 CellChangeTimes->{{3.699712141760172*^9, 3.6997121446551123`*^9}, 
   3.69976864475666*^9, 3.6997876445813713`*^9, 3.69979383222227*^9, 
   3.6998474545895653`*^9, 3.699848118748927*^9, 3.69984892083706*^9, 
   3.6998537385996017`*^9, 3.6999553479241657`*^9, 3.7022013074046917`*^9, 
   3.70228966515206*^9, 3.704178949211241*^9, 3.7045177062678623`*^9, {
   3.705382089870524*^9, 3.7053821029634037`*^9}, 3.70538718836833*^9, 
   3.709989873812937*^9, {3.709990551762856*^9, 3.709990559711013*^9}, 
   3.710046276126759*^9, 3.710049685955085*^9, 3.710054026077231*^9, 
   3.710054498920992*^9, 3.710156944554285*^9, 3.713407334488763*^9, 
   3.714227895975457*^9, 3.714231879864925*^9, 3.7195522870377293`*^9, 
   3.725281762487653*^9},ExpressionUUID->"8913644b-d45e-4eda-b892-\
243e6e3631ca"],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "-", "m"}], 
  RowBox[{"1", "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "n"}], ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.699712141760172*^9, 3.6997121446551123`*^9}, 
   3.69976864475666*^9, 3.6997876445813713`*^9, 3.69979383222227*^9, 
   3.6998474545895653`*^9, 3.699848118748927*^9, 3.69984892083706*^9, 
   3.6998537385996017`*^9, 3.6999553479241657`*^9, 3.7022013074046917`*^9, 
   3.70228966515206*^9, 3.704178949211241*^9, 3.7045177062678623`*^9, {
   3.705382089870524*^9, 3.7053821029634037`*^9}, 3.70538718836833*^9, 
   3.709989873812937*^9, {3.709990551762856*^9, 3.709990559711013*^9}, 
   3.710046276126759*^9, 3.710049685955085*^9, 3.710054026077231*^9, 
   3.710054498920992*^9, 3.710156944554285*^9, 3.713407334488763*^9, 
   3.714227895975457*^9, 3.714231879864925*^9, 3.7195522870377293`*^9, 
   3.725281762562916*^9},ExpressionUUID->"2eec4a2a-a9f1-4b10-9906-\
03a1e01fc51f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Limit", "[", 
  RowBox[{"QoutMw", ",", 
   RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Limit", "[", 
  RowBox[{"QoutMw", ",", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.699712130826983*^9, 3.699712135993896*^9}, {
  3.705382111666535*^9, 
  3.7053821152416763`*^9}},ExpressionUUID->"bb04212e-b715-45c1-9159-\
6c831c019ce9"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.699712136340899*^9, 3.6997686447847843`*^9, 3.699787644605831*^9, 
   3.6997938322542067`*^9, 3.699847454702386*^9, 3.699848118809474*^9, 
   3.699848920892647*^9, 3.699853738738146*^9, 3.699955348164055*^9, 
   3.702201307497787*^9, 3.702289665309238*^9, 3.7041789492668447`*^9, 
   3.704517706398435*^9, 3.705382115731319*^9, 3.705387188430135*^9, 
   3.7099898750301332`*^9, {3.709990551842244*^9, 3.709990559739213*^9}, 
   3.7100462777802267`*^9, 3.710049686036673*^9, 3.710054026183473*^9, 
   3.7100544990007257`*^9, 3.710156944790821*^9, 3.7134073345463943`*^9, 
   3.7142278960319147`*^9, 3.714231880161955*^9, 3.719552287166959*^9, 
   3.725281762629561*^9},ExpressionUUID->"7f97df8f-a011-4072-9ffd-\
2cc7a8c01c96"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.699712136340899*^9, 3.6997686447847843`*^9, 3.699787644605831*^9, 
   3.6997938322542067`*^9, 3.699847454702386*^9, 3.699848118809474*^9, 
   3.699848920892647*^9, 3.699853738738146*^9, 3.699955348164055*^9, 
   3.702201307497787*^9, 3.702289665309238*^9, 3.7041789492668447`*^9, 
   3.704517706398435*^9, 3.705382115731319*^9, 3.705387188430135*^9, 
   3.7099898750301332`*^9, {3.709990551842244*^9, 3.709990559739213*^9}, 
   3.7100462777802267`*^9, 3.710049686036673*^9, 3.710054026183473*^9, 
   3.7100544990007257`*^9, 3.710156944790821*^9, 3.7134073345463943`*^9, 
   3.7142278960319147`*^9, 3.714231880161955*^9, 3.719552287166959*^9, 
   3.725281762661831*^9},ExpressionUUID->"183c580c-01e8-41b5-8b3e-\
0378c8e9962b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wright - Fisher", "Section",
 CellChangeTimes->{{3.698755041677388*^9, 
  3.698755047045236*^9}},ExpressionUUID->"45cb321f-1f12-4fe0-8b4e-\
7c5bd227a874"],

Cell["\<\
The structure of this part is the same as for the Moran version above, so \
comments are lighter here.\
\>", "Text",
 CellChangeTimes->{{3.7100462860792913`*^9, 
  3.710046305307435*^9}},ExpressionUUID->"43cad485-b08f-469d-96f5-\
2c4f647c6cba"],

Cell[CellGroupData[{

Cell["Simplify QinM and QoutM", "Subsection",
 CellChangeTimes->{{3.7053925967093763`*^9, 
  3.705392598368638*^9}},ExpressionUUID->"deb3106d-6256-41a9-bef5-\
7007af796eef"],

Cell["\<\
See Appendix B2 for details on how Qself, Qin and Qout were obtained using a \
formula presented in the appendix of Debarre 2017 JTB for \"2D graphs\".\
\>", "Text",
 CellChangeTimes->{{3.7053850217373037`*^9, 
  3.705385024128645*^9}},ExpressionUUID->"2a8b2f98-e230-49ac-84ee-\
ff25d9a506d4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"QselfWF2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", " ", "-", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"dself", "-", "din"}], ")"}], "2"]}]}]], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "d"}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "m", "-", 
             FractionBox["m", 
              RowBox[{"d", "-", "1"}]]}], ")"}], "2"]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QinWF2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", " ", "-", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]], "-", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"dself", "-", "din"}], ")"}], "2"]}]}]], "d"}], "+", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "m", "-", 
             FractionBox["m", 
              RowBox[{"d", "-", "1"}]]}], ")"}], "2"]}]}]], 
       RowBox[{"(", 
        RowBox[{"d", "-", "1"}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QoutWF2", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"\[Mu]", " ", "\[Lambda]"}], 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"1", " ", "-", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]], "-", 
      FractionBox["1", 
       RowBox[{"1", "-", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "m", "-", 
            FractionBox["m", 
             RowBox[{"d", "-", "1"}]]}], ")"}], "2"]}]}]]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6997135185821047`*^9, 3.699713651029313*^9}, {
  3.699793796275002*^9, 3.6997938023562527`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"623e9932-1227-43ed-bb05-f96e18b6a1cf"],

Cell["Find \[Lambda] using Qself == 1", "Text",
 CellChangeTimes->{{3.699768554735057*^9, 
  3.699768560789783*^9}},ExpressionUUID->"9f9e80a1-2cf1-4d09-af3e-\
3795f57f37f0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Lambda]WF", "=", 
  RowBox[{"\[Lambda]", "/.", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"QselfWF2", "\[Equal]", "1"}], ",", "\[Lambda]"}], "]"}], 
    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}]], "Input",
 CellChangeTimes->{{3.6997136534525347`*^9, 3.699713667340845*^9}, 
   3.699793805199163*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"8a6bc569-74d9-4f30-89c5-f265f4b659a9"],

Cell[BoxData[
 FractionBox[
  RowBox[{"d", " ", "n"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"1", "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]], "+", 
     FractionBox[
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
      RowBox[{"1", "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "din"}], "+", "dself"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]}]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], 
      RowBox[{"1", "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "m", "-", 
           FractionBox["m", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "d"}]]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}]}]]}], ")"}], " ", 
   "\[Mu]"}]]], "Output",
 CellChangeTimes->{{3.699713663992773*^9, 3.699713667644438*^9}, 
   3.6997686498867693`*^9, 3.699787648892887*^9, 3.699793840904955*^9, 
   3.699847462821162*^9, 3.699848127086094*^9, 3.699848944043481*^9, 
   3.699853745219801*^9, 3.699955353774413*^9, 3.702201314357094*^9, 
   3.702289671887183*^9, 3.7041789574015827`*^9, 3.704517713153195*^9, 
   3.705382208155657*^9, 3.705387188496587*^9, 3.709989880379635*^9, 
   3.7099905519487133`*^9, 3.710046310259514*^9, 3.710049686132474*^9, 
   3.7100540298370333`*^9, 3.7100544991556787`*^9, 3.710156945301324*^9, 
   3.7134073346076727`*^9, 3.714227896228875*^9, 3.714231880543619*^9, 
   3.71955228741881*^9, 3.7252817628433*^9, 3.776138399124461*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"7dafd0cc-9e23-460f-988b-e0382536f428"]
}, Open  ]],

Cell["Replace \[Lambda] in the equations", "Text",
 CellChangeTimes->{{3.699768563135151*^9, 
  3.699768568700657*^9}},ExpressionUUID->"6abd8736-161b-4eaa-ab36-\
fed661a76cca"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QinWF", "=", 
  RowBox[{
   RowBox[{"QinWF2", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", "\[Lambda]WF"}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"QoutWF", "=", 
  RowBox[{
   RowBox[{"QoutWF2", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", "\[Lambda]WF"}]}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.699713671535714*^9, 3.699713691587577*^9}, {
  3.699793806834413*^9, 3.6997938110520763`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"51151e49-a98d-4f8f-9bd4-f6cbb2da9ed4"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox["d", 
     RowBox[{"1", "-", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"din", "-", "dself"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}]}]]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
    RowBox[{"1", "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"din", "-", "dself"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.699713678348674*^9, 3.699713692055463*^9}, 
   3.6997686513293247`*^9, 3.699787650296679*^9, 3.699793842625929*^9, 
   3.699847464903398*^9, 3.699848129275997*^9, 3.699848946322311*^9, 
   3.69985374668642*^9, 3.6999553552201347`*^9, 3.702201315969821*^9, 
   3.7022896737779007`*^9, 3.7041789595883904`*^9, 3.704517714606336*^9, 
   3.705382210606203*^9, 3.705387190408545*^9, 3.709989882981759*^9, 
   3.709990553462431*^9, 3.710046313245983*^9, 3.7100496882054787`*^9, 
   3.71005403169142*^9, 3.710054501055789*^9, 3.7101569472870493`*^9, 
   3.7134073368716087`*^9, 3.714227898289114*^9, 3.714231881935482*^9, 
   3.719552289479233*^9, 3.7252817646134987`*^9, 3.776138401044373*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"7f568f30-63fd-422c-ba96-f660d0f43279"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
    RowBox[{"1", "-", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"din", "-", "dself"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.699713678348674*^9, 3.699713692055463*^9}, 
   3.6997686513293247`*^9, 3.699787650296679*^9, 3.699793842625929*^9, 
   3.699847464903398*^9, 3.699848129275997*^9, 3.699848946322311*^9, 
   3.69985374668642*^9, 3.6999553552201347`*^9, 3.702201315969821*^9, 
   3.7022896737779007`*^9, 3.7041789595883904`*^9, 3.704517714606336*^9, 
   3.705382210606203*^9, 3.705387190408545*^9, 3.709989882981759*^9, 
   3.709990553462431*^9, 3.710046313245983*^9, 3.7100496882054787`*^9, 
   3.71005403169142*^9, 3.710054501055789*^9, 3.7101569472870493`*^9, 
   3.7134073368716087`*^9, 3.714227898289114*^9, 3.714231881935482*^9, 
   3.719552289479233*^9, 3.7252817646134987`*^9, 3.7761384013487263`*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"abd67fed-ae1b-477e-968f-c7601276c078"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check numerically", "Subsection",
 CellChangeTimes->{{3.705383839778914*^9, 
  3.7053838430531073`*^9}},ExpressionUUID->"1993159a-eb46-485a-a246-\
9f33280bdef0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NGetQWF", "[", 
   RowBox[{
   "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "p_", ",", 
    "\[Mu]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"QT", ",", "eqs", ",", "vars", ",", "sols", ",", "QTs"}], "}"}], 
    ",", 
    RowBox[{"(*", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"G", " ", "is", " ", "the", " ", "dispersal", " ", "graph"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
      "\[CapitalNu]", " ", "is", " ", "the", " ", "size", " ", "of", " ", 
       "the", " ", "population"}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "graphdegree", " ", "is", " ", "the", " ", "degree", " ", "of", " ", 
       "the", " ", "graph", " ", 
       RowBox[{"(", 
        RowBox[{"=", 
         RowBox[{"1", " ", "in", " ", "a", " ", "subdivided", " ", "pop"}]}], 
        ")"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"p", " ", "is", " ", "the", " ", "mutation", " ", "biais"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"\[Mu]", " ", "is", " ", "the", " ", "mutation", " ", 
       RowBox[{"probability", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Initialize", " ", "the", " ", "QT", " ", "matrix"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], "=", "0"}], ";", 
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], "=."}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"QT", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        SubscriptBox["Q", 
         RowBox[{"i", ",", "j"}]], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QT", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}], "=", "1"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       SubscriptBox["Q", 
        RowBox[{"i", ",", "i"}]], "=", "1"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"QT", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
        SubscriptBox["Q", 
         RowBox[{"j", ",", "i"}]]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"j", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], ";", 
     " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Because", " ", "Q", " ", "is", " ", "symmetric"}], " ", "*)"}],
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["Q", 
           RowBox[{"i", ",", "j"}]], "\[Equal]", 
          RowBox[{
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"], 
            SuperscriptBox["graphdegree", "2"]], 
           RowBox[{"(", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"G", "\[LeftDoubleBracket]", 
                RowBox[{"l", ",", "j"}], "\[RightDoubleBracket]"}], 
               RowBox[{"G", "\[LeftDoubleBracket]", 
                RowBox[{"k", ",", "i"}], "\[RightDoubleBracket]"}], 
               RowBox[{"QT", "\[LeftDoubleBracket]", 
                RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
            ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         SubscriptBox["Q", 
          RowBox[{"i", ",", "j"}]], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"\[CapitalNu]", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}], ",", "\[CapitalNu]"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sols", "=", 
      RowBox[{"NSolve", "[", 
       RowBox[{"eqs", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"QTs", "=", 
      RowBox[{"QT", "/.", 
       RowBox[{
       "sols", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
     ";", "\[IndentingNewLine]", "QTs"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.710046837714695*^9, 3.710046841508738*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"3137111d-c1a0-443f-b244-270f8d06f6d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"prs", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CheckQWF", "[", 
   RowBox[{"prs_", ",", "dvalues_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"NG", ",", "NQin", ",", "NQout", ",", "NQinMatrix"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NG", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"\"\<G\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{
            RowBox[{"d", " ", "n"}], "/.", "prs"}], "]"}], "<>", 
          "\"\<generic\>\""}], "]"}], "/.", "dvalues"}], "/.", "prs"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"NQinMatrix", "=", 
      RowBox[{"NGetQWF", "[", 
       RowBox[{"NG", ",", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "/.", "prs"}], ",", "1", ",", "0.5", ",", 
        RowBox[{"\[Mu]", "/.", "prs"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NQin", "=", 
      RowBox[{"NQinMatrix", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NQout", "=", 
      RowBox[{"NQinMatrix", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "/.", "prs"}]}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<Qin\>\"", ",", "NQin", ",", 
            RowBox[{
             RowBox[{"QinWF", "/.", "dvalues"}], "/.", "prs"}]}], "}"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"\"\<Qout\>\"", ",", "NQout", ",", 
            RowBox[{
             RowBox[{"QoutWF", "/.", "dvalues"}], "/.", "prs"}]}], "}"}]}], 
         "}"}], "//", "Transpose"}], "//", "MatrixForm"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.705383847090728*^9, 3.705383857404091*^9}, {
  3.7053838996520348`*^9, 3.7053839022914953`*^9}, {3.710046333220248*^9, 
  3.71004636876978*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"8f985415-98e0-459c-a217-e2567961fd1a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"CheckQWF", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}], ",", 
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", 
   "withselfreplacement"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"CheckQWF", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}], ",", 
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", "noselfreplacement"}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"CheckQWF", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "2"}], ",", 
     RowBox[{"n", "\[Rule]", "5"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", 
   "withselfreplacement"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"CheckQWF", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"m", "\[Rule]", "0.2"}], ",", 
     RowBox[{"d", "\[Rule]", "2"}], ",", 
     RowBox[{"n", "\[Rule]", "5"}], ",", 
     RowBox[{"\[Mu]", "\[Rule]", "0.2"}]}], "}"}], ",", "noselfreplacement"}],
   "]"}]}], "Input",
 CellChangeTimes->{{3.705383847090728*^9, 3.705383857404091*^9}, {
  3.7053838996520348`*^9, 3.7053839022914953`*^9}, {3.710046333220248*^9, 
  3.710046381231841*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"79e06577-18f7-4966-9436-c8d37da2e9c5"],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.21835246847214482`", "0.08161535624318243`"},
     {"0.21835246847214485`", "0.08161535624318234`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.70538389339319*^9, 3.705383903192623*^9}, 
   3.7053871909954557`*^9, 3.7099898974331007`*^9, 3.709990553945369*^9, 
   3.71004631687917*^9, {3.710046356579269*^9, 3.710046381920025*^9}, 
   3.7100468461683073`*^9, 3.710049688721513*^9, 3.710054032116688*^9, 
   3.710054501687112*^9, 3.710156948167297*^9, 3.71340733740383*^9, 
   3.714227899137577*^9, 3.714231882825202*^9, 3.7195522902034817`*^9, 
   3.725281765256771*^9, 3.7761384051192493`*^9},
 CellLabel->
  "During evaluation of \
In[31]:=",ExpressionUUID->"fadc17a0-d717-436c-902d-e18bcccbcc8b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.17804414067103275`", "0.07703574013905495`"},
     {"0.17804414067103244`", "0.07703574013905486`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.70538389339319*^9, 3.705383903192623*^9}, 
   3.7053871909954557`*^9, 3.7099898974331007`*^9, 3.709990553945369*^9, 
   3.71004631687917*^9, {3.710046356579269*^9, 3.710046381920025*^9}, 
   3.7100468461683073`*^9, 3.710049688721513*^9, 3.710054032116688*^9, 
   3.710054501687112*^9, 3.710156948167297*^9, 3.71340733740383*^9, 
   3.714227899137577*^9, 3.714231882825202*^9, 3.7195522902034817`*^9, 
   3.725281765256771*^9, 3.776138405215798*^9},
 CellLabel->
  "During evaluation of \
In[31]:=",ExpressionUUID->"7aef8af9-a2f6-41ca-a96e-46d9d927550d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.171990359970927`", "0.1224130675949659`"},
     {"0.17199035997092688`", "0.12241306759496573`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.70538389339319*^9, 3.705383903192623*^9}, 
   3.7053871909954557`*^9, 3.7099898974331007`*^9, 3.709990553945369*^9, 
   3.71004631687917*^9, {3.710046356579269*^9, 3.710046381920025*^9}, 
   3.7100468461683073`*^9, 3.710049688721513*^9, 3.710054032116688*^9, 
   3.710054501687112*^9, 3.710156948167297*^9, 3.71340733740383*^9, 
   3.714227899137577*^9, 3.714231882825202*^9, 3.7195522902034817`*^9, 
   3.725281765256771*^9, 3.776138405265482*^9},
 CellLabel->
  "During evaluation of \
In[31]:=",ExpressionUUID->"bdadaa14-c6f4-4acb-9cbd-ffc6b8fbc2b5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\<\"Qin\"\>", "\<\"Qout\"\>"},
     {"0.16477201691061744`", "0.12031913465055881`"},
     {"0.16477201691061727`", "0.12031913465055864`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{{3.70538389339319*^9, 3.705383903192623*^9}, 
   3.7053871909954557`*^9, 3.7099898974331007`*^9, 3.709990553945369*^9, 
   3.71004631687917*^9, {3.710046356579269*^9, 3.710046381920025*^9}, 
   3.7100468461683073`*^9, 3.710049688721513*^9, 3.710054032116688*^9, 
   3.710054501687112*^9, 3.710156948167297*^9, 3.71340733740383*^9, 
   3.714227899137577*^9, 3.714231882825202*^9, 3.7195522902034817`*^9, 
   3.725281765256771*^9, 3.776138405313829*^9},
 CellLabel->
  "During evaluation of \
In[31]:=",ExpressionUUID->"b081842e-1be4-41a9-ac6b-8f8cc5815423"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Particular cases", "Subsection",
 CellChangeTimes->{{3.7099899437833014`*^9, 
  3.70998994895147*^9}},ExpressionUUID->"f1f99cf2-d724-42f5-9ad9-\
be3f8d2f6166"],

Cell[CellGroupData[{

Cell["With Self Replacement", "Subsubsection",
 CellChangeTimes->{{3.699713697718473*^9, 
  3.699713702474758*^9}},ExpressionUUID->"9fb96309-336f-41e9-83d9-\
888dcb0f7f11"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QinWFs", "=", 
  RowBox[{
   RowBox[{"QinWF", "/.", "withselfreplacement"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699713715219798*^9, 3.699713729121462*^9}, 
   3.6997938139913893`*^9},
 CellLabel->"In[35]:=",ExpressionUUID->"00e67089-4a4e-4e09-87d6-70babe3da5fe"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "d"}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.6997137205942917`*^9, 3.6997137296346273`*^9}, 
   3.6997686517538443`*^9, 3.6997876505973454`*^9, 3.699793843963087*^9, 
   3.699847465465046*^9, 3.69984812985738*^9, 3.699848946767274*^9, 
   3.699853747064089*^9, 3.699955355684174*^9, 3.702201316414547*^9, 
   3.7022896743934183`*^9, 3.7041789601167593`*^9, 3.704517715073738*^9, 
   3.705382211114374*^9, 3.705387191365016*^9, 3.709989902727758*^9, 
   3.709990554071863*^9, 3.710046388215872*^9, 3.710049689182773*^9, 
   3.7100540325722713`*^9, 3.7100545020664988`*^9, 3.710156948694996*^9, 
   3.713407337873167*^9, 3.714227899635427*^9, 3.714231883509173*^9, 
   3.719552290618723*^9, 3.725281765604205*^9, 3.776138414073759*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"5b4ae1cb-d7bb-4489-9021-59fff99378bb"]
}, Open  ]],

Cell["Simplify the way it is written", "Text",
 CellChangeTimes->{{3.710046422562079*^9, 
  3.710046428585051*^9}},ExpressionUUID->"6f34ef66-7cc1-412a-87c3-\
9957ac8b7d6b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M1", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"M2", "=", 
    FractionBox["1", 
     RowBox[{
      RowBox[{"2", " ", "\[Mu]"}], "-", 
      SuperscriptBox["\[Mu]", "2"]}]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qinwfs", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "d"}], " ", "+", " ", "M1", "+", "M2"}], 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}], "d"}], "+", "M1", "+", "M2"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QinWFs", " ", "-", " ", "qinwfs"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.704715667696094*^9, 3.70471569325393*^9}, {
  3.71004644570728*^9, 3.710046446146241*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"e388a2c2-3f3a-41bc-9878-4b01b6a22bbb"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.710046446538151*^9, 3.7100496892133427`*^9, 
  3.710054032601166*^9, 3.710054502132368*^9, 3.7101569488466187`*^9, 
  3.7134073378947353`*^9, 3.714227899670794*^9, 3.714231883812028*^9, 
  3.7195522908015413`*^9, 3.725281765719616*^9, 3.776138414124854*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"d252a045-95a2-4a12-9fdc-2a76d555073a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QoutWFs", "=", 
  RowBox[{
   RowBox[{"QoutWF", "/.", "withselfreplacement"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.69971376959558*^9, 3.699713781778393*^9}, 
   3.699793816389996*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"81a1d3f1-d095-43ee-8e2d-3e2f20421e10"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{3.699713782107119*^9, 3.6997686518296843`*^9, 
  3.699787650721113*^9, 3.699793844171132*^9, 3.699847465709929*^9, 
  3.699848130119707*^9, 3.699848946820631*^9, 3.69985374730326*^9, 
  3.6999553558645163`*^9, 3.702201316667905*^9, 3.702289674700729*^9, 
  3.7041789602895823`*^9, 3.704517715379057*^9, 3.7053822164241*^9, 
  3.7053871914895887`*^9, 3.70998990368915*^9, 3.70999055422438*^9, 
  3.710046389301339*^9, 3.710049689296924*^9, 3.710054032672058*^9, 
  3.710054502279993*^9, 3.710156949101604*^9, 3.713407337961378*^9, 
  3.714227899740139*^9, 3.714231884109681*^9, 3.719552291071203*^9, 
  3.7252817658691263`*^9, 3.776138414168888*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"d7c63554-cc84-44d9-a384-9a4bd0226066"]
}, Open  ]],

Cell["Simplify the way it is written", "Text",
 CellChangeTimes->{{3.7100464596730213`*^9, 
  3.710046464870203*^9}},ExpressionUUID->"0c54020b-92ed-4004-af08-\
b5537cb70cb1"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"qoutwfs", "=", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"-", "1"}], 
        RowBox[{"d", "-", "1"}]], "M1"}], "+", "M2"}], 
     RowBox[{
      RowBox[{"d", 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}]}], "+", "M1", "+", "M2"}]], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qoutwfs", "-", "QoutWFs"}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.710046466715753*^9, 3.710046475975423*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"211eab7c-7d5c-4af9-b003-c72f9dc4bd64"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.710046473334022*^9, 3.710046476392544*^9}, 
   3.710049689325638*^9, 3.7100540327022533`*^9, 3.710054502293746*^9, 
   3.71015694919741*^9, 3.713407337989614*^9, 3.7142278999337473`*^9, 
   3.71423188434804*^9, 3.719552291229485*^9, 3.7252817658943577`*^9, 
   3.776138414178462*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"92e6ed3c-d9bf-4356-8d7c-8f96207d64e4"]
}, Open  ]],

Cell["Limit behavior", "Text",
 CellChangeTimes->{{3.705385041146565*^9, 
  3.70538504847071*^9}},ExpressionUUID->"85340289-a1f0-4358-97af-\
ae77b856c12d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Limit", "[", 
  RowBox[{"QinWFs", ",", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Limit", "[", 
  RowBox[{"QoutWFs", ",", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7053850501521*^9, 3.705385108098117*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"458152fe-88ff-4427-bbc2-e1457c4f78ab"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.7053851085939703`*^9, 3.705387191627996*^9, 
  3.7099899052270317`*^9, 3.709990554245013*^9, 3.710046390154361*^9, 
  3.710049689383913*^9, 3.710054032821878*^9, 3.71005450246974*^9, 
  3.7101569493481092`*^9, 3.7134073381801767`*^9, 3.714227900049821*^9, 
  3.714231884569687*^9, 3.719552291410769*^9, 3.725281766087513*^9, 
  3.776138414225696*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"4b47e257-5a46-451a-8460-85b3881dd25e"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.7053851085939703`*^9, 3.705387191627996*^9, 
  3.7099899052270317`*^9, 3.709990554245013*^9, 3.710046390154361*^9, 
  3.710049689383913*^9, 3.710054032821878*^9, 3.71005450246974*^9, 
  3.7101569493481092`*^9, 3.7134073381801767`*^9, 3.714227900049821*^9, 
  3.714231884569687*^9, 3.719552291410769*^9, 3.725281766087513*^9, 
  3.776138414232958*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"50580ec1-5517-4d23-9d4f-2037596eccbe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QinWFs", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"%", ",", 
    RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7053850501521*^9, 3.705385099592635*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"1c8f4b70-f338-4798-a731-0dd76552de16"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "1"}], "-", 
    RowBox[{"2", " ", "m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
    RowBox[{
     SuperscriptBox["m", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", 
     "\[Mu]"}]}]]}]], "Output",
 CellChangeTimes->{{3.7053850729698668`*^9, 3.705385099935501*^9}, 
   3.7053871919399967`*^9, 3.7099899065603447`*^9, 3.709990554385026*^9, 
   3.7100463911668177`*^9, 3.710049689690675*^9, 3.710054033106924*^9, 
   3.7100545028536243`*^9, 3.7101569496858053`*^9, 3.713407338656136*^9, 
   3.7142279003587093`*^9, 3.7142318850416603`*^9, 3.719552291814623*^9, 
   3.725281766559465*^9, 3.776138414362701*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"3290674a-9864-4265-8800-3ab83fff96f6"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}]]}]], "Output",
 CellChangeTimes->{{3.7053850729698668`*^9, 3.705385099935501*^9}, 
   3.7053871919399967`*^9, 3.7099899065603447`*^9, 3.709990554385026*^9, 
   3.7100463911668177`*^9, 3.710049689690675*^9, 3.710054033106924*^9, 
   3.7100545028536243`*^9, 3.7101569496858053`*^9, 3.713407338656136*^9, 
   3.7142279003587093`*^9, 3.7142318850416603`*^9, 3.719552291814623*^9, 
   3.725281766559465*^9, 3.776138414423633*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"250936d2-1417-4379-bed1-997349375519"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"QoutWFs", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.705385116067935*^9, 3.705385122312422*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"ebee7663-1add-45dc-9488-b25d8588098a"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.7053851175044403`*^9, 3.7053851229146233`*^9}, 
   3.705387192135598*^9, 3.7099899076389303`*^9, 3.7099905544255743`*^9, 
   3.710046392165245*^9, 3.710049689859709*^9, 3.710054033248378*^9, 
   3.710054503002428*^9, 3.710156949996866*^9, 3.7134073387900457`*^9, 
   3.7142279004834127`*^9, 3.714231885285528*^9, 3.71955229214532*^9, 
   3.725281766711163*^9, 3.7761384144869537`*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"31c52ec3-425c-4433-ad21-d6f62a4c90b3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Comparison to Cockerham and Weir 1987", "Subsubsection",
 CellChangeTimes->{{3.7101558010783978`*^9, 
  3.710155812523353*^9}},ExpressionUUID->"17a1e96f-0c49-43e3-8b40-\
20f2146bcf6b"],

Cell["Cockerham and Weir\[CloseCurlyQuote]s \[Beta]", "Text",
 CellChangeTimes->{{3.7101533456316957`*^9, 3.710153350912513*^9}, {
  3.710155679639537*^9, 
  3.7101556816751003`*^9}},ExpressionUUID->"c17936f0-cc33-4d23-8ac8-\
16ffd72608ef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dd", " ", "=", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", " ", 
       FractionBox["nbdemes", 
        RowBox[{"nbdemes", "-", "1"}]]}]}], ")"}], "2"]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", "=", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], "2"]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7101533589980097`*^9, 3.710153431778693*^9}, {
   3.7101534922471943`*^9, 3.710153506936021*^9}, 3.710153933234684*^9, 
   3.710155690597134*^9, 3.710155742896264*^9},
 CellLabel->"In[57]:=",ExpressionUUID->"5d50e4fd-1d83-43d4-b8a4-6ea8b4efc4ed"],

Cell["\<\
Update deme size, which is 2 N in their paper, to N, to adapt the result to a \
haploid population\
\>", "Text",
 CellChangeTimes->{{3.7101556954302807`*^9, 
  3.7101557143671417`*^9}},ExpressionUUID->"8074ec9f-70e2-4b45-bb27-\
77bfc204ecc7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[Beta]", " ", "=", " ", 
  RowBox[{
   RowBox[{"\[Rho]", " ", 
    RowBox[{"dd", " ", "/", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"demesize", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"\[Rho]", " ", "dd"}]}], ")"}]}], "+", 
       RowBox[{"\[Rho]", " ", "dd"}]}], ")"}]}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]", "=."}], ";", 
  RowBox[{"dd", "=."}], ";"}]}], "Input",
 CellChangeTimes->{{3.7101533589980097`*^9, 3.710153431778693*^9}, {
   3.7101534922471943`*^9, 3.710153506936021*^9}, 3.710153933234684*^9, {
   3.710155690597134*^9, 3.710155694185615*^9}, {3.7101557458729973`*^9, 
   3.710155766567562*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"11729057-294c-407f-b749-00379078209e"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "nbdemes"}]}], ")"}], 
    "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "nbdemes"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"demesize", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "nbdemes"}]}], 
            ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "nbdemes"}], ")"}], "2"]]}], ")"}]}], 
     "+", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "nbdemes"}]}], ")"}],
         "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "nbdemes"}], ")"}], "2"]]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{{3.710153415668852*^9, 3.7101534323330593`*^9}, {
   3.7101534965249243`*^9, 3.710153507959269*^9}, 3.710153935736274*^9, 
   3.710153989895019*^9, {3.710155753039229*^9, 3.710155770064417*^9}, 
   3.710156950895701*^9, 3.7134073398087*^9, 3.714227901206571*^9, 
   3.7142318875639133`*^9, 3.7195522931130123`*^9, 3.7252817674410686`*^9, {
   3.776138415199472*^9, 3.776138426898767*^9}},
 CellLabel->"Out[59]=",ExpressionUUID->"6b8f56ff-a2d7-4cf7-b2ad-926282159156"]
}, Open  ]],

Cell["For us:", "Text",
 CellChangeTimes->{{3.710153511616827*^9, 3.710153517064158*^9}, {
  3.7101557182870827`*^9, 
  3.710155719678792*^9}},ExpressionUUID->"588788b4-596d-4eec-a2df-\
11e2c7e3c585"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"my\[Beta]", "=", 
  RowBox[{
   FractionBox[
    RowBox[{"QinWFs", "-", "QoutWFs"}], 
    RowBox[{"1", "-", "QoutWFs"}]], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.7101535909793243`*^9, 3.710153618436535*^9}, {
  3.710155736968443*^9, 3.710155754666039*^9}, {3.7761392561517353`*^9, 
  3.7761392599960403`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"77e60307-bd99-4b8a-ad69-39c8d7d9f16b"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{"2", "-", "d", "+", 
       RowBox[{"2", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"2", " ", "\[Mu]"}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", "n"}], ")"}], " ", 
     "\[Mu]"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Mu]", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "\[Mu]"}]}], ")"}], 
      "2"]}]}]]}]], "Output",
 CellChangeTimes->{{3.710153612255775*^9, 3.710153619120739*^9}, 
   3.7101539400130787`*^9, 3.710153994000152*^9, {3.710155755518497*^9, 
   3.710155771191538*^9}, 3.710156952359514*^9, 3.713407342261114*^9, 
   3.714227902738133*^9, 3.714231889107934*^9, 3.719552294794332*^9, 
   3.72528176898274*^9, 3.7761384165701523`*^9, 3.7761392607943563`*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"4871a55e-c4f8-456a-b1ed-c33af1a14756"]
}, Open  ]],

Cell["Compare the two -> same !", "Text",
 CellChangeTimes->{{3.710155774070763*^9, 
  3.710155783048971*^9}},ExpressionUUID->"ecb610b1-3533-46df-8394-\
5bcc6536e051"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"my\[Beta]", "-", "\[Beta]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"nbdemes", "\[Rule]", "d"}], ",", 
      RowBox[{"demesize", "\[Rule]", "n"}]}], "}"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"din", "\[Rule]", 
      RowBox[{"1", "/", "n"}]}], ",", " ", 
     RowBox[{"dself", "\[Rule]", 
      RowBox[{"1", "/", "n"}]}]}], "}"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.710153631178689*^9, 3.710153648804803*^9}, {
  3.77613835968618*^9, 3.7761383628534527`*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"30cf17ab-a686-41d5-837e-0d22675a7ecf"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.710153644453782*^9, 3.710153649486642*^9}, {
   3.710153977518886*^9, 3.710153996770756*^9}, {3.710155757055417*^9, 
   3.710155772257462*^9}, 3.7101569568974047`*^9, 3.713407348314444*^9, 
   3.71422790744143*^9, 3.7142318971413527`*^9, 3.719552299495515*^9, 
   3.72528177351518*^9, 3.776138416643661*^9, 3.776139263588079*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"f106e430-8c42-4403-8dc5-e595b777f0ed"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]", "=."}], ";", 
  RowBox[{"my\[Beta]", "=."}], ";"}]], "Input",
 CellChangeTimes->{{3.710155827463566*^9, 3.710155833449524*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"876b9afc-8637-433d-b0ff-a240fd3817f5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Without Self Replacement", "Subsubsection",
 CellChangeTimes->{{3.699713697718473*^9, 3.699713702474758*^9}, {
  3.6997140344242887`*^9, 
  3.6997140345381327`*^9}},ExpressionUUID->"bd333452-9ffa-4235-b16f-\
bb879b9c1c29"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QinWFw", "=", 
  RowBox[{
   RowBox[{"QinWF", "/.", "noselfreplacement"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699713715219798*^9, 3.699713729121462*^9}, {
   3.699714032451695*^9, 3.699714037934367*^9}, 3.699793818749946*^9},
 CellLabel->"In[55]:=",ExpressionUUID->"f96652eb-259b-4b43-a3a4-2606a75d9205"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
   FractionBox["d", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox[
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.6997137205942917`*^9, 3.6997137296346273`*^9}, 
   3.699714039975412*^9, 3.699768653054854*^9, 3.699787652032732*^9, 
   3.6997938456645737`*^9, 3.699847467487503*^9, 3.6998481320938587`*^9, 
   3.6998489485357647`*^9, 3.699853748614737*^9, 3.699955357081094*^9, 
   3.702201318097715*^9, 3.702289676445603*^9, 3.704178962090172*^9, 
   3.7045177167620573`*^9, 3.705382220777729*^9, 3.7053871936452217`*^9, 
   3.70998991030722*^9, 3.7099905553194304`*^9, 3.7100464851628847`*^9, 
   3.71004969115324*^9, 3.7100540344483*^9, 3.710054504229106*^9, 
   3.710156958417386*^9, 3.7134073501330633`*^9, 3.714227908931292*^9, 
   3.714231898992942*^9, 3.71955230106396*^9, 3.7252817749165363`*^9, 
   3.776138417733553*^9},
 CellLabel->"Out[55]=",ExpressionUUID->"35f59147-6d39-4c87-8910-5e50ef26a5a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"QoutWFw", "=", 
  RowBox[{
   RowBox[{"QoutWF", "/.", "noselfreplacement"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.69971376959558*^9, 3.699713781778393*^9}, {
   3.699714043938485*^9, 3.699714047373885*^9}, 3.6997938202130213`*^9},
 CellLabel->"In[56]:=",ExpressionUUID->"ae162f18-4950-4e9a-b6b4-06626975649c"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}], 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
   FractionBox[
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"2", " ", "\[Mu]"}], "-", 
     SuperscriptBox["\[Mu]", "2"]}]]}]]], "Output",
 CellChangeTimes->{3.699713782107119*^9, 3.699714048290897*^9, 
  3.6997686532808933`*^9, 3.699787652287928*^9, 3.6997938458919277`*^9, 
  3.699847467901083*^9, 3.6998481326015472`*^9, 3.699848948881896*^9, 
  3.699853748947424*^9, 3.699955357392652*^9, 3.7022013184846163`*^9, 
  3.70228967685288*^9, 3.704178962424152*^9, 3.7045177171525517`*^9, 
  3.705382220970962*^9, 3.7053871941159887`*^9, 3.70998991061347*^9, 
  3.709990555540123*^9, 3.7100464856492453`*^9, 3.710049691371263*^9, 
  3.7100540346669807`*^9, 3.710054504572701*^9, 3.7101569588867083`*^9, 
  3.71340735044776*^9, 3.7142279093643913`*^9, 3.714231900137219*^9, 
  3.719552301427497*^9, 3.7252817753464108`*^9, 3.7761384179683228`*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"f269aa5d-3f70-4cdb-8af6-70e37ca37589"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export to R the Q results", "Section",
 CellChangeTimes->{{3.702201500553801*^9, 3.702201503237453*^9}, {
  3.704803404476313*^9, 
  3.7048034064996977`*^9}},ExpressionUUID->"2419b6ef-5859-4e62-a316-\
552970e8b8fa"],

Cell["Rewrite the Greek letters", "Text",
 CellChangeTimes->{{3.702202576100587*^9, 
  3.702202585533182*^9}},ExpressionUUID->"1a46bc1d-5ea8-4a08-bfaa-\
927567933449"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GreekTerms", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Omega]", "\[Rule]", "sel"}], ",", " ", 
    RowBox[{"\[Mu]", "\[Rule]", "mut"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.702201509383871*^9, 3.702201525212894*^9}, {
  3.704724390807227*^9, 
  3.70472439943757*^9}},ExpressionUUID->"7b22121d-bd91-48fe-ab24-\
9624bc20326c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Omega]", "\[Rule]", "sel"}], ",", 
   RowBox[{"\[Mu]", "\[Rule]", "mut"}]}], "}"}]], "Output",
 CellChangeTimes->{3.70220152616304*^9, 3.7022030131218777`*^9, 
  3.7022897635244837`*^9, 3.704179086467165*^9, 3.7045177944473457`*^9, 
  3.704724393799959*^9, 3.7047246634923162`*^9, 3.704736510164259*^9, 
  3.710054037836182*^9, 3.710054504691545*^9, 3.7101569590860987`*^9, 
  3.713407350476017*^9, 3.714227909395928*^9, 3.7142319005319*^9, 
  3.719552301597114*^9, 
  3.72528177547628*^9},ExpressionUUID->"744b5edf-b93b-41e3-aa55-dc6888dc9392"]
}, Open  ]],

Cell["Common parts to all functions", "Text",
 CellChangeTimes->{{3.7022025881711607`*^9, 
  3.7022025922143908`*^9}},ExpressionUUID->"77554488-5c9e-459c-a3ad-\
19e1e76af0d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "FunctionPartB", "=", 
   "\"\< <- function(p, sel, mut, m, g, n, d, Idself, Ieself){\n## Arguments:\
\n#  p   mutation bias\n#  sel intensity of selection\n#  mut mutation \
probability\n#  m   emigration probability\n#  g   proportion of interactions \
out of the group (interaction equivalent of m)\n#  n   deme size\n#  d   \
number of demes\n#  Idself whether reproduction in site where the parent is\n\
#  Ieself whether interactions with oneself\nreturn(\n\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FunctionPartE", "=", "\"\<)\n}\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.702201586590098*^9, 3.702201660652206*^9}, {
  3.702202515399782*^9, 3.70220251599327*^9}, {3.702202562602117*^9, 
  3.702202562914797*^9}, {3.702202598064639*^9, 3.702202697296604*^9}, {
  3.702202988690043*^9, 3.702203007885222*^9}, {3.704724417045898*^9, 
  3.7047244695037813`*^9}},ExpressionUUID->"578d1aaf-032c-4eaf-a833-\
c5d40d8a929c"],

Cell["Function to translate Mathematica to R", "Text",
 CellChangeTimes->{{3.702202703211164*^9, 
  3.702202713861825*^9}},ExpressionUUID->"abde4a1b-1b34-47ab-bdc5-\
e4d1cba82eba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToRForm", "[", "x_", "]"}], ":=", 
  RowBox[{"ToString", "[", 
   RowBox[{
    RowBox[{"x", "/.", "GreekTerms"}], "//", "CForm"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.702201842966589*^9, 
  3.702201859620515*^9}},ExpressionUUID->"6ff82ee8-98fa-428a-a808-\
c943fae7d07c"],

Cell["Do it for Q", "Text",
 CellChangeTimes->{{3.704724511134218*^9, 
  3.704724513442933*^9}},ExpressionUUID->"f1a54d6f-fb33-4a50-86a1-\
d3cd49272b92"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RtxtQinM", "=", 
   RowBox[{"\"\<QinM \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{"QinM", "/.", "genericde"}], "//", "FullSimplify"}], "]"}], "<>",
     "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtQoutM", "=", 
   RowBox[{"\"\<QoutM \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{"QoutM", "/.", "genericde"}], "//", "FullSimplify"}], "]"}], "<>",
     "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtQinWF", "=", 
   RowBox[{"\"\<QinWF \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{"QinWF", "/.", "genericde"}], "//", "FullSimplify"}], "]"}], "<>",
     "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtQoutWF", "=", 
   RowBox[{"\"\<QoutWF \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{"QoutWF", "/.", "genericde"}], "//", "FullSimplify"}], "]"}], "<>",
     "FunctionPartE"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.704724517750942*^9, 
  3.704724604063252*^9}},ExpressionUUID->"24e12d47-c59b-4b8b-9cfc-\
fe73ebee0f58"],

Cell["Define Power function in R", "Text",
 CellChangeTimes->{{3.7022027318210173`*^9, 
  3.702202737612219*^9}},ExpressionUUID->"d8873f9d-2184-4f13-a453-\
22d2b5962ed3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PowerDef", "=", "\"\<Power <- function(a,b) return(a^b)\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.702201909153489*^9, 3.7022019359137297`*^9}, {
  3.7022019780679827`*^9, 
  3.702201985090732*^9}},ExpressionUUID->"998352f9-798d-41a9-a862-\
c6c9ea3bf521"],

Cell["Combine all texts", "Text",
 CellChangeTimes->{{3.702202739839615*^9, 
  3.702202745125101*^9}},ExpressionUUID->"a57f3910-60af-480d-8abc-\
98acb1a63f95"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rtxt", "=", 
   RowBox[{
   "PowerDef", "<>", "\"\<\n\n\>\"", "<>", "RtxtQinM", "<>", "\"\<\n\n\>\"", "<>",
     "RtxtQoutM", "<>", "\"\<\n\n\>\"", "<>", "RtxtQinWF", "<>", 
    "\"\<\n\n\>\"", "<>", "RtxtQoutWF"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7022019405139227`*^9, 3.702201966147601*^9}, {
  3.7047246131819277`*^9, 
  3.704724637059588*^9}},ExpressionUUID->"780c6311-297f-448c-9e45-\
56278bd0d61b"],

Cell["Export to txt file (Mathematica did not want R)", "Text",
 CellChangeTimes->{{3.702202748144455*^9, 
  3.70220275825738*^9}},ExpressionUUID->"a161dcbd-f12a-452c-bd35-\
5c3774b3e640"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"pathtosave", "<>", "\"\<Mathematica/analyticsQ.txt\>\""}], ",", 
    "Rtxt"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.702201967861699*^9, 3.702202007961507*^9}, {
   3.702202094017145*^9, 3.7022021946253023`*^9}, 3.7047246446676083`*^9, {
   3.710054058242139*^9, 3.710054064754195*^9}, 
   3.7100544433043947`*^9},ExpressionUUID->"5df196a7-34bd-49ad-b093-\
691768e8e714"],

Cell["Convert the file extension to R", "Text",
 CellChangeTimes->{{3.702202760522964*^9, 
  3.702202776867174*^9}},ExpressionUUID->"88a2cd52-f1a6-4478-853b-\
7a8e64310f2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cmd", "=", 
   RowBox[{
   "\"\<mv \>\"", "<>", "pathtosave", "<>", 
    "\"\<Mathematica/analyticsQ.txt \>\"", "<>", "pathtosave", "<>", 
    "\"\<Mathematica/analyticsQ.R\>\""}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7100540725428658`*^9, 
  3.710054132681882*^9}},ExpressionUUID->"e6085f07-8a79-4627-b46b-\
49f6073a43e9"],

Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{"\"\<!\>\"", "<>", "cmd"}], "]"}]], "Input",
 CellChangeTimes->{{3.71005413757959*^9, 3.710054140750166*^9}, {
  3.7100541794834137`*^9, 
  3.710054181106045*^9}},ExpressionUUID->"39dd9515-c67b-40e1-b15c-\
b7d482d79193"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
2) Expected frequency of altruists in a subdivided population\
\>", "Title",
 CellChangeTimes->{{3.714226756880457*^9, 
  3.7142267846734247`*^9}},ExpressionUUID->"592b4e25-b59b-4858-9036-\
e2ec7af7f2f0"],

Cell[CellGroupData[{

Cell["Initializations", "Section",
 CellChangeTimes->{{3.714227869949942*^9, 
  3.714227873207934*^9}},ExpressionUUID->"7c90027d-248b-4774-8149-\
63da68d82c10"],

Cell["Conditions on the parameters", "Text",
 CellChangeTimes->{{3.712973643690879*^9, 
  3.712973648322013*^9}},ExpressionUUID->"7917c417-4607-40f8-995e-\
16da35fd65e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"assumpts", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", ">", "1"}], "&&", 
     RowBox[{"d", ">", "2"}], "&&", 
     RowBox[{"\[Mu]", ">", "0"}], "&&", 
     RowBox[{"\[Mu]", "<", "1"}], "&&", 
     RowBox[{"m", ">", "0"}], "&&", 
     RowBox[{"m", "<", "1"}], "&&", 
     RowBox[{"b", ">", "0"}], "&&", 
     RowBox[{"c", ">", "0"}], "&&", 
     RowBox[{"b", ">", "c"}], "&&", 
     RowBox[{"\[Nu]", ">", "0"}], "&&", 
     RowBox[{"\[Nu]", "<", "1"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.712973640251402*^9, {3.713414973843594*^9, 
   3.713414977819476*^9}},ExpressionUUID->"71002c1f-acfc-4940-889a-\
b4091ab23474"],

Cell["FullSimplify with conditions on the parameters", "Text",
 CellChangeTimes->{{3.712973651749627*^9, 3.712973659335209*^9}, {
  3.71299998629117*^9, 3.712999988131076*^9}, {3.7765047990021687`*^9, 
  3.7765047992413883`*^9}},ExpressionUUID->"7844af98-c423-4dbd-86a7-\
1018b9ebc14b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AF", "[", "x_", "]"}], ":=", 
  RowBox[{"Assuming", "[", 
   RowBox[{"assumpts", ",", 
    RowBox[{"FullSimplify", "[", "x", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.712973660152466*^9, 
  3.712973669462085*^9}},ExpressionUUID->"d400c920-68a1-4bd6-9517-\
b18b7dd04cde"],

Cell[CellGroupData[{

Cell["Relatedness", "Subsection",
 CellChangeTimes->{{3.71422919344092*^9, 
  3.7142291964147663`*^9}},ExpressionUUID->"bc3e3b0e-480a-439f-9e9d-\
449c36e41991"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"R2M", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"QinM", "-", "QoutM"}], 
      RowBox[{"1", "-", "QoutM"}]], "/.", "genericde"}], "/.", 
    RowBox[{"{", 
     RowBox[{"Idself", "\[Rule]", "1"}], "}"}]}], "//", 
   "AF"}]}], "\[IndentingNewLine]", 
 RowBox[{"R2WF", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"QinWF", "-", "QoutWF"}], 
      RowBox[{"1", "-", "QoutWF"}]], "/.", "genericde"}], "/.", 
    RowBox[{"{", 
     RowBox[{"Idself", "\[Rule]", "1"}], "}"}]}], "//", "AF"}]}]}], "Input",
 CellChangeTimes->{{3.7142291980260553`*^9, 
  3.714229243404766*^9}},ExpressionUUID->"b2adbb80-a150-4481-8e95-\
6ac903496584"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], 
   RowBox[{"1", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
       RowBox[{"n", " ", "\[Mu]"}]}], ")"}]}]}]]}]], "Output",
 CellChangeTimes->{{3.714229203117908*^9, 3.7142292438277073`*^9}, 
   3.7142319093299017`*^9, {3.7195523730301743`*^9, 3.7195523779102297`*^9}, 
   3.7252817841069803`*^9},ExpressionUUID->"08da20a9-7ae8-48f0-a1ee-\
48f108529cef"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
    "+", 
    RowBox[{"2", " ", "\[Mu]"}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", 
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", "n"}], ")"}], " ", 
     "\[Mu]"}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
     SuperscriptBox["\[Mu]", "2"]}]}]]}]], "Output",
 CellChangeTimes->{{3.714229203117908*^9, 3.7142292438277073`*^9}, 
   3.7142319093299017`*^9, {3.7195523730301743`*^9, 3.7195523779102297`*^9}, 
   3.7252817847005053`*^9},ExpressionUUID->"9ffac5d2-747b-4f6c-baa2-\
8abe4dc3f2f4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameters", "Subsection",
 CellChangeTimes->{{3.7142294219628763`*^9, 
  3.714229426311678*^9}},ExpressionUUID->"ad4c89ce-a17e-4417-a222-\
80a18fc14998"],

Cell["Set parameter values for numerical examples", "Text",
 CellChangeTimes->{{3.7765048103399553`*^9, 
  3.776504822441348*^9}},ExpressionUUID->"7d7ecf07-c50f-4dd2-a45d-\
baca9d34c308"],

Cell[BoxData[
 RowBox[{
  RowBox[{"prm", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d", "\[Rule]", "15"}], ",", 
     RowBox[{"n", "\[Rule]", "4"}], ",", 
     RowBox[{"b", "\[Rule]", "15"}], ",", 
     RowBox[{"c", "\[Rule]", "1"}], ",", 
     RowBox[{"\[Delta]", "\[Rule]", "0.05"}], ",", 
     RowBox[{"\[Nu]", "\[Rule]", "0.45"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.714229430093514*^9, 
  3.714229432290728*^9}},ExpressionUUID->"a3aa224e-4c35-49ab-899f-\
b767f7ad357b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Derivatives of the expected frequency of altruists", "Section",
 CellChangeTimes->{{3.714226588268301*^9, 
  3.7142265983468113`*^9}},ExpressionUUID->"bbaaca20-eaf2-411b-869b-\
8a4528f30340"],

Cell[CellGroupData[{

Cell["Definitions", "Subsection",
 CellChangeTimes->{{3.7134087082825403`*^9, 
  3.713408710648761*^9}},ExpressionUUID->"d040f1a4-bef6-4bc0-ba2e-\
ebd2b7f0ad68"],

Cell[TextData[{
 "Fitness derivative: decomposition \n",
 StyleBox["Notation:",
  FontWeight->"Bold"],
 " s=self, i=deme-mate who is not the focal"
}], "Text",
 CellChangeTimes->{{3.7142261666161013`*^9, 3.714226196613112*^9}, {
  3.714226340334671*^9, 
  3.714226343850244*^9}},ExpressionUUID->"5fac0855-caca-4a44-939d-\
7a865d69438e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dW", "=", 
   RowBox[{"dWs", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], "dWi", " ", "R2"}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.712984150139451*^9, 
  3.712984179431731*^9}},ExpressionUUID->"46162b65-93a0-47b3-9f89-\
143d1da72c82"],

Cell["Further decomposition with fecundities:", "Text",
 CellChangeTimes->{{3.714226204055153*^9, 
  3.714226215940929*^9}},ExpressionUUID->"fa022214-cb38-4534-aedf-\
0f0097f29f38"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dWs", "=", 
   RowBox[{
    RowBox[{"dWfs", " ", 
     RowBox[{"(", 
      RowBox[{"-", "c"}], ")"}]}], "+", 
    RowBox[{"b", " ", "dWfi"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dWi", "=", 
   RowBox[{
    RowBox[{"dWfs", " ", 
     FractionBox["b", 
      RowBox[{"n", "-", "1"}]]}], "+", 
    RowBox[{"dWfi", 
     RowBox[{"(", 
      RowBox[{"-", "c"}], ")"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"n", "-", "2"}], 
      RowBox[{"n", "-", "1"}]], "b", " ", "dWfi"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.712984186904654*^9, 
  3.712984288567268*^9}},ExpressionUUID->"9bf8ef32-5618-4104-a019-\
3f2e4a62fa50"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Values for each life-cycle, obtained by taking derivatives in table S2\
\[CloseCurlyDoubleQuote]\
\>", "Subsection",
 CellChangeTimes->{{3.714226309372588*^9, 
  3.714226318628942*^9}},ExpressionUUID->"9b6e2ab4-a134-4a94-bae2-\
0fe68c5107fb"],

Cell[CellGroupData[{

Cell["Moran Death - Birth", "Subsubsection",
 CellChangeTimes->{{3.714226220081223*^9, 3.7142262246698437`*^9}, {
  3.7142262854943*^9, 
  3.714226327838628*^9}},ExpressionUUID->"7675be38-eb7d-4da5-b193-\
8bccce0e2792"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dWfsDB", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], 
    FractionBox["1", 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "m"}], ")"}], "2"], "n"], "-", 
      FractionBox[
       SuperscriptBox["m", "2"], 
       RowBox[{"n", 
        RowBox[{"(", 
         RowBox[{"d", "-", "1"}], ")"}]}]]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dWfiDB", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], 
    FractionBox["1", 
     RowBox[{"n", " ", "d"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "m"}], ")"}], "2"], "n"]}], "-", 
      FractionBox[
       SuperscriptBox["m", "2"], 
       RowBox[{"n", 
        RowBox[{"(", 
         RowBox[{"d", "-", "1"}], ")"}]}]]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.712984338322064*^9, 3.712984434238719*^9}, {
  3.712984620339417*^9, 
  3.712984621296452*^9}},ExpressionUUID->"66fb6bf1-64e7-4794-8a15-\
81019a8ae83e"],

Cell["Combine with the formula for dW", "Text",
 CellChangeTimes->{{3.714226357429411*^9, 
  3.714226367126733*^9}},ExpressionUUID->"a715131e-85c3-4ce6-94c3-\
336c8b66aa05"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dWDB", "=", 
   RowBox[{
    RowBox[{"dW", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dWfs", "\[Rule]", "dWfsDB"}], ",", 
       RowBox[{"dWfi", "\[Rule]", "dWfiDB"}]}], "}"}]}], "//", "AF"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BDB", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}], "dWi"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dWfs", "\[Rule]", "dWfsDB"}], ",", 
       RowBox[{"dWfi", "\[Rule]", "dWfiDB"}]}], "}"}]}], "//", "AF"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CDB", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "dWs"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dWfs", "\[Rule]", "dWfsDB"}], ",", 
       RowBox[{"dWfi", "\[Rule]", "dWfiDB"}]}], "}"}]}], "//", "AF"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.712984634828814*^9, 3.7129846819993057`*^9}, {
   3.714226391944724*^9, 3.7142263924264603`*^9}, 3.71422645700879*^9, {
   3.714226631832975*^9, 3.714226653663334*^9}, 
   3.714227782366641*^9},ExpressionUUID->"d0e50d3a-4eb8-489c-a3c3-\
adb6ebee82eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dEXDB", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"n", " ", "d", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "Qout"}], ")"}], "\[Mu]"], "\[Nu]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Nu]"}], ")"}], "dW"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"dWfs", "\[Rule]", "dWfsDB"}], ",", 
          RowBox[{"dWfi", "\[Rule]", "dWfiDB"}]}], "}"}]}], "/.", 
       RowBox[{"R2", "\[Rule]", "R2M"}]}], "/.", 
      RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{"dself", "\[Rule]", "din"}], "}"}]}], "/.", 
    RowBox[{"din", "\[Rule]", 
     FractionBox[
      RowBox[{"1", "-", "m"}], "n"]}]}]}], ";"}]], "Input",ExpressionUUID->\
"6b492584-d728-44c9-a292-f5c66842501f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moran Birth - Death", "Subsubsection",
 CellChangeTimes->{{3.714226323727347*^9, 
  3.7142263319698277`*^9}},ExpressionUUID->"6ee41fb6-703b-4541-8376-\
21f8b62478f0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dWfsBD", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Mu]"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"n", " ", "d"}]], "-", 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"n", " ", "d"}], ")"}], "2"]]}], ")"}]}], "-", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"1", "-", "m"}], ")"}], 
       RowBox[{"n", " ", "n", " ", "d"}]], "-", 
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"n", " ", "d"}], ")"}], "2"]]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dWfiBD", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Mu]"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"-", 
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"n", " ", "d"}], ")"}], "2"]]}], ")"}]}], "-", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"1", "-", "m"}], ")"}], 
       RowBox[{"n", " ", "n", " ", "d"}]], "-", 
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"n", " ", "d"}], ")"}], "2"]]}], ")"}]}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.712984436080041*^9, 3.712984536114875*^9}, {
  3.71298457202428*^9, 
  3.7129845994517117`*^9}},ExpressionUUID->"b59d270c-7ad4-4a79-a08d-\
8c909c1a32de"],

Cell["Combine with dW", "Text",
 CellChangeTimes->{{3.714226432225672*^9, 
  3.714226437625572*^9}},ExpressionUUID->"6985a00b-42d4-43b3-bedf-\
b22919670e32"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dEXBD", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"n", " ", "d", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "Qout"}], ")"}], "\[Mu]"], "\[Nu]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Nu]"}], ")"}], "dW"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"dWfs", "\[Rule]", "dWfsBD"}], ",", 
          RowBox[{"dWfi", "\[Rule]", "dWfiBD"}]}], "}"}]}], "/.", 
       RowBox[{"R2", "\[Rule]", "R2M"}]}], "/.", 
      RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{"dself", "\[Rule]", "din"}], "}"}]}], "/.", 
    RowBox[{"din", "\[Rule]", 
     FractionBox[
      RowBox[{"1", "-", "m"}], "n"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BBD", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}], "dWi"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dWfs", "\[Rule]", "dWfsBD"}], ",", 
       RowBox[{"dWfi", "\[Rule]", "dWfiBD"}]}], "}"}]}], "//", "AF"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CBD", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "dWs"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dWfs", "\[Rule]", "dWfsBD"}], ",", 
       RowBox[{"dWfi", "\[Rule]", "dWfiBD"}]}], "}"}]}], "//", "AF"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.714226663875696*^9, 3.714226685169915*^9}, 
   3.7142277803936663`*^9},ExpressionUUID->"f6b306ac-467e-4230-bf93-\
3f89b4e0fef5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wright - Fisher", "Subsubsection",
 CellChangeTimes->{{3.714226334001795*^9, 
  3.714226336639578*^9}},ExpressionUUID->"68246624-98bb-4b4f-825e-\
05c01642c711"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dWfsWF", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "m"}], ")"}], "2"], "n"], "-", 
      FractionBox[
       SuperscriptBox["m", "2"], 
       RowBox[{"n", 
        RowBox[{"(", 
         RowBox[{"d", "-", "1"}], ")"}]}]]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dWfiWF", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "m"}], ")"}], "2"], "n"]}], "-", 
      FractionBox[
       SuperscriptBox["m", "2"], 
       RowBox[{"n", 
        RowBox[{"(", 
         RowBox[{"d", "-", "1"}], ")"}]}]]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.712984609967702*^9, 
  3.712984627342272*^9}},ExpressionUUID->"f4d0081b-7283-4819-928a-\
b5c637f44472"],

Cell["Combine with dW", "Text",
 CellChangeTimes->{{3.714226447299099*^9, 
  3.714226450709735*^9}},ExpressionUUID->"45cbf12c-11ca-4ecd-99d4-\
5266e9ba091a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dEXWF", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "Qout"}], ")"}], "\[Mu]"], "\[Nu]", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Nu]"}], ")"}], "dW"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dWfs", "\[Rule]", "dWfsWF"}], ",", 
           RowBox[{"dWfi", "\[Rule]", "dWfiWF"}]}], "}"}]}], "/.", 
        RowBox[{"R2", "\[Rule]", "R2WF"}]}], "/.", 
       RowBox[{"Qout", "\[Rule]", "QoutWF"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{"dself", "\[Rule]", "din"}], "}"}]}], "/.", 
     RowBox[{"din", "\[Rule]", 
      FractionBox[
       RowBox[{"1", "-", "m"}], "n"]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BWF", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}], "dWi"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dWfs", "\[Rule]", "dWfsWF"}], ",", 
       RowBox[{"dWfi", "\[Rule]", "dWfiWF"}]}], "}"}]}], "//", "AF"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CWF", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "dWs"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dWfs", "\[Rule]", "dWfsWF"}], ",", 
       RowBox[{"dWfi", "\[Rule]", "dWfiWF"}]}], "}"}]}], "//", "AF"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.713356121753063*^9, 3.713356145407228*^9}, {
   3.713356262561409*^9, 3.713356289706917*^9}, {3.7134092611364822`*^9, 
   3.713409287537105*^9}, {3.713409394585511*^9, 3.713409401028379*^9}, {
   3.713409466430297*^9, 3.713409477770836*^9}, {3.713409642601273*^9, 
   3.713409642948991*^9}, {3.7134097273349447`*^9, 3.7134097314434566`*^9}, {
   3.714226430041389*^9, 3.714226446297415*^9}, {3.7142266926418533`*^9, 
   3.714226705614146*^9}, 
   3.714227772815279*^9},ExpressionUUID->"db4b3944-1a05-46bd-8abe-\
4825cd18ac94"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Checking signs", "Section",
 CellChangeTimes->{{3.712984710044484*^9, 3.7129847134595737`*^9}, {
  3.714227754190227*^9, 3.714227756927113*^9}, {3.7142284879942827`*^9, 
  3.7142284891670427`*^9}},ExpressionUUID->"b4857930-fc01-477d-9e20-\
21d15f061e40"],

Cell[CellGroupData[{

Cell["Death-Birth, whole B term", "Subsection",
 CellChangeTimes->{{3.714226931366014*^9, 3.71422693502754*^9}, {
  3.7142284922174387`*^9, 3.714228495247962*^9}, {3.714228587326931*^9, 
  3.7142285882315083`*^9}},ExpressionUUID->"12f3d572-1a0d-4231-bccd-\
19f5c6ff4426"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AF", "[", 
  RowBox[{"Reduce", "[", 
   RowBox[{
    RowBox[{"BDB", ">", "0"}], ",", "m"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.714226971698881*^9, 3.714226983359057*^9}, {
  3.714228513489498*^9, 3.714228547039112*^9}, {3.714228577410121*^9, 
  3.714228577536928*^9}},ExpressionUUID->"3f6707e4-c31f-42cd-a51b-\
49a36e6fc0fa"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"-", "1"}], "+", "d", "-", 
    SqrtBox[
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"b", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}]}]]]}], "d"], "<", "m", "<", 
  FractionBox[
   RowBox[{
    RowBox[{"-", "1"}], "+", "d", "+", 
    SqrtBox[
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"b", "+", 
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}]}]]]}], "d"]}]], "Output",
 CellChangeTimes->{
  3.71422699040685*^9, 3.71422795709315*^9, {3.7142285318449097`*^9, 
   3.7142285801378613`*^9}, 3.7142319246724577`*^9, 
   3.725281795091826*^9},ExpressionUUID->"893db0d9-43c5-44da-a9e7-\
216afe847326"]
}, Open  ]],

Cell[TextData[{
 "and this is true when m<",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"d", "-", "1"}], "d"], TraditionalForm]],ExpressionUUID->
  "91ae6949-ec6a-4083-b171-c29ac425e5c5"],
 "."
}], "Text",
 CellChangeTimes->{{3.714227016915841*^9, 
  3.714227027024652*^9}},ExpressionUUID->"a60b9416-5a0b-4389-840d-\
365c761feaae"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AF", "[", 
  RowBox[{"Reduce", "[", 
   RowBox[{
    RowBox[{"CDB", ">", "0"}], ",", "m"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.714227763219575*^9, 
  3.714227763339057*^9}},ExpressionUUID->"e39a2e3d-7304-4aad-967c-\
0c21927d6f1b"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.714227766702195*^9, 3.714227789347801*^9}, 
   3.714227957739546*^9, 3.714231925490996*^9, 
   3.7252817961063137`*^9},ExpressionUUID->"9dc72559-5a34-4dd5-86b1-\
8ee534ba3073"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Competition terms", "Subsection",
 CellChangeTimes->{{3.7142269035058813`*^9, 
  3.71422690769203*^9}},ExpressionUUID->"fa8b5227-5b9a-4be4-b3c0-\
3f3ad5a74749"],

Cell[CellGroupData[{

Cell["Check for BD competition", "Subsubsection",
 CellChangeTimes->{{3.713323238990649*^9, 3.7133232420530863`*^9}, {
  3.713324382666643*^9, 3.7133243848522463`*^9}, {3.713327111038334*^9, 
  3.713327121646955*^9}},ExpressionUUID->"d6e60353-b8c3-42d3-9dcf-\
a1387d04ec02"],

Cell["Competition term in the BD life-cycle", "Text",
 CellChangeTimes->{{3.713324419947974*^9, 
  3.713324425275394*^9}},ExpressionUUID->"cc38ce0b-830f-433a-a5ca-\
e380b604da31"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BDcomp", "=", 
   RowBox[{
    FractionBox["\[Mu]", 
     RowBox[{"n", " ", "d"}]], "-", 
    FractionBox[
     RowBox[{"1", "-", "m"}], "n"]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.71332441344331*^9, 
  3.713324429055477*^9}},ExpressionUUID->"4349dc74-3025-4d7a-a6ac-\
4e553b376232"],

Cell["It increases with m (because its derivative is >0)", "Text",
 CellChangeTimes->{{3.713324436570373*^9, 3.7133244475331287`*^9}, {
  3.714228930210991*^9, 
  3.71422893517703*^9}},ExpressionUUID->"8e060817-3981-4dff-b7e8-\
3949ef927e7d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"BDcomp", ",", "m"}], "]"}], "//", "AF"}]], "Input",
 CellChangeTimes->{{3.713323489920775*^9, 3.713323493703521*^9}, {
  3.713324461675806*^9, 
  3.713324463509656*^9}},ExpressionUUID->"2dec133d-dd32-4a3b-89f6-\
5ef577435ba3"],

Cell[BoxData[
 FractionBox["1", "n"]], "Output",
 CellChangeTimes->{3.713323494108646*^9, 3.7133244639754963`*^9, 
  3.7142286280644207`*^9, 3.7142319257261477`*^9, 
  3.725281796317444*^9},ExpressionUUID->"cd76d905-215f-4fb9-a944-\
4c324ed1e73c"]
}, Open  ]],

Cell["It is negative when m=0 (because \[Mu]<d)", "Text",
 CellChangeTimes->{{3.7133244502867823`*^9, 
  3.713324501695187*^9}},ExpressionUUID->"66053a41-4390-4250-b177-\
5787ab89eafe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BDcomp", "/.", 
   RowBox[{"m", "\[Rule]", "0"}]}], "//", "AF"}]], "Input",
 CellChangeTimes->{{3.7133244684416103`*^9, 
  3.713324476422662*^9}},ExpressionUUID->"1f3dd259-fee2-402c-b247-\
c73d9fdca764"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "d"}], "+", "\[Mu]"}], 
  RowBox[{"d", " ", "n"}]]], "Output",
 CellChangeTimes->{{3.7133244718724327`*^9, 3.71332447690895*^9}, 
   3.714228630712381*^9, 3.714231925899115*^9, 
   3.7252817964657393`*^9},ExpressionUUID->"5129f45c-b1ec-4e00-9cd0-\
7a383da59c96"]
}, Open  ]],

Cell["And it is still negative when we reach mc", "Text",
 CellChangeTimes->{{3.7133245052551537`*^9, 
  3.713324511996076*^9}},ExpressionUUID->"3e1b2a0a-21cb-42a1-8a77-\
6447d0cd8827"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BDcomp", "/.", 
   RowBox[{"m", "\[Rule]", 
    FractionBox[
     RowBox[{"d", "-", "1"}], "d"]}]}], "//", "AF"}]], "Input",
 CellChangeTimes->{{3.713323462877427*^9, 3.713323470848113*^9}, {
  3.713324516564931*^9, 
  3.713324517437285*^9}},ExpressionUUID->"c34a3d04-6b92-401a-a776-\
563ae4874a4a"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "1"}], "+", "\[Mu]"}], 
  RowBox[{"d", " ", "n"}]]], "Output",
 CellChangeTimes->{{3.713323366815885*^9, 3.7133233696445923`*^9}, {
   3.713323468202882*^9, 3.713323471247219*^9}, 3.713324519077026*^9, 
   3.714228631687543*^9, 3.714231926015806*^9, 
   3.72528179651978*^9},ExpressionUUID->"f6fd03ac-a9e9-4ca4-8259-\
26217029296b"]
}, Open  ]],

Cell["\<\
So it is negative for all values of m that we consider, and increases with m.
-> Competition is reduced as m increases (the absolute value of the \
competition term decreases)\
\>", "Text",
 CellChangeTimes->{{3.714228898527234*^9, 
  3.714228964968194*^9}},ExpressionUUID->"71812d3d-f4ec-4c17-9988-\
856176bacfbc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check for DB & WF competition", "Subsubsection",
 CellChangeTimes->{{3.713327127143981*^9, 3.7133271325012608`*^9}, {
  3.714228697482586*^9, 
  3.714228698023656*^9}},ExpressionUUID->"aba5341f-98ce-422c-b11d-\
9cae83e67918"],

Cell["The competition term is negative:", "Text",
 CellChangeTimes->{{3.714228856037085*^9, 
  3.714228862831358*^9}},ExpressionUUID->"4be135c5-68eb-48d3-9f51-\
3be2e4afcb20"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DBcomp", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Mu]"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "m"}], ")"}], "2"], "n"], "+", 
      FractionBox[
       SuperscriptBox["m", "2"], 
       RowBox[{"n", " ", 
        RowBox[{"(", 
         RowBox[{"d", "-", "1"}], ")"}]}]]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.71332713480097*^9, 
  3.7133271664738703`*^9}},ExpressionUUID->"585e3ca9-70ae-4cc3-b299-\
230c9a529b36"],

Cell["\<\
How does it change with m? 
Derivative with respect to m\
\>", "Text",
 CellChangeTimes->{{3.714228703954336*^9, 3.714228714714078*^9}, {
  3.714228867607938*^9, 
  3.714228875270731*^9}},ExpressionUUID->"6f01f1ff-6f95-4271-914e-\
50f8c1b95433"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dcomp", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"DBcomp", ",", "m"}], "]"}], "//", "AF"}]}]], "Input",
 CellChangeTimes->{{3.713327168000235*^9, 
  3.7133271802262363`*^9}},ExpressionUUID->"64694bc2-64fc-4cfe-b377-\
ae02486b6c8d"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n"}]]], "Output",
 CellChangeTimes->{{3.71332717158104*^9, 3.71332718094524*^9}, 
   3.713438794155141*^9, 3.714228634169249*^9, 3.714231926209448*^9, 
   3.725281796700109*^9},ExpressionUUID->"d07a1093-d1f8-4818-a8fe-\
55bb3a5902c0"]
}, Open  ]],

Cell["Derivative changes sign at the critical m value", "Text",
 CellChangeTimes->{{3.714228719269672*^9, 
  3.714228727763007*^9}},ExpressionUUID->"5198fbdd-5059-45a1-96e0-\
480150331d1f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"dcomp", "\[Equal]", "0"}], ",", "m"}], "]"}]], "Input",
 CellChangeTimes->{{3.7133271942348948`*^9, 
  3.713327197418749*^9}},ExpressionUUID->"71f1fcbe-a7ee-4240-a895-\
490695cf0cb6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"m", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], "d"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.713327197869233*^9, 3.714228636268414*^9, 
  3.714231926309305*^9, 
  3.725281796794314*^9},ExpressionUUID->"53169122-99e7-49f6-9022-\
49183de4e213"]
}, Open  ]],

Cell["\<\
Second derivative is negative -> derivative decreases 
-> derivative is positive for m<1-1/d (and indeed it is for m->0)
-> competition term increases with m, BUT...\
\>", "Text",
 CellChangeTimes->{{3.7142286864349613`*^9, 3.714228689079811*^9}, {
  3.7142287340457163`*^9, 
  3.714228849910329*^9}},ExpressionUUID->"e0b1e252-49b1-4d81-93d2-\
26f163e3531a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"dcomp", ",", "m"}], "]"}], "//", "AF"}]], "Input",
 CellChangeTimes->{{3.713438810288028*^9, 
  3.7134388145208483`*^9}},ExpressionUUID->"78c5a8c7-5e8a-43cb-9ef1-\
780cb0718b3b"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "d", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n"}]]], "Output",
 CellChangeTimes->{{3.713438812829534*^9, 3.713438815081916*^9}, 
   3.714228636993326*^9, 3.714231926468281*^9, 
   3.72528179690024*^9},ExpressionUUID->"af4faf4e-083a-4c7c-9979-\
979ae185d9a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dcomp", "/.", 
   RowBox[{"m", "\[Rule]", "0"}]}], "//", "AF"}]], "Input",
 CellChangeTimes->{{3.713327204096084*^9, 
  3.713327210197323*^9}},ExpressionUUID->"b2ae20d9-947c-49f8-b28f-\
4285f91f566d"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", "-", 
   RowBox[{"2", " ", "\[Mu]"}]}], "n"]], "Output",
 CellChangeTimes->{{3.713327207516994*^9, 3.713327210680633*^9}, 
   3.714228637741973*^9, 3.7142319265392113`*^9, 
   3.725281796993331*^9},ExpressionUUID->"324810f7-d4d4-4ace-847b-\
978f87759e92"]
}, Open  ]],

Cell["\<\
... BUT competition term is negative, so competition is reduced as m increases\
\>", "Text",
 CellChangeTimes->{{3.714228828139855*^9, 
  3.714228847078383*^9}},ExpressionUUID->"558ee762-dd05-4c02-b7f6-\
c76da1a4e453"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Changes with m", "Section",
 CellChangeTimes->{{3.714228980531352*^9, 
  3.7142289843809557`*^9}},ExpressionUUID->"f2472a75-fc4b-4cd8-83d6-\
bb6c62b40759"],

Cell[CellGroupData[{

Cell["Birth - Death", "Subsection",
 CellChangeTimes->{{3.7142289881192904`*^9, 
  3.714228991903933*^9}},ExpressionUUID->"9c7a1baf-09b4-4089-88cc-\
e0bbd683b1aa"],

Cell["Derivative with respect to m", "Text",
 CellChangeTimes->{{3.7142290122859173`*^9, 
  3.7142290195363283`*^9}},ExpressionUUID->"23759817-8913-41ed-b6e0-\
a4d4d888e698"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ddEXBD", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"dEXBD", ",", "m"}], "]"}], "//", "AF"}]}]], "Input",
 CellChangeTimes->{{3.714229021051134*^9, 3.714229054222846*^9}, 
   3.714229169806116*^9, {3.714229259996747*^9, 
   3.714229260564464*^9}},ExpressionUUID->"8d239b19-30b0-4547-b4aa-\
ea6803c92a96"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", "\[Mu]", " ", 
   RowBox[{"(", 
    RowBox[{"c", "+", 
     RowBox[{"c", " ", "d", " ", "n"}], "-", 
     RowBox[{"c", " ", "\[Mu]"}], "+", 
     RowBox[{"b", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"d", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}]}]}], ")"}], " ", 
         "\[Mu]"}]}], ")"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Nu]"}], ")"}], " ", "\[Nu]"}], 
  RowBox[{"d", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
      "-", 
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
        ")"}]}]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{{3.714229166523149*^9, 3.714229170355075*^9}, {
   3.714229255201606*^9, 3.7142292618892593`*^9}, 3.714231927246978*^9, 
   3.725281797677706*^9},ExpressionUUID->"c7359a20-89a1-49fd-9d6f-\
c74c641ac7c7"]
}, Open  ]],

Cell["There are no roots -> monotonic change with m", "Text",
 CellChangeTimes->{{3.714229060096945*^9, 
  3.71422907949137*^9}},ExpressionUUID->"3cc46718-1e42-4304-b9e9-\
c35b618ecf2e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"ddEXBD", "\[Equal]", "0"}], ",", "m"}], "]"}], "//", 
  "AF"}]], "Input",
 CellChangeTimes->{{3.714229021051134*^9, 
  3.714229068084038*^9}},ExpressionUUID->"2be7ba42-acc0-4aa3-8938-\
49dc92602eff"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.714229264856741*^9, 3.714231927514934*^9, 
  3.72528179783643*^9},ExpressionUUID->"037fe27f-aa5b-4f2c-a94c-7a0f192f6e5b"]
}, Open  ]],

Cell["How does the sign of the derivative change with \[Mu]?", "Text",
 CellChangeTimes->{{3.714229086990836*^9, 3.7142291046049023`*^9}, {
  3.71422935090206*^9, 
  3.714229351013934*^9}},ExpressionUUID->"2c0b0546-2864-4eb1-9d27-\
39b9bcd364c7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"ddEXBD", "\[Equal]", "0"}], ",", "\[Mu]"}], "]"}], "//", 
  "AF"}]], "Input",
 CellChangeTimes->{{3.714229021051134*^9, 3.714229068084038*^9}, {
  3.714229269806576*^9, 3.714229281693572*^9}, {3.714229356267791*^9, 
  3.71422936030971*^9}},ExpressionUUID->"d322ffed-71f4-4fcc-a8ae-\
824278a8e7f0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"b", "-", "c", "-", 
        RowBox[{"2", " ", "b", " ", "d", " ", "n"}], "+", 
        SqrtBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"b", "-", "c"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"b", "-", "c", "+", 
            RowBox[{"4", " ", "b", " ", 
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["n", "2"]}]}], ")"}]}]]}], 
       RowBox[{"2", " ", "b", " ", "d", " ", "n"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", 
     FractionBox[
      RowBox[{"c", "+", 
       RowBox[{"b", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "d", " ", "n"}]}], ")"}]}], "+", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"b", "-", "c"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"b", "-", "c", "+", 
           RowBox[{"4", " ", "b", " ", 
            SuperscriptBox["d", "2"], " ", 
            SuperscriptBox["n", "2"]}]}], ")"}]}]]}], 
      RowBox[{"2", " ", "b", " ", "d", " ", "n"}]]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.714229373223629*^9, 3.714231929168882*^9, 
  3.725281799212929*^9},ExpressionUUID->"47220b81-d057-4f8f-86d7-\
5d3525939e89"]
}, Open  ]],

Cell["Select the admissible solution", "Text",
 CellChangeTimes->{{3.7142293611631536`*^9, 
  3.7142293683526497`*^9}},ExpressionUUID->"17c0c616-df54-4511-a0ac-\
1c661b8422ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Mu]cBD", "=", 
    RowBox[{
     RowBox[{"\[Mu]", "/.", 
      RowBox[{"%", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "//",
      "AF"}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.714229021051134*^9, 3.714229068084038*^9}, {
  3.714229269806576*^9, 3.714229281693572*^9}, {3.714229356267791*^9, 
  3.71422936030971*^9}, {3.714229399186849*^9, 
  3.71422939985465*^9}},ExpressionUUID->"eb5f717a-cd82-4c9c-8cd8-\
1b3d97665440"],

Cell["Value with our parameters", "Text",
 CellChangeTimes->{{3.714229400823316*^9, 
  3.714229403999908*^9}},ExpressionUUID->"203c5b42-4b02-4208-8aed-\
5e680af9c9c5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Mu]cBD", "/.", "prm"}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.714229442776513*^9, 
  3.714229446939659*^9}},ExpressionUUID->"74346dda-d7a2-4f01-bcec-\
c6060d213d09"],

Cell[BoxData["0.02609913112021685`"], "Output",
 CellChangeTimes->{{3.7142294449082413`*^9, 3.7142294472242317`*^9}, 
   3.714231929384791*^9, 
   3.725281799449053*^9},ExpressionUUID->"6826633f-5dd5-4981-a51a-\
2565acd72ad3"]
}, Open  ]],

Cell["\<\
How is it affected by changes in d or n? (they play the same role)\
\>", "Text",
 CellChangeTimes->{{3.714229379741334*^9, 3.714229388062199*^9}, {
  3.71423025427663*^9, 
  3.714230258454563*^9}},ExpressionUUID->"903709db-28ea-43ba-9439-\
af746e18b339"],

Cell["\<\
The derivative is positive : the threshold increases with d and n\
\>", "Text",
 CellChangeTimes->{{3.71423026001819*^9, 
  3.714230270801515*^9}},ExpressionUUID->"723547b1-7688-445e-983b-\
e19bbc3e9367"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"\[Mu]cBD", ",", "d"}], "]"}], "//", "AF"}]], "Input",
 CellChangeTimes->{{3.714230241438333*^9, 
  3.7142302467914677`*^9}},ExpressionUUID->"f277b570-dbfa-4efc-9583-\
406d7ebcc37f"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SqrtBox[
    FractionBox[
     RowBox[{"b", "-", "c"}], 
     RowBox[{"b", "-", "c", "+", 
      RowBox[{"4", " ", "b", " ", 
       SuperscriptBox["d", "2"], " ", 
       SuperscriptBox["n", "2"]}]}]]], " ", 
   RowBox[{"(", 
    RowBox[{"b", "-", "c", "+", 
     SqrtBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"b", "-", "c", "+", 
         RowBox[{"4", " ", "b", " ", 
          SuperscriptBox["d", "2"], " ", 
          SuperscriptBox["n", "2"]}]}], ")"}]}]]}], ")"}]}], 
  RowBox[{"2", " ", "b", " ", 
   SuperscriptBox["d", "2"], " ", "n"}]]], "Output",
 CellChangeTimes->{3.714230247484139*^9, 3.714231929745648*^9, 
  3.7252817997576017`*^9},ExpressionUUID->"d3221bac-c920-4195-8285-\
3169c73dabf5"]
}, Open  ]],

Cell["The maximum value of the threshold is", "Text",
 CellChangeTimes->{{3.714230275155513*^9, 
  3.7142302833922853`*^9}},ExpressionUUID->"f3203433-d2a8-46ed-91ed-\
5ab62efe9af6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"\[Mu]cBD", ",", 
    RowBox[{"d", "\[Rule]", "\[Infinity]"}]}], "]"}], "//", 
  "AF"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"b", "\[Rule]", "15"}], ",", 
     RowBox[{"c", "\[Rule]", "1"}]}], "}"}]}], "//", "N"}]}], "Input",
 CellChangeTimes->{{3.714229021051134*^9, 3.714229068084038*^9}, {
  3.714229269806576*^9, 3.71422930338155*^9}, {3.714230238962978*^9, 
  3.714230240078824*^9}},ExpressionUUID->"93899444-9cf1-4d02-8b70-\
cf5da1d113c5"],

Cell[BoxData[
 RowBox[{"1", "-", 
  SqrtBox[
   RowBox[{"1", "-", 
    FractionBox["c", "b"]}]]}]], "Output",
 CellChangeTimes->{3.714229304487348*^9, 3.7142319302347918`*^9, 
  3.725281800124631*^9},ExpressionUUID->"347d0d12-d668-4aea-a78b-\
bdc7b988d75f"],

Cell[BoxData["0.033908216920704115`"], "Output",
 CellChangeTimes->{3.714229304487348*^9, 3.7142319302347918`*^9, 
  3.725281800126466*^9},ExpressionUUID->"78c048a1-b447-43bb-a032-\
a3d4a4e34e3c"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"->", 
   RowBox[{
   "The", " ", "critical", " ", "value", " ", "of", " ", "\[Mu]", " ", 
    "above", " ", "which", " ", 
    RowBox[{"E", "[", "X", "]"}], " ", "increases", " ", "with", " ", "m", 
    " ", "is"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]cBD", "=", 
   RowBox[{"1", "-", 
    FractionBox[
     RowBox[{"b", "-", "c", "+", 
      SqrtBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "-", "c"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"b", "-", "c", "+", 
          RowBox[{"4", " ", "b", " ", 
           SuperscriptBox["d", "2"], " ", 
           SuperscriptBox["n", "2"]}]}], ")"}]}]]}], 
     RowBox[{"2", " ", "b", " ", "d", " ", "n"}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "this", " ", "threshold", " ", "increases", " ", "with", " ", "d", " ", 
   "and", " ", "n", " ", "to", " ", "reach", " ", "a", " ", "maximum", " ", 
   "value", " ", "\[Mu]cBDmax"}], " ", "=", " ", 
  RowBox[{"1", "-", 
   SqrtBox[
    RowBox[{"1", "-", 
     FractionBox["c", "b"]}]]}]}]}], "Text",
 CellChangeTimes->{{3.7142300771116667`*^9, 3.7142301737907963`*^9}},
 FontFamily->"Nimbus Sans L",
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"2b40af41-08da-4cd3-929f-d54f7a0ef855"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Death - Birth", "Subsection",
 CellChangeTimes->{{3.7142294623082247`*^9, 
  3.71422946623085*^9}},ExpressionUUID->"5ca726f4-8b2c-4416-b4f5-\
8a22ea2487a0"],

Cell["Derivative with respect to m", "Text",
 CellChangeTimes->{{3.714229487271793*^9, 
  3.7142294923960943`*^9}},ExpressionUUID->"d201e9a9-463f-4f8a-b079-\
a9b6c3e7ecc4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ddEXDB", " ", "=", " ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"dEXDB", ",", "m"}], "]"}], "//", "AF"}]}]], "Input",
 CellChangeTimes->{{3.714229496794116*^9, 
  3.714229503625708*^9}},ExpressionUUID->"7198fac2-80b9-4679-aeb5-\
5c996eb22b43"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "d"}], " ", 
          SuperscriptBox["m", "2"]}], "+", "\[Mu]", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "+", 
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", "m"}], ")"}]}], "-", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "n"}], ")"}]}], "-", 
               RowBox[{"d", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"m", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", "n"}], 
                 ")"}]}]}], ")"}]}]}], ")"}], " ", "\[Mu]"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"d", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
          SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}], "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "d"}], " ", 
          SuperscriptBox["m", "2"]}], "+", "\[Mu]", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", 
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{"2", "+", "m"}], ")"}]}], "+", 
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"m", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "m", "-", 
                  RowBox[{"m", " ", "n"}]}], ")"}]}]}], ")"}]}]}], ")"}], " ",
           "\[Mu]"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"d", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"]}], 
            "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "+", 
               RowBox[{"2", " ", "d", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "m"}], ")"}]}], "+", 
               RowBox[{
                SuperscriptBox["d", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{"2", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m"}]}], 
                 ")"}]}]}], ")"}], " ", "n"}]}], ")"}], " ", 
          SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Nu]"}], ")"}], " ", "\[Nu]"}], ")"}], "/", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
     "-", 
     RowBox[{"m", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}],
     ")"}], "2"]}]], "Output",
 CellChangeTimes->{3.714229510729363*^9, 3.714231935460911*^9, 
  3.72528180348083*^9},ExpressionUUID->"7bc4db14-c5d4-47ad-9db7-603d756dc0ef"]
}, Open  ]],

Cell["The change is not monotonic with m:", "Text",
 CellChangeTimes->{{3.714229554708325*^9, 
  3.7142295682256603`*^9}},ExpressionUUID->"f847a1e9-bcd9-43df-8010-\
101ba32b908f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"ddEXDB", "\[Equal]", "0"}], ",", "m"}], "]"}], "//", 
  "AF"}]], "Input",
 CellChangeTimes->{{3.714229534380978*^9, 3.7142295446676617`*^9}, {
  3.714229830126457*^9, 3.714229831305579*^9}, {3.714229997988777*^9, 
  3.714229999896916*^9}},ExpressionUUID->"3cd49b04-8bb3-4aea-a84b-\
05883a97357d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"m", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"b", "-", "c"}], ")"}], " ", "d", " ", "\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
           ")"}]}], "-", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"b", "-", "c"}], ")"}]}], " ", "d", " ", "\[Mu]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "n"}], ")"}]}], "+", 
             RowBox[{"c", " ", "\[Mu]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", 
                RowBox[{"d", " ", 
                 SuperscriptBox["n", "2"]}], "+", "\[Mu]", "-", 
                RowBox[{"n", " ", "\[Mu]"}]}], ")"}]}], "+", 
             RowBox[{"b", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"\[Mu]", " ", 
                 RowBox[{"(", 
                  RowBox[{"2", "-", "\[Mu]", "+", 
                   RowBox[{"n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", 
                    "\[Mu]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
            ")"}]}]]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "c"}], ")"}], " ", "d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
        ")"}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"m", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"b", "-", "c"}], ")"}], " ", "d", " ", "\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
           ")"}]}], "+", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"b", "-", "c"}], ")"}]}], " ", "d", " ", "\[Mu]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "n"}], ")"}]}], "+", 
             RowBox[{"c", " ", "\[Mu]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", 
                RowBox[{"d", " ", 
                 SuperscriptBox["n", "2"]}], "+", "\[Mu]", "-", 
                RowBox[{"n", " ", "\[Mu]"}]}], ")"}]}], "+", 
             RowBox[{"b", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"\[Mu]", " ", 
                 RowBox[{"(", 
                  RowBox[{"2", "-", "\[Mu]", "+", 
                   RowBox[{"n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", 
                    "\[Mu]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
            ")"}]}]]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "c"}], ")"}], " ", "d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
        ")"}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7142300358465567`*^9, 3.714231948743877*^9, 
  3.725281808952894*^9},ExpressionUUID->"3f32d0ac-dc5e-4d99-b8a0-\
5a22f3fb730c"]
}, Open  ]],

Cell["Select admissible solution (denominator <0)", "Text",
 CellChangeTimes->{{3.714230002890151*^9, 
  3.714230012784911*^9}},ExpressionUUID->"e8aeabc6-d161-4bb0-9272-\
c7c17b6f2d95"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mcDB", "=", 
  RowBox[{"m", "/.", 
   RowBox[{
   "%", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}]], "Input",
 CellChangeTimes->{{3.714230015461989*^9, 
  3.714230018288484*^9}},ExpressionUUID->"da093bd9-b454-4059-855e-\
85e97d75f34c"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"b", "-", "c"}], ")"}], " ", "d", " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
     "-", 
     SqrtBox[
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"b", "-", "c"}], ")"}]}], " ", "d", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "n"}], ")"}]}], "+", 
         RowBox[{"c", " ", "\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", 
            RowBox[{"d", " ", 
             SuperscriptBox["n", "2"]}], "+", "\[Mu]", "-", 
            RowBox[{"n", " ", "\[Mu]"}]}], ")"}]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"\[Mu]", " ", 
             RowBox[{"(", 
              RowBox[{"2", "-", "\[Mu]", "+", 
               RowBox[{"n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", 
                    "\[Mu]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
        ")"}]}]]}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"b", "-", "c"}], ")"}], " ", "d", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{{3.7142295405204678`*^9, 3.714229566058485*^9}, 
   3.714229851936678*^9, {3.7142300187899103`*^9, 3.7142300359670677`*^9}, 
   3.714231948903594*^9, 
   3.7252818091275*^9},ExpressionUUID->"4568ba39-5e42-41f9-aad4-d581ab7071be"]
}, Open  ]],

Cell["\<\
We need to know whether this is a max or a min... 
But the solutions are a bit complicated, so let' s focus on what happens at m \
-> 0\
\>", "Text",
 CellChangeTimes->{{3.71422957100807*^9, 3.714229583920951*^9}, {
  3.714230054368207*^9, 
  3.7142300626396503`*^9}},ExpressionUUID->"cd0aac85-6f47-4813-9084-\
49ec71584fb4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ddEXDB0", "=", 
  RowBox[{
   RowBox[{"ddEXDB", "/.", 
    RowBox[{"m", "\[Rule]", "0"}]}], "//", "AF"}]}]], "Input",
 CellChangeTimes->{{3.714229590485798*^9, 
  3.714229597749955*^9}},ExpressionUUID->"90e2538f-02c8-4d83-bfd6-\
f164fd2fcb38"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"b", "+", 
     RowBox[{"b", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "n"}]}], ")"}], " ", "\[Mu]"}], "-", 
     RowBox[{"c", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "n", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}]}],
     ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Nu]"}], ")"}], " ", "\[Nu]"}], 
  RowBox[{"\[Mu]", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}], 
    "2"]}]]], "Output",
 CellChangeTimes->{3.714229598235066*^9, 3.714231949144637*^9, 
  3.725281809372274*^9},ExpressionUUID->"23c8b474-1f03-4a45-8959-\
258ea1d2ea7a"]
}, Open  ]],

Cell["How does this change with \[Mu]?", "Text",
 CellChangeTimes->{{3.714229603756278*^9, 
  3.71422961020947*^9}},ExpressionUUID->"1db69bc0-2191-46c1-a7e7-\
c3e1d9e70f8c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dddEXDB0", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"ddEXDB0", ",", "\[Mu]"}], "]"}], "//", "AF"}]}]], "Input",
 CellChangeTimes->{{3.714229611360251*^9, 
  3.714229632595389*^9}},ExpressionUUID->"c67c6d37-e58b-4784-9047-\
3a2c5b377850"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "n"}], ")"}]}], "-", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "n"}], ")"}]}], "+", 
         RowBox[{"3", " ", "\[Mu]"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
          SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}], "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{"3", "-", 
            RowBox[{"3", " ", "n", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "3"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["n", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
           ")"}]}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Nu]"}], ")"}], " ", "\[Nu]"}], 
   RowBox[{
    SuperscriptBox["\[Mu]", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}], 
     "3"]}]]}]], "Output",
 CellChangeTimes->{{3.714229619922111*^9, 3.71422963543924*^9}, 
   3.7142319518424397`*^9, 
   3.725281810432624*^9},ExpressionUUID->"6b35a13e-0b7e-42d7-8971-\
a56a5ecb5d0c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AF", "[", 
  RowBox[{"Reduce", "[", 
   RowBox[{
    RowBox[{"ddEXDB0", ">", "0"}], ",", "\[Mu]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AF", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"ddEXDB0", "\[Equal]", "0"}], ",", "\[Mu]"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.714229699358397*^9, 
  3.714229749248536*^9}},ExpressionUUID->"2092722e-9e59-41ec-b443-\
574b15fc72c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"c", "+", 
    RowBox[{"c", " ", "n"}], "+", 
    RowBox[{"b", " ", "\[Mu]"}], "+", 
    RowBox[{"c", " ", "n", " ", "\[Mu]"}]}], "<", 
   RowBox[{"b", "+", 
    RowBox[{"c", " ", "\[Mu]"}], "+", 
    RowBox[{"2", " ", "b", " ", "n", " ", "\[Mu]"}]}]}], "||", 
  RowBox[{"b", "\[GreaterEqual]", 
   RowBox[{"c", "+", 
    RowBox[{"c", " ", "n"}]}]}]}]], "Output",
 CellChangeTimes->{{3.714229707855596*^9, 3.7142297164261723`*^9}, 
   3.7142297502835417`*^9, 3.714231957267721*^9, 
   3.725281814517255*^9},ExpressionUUID->"56bb83ae-1368-478d-a714-\
3a6f1544ba62"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Mu]", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "b"}], "+", "c", "+", 
       RowBox[{"c", " ", "n"}]}], 
      RowBox[{"c", "-", 
       RowBox[{"c", " ", "n"}], "+", 
       RowBox[{"b", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "n"}]}], ")"}]}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.714229707855596*^9, 3.7142297164261723`*^9}, 
   3.7142297502835417`*^9, 3.714231957267721*^9, 
   3.7252818145474653`*^9},ExpressionUUID->"4e5b8938-792c-42f4-9023-\
445afa9dfa77"]
}, Open  ]],

Cell[TextData[{
 "-> E[X] is a non - monotonic function of m;\n\nThe initial (i.e., for m -> \
0) increase of E[X] with m depends on the values of b and \[Mu] :\nif b > c \
(n + 1), E[X] initially increases with m ;\notherwise, E[X] initially \
increases with m if \[Mu]>",
 Cell[BoxData[
  FractionBox[
   RowBox[{
    RowBox[{"-", "b"}], "+", "c", "+", 
    RowBox[{"c", " ", "n"}]}], 
   RowBox[{"c", "-", 
    RowBox[{"c", " ", "n"}], "+", 
    RowBox[{"b", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "n"}]}], ")"}]}]}]]], "Output",
  CellChangeTimes->{{3.714229707855596*^9, 3.7142297164261723`*^9}, 
    3.714229750312285*^9},ExpressionUUID->
  "7233ec91-ef2d-46da-b246-a73ef29443f5"],
 ";\n\nThen, a maximum is reached at m=",
 Cell[BoxData[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "-", "c"}], ")"}], " ", "d", " ", "\[Mu]", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}],
        "-", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"b", "-", "c"}], ")"}]}], " ", "d", " ", "\[Mu]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "n"}], ")"}]}], "+", 
           RowBox[{"c", " ", "\[Mu]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", 
              RowBox[{"d", " ", 
               SuperscriptBox["n", "2"]}], "+", "\[Mu]", "-", 
              RowBox[{"n", " ", "\[Mu]"}]}], ")"}]}], "+", 
           RowBox[{"b", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"\[Mu]", " ", 
               RowBox[{"(", 
                RowBox[{"2", "-", "\[Mu]", "+", 
                 RowBox[{"n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", 
                    "\[Mu]"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]]}], ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", "-", "c"}], ")"}], " ", "d", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
    ")"}]}]], "Output",
  CellChangeTimes->{{3.7142295405204678`*^9, 3.714229566058485*^9}, 
    3.714229851936678*^9, {3.7142300187899103`*^9, 3.7142300359670677`*^9}},
  ExpressionUUID->"262d77fe-eb12-431b-b015-9cb536175fcd"],
 ";\n"
}], "Text",
 CellChangeTimes->{{3.714230301883078*^9, 3.714230467804916*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"6d3b3b94-d03e-4b0f-8fdb-1130bd797756"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wright - Fisher", "Subsection",
 CellChangeTimes->{{3.714230478680243*^9, 
  3.714230481534193*^9}},ExpressionUUID->"5bb86e7e-52e9-4cbd-b644-\
dc33661653a3"],

Cell["Derivative with respect to m", "Text",
 CellChangeTimes->{{3.714230488499378*^9, 
  3.714230496037897*^9}},ExpressionUUID->"6e7e468a-4e91-4549-a046-\
55d750879c1a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ddEXWF", " ", "=", " ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"dEXWF", ",", "m"}], "]"}], "//", "AF"}]}]], "Input",
 CellChangeTimes->{{3.714230498204989*^9, 
  3.714230500951848*^9}},ExpressionUUID->"c808bcc6-f8e8-42a1-9e6d-\
ec091fb56c50"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], "3"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], " ", "n", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
   RowBox[{"(", 
    RowBox[{"c", "+", 
     RowBox[{"b", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], ")"}], 
   " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "\[Nu]"}], ")"}], " ", "\[Nu]"}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "m", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}], "+", 
     RowBox[{"d", " ", 
      SuperscriptBox["m", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"d", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], 
       ")"}]}]}], ")"}], "2"]]], "Output",
 CellChangeTimes->{3.714230502877071*^9, 3.714231959412127*^9, 
  3.725281816022867*^9},ExpressionUUID->"28f88710-8ef3-4e44-b6af-\
a362710b9bcc"]
}, Open  ]],

Cell["\<\
An extremum is reached at the maximum possible emigration value:\
\>", "Text",
 CellChangeTimes->{{3.714230519799027*^9, 
  3.714230541446657*^9}},ExpressionUUID->"18aae9ae-0db5-4b37-80dc-\
dab47d83b02f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"ddEXWF", "\[Equal]", "0"}], ",", "m"}], "]"}], "//", 
  "AF"}]], "Input",
 CellChangeTimes->{{3.7142305074529247`*^9, 
  3.714230517414317*^9}},ExpressionUUID->"45dde43a-a790-4cf1-aea1-\
1a9a60aba4f1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"m", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], "d"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.714230513771491*^9, 3.714230517773347*^9}, 
   3.714231959654847*^9, 
   3.7252818163773403`*^9},ExpressionUUID->"81d91ad0-d51a-429c-adb1-\
68030159ece1"]
}, Open  ]],

Cell["\<\
Whether it is a min or max depends on \[Mu]; let\[CloseCurlyQuote]s consider \
for simplicity m->0\
\>", "Text",
 CellChangeTimes->{{3.714230552421446*^9, 
  3.7142305743505287`*^9}},ExpressionUUID->"a46bee81-2318-4a82-8587-\
a7473de0f195"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ddEXWF0", "=", 
  RowBox[{
   RowBox[{"ddEXWF", "/.", 
    RowBox[{"m", "\[Rule]", "0"}]}], "//", "AF"}]}]], "Input",
 CellChangeTimes->{{3.714230681636448*^9, 
  3.714230692666686*^9}},ExpressionUUID->"a177d3ac-4ff7-4e94-98cf-\
870c73bba29a"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", "n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"c", "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], ")"}], 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Nu]"}], ")"}], " ", "\[Nu]"}], 
   RowBox[{"\[Mu]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}], ")"}], 
     "2"]}]]}]], "Output",
 CellChangeTimes->{3.714230693094363*^9, 3.7142319598965693`*^9, 
  3.725281816543641*^9},ExpressionUUID->"9a3a22c0-9121-48d2-ba79-\
56b371d56c6b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AF", "[", 
  RowBox[{"Reduce", "[", 
   RowBox[{
    RowBox[{"ddEXWF0", ">", "0"}], ",", "\[Mu]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.71423070479364*^9, 
  3.7142307147625504`*^9}},ExpressionUUID->"51d469c0-31ca-4835-b768-\
0dfde86ec104"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SqrtBox[
    RowBox[{"1", "-", 
     FractionBox["c", "b"]}]], "+", "\[Mu]"}], ">", "1"}]], "Output",
 CellChangeTimes->{3.714230718419951*^9, 3.714231963856244*^9, 
  3.725281819648444*^9},ExpressionUUID->"3cf8aaa9-3721-4711-ac9e-\
52efa02d2409"]
}, Open  ]],

Cell[TextData[{
 "->E[X] is a monotonic function of m for 0 < m < 1 - 1/d,\nand it is an \
increasing function for \[Mu]>1 - ",
 Cell[BoxData[
  SqrtBox[
   RowBox[{"1", "-", 
    FractionBox["c", "b"]}]]], "Output",
  CellChangeTimes->{3.714230718419951*^9},ExpressionUUID->
  "be19ee2b-7e15-4c7a-83e2-1320f40932a9"]
}], "Text",
 CellChangeTimes->{{3.7142307307612467`*^9, 3.714230777665942*^9}},
 Background->RGBColor[
  0.94, 0.91, 0.88],ExpressionUUID->"b0787682-f3fd-4b68-9369-6ba11c61924f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Qualitative effect of m on E[X] in the Moran DB life - cycle", "Section",
 CellChangeTimes->{{3.714231005366385*^9, 
  3.714231022348549*^9}},ExpressionUUID->"3f6dda12-77af-4907-9699-\
1934c95e4251"],

Cell["We have already checked that BDB>0", "Text",
 CellChangeTimes->{{3.714231027392906*^9, 
  3.714231038490273*^9}},ExpressionUUID->"08ec9b10-6603-4fac-81bb-\
89179e5f20c9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CBratio", "=", 
  RowBox[{
   FractionBox["CDB", "BDB"], "//", "AF"}]}]], "Input",
 CellChangeTimes->{{3.714231040235314*^9, 
  3.714231047761689*^9}},ExpressionUUID->"25d31bd7-39fb-49c0-a345-\
e6a9e81a9818"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"b", "-", "c"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"d", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"]}], "+", 
       RowBox[{"2", " ", "m"}]}], ")"}]}], "+", 
    RowBox[{"c", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n"}]}], 
   RowBox[{
    RowBox[{
     RowBox[{"-", "c"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"d", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"]}], "+", 
       RowBox[{"2", " ", "m"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
    RowBox[{"b", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"d", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"]}], "+", 
       RowBox[{"2", " ", "m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "m"}], ")"}], " ", "m", " ", "n"}]}], 
      ")"}]}]}]]}]], "Output",
 CellChangeTimes->{3.7142310489013243`*^9, 3.714231965044311*^9, 
  3.725281820060048*^9},ExpressionUUID->"a43dcf20-a985-4846-a37c-\
8f3f8444f70c"]
}, Open  ]],

Cell["\<\
Values of R and C/B for m -> 0
we have R<= C/B, == when \[Mu]->0\
\>", "Text",
 CellChangeTimes->{{3.7142310562859383`*^9, 3.71423107198041*^9}, {
  3.714231105177857*^9, 
  3.714231115529365*^9}},ExpressionUUID->"15762942-345c-494b-95ae-\
9846b0c7936d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"R2M", ",", 
    RowBox[{"m", "\[Rule]", "0"}]}], "]"}], "//", 
  "AF"}], "\[IndentingNewLine]", 
 RowBox[{"Limit", "[", 
  RowBox[{"%", ",", 
   RowBox[{"\[Mu]", "\[Rule]", "0"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.714231074915859*^9, 
  3.714231088266698*^9}},ExpressionUUID->"c9667df5-e5e2-4172-92a0-\
2c074711555c"],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "-", "\[Mu]"}], 
  RowBox[{"1", "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}]]], "Output",
 CellChangeTimes->{{3.714231079499547*^9, 3.7142310890028048`*^9}, 
   3.714231965222693*^9, 
   3.7252818201906776`*^9},ExpressionUUID->"01ac13ab-8025-42be-bcc6-\
69207e5603a3"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.714231079499547*^9, 3.7142310890028048`*^9}, 
   3.714231965222693*^9, 
   3.725281820196355*^9},ExpressionUUID->"2bbf6615-0540-41af-8e93-\
4fc696d8dd8c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"CBratio", ",", 
    RowBox[{"m", "\[Rule]", "0"}]}], "]"}], "//", "AF"}]], "Input",
 CellChangeTimes->{{3.71423109108398*^9, 
  3.7142310994223547`*^9}},ExpressionUUID->"f8705b4b-f679-4d99-932f-\
cfb8a1f1f693"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.7142310998142357`*^9, 3.71423196532088*^9, 
  3.725281820354782*^9},ExpressionUUID->"eedbd30a-ef32-4306-a80e-\
ea1dae78113c"]
}, Open  ]],

Cell["At the other extreme:", "Text",
 CellChangeTimes->{{3.7142311295716887`*^9, 
  3.714231132930059*^9}},ExpressionUUID->"3593d24c-71f5-4b1b-8016-\
f33ded27ca6c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"R2M", ",", 
    RowBox[{"m", "\[Rule]", 
     RowBox[{"1", "-", 
      RowBox[{"1", "/", "d"}]}]}]}], "]"}], "//", "AF"}]], "Input",
 CellChangeTimes->{{3.714231135373782*^9, 
  3.71423114361067*^9}},ExpressionUUID->"b8b059f6-576a-4a2b-8cc1-\
364838a8ba23"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.7142311415327463`*^9, 3.71423114392092*^9}, 
   3.714231965423812*^9, 
   3.725281820467904*^9},ExpressionUUID->"e0114aab-3f55-4687-bdd5-\
53514a9b6638"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Limit", "[", 
   RowBox[{"CBratio", ",", 
    RowBox[{"m", "\[Rule]", 
     RowBox[{"1", "-", 
      RowBox[{"1", "/", "d"}]}]}]}], "]"}], "//", "AF"}]], "Input",
 CellChangeTimes->{{3.714231148044702*^9, 
  3.714231151213529*^9}},ExpressionUUID->"12503a3f-c394-44d1-a4ba-\
39df2037de68"],

Cell[BoxData[
 FractionBox[
  RowBox[{"b", "+", 
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"d", " ", "n"}]}], ")"}]}]}], 
  RowBox[{"b", "+", 
   RowBox[{"c", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
   RowBox[{"b", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n"}]}]]], "Output",
 CellChangeTimes->{3.714231152020175*^9, 3.714231965592244*^9, 
  3.725281820665722*^9},ExpressionUUID->"4fbdb6e3-37a6-4154-8464-\
e17ce5750547"]
}, Open  ]],

Cell["Threshold emigration value to have R>C/B", "Text",
 CellChangeTimes->{{3.714231183025928*^9, 
  3.7142311971785*^9}},ExpressionUUID->"58563d71-3eb2-4109-8829-89a6c17fd886"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mDBqualit", "=", 
  RowBox[{
   RowBox[{"m", "/.", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"R2M", " ", "BDB"}], "-", "CDB"}], "\[Equal]", "0"}], ",", 
      "m"}], "]"}]}], "//", "AF"}]}]], "Input",
 CellChangeTimes->{{3.7142311988419323`*^9, 3.714231261788662*^9}, {
  3.714231300883994*^9, 
  3.714231301250543*^9}},ExpressionUUID->"06e16674-fa4c-4864-976d-\
3cd3eb8e3b8a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "c"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "d", "+", 
        RowBox[{"d", " ", "n"}]}], ")"}]}], "+", 
     RowBox[{"c", " ", "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}], "+", 
     RowBox[{"b", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "d", "+", 
        RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}], "-", 
     SqrtBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", 
        RowBox[{"(", 
         RowBox[{"b", "-", "c"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "d", " ", 
        RowBox[{"(", 
         RowBox[{"b", "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", "\[Mu]"}],
        "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "d", "+", 
             RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"2", "-", 
             RowBox[{"d", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "n"}], ")"}]}], "+", 
             RowBox[{"d", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
            ")"}]}]}], ")"}], "2"]}]]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"b", "-", "c"}], ")"}], " ", "d"}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "c"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "d", "+", 
        RowBox[{"d", " ", "n"}]}], ")"}]}], "+", 
     RowBox[{"c", " ", "d", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}], "+", 
     RowBox[{"b", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "d", "+", 
        RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}], "+", 
     SqrtBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", 
        RowBox[{"(", 
         RowBox[{"b", "-", "c"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "d", " ", 
        RowBox[{"(", 
         RowBox[{"b", "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", "\[Mu]"}],
        "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "d", "+", 
             RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}], "+", 
          RowBox[{"c", " ", 
           RowBox[{"(", 
            RowBox[{"2", "-", 
             RowBox[{"d", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "n"}], ")"}]}], "+", 
             RowBox[{"d", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
            ")"}]}]}], ")"}], "2"]}]]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"b", "-", "c"}], ")"}], " ", "d"}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.714231207549797*^9, 3.714231270553595*^9}, 
   3.714231307688175*^9, 3.714231971364995*^9, 
   3.725281824667231*^9},ExpressionUUID->"5ce8e32c-fc8f-4eff-85e0-\
60994e3a6277"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3) Expected Frequency Equations - Generic method", "Title",
 CellChangeTimes->{{3.699768851984043*^9, 3.699768858124469*^9}, {
  3.710048459761939*^9, 3.710048460391974*^9}, {3.714225569299754*^9, 
  3.714225576082962*^9}},ExpressionUUID->"81b6647a-00b9-434a-9672-\
d915328af4e9"],

Cell["\<\
Here we use the methodology presented in D\[EAcute]barre 2017 JTB, and \
similar terminology and decomposition of E[X].
The derivation is much more tedious... but it allows us to consider other \
kinds of subdivided populations:
- we do not specify the values of dself, din and dout (for instance we can \
have dself  =0, no replacement of the parent by the offspring),
- we  do not specify the values of eself, ein and eout (for instance, we can \
have eout proportional to dout, i.e. not restrict social interaction to \
deme-mates).\
\>", "Text",
 CellChangeTimes->{{3.714231518822658*^9, 
  3.714231672262864*^9}},ExpressionUUID->"c0276da3-feb2-403f-9c3f-\
fb3fca231e5a"],

Cell[CellGroupData[{

Cell["Formulas for the different life-cycles", "Section",
 CellChangeTimes->{{3.699768859805334*^9, 3.699768867744869*^9}, {
  3.705387119787652*^9, 
  3.705387127043717*^9}},ExpressionUUID->"21cfa1c4-9993-4429-b9bf-\
5f6afb97b4d9"],

Cell["\<\
The formulas for each term is obtained by hand, by replacing the dispersal \
and interaction graphs by their formulas in a subdivided population, from the \
equations given in Appendix B1. In some cases (e.g., \[Beta]I for the Moran \
DB life-cycle), there is a large number of cases to consider when unpacking \
the sums. 
D corresponds to direct / primary effects,
I corresponds to indirect / secondary effects. \
\>", "Text",
 CellChangeTimes->{{3.705385172637076*^9, 3.705385179189186*^9}, {
  3.7099900011579723`*^9, 3.709990009774757*^9}, {3.709990043198502*^9, 
  3.70999004982239*^9}, {3.7100468534555197`*^9, 3.710046912245219*^9}, {
  3.710046964544293*^9, 3.710046983885819*^9}, {3.710047084744001*^9, 
  3.71004711913234*^9}},ExpressionUUID->"19dca6e4-5ce9-47c6-a6fa-\
9e683901c72f"],

Cell[CellGroupData[{

Cell["Moran, Birth-Death", "Subsection",
 CellChangeTimes->{{3.699788303462345*^9, 3.699788307241809*^9}, {
  3.705387130107669*^9, 
  3.7053871363953457`*^9}},ExpressionUUID->"180a86f3-c6df-46c4-a9c3-\
bac030ec42bf"],

Cell[CellGroupData[{

Cell["\[Beta]", "Subsubsection",
 CellChangeTimes->{{3.699768872084917*^9, 
  3.699768873677112*^9}},ExpressionUUID->"4d21c859-34af-4db7-97e6-\
fd0626c0fa21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]BDD", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"eself", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "ein", " ", "Qin"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "eout", " ", "Qout"}]}], 
     ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699768876066028*^9, 3.699768891232036*^9}, {
  3.699768961189538*^9, 
  3.699768983541917*^9}},ExpressionUUID->"e1e8db83-65a1-4c54-9255-\
1626bb0713aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]BDI", "=", 
   RowBox[{
    RowBox[{"dself", " ", "eself"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], "din", " ", "ein"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", "d"}], " ", "-", "n"}], " ", ")"}], "dout", " ", 
     "eout"}], 
    RowBox[{"(*", "\[IndentingNewLine]", "*)"}], "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"din", " ", "eself"}], " ", "+", " ", 
       RowBox[{"dself", " ", "ein"}], " ", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "2"}], ")"}], "din", " ", "ein"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], "dout", " ", 
        "eout"}]}], ")"}], "Qin"}], " ", 
    RowBox[{"(*", "\[IndentingNewLine]", "*)"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", "d"}], " ", "-", " ", "n"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dself", " ", "eout"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "din", " ", "eout"}], " ", "+", " ", 
       
       RowBox[{"dout", " ", "eself"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "ein"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "d"}], " ", "-", 
          RowBox[{"2", "n"}]}], ")"}], "dout", " ", "eout"}]}], ")"}], 
     "Qout"}], 
    RowBox[{"(*", "\[IndentingNewLine]", "*)"}], "-", 
    RowBox[{
     FractionBox["\[Mu]", 
      RowBox[{"n", " ", "d"}]], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "Qin"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], "Qout"}]}], ")"}], 
     
     RowBox[{"(", 
      RowBox[{"eself", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "ein"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "eout"}]}], ")"}]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.69976898989773*^9, 3.699769149062419*^9}, {
  3.699783552293282*^9, 
  3.699783562281807*^9}},ExpressionUUID->"ffab36e3-0f70-4fe7-bb56-\
3e9ac5e10f88"],

Cell[BoxData[
 RowBox[{
  RowBox[{"factorBD", "=", 
   FractionBox[
    RowBox[{"p", 
     RowBox[{"(", 
      RowBox[{"1", "-", "p"}], ")"}]}], "\[Mu]"]}], ";"}]], "Input",
 CellChangeTimes->{{3.6997810044037027`*^9, 3.699781013324629*^9}, 
   3.776506065269863*^9},ExpressionUUID->"35e25afa-aef9-4729-bdd3-\
6ab10fc80539"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]BD", "=", 
   RowBox[{"factorBD", 
    RowBox[{"(", 
     RowBox[{"\[Beta]BDD", "-", "\[Beta]BDI"}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699781018565494*^9, 
  3.699781031469839*^9}},ExpressionUUID->"f5f6a596-2d9e-4dc7-8721-\
b188b8eaa27f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Gamma]", "Subsubsection",
 CellChangeTimes->{{3.699787927626891*^9, 
  3.699787929439444*^9}},ExpressionUUID->"48d4c8d2-e2a0-4cb3-b9b2-\
6140cc7dab8c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]BDD", "=", 
   RowBox[{"1", "-", "\[Mu]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699787932024872*^9, 
  3.699787942256565*^9}},ExpressionUUID->"3f0718a1-10b1-4fc4-acc7-\
74ef8e304a71"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]BDI", "=", 
   RowBox[{"dself", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}], "din", " ", "Qin"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", "Qout"}], "-", 
    RowBox[{
     FractionBox["\[Mu]", 
      RowBox[{"n", " ", "d"}]], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", "1"}], ")"}], "Qin"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "Qout"}]}], ")"}]}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.6997879444913797`*^9, 
  3.6997879865015497`*^9}},ExpressionUUID->"b3c7195d-c300-4592-bb9d-\
21db7aa07ce9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]BD", "=", 
  RowBox[{
   RowBox[{"factorBD", 
    RowBox[{"(", 
     RowBox[{"\[Gamma]BDD", "-", "\[Gamma]BDI"}], ")"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699787990021633*^9, 
  3.699788004937168*^9}},ExpressionUUID->"fc951c6f-d049-4ea4-9ab1-\
7921b8729470"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"d", " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "dself", "+", 
        RowBox[{"din", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "dout", " ", "n", " ", 
         "Qout"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "Qin", "+", 
        RowBox[{"n", " ", 
         RowBox[{"(", 
          RowBox[{"d", "-", "Qin", "+", "Qout", "-", 
           RowBox[{"d", " ", "Qout"}]}], ")"}]}]}], ")"}], " ", "\[Mu]"}]}], 
    ")"}]}], 
  RowBox[{"d", " ", "n", " ", "\[Mu]"}]]], "Output",
 CellChangeTimes->{{3.6997880018981028`*^9, 3.699788005307209*^9}, 
   3.699793867687854*^9, 3.699847510539104*^9, 3.699848993407742*^9, 
   3.699853749752069*^9, 3.6999553580700197`*^9, 3.702201319343082*^9, 
   3.702289677567067*^9, 3.7041789628852587`*^9, 3.7045177179484787`*^9, 
   3.70538552563669*^9, 3.7053857493865147`*^9, 3.70999005510261*^9, 
   3.709990584634004*^9, 3.710047000000866*^9, 3.710049691737043*^9, 
   3.7100543048914223`*^9, 3.710054510902038*^9, 3.7101569679797*^9, 
   3.713407361156756*^9, 
   3.714231972377007*^9},ExpressionUUID->"ed6cbe26-df80-459e-b6b7-\
6a6eaf74103d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moran, Death-Birth", "Subsection",
 CellChangeTimes->{{3.6997882937760963`*^9, 
  3.699788365013695*^9}},ExpressionUUID->"fcececbd-cd5d-4f25-a5f2-\
21ce4e1799a4"],

Cell[CellGroupData[{

Cell["\[Beta]", "Subsubsection",
 CellChangeTimes->{{3.6997883477895412`*^9, 
  3.69978834940098*^9}},ExpressionUUID->"f0d3227b-e177-42b2-a4cc-\
284c4bae927d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]DBD", "=", "\[Beta]BDD"}]], "Input",
 CellChangeTimes->{{3.699788350622011*^9, 
  3.699788367592432*^9}},ExpressionUUID->"09cbd0d1-cccc-4e71-9131-\
4bd9f2d67314"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"eself", "+", 
    RowBox[{"ein", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
    RowBox[{"eout", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "n"}], "+", 
       RowBox[{"d", " ", "n"}]}], ")"}], " ", "Qout"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", "\[Mu]"}], ")"}]}]], "Output",
 CellChangeTimes->{3.699788368875032*^9, 3.699793867805636*^9, 
  3.699847510687601*^9, 3.699848999986759*^9, 3.699853749950212*^9, 
  3.699955358165345*^9, 3.7022013195009747`*^9, 3.702289677727807*^9, 
  3.704178962940996*^9, 3.704517718153728*^9, 3.705385528716528*^9, 
  3.7053857544696503`*^9, 3.70999005511514*^9, 3.7099905846572647`*^9, 
  3.7100470023149157`*^9, 3.7100496917726088`*^9, 3.710054304921584*^9, 
  3.710054511039755*^9, 3.710156968077525*^9, 3.713407361186426*^9, 
  3.714231972551651*^9},ExpressionUUID->"bcc8c9a1-b5fc-4a39-a3ef-\
3890edf132ee"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]DBI", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1", "*", "dself", " ", "dself", " ", "eself", "*", "1"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "02", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dself", " ", "din", " ", "ein", " ", 
       "*", "1"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "03", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dself", " ", "dout", 
       " ", "eout", " ", "*", "1"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "04", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dself", " ", "dself", " ", "ein", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "05", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "dself", " ", "din", " ", 
       "eself", " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "06", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "dself", " ", "din", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "07", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], " ", "dself", " ", 
       "dout", " ", "eout", " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "08", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], "dself", " ", 
       "dself", " ", "eout", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "09", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "dself", " ", "din", " ", "eout",
        " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "10", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], "dself", " ", 
       "dout", " ", "eself", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "11", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "dself", " ", "dout", " ", "ein",
        " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "12", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], " ", "dself", " ", "dout", " ", "eout", 
       " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "13", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "din", " ", "dself", " ", "eself", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "14", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "din", " ", "din", " ", "ein", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "15", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "din", " ", "din", " ", "ein", " ", 
       "Qin"}], " ", 
      RowBox[{"(*", "\[IndentingNewLine]", "16", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], "din", " ", "dout", 
       " ", "eout", " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "17", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "din", " ", "dself", " ", "ein"}], 
      " ", 
      RowBox[{"(*", "\[IndentingNewLine]", "18", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "din", " ", "din", " ", "eself"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "19", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "din", " ", "din", " ", "ein"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "20", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "din", " ", "dout", " ", 
       "eout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "21", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "din", " ", "dself", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "22", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "din", " ", "din", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "23", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], " ", "din", " ", "din", " ", "eself", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "24", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "3"}], ")"}], "din", " ", "din", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "25", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "din", " ", "dout", " ", 
       "eout", " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "26", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "din", " ", "dself", " ",
        "eout", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "27", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "din", " ", "din", " ", 
       "eout", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "28", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "din", " ", "din", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "29", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "din", " ", "dout", " ", 
       "eself", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "30", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "din", " ", "dout", " ", "ein", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "31", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], " ", "din", " ", "dout", " ", "eout", 
       " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "32", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", "dself", 
       " ", "eself", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "33", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din", " ", "ein", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "34", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", "dout", " ",
        "eout", " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "35", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "dout", " ", "dout", " ", "eout",
        " ", "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "36", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "37", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dself", " ", "ein", " ",
        "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "38", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din", " ", "eself", " ",
        "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "39", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "dout", " ", "din", " ", "ein", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "40", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], " ", "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "eout", " ",
        "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "41", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "eout", " ",
        "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "42", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "43", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", "dself", 
       " ", "eout"}], " ", 
      RowBox[{"(*", "\[IndentingNewLine]", "44", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din", " ", "eout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "45", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", "dout", " ",
        "eself"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "46", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "ein"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "47", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "48", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dself", " ", "eout", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "49", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din", " ", "eout", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "50", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "51", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "eself", 
       " ", "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "52", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "2"}], ")"}], "dout", " ", "dout", " ", "ein", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "53", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout", " ", 
       "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "54", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dself", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "55", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "56", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "57", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "eout", " ",
        "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "58", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout", " ", "eself", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "59", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "dout", " ", "ein", " ", 
       "Qout"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "60", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"2", "n"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", 
         RowBox[{"3", "n"}]}], ")"}], "dout", " ", "dout", " ", "eout", " ", 
       "Qout"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699788370828354*^9, 3.6997883737861567`*^9}, {
  3.6997885910757103`*^9, 3.6997887279414787`*^9}, {3.699788766452323*^9, 
  3.69978887959624*^9}, {3.699789587279212*^9, 3.699789590128297*^9}, {
  3.6997897035456047`*^9, 3.699790157751882*^9}, {3.699790248805749*^9, 
  3.6997904719344053`*^9}, {3.6997909127859507`*^9, 3.699791106760395*^9}, {
  3.699791559504848*^9, 3.699791710511548*^9}, {3.69979191446669*^9, 
  3.6997919239386578`*^9}},ExpressionUUID->"07838e35-63cc-4bab-a076-\
d9741eb1c393"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"factorDB", "=", "factorBD"}]], "Input",
 CellChangeTimes->{{3.699791725220916*^9, 
  3.699791732023768*^9}},ExpressionUUID->"5b1b9cbb-c199-4d3c-9f47-\
cc96e2d546d1"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], " ", "p"}], "\[Mu]"]], "Output",
 CellChangeTimes->{{3.699791726790472*^9, 3.699791732340192*^9}, 
   3.6997938682265463`*^9, 3.699847981983308*^9, 3.699849000076928*^9, 
   3.6998537501443233`*^9, 3.6999553584313593`*^9, 3.702201319689139*^9, 
   3.7022896779804573`*^9, 3.704178963019085*^9, 3.7045177183790417`*^9, 
   3.705385528792678*^9, 3.7053857545731573`*^9, 3.7099900551495123`*^9, 
   3.70999058469648*^9, 3.710047029070117*^9, 3.710049691820953*^9, 
   3.7100543049660788`*^9, 3.710054511148797*^9, 3.710156968281186*^9, 
   3.713407361244309*^9, 
   3.714231972719874*^9},ExpressionUUID->"100b8271-bf2e-410b-9954-\
bef2d54ff30c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]DB", "=", 
  RowBox[{
   RowBox[{"factorDB", 
    RowBox[{"(", 
     RowBox[{"\[Beta]DBD", "-", "\[Beta]DBI"}], ")"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.699791734393208*^9, 3.6997917476423197`*^9}, {
  3.6997926117664433`*^9, 
  3.6997926138905087`*^9}},ExpressionUUID->"2faf86c6-28be-4405-a46c-\
b3c2bd158df8"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "\[Mu]"], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{"eself", "+", 
     RowBox[{"ein", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "eout", " ", "n", " ", 
      "Qout"}], "-", 
     RowBox[{
      SuperscriptBox["dself", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"eself", "+", 
        RowBox[{"ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "eout", " ", "n", " ", 
         "Qout"}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["din", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"eself", "+", 
        RowBox[{"eself", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
        RowBox[{"ein", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "n", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"3", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", "n"}]}], ")"}], 
            " ", "Qin"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "eout", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", "Qout"}]}], 
       ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
      SuperscriptBox["dout", "2"], " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"eself", "+", 
           RowBox[{"ein", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "eout", " ", 
            "n"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}]}], ")"}]}], 
        "+", 
        RowBox[{"n", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "eself"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "ein", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"3", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "3"}], "+", "d"}], ")"}], " ", "d"}]}], ")"}], 
            " ", "eout", " ", "n"}]}], ")"}], " ", "Qout"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "dout", " ", "dself", " ",
       "n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"eself", "+", 
           RowBox[{"ein", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}]}]}], ")"}], " ", "Qout"}],
         "+", 
        RowBox[{"eout", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "n", " ", 
            "Qout"}]}], ")"}]}]}], ")"}]}], "-", 
     RowBox[{"2", " ", "din", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dself", " ", 
         RowBox[{"(", 
          RowBox[{"ein", "+", 
           RowBox[{"eself", " ", "Qin"}], "+", 
           RowBox[{"ein", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "eout", " ", "n", 
            " ", "Qout"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "dout", " ", "n", " ", 
         
         RowBox[{"(", 
          RowBox[{"eout", "+", 
           RowBox[{"eout", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "Qin"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"eself", "+", 
              RowBox[{"ein", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "eout", " ", 
               "n"}]}], ")"}], " ", "Qout"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
   " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "\[Mu]"}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.699791749004755*^9, 3.699791928140911*^9, 
  3.699792626181149*^9, 3.699793879672049*^9, 3.6998475283084784`*^9, 
  3.699849009846263*^9, 3.699853759446772*^9, 3.6999553665676394`*^9, 
  3.702201328485806*^9, 3.702289688938758*^9, 3.7041789784206753`*^9, 
  3.704517727201066*^9, 3.7053855375718317`*^9, 3.705385759703961*^9, 
  3.70999006205303*^9, 3.7099905943620863`*^9, 3.710047040104258*^9, 
  3.710049702228156*^9, 3.710054313368938*^9, 3.710054519456626*^9, 
  3.7101569805272512`*^9, 3.713407377816057*^9, 
  3.714232036638342*^9},ExpressionUUID->"581638d4-6339-4fb6-ad13-\
92d704c97d49"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Gamma]", "Subsubsection",
 CellChangeTimes->{{3.6997883477895412`*^9, 3.69978834940098*^9}, {
  3.699792669000319*^9, 
  3.699792670294528*^9}},ExpressionUUID->"742c7448-0bb1-48cd-9745-\
b4411ddfeb90"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]DBD", "=", "\[Gamma]BDD"}]], "Input",
 CellChangeTimes->{{3.699792671742481*^9, 
  3.699792678668209*^9}},ExpressionUUID->"3f678307-136a-4e35-827e-\
14d0efcf9819"],

Cell[BoxData[
 RowBox[{"1", "-", "\[Mu]"}]], "Output",
 CellChangeTimes->{3.6997926798829107`*^9, 3.699793879753723*^9, 
  3.699847528456636*^9, 3.6998490099380207`*^9, 3.699853759632382*^9, 
  3.699955366711424*^9, 3.702201328654451*^9, 3.702289689100259*^9, 
  3.704178978486375*^9, 3.7045177274160137`*^9, 3.7053855377473497`*^9, 
  3.705385759747951*^9, 3.709990062316594*^9, 3.7099905944100246`*^9, 
  3.710047042329115*^9, 3.710049702285987*^9, 3.710054313496426*^9, 
  3.7100545195890703`*^9, 3.710156980738796*^9, 3.713407377862473*^9, 
  3.714232036820908*^9},ExpressionUUID->"684317b0-a361-4796-b6f6-\
8275bc8eb0bf"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Gamma]DBI", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Mu]"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["dself", "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       SuperscriptBox["din", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       SuperscriptBox["dout", "2"]}], 
      RowBox[{"(*", "\[IndentingNewLine]", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", "din"}], "+", " ", 
         RowBox[{"din", " ", "dself"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}], "din", " ", "din"}], " ", "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], "dout", " ", 
          "dout"}]}], ")"}], "Qin"}], 
      RowBox[{"(*", "\[IndentingNewLine]", "*)"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "d"}], "-", "n"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", "dout"}], " ", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "din", " ", "dout"}], "+", " ", 
         RowBox[{"dout", " ", "dself"}], "+", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "1"}], ")"}], "dout", " ", "din"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"n", " ", "d"}], "-", 
            RowBox[{"2", "n"}]}], ")"}], "dout", " ", "dout"}]}], ")"}], 
       "Qout"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.699792681385618*^9, 3.6997928220916023`*^9}, {
  3.6997931579841633`*^9, 3.699793164560968*^9}, {3.699793207548834*^9, 
  3.699793212788492*^9}},ExpressionUUID->"9f0674ba-3fca-4084-92ee-\
d8b1f14becf1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]DB", "=", 
  RowBox[{"factorDB", 
   RowBox[{"(", 
    RowBox[{"\[Gamma]DBD", "-", "\[Gamma]DBI"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6997928247896*^9, 
  3.699792842326086*^9}},ExpressionUUID->"103be1a4-9e6d-47c4-8afd-\
d27891fc6669"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "\[Mu]"], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["dself", "2"], "+", 
        RowBox[{
         SuperscriptBox["din", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["dout", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "din", " ", "dself"}], "+", 
           RowBox[{
            SuperscriptBox["din", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "n"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["dout", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "n"}], "+", 
              RowBox[{"d", " ", "n"}]}], ")"}]}]}], ")"}], " ", "Qin"}], "+", 
        
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "n"}], "+", 
           RowBox[{"d", " ", "n"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "dout", " ", "dself"}], "+", 
           RowBox[{"2", " ", "din", " ", "dout", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["dout", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "n"}], "+", 
              RowBox[{"d", " ", "n"}]}], ")"}]}]}], ")"}], " ", "Qout"}]}], 
       ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Mu]"}], ")"}]}], "-", "\[Mu]"}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.699792843210064*^9, 3.6997931658091793`*^9, 
  3.699793214494582*^9, 3.699793879823855*^9, 3.699847528602282*^9, 
  3.699849009993635*^9, 3.699853759799317*^9, 3.699955366875863*^9, 
  3.702201328835555*^9, 3.7022896892128677`*^9, 3.7041789785551357`*^9, 
  3.704517727624941*^9, 3.705385537806016*^9, 3.7053857598273993`*^9, 
  3.709990062326001*^9, 3.7099905944497538`*^9, 3.710047043549039*^9, 
  3.7100497023242273`*^9, 3.71005431353528*^9, 3.7100545197590714`*^9, 
  3.710156980911428*^9, 3.7134073779281187`*^9, 
  3.714232037032537*^9},ExpressionUUID->"d437f87d-a621-4de5-a0e6-\
248ddaa2b548"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wright - Fisher", "Subsection",
 CellChangeTimes->{{3.69979364538774*^9, 
  3.6997936505742283`*^9}},ExpressionUUID->"3b7d36e1-b552-4ffb-b337-\
945cf572a1df"],

Cell["\<\
The formulas are the same as the Moran DB life-cycle, only the probabilities \
of identity by descent Q will differ. \
\>", "Text",
 CellChangeTimes->{{3.71004712599955*^9, 
  3.7100471537307873`*^9}},ExpressionUUID->"721f8cd6-5c5b-47ce-8a22-\
9a687cf20b65"],

Cell[CellGroupData[{

Cell["\[Beta]", "Subsubsection",
 CellChangeTimes->{{3.699793660765585*^9, 
  3.699793662299658*^9}},ExpressionUUID->"b3152777-685d-4475-ad40-\
cd1faa3298cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Beta]WFI", "=", "\[Beta]DBI"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]WFD", "=", "\[Beta]DBD"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Beta]WF", "=", "\[Beta]DB"}], ";"}]}], "Input",
 CellChangeTimes->{{3.699793681804043*^9, 3.6997936868298264`*^9}, {
  3.7100516610266438`*^9, 
  3.7100516730745697`*^9}},ExpressionUUID->"2189b01b-67d9-4800-aefb-\
df02983bfadd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Gamma]", "Subsubsection",
 CellChangeTimes->{{3.699793660765585*^9, 
  3.699793691772121*^9}},ExpressionUUID->"efe07bbd-5403-4303-82ea-\
49b5c7871c4a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Gamma]WF", "=", "\[Gamma]DB"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]WFD", "=", "\[Gamma]DBD"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]WFI", "=", "\[Gamma]DBI"}], ";"}]}], "Input",
 CellChangeTimes->{{3.699793681804043*^9, 3.699793695476061*^9}, {
  3.710054344520341*^9, 
  3.710054351104436*^9}},ExpressionUUID->"d336fffd-5364-4540-9224-\
05a09cb158b3"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check the results numerically", "Section",
 CellChangeTimes->{{3.69976960096646*^9, 3.699769610384227*^9}, {
  3.699850594091323*^9, 3.69985059613144*^9}, {3.705385403861724*^9, 
  3.705385410277524*^9}},ExpressionUUID->"07f39d37-7f7b-4289-97ee-\
3d7185370697"],

Cell["\<\
We use generic equations valid for any life-cycle and any graph, and adapt \
them to our life-cycles and to a subdivided population. We compare the \
numerical results to the ones obtained with the equations written above. \
\>", "Text",
 CellChangeTimes->{{3.705385415146649*^9, 
  3.7053854805488234`*^9}},ExpressionUUID->"3ffbe9e2-a964-4d12-868d-\
bb7743e1baad"],

Cell[CellGroupData[{

Cell["Full functions, any life-cycle", "Subsection",
 CellChangeTimes->{{3.667805530329844*^9, 3.667805533236369*^9}, {
   3.667817240550598*^9, 3.6678172439254503`*^9}, 
   3.6703187116345387`*^9},ExpressionUUID->"9f08f38e-9d86-41d5-b7cc-\
d99f6a7f8149"],

Cell["\<\
\[Beta] and \[Gamma] were calculated by hand - these are generic equations \
value for any life-cycle and any regular graph. 
(see Appendix B1 for details, and Debarre 2017 JTB for even further details)\
\>", "Text",
 CellChangeTimes->{{3.679394260451545*^9, 3.679394277503475*^9}, 
   3.7053852236151247`*^9, {3.7053853495020123`*^9, 3.705385388886067*^9}, {
   3.710047168386541*^9, 
   3.7100471691967497`*^9}},ExpressionUUID->"7ccc2502-03ab-4bab-97b5-\
a3e7ef17994e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetBeta", "[", 
    RowBox[{
    "sBf_", ",", "Df_", ",", "G_", ",", "GE_", ",", "Qmat_", ",", 
     "\[CapitalNu]_", ",", "graphdegree_", ",", "Bstar_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"part1", ",", "part2", ",", "factor"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"factor", "=", 
       FractionBox[
        RowBox[{"p", 
         RowBox[{"(", 
          RowBox[{"1", "-", "p"}], ")"}]}], 
        RowBox[{"\[Mu]", " ", "\[CapitalNu]", " ", "Bstar"}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"part1", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Mu]"}], ")"}], 
             RowBox[{"sBf", "[", 
              RowBox[{
              "G", ",", "\[CapitalNu]", ",", "graphdegree", ",", "j", ",", 
               "l"}], "]"}]}], "-", 
            RowBox[{"Df", "[", 
             RowBox[{
             "G", ",", "\[CapitalNu]", ",", "graphdegree", ",", "j", ",", 
              "l"}], "]"}]}], ")"}], "*", 
          RowBox[{"GE", "\[LeftDoubleBracket]", 
           RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}], "*", 
          RowBox[{"Qmat", "\[LeftDoubleBracket]", 
           RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"factor", "*", "part1"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetGamma", "[", 
   RowBox[{
   "sBf_", ",", "Df_", ",", "G_", ",", "GE_", ",", "Qmat_", ",", 
    "\[CapitalNu]_", ",", "graphdegree_", ",", "Bstar_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"part1", ",", "part2", ",", "factor"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"factor", "=", 
      FractionBox[
       RowBox[{"p", 
        RowBox[{"(", 
         RowBox[{"1", "-", "p"}], ")"}]}], 
       RowBox[{"\[Mu]", " ", "\[CapitalNu]", " ", "Bstar"}]]}], ";", 
     RowBox[{"part1", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Mu]"}], ")"}], 
            RowBox[{"sBf", "[", 
             RowBox[{
             "G", ",", "\[CapitalNu]", ",", "graphdegree", ",", "j", ",", 
              "k"}], "]"}]}], "-", 
           RowBox[{"Df", "[", 
            RowBox[{
            "G", ",", "\[CapitalNu]", ",", "graphdegree", ",", "j", ",", 
             "k"}], "]"}]}], ")"}], "*", 
         RowBox[{"Qmat", "\[LeftDoubleBracket]", 
          RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"factor", "*", "part1"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6767809663714542`*^9, 3.676781023510331*^9}, {
  3.676804537681356*^9, 3.676804544825398*^9}, {3.679396412220232*^9, 
  3.679396413286743*^9}, {3.699769980839834*^9, 3.699769997947857*^9}, {
  3.699778646203886*^9, 3.6997786598998013`*^9}, {3.699778713529934*^9, 
  3.6997788466070232`*^9}, {3.6997814408909063`*^9, 3.699781470396274*^9}, {
  3.6997873888540173`*^9, 3.69978742458986*^9}, {3.710044608058228*^9, 
  3.710044629109458*^9}},ExpressionUUID->"bf322ff7-b7a6-4963-87cc-\
7a17382b9920"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moran DB", "Subsection",
 CellChangeTimes->{{3.667817266049498*^9, 3.667817267641507*^9}, {
  3.667829361694632*^9, 3.667829362862344*^9}, {3.670318555363709*^9, 
  3.67031856010742*^9}, {3.679394287560162*^9, 
  3.6793942988890533`*^9}},ExpressionUUID->"984cb3fd-e0aa-4a4d-93a3-\
d2300cd8e760"],

Cell[CellGroupData[{

Cell["Define \[Delta]B and \[Delta]D", "Subsubsection",
 CellChangeTimes->{{3.667817270639081*^9, 
  3.667817303563981*^9}},ExpressionUUID->"efaf43d2-fe07-45a5-9bb4-\
f33cdd1a47c4"],

Cell["graphdegree is the degree of the graph, here equal to 1", "Text",
 CellChangeTimes->{{3.705385243294672*^9, 3.705385251443304*^9}, 
   3.710044631061921*^9},ExpressionUUID->"f2db820c-2aef-4532-abeb-\
cc493d5fb29b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sBfDB", "[", 
    RowBox[{
    "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "j_", ",", "k_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Delta", "[", 
        RowBox[{"k", "-", "j"}], "]"}], 
       SuperscriptBox["graphdegree", "2"]}], "-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"G", "\[LeftDoubleBracket]", 
          RowBox[{"j", ",", "i"}], "\[RightDoubleBracket]"}], 
         RowBox[{"G", "\[LeftDoubleBracket]", 
          RowBox[{"k", ",", "i"}], "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], 
     ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"\[CapitalNu]", " ", 
      SuperscriptBox["graphdegree", "2"]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DfDB", "[", 
    RowBox[{
    "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "j_", ",", "k_"}], 
    "]"}], ":=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BstarDB", "=", 
   FractionBox["1", "\[CapitalNu]"]}], ";"}]}], "Input",
 CellChangeTimes->{{3.667805794031062*^9, 3.6678058049416933`*^9}, {
   3.667805883047532*^9, 3.667806013751638*^9}, {3.667806064496217*^9, 
   3.667806108193321*^9}, {3.6678067367929573`*^9, 3.667806737538381*^9}, {
   3.667806855132804*^9, 3.667806855241205*^9}, 3.6678069002815533`*^9, {
   3.6678178907809553`*^9, 3.6678178913089523`*^9}, {3.699778852523326*^9, 
   3.699778862434937*^9}, {3.6997874275513897`*^9, 3.699787463278324*^9}, {
   3.710044633532029*^9, 
   3.7100446369559927`*^9}},ExpressionUUID->"3041058c-f609-490c-bf01-\
08af71a187e2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Beta]", "Subsubsection",
 CellChangeTimes->{{3.69978004306563*^9, 3.6997800470396347`*^9}, {
  3.699792857641252*^9, 
  3.6997928577847347`*^9}},ExpressionUUID->"1c6237a6-9688-45a5-9b49-\
1c653f0754f4"],

Cell["Numerical comparison for the population of size 12", "Text",
 CellChangeTimes->{{3.710047191461318*^9, 
  3.710047206628955*^9}},ExpressionUUID->"142428db-ef0d-4f37-956d-\
1e94ce50e811"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]DBexemple", "=", 
  RowBox[{
   RowBox[{"GetBeta", "[", 
    RowBox[{
    "sBfDB", ",", "DfDB", ",", "G12generic", ",", "GE12generic", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarDB", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997800509176693`*^9, 3.6997800766118813`*^9}, {
  3.699780227296484*^9, 3.699780254043705*^9}, {3.699781039145463*^9, 
  3.699781043696348*^9}, {3.6997811552598333`*^9, 3.699781156248343*^9}, {
  3.699791766659071*^9, 3.699791790258472*^9}, {3.705385777149726*^9, 
  3.705385779307852*^9}},ExpressionUUID->"0f0177e1-d58d-4080-903a-\
ecc1af12ae44"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["dself", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"eself", "+", 
         RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
         RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["din", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"ein", "+", "eself", "+", 
         RowBox[{"3", " ", "ein", " ", "Qin"}], "+", 
         RowBox[{"eself", " ", "Qin"}], "+", 
         RowBox[{"18", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"18", " ", "dout", " ", "dself", " ", 
       RowBox[{"(", 
        RowBox[{"eout", "+", 
         RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
         RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
         RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
         RowBox[{"eself", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"9", " ", 
       SuperscriptBox["dout", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "ein"}], "+", 
            RowBox[{"6", " ", "eout"}], "+", "eself"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "Qin"}]}], ")"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "ein"}], "+", 
            RowBox[{"21", " ", "eout"}], "+", 
            RowBox[{"2", " ", "eself"}]}], ")"}], " ", "Qout"}]}], ")"}]}], 
      "+", 
      RowBox[{"4", " ", "din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", 
          RowBox[{"(", 
           RowBox[{"ein", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ein", "+", "eself"}], ")"}], " ", "Qin"}], "+", 
            RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
         RowBox[{"9", " ", "dout", " ", 
          RowBox[{"(", 
           RowBox[{"eout", "+", 
            RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
            RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
            RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
            RowBox[{"eself", " ", "Qout"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.69978024638573*^9, 3.699780256098102*^9}, 
   3.699781045273366*^9, 3.699781157642991*^9, 3.699781474913704*^9, 
   3.699783922853292*^9, 3.699787598717938*^9, {3.6997917699729023`*^9, 
   3.699791791253379*^9}, 3.6997938463840523`*^9, 3.6998474709052677`*^9, 
   3.699848136068221*^9, 3.6998506023560133`*^9, 3.699853761541006*^9, 
   3.699955368362294*^9, 3.7022013304406977`*^9, 3.702289690824561*^9, 
   3.704178980449655*^9, 3.704517729262532*^9, 3.705385501064349*^9, 
   3.705385711972087*^9, {3.70538577278124*^9, 3.705385780505777*^9}, 
   3.709990174748199*^9, 3.709990595225204*^9, 3.710047180131008*^9, 
   3.7100497031853237`*^9, 3.710054314797099*^9, 3.710054521349021*^9, 
   3.710156982949984*^9, 3.713407380491803*^9, 
   3.7142320418460827`*^9},ExpressionUUID->"78340c26-9a59-4489-b711-\
6093a9ac020a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]DBexemple", "-", "\[Beta]DB"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699791793075905*^9, 3.6997918142667027`*^9}, {
  3.704518414547575*^9, 
  3.704518424365841*^9}},ExpressionUUID->"05465984-b1a6-4566-a6da-\
8b8a3732a426"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699791804334284*^9, 3.699791815023748*^9}, 
   3.699791940967175*^9, 3.699793849735236*^9, 3.699847473358466*^9, 
   3.699848138659239*^9, 3.6998506024698*^9, 3.699853761680664*^9, 
   3.699955368504578*^9, 3.702201330605775*^9, 3.702289690977955*^9, 
   3.704178980521405*^9, 3.704517729471529*^9, {3.704518416387002*^9, 
   3.704518424546892*^9}, 3.705385503251767*^9, {3.70538569358629*^9, 
   3.705385718349859*^9}, 3.7053857820865*^9, 3.709990183151667*^9, 
   3.709990595261455*^9, 3.710047181094242*^9, 3.7100497032193537`*^9, 
   3.710054314876215*^9, 3.710054521482843*^9, 3.7101569830927143`*^9, 
   3.713407380530377*^9, 
   3.714232042067981*^9},ExpressionUUID->"96b2927c-a7f8-401f-a669-\
1fcec127b33f"]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 
  3.7100472277111177`*^9}},ExpressionUUID->"f516da83-107c-48fe-8e64-\
734362115ce4"],

Cell["Numerical comparison for the population of size 10", "Text",
 CellChangeTimes->{{3.710047191461318*^9, 
  3.710047216676303*^9}},ExpressionUUID->"3a3e42d7-0a75-4191-b0e5-\
53dd161a3c14"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]DBexemple2", "=", 
  RowBox[{
   RowBox[{"GetBeta", "[", 
    RowBox[{
    "sBfDB", ",", "DfDB", ",", "G10generic", ",", "GE10generic", ",", 
     "Q10generic", ",", "10", ",", "1", ",", 
     RowBox[{"BstarDB", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "10"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997922176034184`*^9, 
  3.6997922333025217`*^9}},ExpressionUUID->"d1ae865e-9cf6-481a-838a-\
e238dcc8b52d"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["dself", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"eself", "+", 
         RowBox[{"4", " ", "ein", " ", "Qin"}], "+", 
         RowBox[{"5", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["din", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"eself", "+", 
         RowBox[{"3", " ", "eself", " ", "Qin"}], "+", 
         RowBox[{"ein", " ", 
          RowBox[{"(", 
           RowBox[{"3", "+", 
            RowBox[{"13", " ", "Qin"}]}], ")"}]}], "+", 
         RowBox[{"20", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"5", " ", 
       SuperscriptBox["dout", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "ein"}], "+", "eself"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"4", " ", "Qin"}]}], ")"}]}], "+", 
         RowBox[{"25", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"10", " ", "dout", " ", "dself", " ", 
       RowBox[{"(", 
        RowBox[{"eout", "+", 
         RowBox[{"4", " ", "eout", " ", "Qin"}], "+", 
         RowBox[{"4", " ", "ein", " ", "Qout"}], "+", 
         RowBox[{"eself", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"8", " ", "din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", 
          RowBox[{"(", 
           RowBox[{"ein", "+", 
            RowBox[{"3", " ", "ein", " ", "Qin"}], "+", 
            RowBox[{"eself", " ", "Qin"}], "+", 
            RowBox[{"5", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
         RowBox[{"5", " ", "dout", " ", 
          RowBox[{"(", 
           RowBox[{"eout", "+", 
            RowBox[{"4", " ", "eout", " ", "Qin"}], "+", 
            RowBox[{"4", " ", "ein", " ", "Qout"}], "+", 
            RowBox[{"eself", " ", "Qout"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.6997922351725397`*^9, 3.6997938504112864`*^9, 
  3.699847474799409*^9, 3.699848140390723*^9, 3.6998506041587563`*^9, 
  3.6998537629428673`*^9, 3.699955369423333*^9, 3.702201331633013*^9, 
  3.70228969212409*^9, 3.704178982196525*^9, 3.7045177304936438`*^9, 
  3.705385695022094*^9, 3.705385784128316*^9, 3.709990186222736*^9, 
  3.709990596312099*^9, 3.710047392762372*^9, 3.7100497046122913`*^9, 
  3.710054315795927*^9, 3.7100545225544653`*^9, 3.7101569844063683`*^9, 
  3.713407382219857*^9, 
  3.714232045746003*^9},ExpressionUUID->"a4d2e4c6-d7ef-470a-a049-\
bac3335d3797"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]DBexemple2", "-", "\[Beta]DB"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "5"}], ",", 
     RowBox[{"d", "\[Rule]", "2"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699792241182529*^9, 
  3.699792249407493*^9}},ExpressionUUID->"e6e168e8-83d7-425e-908d-\
b535e203501b"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699792244617155*^9, 3.699792249502091*^9}, 
   3.6997938551855373`*^9, 3.699847477795148*^9, 3.699848143818454*^9, 
   3.699850604259791*^9, 3.699853763077199*^9, 3.699955369567561*^9, 
   3.7022013318022823`*^9, 3.70228969228119*^9, 3.704178982263274*^9, 
   3.704517730731916*^9, 3.7053856950796824`*^9, 3.705385785289909*^9, 
   3.709990190147925*^9, 3.709990596395607*^9, 3.710047393269868*^9, 
   3.710049704654264*^9, 3.7100543158352003`*^9, 3.7100545226815147`*^9, 
   3.71015698455232*^9, 3.713407382257227*^9, 
   3.714232045908511*^9},ExpressionUUID->"f1651a92-ce44-4d27-ba48-\
d9cbfafb6d29"]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 
  3.7100472277111177`*^9}},ExpressionUUID->"ac78b8b1-e666-46ec-9283-\
e830e6420ce2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Gamma]", "Subsubsection",
 CellChangeTimes->{{3.69978004306563*^9, 3.6997800470396347`*^9}, {
  3.699792857641252*^9, 
  3.6997928674291353`*^9}},ExpressionUUID->"6d2e929b-7f57-4b9b-8d71-\
776da5e4fb10"],

Cell["Numerical comparison for the population of size 12", "Text",
 CellChangeTimes->{{3.710047191461318*^9, 3.710047216676303*^9}, {
  3.7100480367495193`*^9, 
  3.710048037368987*^9}},ExpressionUUID->"b2213e5a-99c9-4a94-baac-\
8e679ca7b2d8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]DBexemple", "=", 
  RowBox[{
   RowBox[{"GetGamma", "[", 
    RowBox[{
    "sBfDB", ",", "DfDB", ",", "G12generic", ",", "GE12generic", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarDB", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997800509176693`*^9, 3.6997800766118813`*^9}, {
  3.699780227296484*^9, 3.699780254043705*^9}, {3.699781039145463*^9, 
  3.699781043696348*^9}, {3.6997811552598333`*^9, 3.699781156248343*^9}, {
  3.699791766659071*^9, 3.699791790258472*^9}, {3.699792869185608*^9, 
  3.699792873215055*^9}, {3.705386121796611*^9, 
  3.705386123738603*^9}},ExpressionUUID->"03958438-468a-43b6-9df8-\
e19eb37619b7"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["dself", "2"], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["din", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "Qin"}], ")"}]}], "+", 
      RowBox[{"4", " ", "din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", "Qin"}], "+", 
         RowBox[{"9", " ", "dout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"9", " ", "dout", " ", 
       RowBox[{"(", 
        RowBox[{"dout", "+", 
         RowBox[{"2", " ", "dout", " ", "Qin"}], "+", 
         RowBox[{"6", " ", "dout", " ", "Qout"}], "+", 
         RowBox[{"2", " ", "dself", " ", "Qout"}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.69978024638573*^9, 3.699780256098102*^9}, 
   3.699781045273366*^9, 3.699781157642991*^9, 3.699781474913704*^9, 
   3.699783922853292*^9, 3.699787598717938*^9, {3.6997917699729023`*^9, 
   3.699791791253379*^9}, 3.6997928744168043`*^9, 3.699793225128313*^9, 
   3.6997938553436613`*^9, 3.6998474781335363`*^9, 3.6998481443005123`*^9, 
   3.6998506070961523`*^9, 3.699853763359934*^9, 3.6999553698191566`*^9, 
   3.702201332087606*^9, 3.7022896925574408`*^9, 3.704178982497615*^9, 
   3.704517731012682*^9, 3.705385789772509*^9, 3.7053861246182823`*^9, 
   3.709990192385351*^9, 3.709990596589851*^9, 3.710048038606057*^9, 
   3.7100497048101377`*^9, 3.710054316019289*^9, 3.7100545229004307`*^9, 
   3.7101569847769136`*^9, 3.713407382455076*^9, 
   3.714232046221287*^9},ExpressionUUID->"53d0825f-bc4c-4c43-bf7d-\
9f297527035c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]DBexemple", "-", "\[Gamma]DB"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699791793075905*^9, 3.6997918142667027`*^9}, {
  3.699792876177504*^9, 
  3.6997928792173023`*^9}},ExpressionUUID->"4106d92e-9b41-4e5f-85d0-\
66690587c8b1"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699791804334284*^9, 3.699791815023748*^9}, 
   3.699791940967175*^9, 3.699792879944309*^9, 3.699793181383277*^9, 
   3.699793225184245*^9, 3.6997938556744423`*^9, 3.699847478511882*^9, 
   3.69984814491894*^9, 3.6998506090564632`*^9, 3.699853763529297*^9, 
   3.699955369950479*^9, 3.702201332286913*^9, 3.702289692727661*^9, 
   3.704178982565536*^9, 3.704517731180649*^9, 3.705386133224227*^9, 
   3.7099901943515453`*^9, 3.709990596596596*^9, 3.710048039355609*^9, 
   3.710049704837688*^9, 3.7100543160623617`*^9, 3.7100545229144917`*^9, 
   3.710156984806225*^9, 3.71340738247503*^9, 
   3.714232046375513*^9},ExpressionUUID->"fe918f99-1fef-4f9b-b0ed-\
020434ccb6db"]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 
  3.7100472277111177`*^9}},ExpressionUUID->"bdf5acc7-683a-47b5-8e4b-\
e43c86ad2d64"],

Cell["Numerical comparison for the population of size 10", "Text",
 CellChangeTimes->{{3.710047191461318*^9, 
  3.710047216676303*^9}},ExpressionUUID->"fc9c00a3-bce5-46c7-88d6-\
0fe4b29c41bd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]DBexemple2", "=", 
  RowBox[{
   RowBox[{"GetGamma", "[", 
    RowBox[{
    "sBfDB", ",", "DfDB", ",", "G10generic", ",", "GE10generic", ",", 
     "Q10generic", ",", "10", ",", "1", ",", 
     RowBox[{"BstarDB", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "10"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997922176034184`*^9, 3.6997922333025217`*^9}, {
  3.6997928836005917`*^9, 3.699792884605294*^9}, {3.6997931965600157`*^9, 
  3.6997931976610737`*^9}},ExpressionUUID->"d5d27ecd-2d76-40be-be5f-\
caa4bb8d74d8"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["dself", "2"], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["din", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"3", " ", "Qin"}]}], ")"}]}], "+", 
      RowBox[{"8", " ", "din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", "Qin"}], "+", 
         RowBox[{"5", " ", "dout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"5", " ", "dout", " ", 
       RowBox[{"(", 
        RowBox[{"dout", "+", 
         RowBox[{"4", " ", "dout", " ", "Qin"}], "+", 
         RowBox[{"2", " ", "dself", " ", "Qout"}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "\[Mu]"]}]], "Output",
 CellChangeTimes->{
  3.6997922351725397`*^9, 3.699792888128591*^9, {3.699793182918476*^9, 
   3.6997932253132267`*^9}, 3.699793855883088*^9, 3.69984747883878*^9, 
   3.6998481453289337`*^9, 3.699850609714999*^9, 3.699853763776083*^9, 
   3.69995537019744*^9, 3.702201332538973*^9, 3.702289692983096*^9, 
   3.704178982832259*^9, 3.70451773145947*^9, 3.705386134677553*^9, 
   3.709990195901651*^9, 3.709990596765334*^9, 3.7100480415088997`*^9, 
   3.710049704981529*^9, 3.71005431621916*^9, 3.710054523095546*^9, 
   3.710156985057029*^9, 3.7134073826680117`*^9, 
   3.714232046717184*^9},ExpressionUUID->"7a0ffd8f-c9ca-480f-85d9-\
c7ce50a22456"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]DBexemple2", "-", "\[Gamma]DB"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "5"}], ",", 
     RowBox[{"d", "\[Rule]", "2"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699792241182529*^9, 3.699792249407493*^9}, {
  3.699792889401593*^9, 
  3.699792892793714*^9}},ExpressionUUID->"cfd33bf7-9f64-41ac-bd34-\
bafc298ef354"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699792244617155*^9, 3.699792249502091*^9}, 
   3.699792895322885*^9, {3.699793185251954*^9, 3.6997932253397837`*^9}, 
   3.6997938561037617`*^9, 3.699847479378138*^9, 3.699848145708249*^9, 
   3.699850610231893*^9, 3.699853763858077*^9, 3.699955370216586*^9, 
   3.7022013325889177`*^9, 3.70228969307031*^9, 3.704178982875839*^9, 
   3.704517731499671*^9, 3.70538613635847*^9, 3.709990197060823*^9, 
   3.709990596805367*^9, 3.710048042098637*^9, 3.71004970501007*^9, 
   3.71005431626306*^9, 3.710054523164699*^9, 3.710156985132773*^9, 
   3.7134073826897593`*^9, 
   3.714232046809765*^9},ExpressionUUID->"9a877f25-5743-45f4-8adb-\
cb5178205850"]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 
  3.7100472277111177`*^9}},ExpressionUUID->"63b1c5f5-75a3-47ae-b51e-\
41066850d331"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moran BD", "Subsection",
 CellChangeTimes->{{3.667817266049498*^9, 3.667817267641507*^9}, {
   3.66782181858403*^9, 3.667821819675145*^9}, {3.66782936574275*^9, 
   3.667829366991437*^9}, 3.670318572988695*^9, {3.6793943239760017`*^9, 
   3.67939432588864*^9}},ExpressionUUID->"7d850f60-ed15-43ea-8198-\
0cef8117ee37"],

Cell["\<\
The structure is the same as for Moran DB above - comments are lighter here!\
\>", "Text",
 CellChangeTimes->{{3.710048063471426*^9, 
  3.710048080308312*^9}},ExpressionUUID->"71763304-5a12-4863-bb1e-\
7379ce79f9f3"],

Cell[CellGroupData[{

Cell["Define \[Delta]B and \[Delta]D", "Subsubsection",
 CellChangeTimes->{{3.667817270639081*^9, 
  3.667817303563981*^9}},ExpressionUUID->"6fb3442f-5eae-4ef5-929a-\
a7d8836669d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sBfBD", "[", 
    RowBox[{
    "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "j_", ",", "k_"}], 
    "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"Delta", "[", 
       RowBox[{"k", "-", "j"}], "]"}], "\[CapitalNu]"}], "-", "1"}], 
    SuperscriptBox["\[CapitalNu]", "2"]]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DfBD", "[", 
    RowBox[{
    "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "j_", ",", "k_"}], 
    "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"G", "\[LeftDoubleBracket]", 
      RowBox[{"k", ",", "j"}], "\[RightDoubleBracket]"}], 
     RowBox[{"\[CapitalNu]", " ", "graphdegree"}]], "-", 
    FractionBox["1", 
     SuperscriptBox["\[CapitalNu]", "2"]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BstarBD", "=", 
   FractionBox["1", "\[CapitalNu]"]}], ";"}]}], "Input",
 CellChangeTimes->{{3.667805794031062*^9, 3.6678058049416933`*^9}, {
   3.667805883047532*^9, 3.667806013751638*^9}, {3.667806064496217*^9, 
   3.667806108193321*^9}, {3.6678067367929573`*^9, 3.667806737538381*^9}, {
   3.667806855132804*^9, 3.667806855241205*^9}, 3.6678069002815533`*^9, {
   3.6678178907809553`*^9, 3.6678178913089523`*^9}, {3.6678218224839478`*^9, 
   3.667821926596066*^9}, {3.69977903377708*^9, 3.699779037288487*^9}, {
   3.699787474076399*^9, 3.699787478013597*^9}, {3.6997875245164633`*^9, 
   3.699787524675749*^9}, {3.710044637988566*^9, 
   3.710044639211814*^9}},ExpressionUUID->"23a2fb8e-3797-4847-8f6f-\
8a7669061f1c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations \[Beta]", "Subsubsection",
 CellChangeTimes->{{3.69978004306563*^9, 3.6997800470396347`*^9}, {
  3.699788019288118*^9, 
  3.699788020367642*^9}},ExpressionUUID->"45c978b1-982a-4eda-b57b-\
4b7200d7e611"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]BDexemple", "=", 
  RowBox[{
   RowBox[{"GetBeta", "[", 
    RowBox[{
    "sBfBD", ",", "DfBD", ",", "G12generic", ",", "GE12generic", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarBD", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997800509176693`*^9, 3.6997800766118813`*^9}, {
   3.699780227296484*^9, 3.699780254043705*^9}, {3.699781039145463*^9, 
   3.699781043696348*^9}, {3.6997811552598333`*^9, 3.699781176230454*^9}, {
   3.6997814599873953`*^9, 3.699781463270492*^9}, 3.699787561723735*^9, {
   3.699787605440502*^9, 3.6997876067381372`*^9}, {3.6997876630669823`*^9, 
   3.699787667730566*^9}, {3.705386274883584*^9, 
   3.705386277097451*^9}},ExpressionUUID->"be3a88fd-e48e-4c4e-bd91-\
32acfb5ef538"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"12", " ", "\[Mu]"}]], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"12", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "dself"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"eself", "+", 
           RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
           RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", "din", " ", 
         RowBox[{"(", 
          RowBox[{"ein", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ein", "+", "eself"}], ")"}], " ", "Qin"}], "+", 
           RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
        RowBox[{"9", " ", "dout", " ", 
         RowBox[{"(", 
          RowBox[{"eout", "+", 
           RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
           RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
           RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
           RowBox[{"eself", " ", "Qout"}]}], ")"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "9"}], " ", "eout"}], "+", 
        RowBox[{"11", " ", "eself"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"ein", "-", 
           RowBox[{"10", " ", "ein", " ", "Qin"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"9", " ", "eout"}], "+", "eself"}], ")"}], " ", 
            "Qin"}]}], ")"}]}], "-", 
        RowBox[{"9", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "ein"}], "-", 
           RowBox[{"3", " ", "eout"}], "+", "eself"}], ")"}], " ", "Qout"}]}],
        ")"}], " ", "\[Mu]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.699781180204089*^9, {3.699781446797988*^9, 3.699781479785037*^9}, 
   3.699787527248124*^9, {3.699787559397271*^9, 3.699787562336577*^9}, 
   3.6997876019039497`*^9, {3.699787663714706*^9, 3.6997876695101843`*^9}, 
   3.699793857302267*^9, 3.6998474811847258`*^9, 3.699848148104183*^9, 
   3.699850615293481*^9, 3.699853766085619*^9, 3.6999553719306917`*^9, 
   3.702201334540431*^9, 3.702289695066875*^9, 3.704178985781805*^9, 
   3.704517733491603*^9, 3.705386141655033*^9, 3.7053862795179243`*^9, 
   3.709990201244254*^9, 3.709990598061387*^9, 3.710048084022653*^9, 
   3.710049706553835*^9, 3.710054317893012*^9, 3.710054524579379*^9, 
   3.710156987840686*^9, 3.713407386662087*^9, 
   3.714232052057707*^9},ExpressionUUID->"abe122fe-0907-4936-82a0-\
fa90b7be32e7"]
}, Open  ]],

Cell["Check also the different terms separately", "Text",
 CellChangeTimes->{{3.7100481590332317`*^9, 
  3.7100481746310043`*^9}},ExpressionUUID->"dc95e1ea-8fa0-415b-a851-\
507063527d44"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]IBDtest", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["\[Mu]", 
           SuperscriptBox["\[CapitalNu]", "2"]], "-", 
          FractionBox[
           RowBox[{"G", "\[LeftDoubleBracket]", 
            RowBox[{"l", ",", "j"}], "\[RightDoubleBracket]"}], 
           "\[CapitalNu]"]}], ")"}], 
        RowBox[{"GE", "\[LeftDoubleBracket]", 
         RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}], 
        RowBox[{"Q", "\[LeftDoubleBracket]", 
         RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"G", "\[Rule]", "G12generic"}], ",", 
       RowBox[{"GE", "\[Rule]", "GE12generic"}], ",", 
       RowBox[{"Q", "\[Rule]", "Q12generic"}], ",", 
       RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}], "}"}]}], "//", 
    "FullSimplify"}], "//", "Quiet"}]}]], "Input",
 CellChangeTimes->{{3.699782870840354*^9, 3.699783001047284*^9}, {
  3.699783945553492*^9, 3.699783947090015*^9}, {3.705386306210133*^9, 
  3.7053863084189987`*^9}, {3.710048089207355*^9, 
  3.7100480900302362`*^9}},ExpressionUUID->"146fffe3-aa9d-4539-8fef-\
a4450221c4a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "dself"}], " ", 
   RowBox[{"(", 
    RowBox[{"eself", "+", 
     RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
     RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "-", 
  RowBox[{"2", " ", "din", " ", 
   RowBox[{"(", 
    RowBox[{"ein", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ein", "+", "eself"}], ")"}], " ", "Qin"}], "+", 
     RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "-", 
  RowBox[{"9", " ", "dout", " ", 
   RowBox[{"(", 
    RowBox[{"eout", "+", 
     RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
     RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
     RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
     RowBox[{"eself", " ", "Qout"}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["1", "12"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "ein"}], "+", 
     RowBox[{"9", " ", "eout"}], "+", "eself"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"2", " ", "Qin"}], "+", 
     RowBox[{"9", " ", "Qout"}]}], ")"}], " ", "\[Mu]"}]}]], "Output",
 CellChangeTimes->{
  3.699850626908044*^9, 3.69985377477147*^9, 3.69995537862757*^9, 
   3.702201342087907*^9, 3.7022897036459637`*^9, 3.704178998731361*^9, 
   3.704517741831716*^9, 3.7053863161025667`*^9, 3.709990212274704*^9, 
   3.709990598795203*^9, {3.7100480919870453`*^9, 3.710048096375235*^9}, 
   3.710049707222682*^9, 3.710054326783057*^9, 3.710054533899839*^9, 
   3.710156994807612*^9, 3.713407395873147*^9, 
   3.714232062292047*^9},ExpressionUUID->"20cda14b-ba32-4f77-80c1-\
e4e4c9aafcf0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]IBDtest", "+", "\[Beta]BDI"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699783020789446*^9, 3.699783038546137*^9}, 
   3.699783089340975*^9, {3.699783957941577*^9, 
   3.699783963099947*^9}},ExpressionUUID->"7da5e941-5242-4509-b6ea-\
bc7318946d9d"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699783026270259*^9, 3.699783039204505*^9}, 
   3.699783090301508*^9, 3.699783569034895*^9, {3.6997839494167013`*^9, 
   3.69978396360054*^9}, {3.699787700318171*^9, 3.699787726454076*^9}, 
   3.699793858230879*^9, 3.6998474919171143`*^9, 3.6998506272226458`*^9, 
   3.699853774989265*^9, 3.699955378817668*^9, 3.702201342294386*^9, 
   3.702289703879959*^9, 3.70417899891127*^9, 3.7045177421432943`*^9, 
   3.70538631770267*^9, 3.7099902164877*^9, 3.709990598835939*^9, 
   3.7100480970973253`*^9, 3.7100497072601223`*^9, 3.710054326895178*^9, 
   3.710054534204973*^9, 3.710156995064357*^9, 3.71340739596626*^9, 
   3.714232062567128*^9},ExpressionUUID->"ad4f0c80-6417-40b1-9618-\
819624c7cc9c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]DBDtest", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]"}], ")"}], "\[CapitalNu]"], 
        RowBox[{"GE", "\[LeftDoubleBracket]", 
         RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}], 
        RowBox[{"Q", "\[LeftDoubleBracket]", 
         RowBox[{"l", ",", "k"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "\[CapitalNu]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"G", "\[Rule]", "G12generic"}], ",", 
       RowBox[{"GE", "\[Rule]", "GE12generic"}], ",", 
       RowBox[{"Q", "\[Rule]", "Q12generic"}], ",", 
       RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}], "}"}]}], "//", 
    "FullSimplify"}], "//", "Quiet"}]}]], "Input",
 CellChangeTimes->{{3.699783999036151*^9, 3.699784026470895*^9}, {
  3.705386321946117*^9, 3.70538632397878*^9}, {3.7100481003225203`*^9, 
  3.710048101278778*^9}},ExpressionUUID->"0bb690e7-87f8-4355-81d9-\
f87049dc66e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{"eself", "+", 
     RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
     RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]], "Output",
 CellChangeTimes->{3.699784037424552*^9, 3.699787735289548*^9, 
  3.6997938582837276`*^9, 3.69984750347519*^9, 3.699850638367219*^9, 
  3.699853784041383*^9, 3.6999553855026217`*^9, 3.702201349396064*^9, 
  3.702289713059708*^9, 3.704179011634886*^9, 3.70451774950618*^9, 
  3.7053863310392017`*^9, 3.709990224577718*^9, 3.709990598917156*^9, 
  3.71004810892866*^9, 3.710049707307419*^9, 3.710054335698373*^9, 
  3.710054543084178*^9, 3.710157002124436*^9, 3.713407405004422*^9, 
  3.714232072555332*^9},ExpressionUUID->"a1c16f8f-a2dc-4105-9edf-\
1a93b5868616"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]DBDtest", "-", "\[Beta]BDD"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699784038835702*^9, 
  3.69978404413303*^9}},ExpressionUUID->"868fe710-6504-4e2c-a237-\
0a87192866c9"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.699784045088913*^9, 3.6997877353512278`*^9, 
  3.6997938583591948`*^9, 3.699847503650477*^9, 3.699850638481913*^9, 
  3.699853784270899*^9, 3.699955385681616*^9, 3.702201349573618*^9, 
  3.702289713227303*^9, 3.704179011750761*^9, 3.7045177497505617`*^9, 
  3.705386331099812*^9, 3.709990236560951*^9, 3.709990598923615*^9, 
  3.710048109047861*^9, 3.710049707339924*^9, 3.7100543357814617`*^9, 
  3.7100545432558804`*^9, 3.7101570023209543`*^9, 3.713407405062214*^9, 
  3.714232072835046*^9},ExpressionUUID->"9c06078b-601e-4c90-b18b-\
243a5bb301c7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]BDtest", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"p", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p"}], ")"}]}], "\[Mu]"], 
     RowBox[{"(", 
      RowBox[{"\[Beta]DBDtest", "+", "\[Beta]IBDtest"}], ")"}]}], "//", 
    "FullSimplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6997840516560383`*^9, 3.699784066994879*^9}, {
   3.699784124706222*^9, 3.699784180324698*^9}, {3.699784434476344*^9, 
   3.699784438938961*^9}, 
   3.7100481939081993`*^9},ExpressionUUID->"dc8f5c7c-9d24-498f-b19c-\
37f4e6bd4410"],

Cell["\<\
Numerical comparison (the differences are zero: we are fine!)\
\>", "Text",
 CellChangeTimes->{{3.710048127222234*^9, 3.710048138020673*^9}, {
  3.7100481992860727`*^9, 
  3.71004820811012*^9}},ExpressionUUID->"aa60792a-cf23-42e0-a2db-\
d482d1e19f83"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]BDtest", "-", "\[Beta]BD"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6997841387119617`*^9, 3.699784144916231*^9}, {
  3.6997841825084257`*^9, 3.699784184642168*^9}, {3.699784448322966*^9, 
  3.699784451265874*^9}},ExpressionUUID->"49acbdd1-68a6-4107-92ff-\
e48c1e4945c4"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699784145255732*^9, 3.699784186958892*^9}, 
   3.699784452682255*^9, 3.699787736958263*^9, 3.699793862518971*^9, 
   3.699847507948889*^9, 3.699850640346918*^9, 3.6998537858932962`*^9, 
   3.6999553869110813`*^9, 3.702201350832096*^9, 3.702289714792705*^9, 
   3.704179013976646*^9, 3.704517751616626*^9, 3.705386332362678*^9, 
   3.709990240896392*^9, 3.709990600096583*^9, 3.710048110910675*^9, 
   3.7100481967790203`*^9, 3.7100497074300737`*^9, 3.710054337243113*^9, 
   3.710054544484828*^9, 3.710157004058296*^9, 3.713407407251863*^9, 
   3.714232075670663*^9},ExpressionUUID->"53d0a1c7-6b4c-40f5-bcd7-\
7dc20da482d3"]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 
  3.7100472277111177`*^9}},ExpressionUUID->"10413593-8879-492f-a11e-\
3a5208855ac9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]BDD", "-", "\[Beta]DBDtest"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699784301329733*^9, 
  3.699784327843625*^9}},ExpressionUUID->"a2b06b7e-4d02-45a6-8150-\
4b45270cadd7"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699784315772072*^9, 3.699784328285502*^9}, 
   3.699787737025803*^9, 3.699793862734157*^9, 3.69984750811241*^9, 
   3.699850640429304*^9, 3.699853785979096*^9, 3.699955387013412*^9, 
   3.7022013509303293`*^9, 3.7022897148979387`*^9, 3.704179014096588*^9, 
   3.704517751800221*^9, 3.705386341001157*^9, 3.709990241790206*^9, 
   3.709990600143642*^9, 3.710048110954846*^9, 3.710049707461434*^9, 
   3.71005433724935*^9, 3.710054544572597*^9, 3.710157004139224*^9, 
   3.713407407274166*^9, 
   3.714232075781427*^9},ExpressionUUID->"5389c077-dde5-4cb2-ab4a-\
37433e6b122f"]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 
  3.7100472277111177`*^9}},ExpressionUUID->"b07323a4-ef47-4f81-9209-\
400a85d07d35"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]BDI", "+", "\[Beta]IBDtest"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.699784332794595*^9, 
  3.6997843402035503`*^9}},ExpressionUUID->"be36772c-9503-43c3-b1d9-\
36c82e715c96"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6997843371632423`*^9, 3.699784340651658*^9}, 
   3.6997877370675783`*^9, 3.699793863115623*^9, 3.699847508572557*^9, 
   3.69985064051857*^9, 3.699853786064782*^9, 3.699955387107954*^9, 
   3.702201351026763*^9, 3.702289714985482*^9, 3.704179014169434*^9, 
   3.704517751951542*^9, 3.705386341733025*^9, 3.709990242288851*^9, 
   3.7099906001897717`*^9, 3.71004811100462*^9, 3.710049707512568*^9, 
   3.710054337278998*^9, 3.710054544665125*^9, 3.7101570042156153`*^9, 
   3.713407407299868*^9, 
   3.714232075927137*^9},ExpressionUUID->"d794707d-255d-4e4a-ac4d-\
d20173d4a8de"]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 
  3.7100472277111177`*^9}},ExpressionUUID->"4890b1cc-d2b5-4c28-9fa0-\
c48ab9eb47fc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations \[Gamma]", "Subsubsection",
 CellChangeTimes->{{3.69978004306563*^9, 3.6997800470396347`*^9}, {
  3.699788019288118*^9, 
  3.699788039145166*^9}},ExpressionUUID->"be20d383-8e61-44f0-9a57-\
56dea43d76c6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]BDexemple", "=", 
  RowBox[{
   RowBox[{"GetGamma", "[", 
    RowBox[{
    "sBfBD", ",", "DfBD", ",", "G12generic", ",", "GE12generic", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarBD", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6997800509176693`*^9, 3.6997800766118813`*^9}, {
   3.699780227296484*^9, 3.699780254043705*^9}, {3.699781039145463*^9, 
   3.699781043696348*^9}, {3.6997811552598333`*^9, 3.699781176230454*^9}, {
   3.6997814599873953`*^9, 3.699781463270492*^9}, 3.699787561723735*^9, {
   3.699787605440502*^9, 3.6997876067381372`*^9}, {3.6997876630669823`*^9, 
   3.699787667730566*^9}, {3.699788044392364*^9, 3.699788048476987*^9}, {
   3.705386355939402*^9, 
   3.705386358345911*^9}},ExpressionUUID->"938087f0-796f-4420-8474-\
b7f38fede2e9"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"12", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "dself", "+", 
        RowBox[{"2", " ", "din", " ", "Qin"}], "+", 
        RowBox[{"9", " ", "dout", " ", "Qout"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"11", "-", 
        RowBox[{"2", " ", "Qin"}], "-", 
        RowBox[{"9", " ", "Qout"}]}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
  RowBox[{"12", " ", "\[Mu]"}]]], "Output",
 CellChangeTimes->{
  3.699781180204089*^9, {3.699781446797988*^9, 3.699781479785037*^9}, 
   3.699787527248124*^9, {3.699787559397271*^9, 3.699787562336577*^9}, 
   3.6997876019039497`*^9, {3.699787663714706*^9, 3.6997876695101843`*^9}, 
   3.699788051319792*^9, 3.699793864949399*^9, 3.699847509644327*^9, 
   3.699850685973023*^9, 3.699853786497395*^9, 3.699955387562585*^9, 
   3.70220135154718*^9, 3.7022897154491863`*^9, 3.70417901455355*^9, 
   3.704517752570101*^9, {3.705386353950165*^9, 3.7053863587980022`*^9}, 
   3.70538654765583*^9, 3.709990246021771*^9, 3.709990600417149*^9, 
   3.710048215703889*^9, 3.71004970764592*^9, 3.71005433740177*^9, 
   3.7100545448285646`*^9, 3.710157004389598*^9, 3.7134074074413013`*^9, 
   3.714232076216346*^9},ExpressionUUID->"c8551086-59a2-475d-91ab-\
d9cadd05ec99"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]BDexemple", "-", "\[Gamma]BD"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.6997880588652267`*^9, 
  3.699788076656334*^9}},ExpressionUUID->"f2bb2427-cd97-46f3-a125-\
2813178d4fb2"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.699788066511174*^9, 3.6997880771213427`*^9}, 
   3.699793865313139*^9, 3.6998475097083883`*^9, 3.699850686611573*^9, 
   3.699853786579216*^9, 3.699955387656536*^9, 3.702201351583353*^9, 
   3.702289715530821*^9, 3.7041790146585817`*^9, 3.7045177527881517`*^9, 
   3.705386360358778*^9, 3.7053865484441767`*^9, 3.709990247084528*^9, 
   3.709990600462048*^9, 3.710048216095747*^9, 3.710049707701622*^9, 
   3.710054337456411*^9, 3.710054544909442*^9, 3.710157004516389*^9, 
   3.713407407464106*^9, 
   3.7142320763685913`*^9},ExpressionUUID->"ffb86f97-8dd5-4d77-be46-\
ef69a039cfc7"]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 
  3.7100472277111177`*^9}},ExpressionUUID->"00f0c07c-0fa5-42af-8563-\
2028512c40dd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wright-Fisher", "Subsection",
 CellChangeTimes->{{3.667817266049498*^9, 3.667817267641507*^9}, {
   3.66782181858403*^9, 3.667821819675145*^9}, {3.66782936574275*^9, 
   3.6678293897729073`*^9}, 3.670318583924882*^9, {3.679394331716178*^9, 
   3.67939433186239*^9}},ExpressionUUID->"91f9c5e6-ef04-4984-bebf-\
613aa6f49c50"],

Cell["\<\
The structure is the same as for Moran DB above - comments are lighter here!\
\>", "Text",
 CellChangeTimes->{{3.710048063471426*^9, 
  3.710048080308312*^9}},ExpressionUUID->"872378a9-34a3-4c1f-9050-\
e3162a3fb146"],

Cell[CellGroupData[{

Cell["Define \[Delta]B and \[Delta]D", "Subsubsection",
 CellChangeTimes->{{3.667817270639081*^9, 
  3.667817303563981*^9}},ExpressionUUID->"b8299969-0e84-4554-af62-\
575f10c178ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sBfWF", "[", 
    RowBox[{
    "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "j_", ",", "k_"}], 
    "]"}], ":=", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox["graphdegree", "2"]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Delta", "[", 
        RowBox[{"k", "-", "j"}], "]"}], 
       SuperscriptBox["graphdegree", "2"]}], "-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"G", "\[LeftDoubleBracket]", 
          RowBox[{"j", ",", "i"}], "\[RightDoubleBracket]"}], 
         RowBox[{"G", "\[LeftDoubleBracket]", 
          RowBox[{"k", ",", "i"}], "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "\[CapitalNu]"}], "}"}]}], "]"}]}], 
     ")"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DfWF", "[", 
    RowBox[{
    "G_", ",", "\[CapitalNu]_", ",", "graphdegree_", ",", "j_", ",", "k_"}], 
    "]"}], ":=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BstarWF", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.667805794031062*^9, 3.6678058049416933`*^9}, {
   3.667805883047532*^9, 3.667806013751638*^9}, {3.667806064496217*^9, 
   3.667806108193321*^9}, {3.6678067367929573`*^9, 3.667806737538381*^9}, {
   3.667806855132804*^9, 3.667806855241205*^9}, 3.6678069002815533`*^9, {
   3.6678178907809553`*^9, 3.6678178913089523`*^9}, {3.6678218224839478`*^9, 
   3.667821926596066*^9}, {3.667829392668222*^9, 3.667829444078204*^9}, {
   3.699779079313068*^9, 3.699779084984041*^9}, {3.699787483271895*^9, 
   3.699787499548053*^9}, 3.6997875336757717`*^9, {3.710044640003652*^9, 
   3.710044641907976*^9}},ExpressionUUID->"435c95c5-dcbe-4435-a8eb-\
c8028435224e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations \[Beta]", "Subsubsection",
 CellChangeTimes->{{3.704518466305232*^9, 
  3.704518471077755*^9}},ExpressionUUID->"40bfa83a-c17a-48e6-87d9-\
5463b588cc1b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Beta]WFexemple", "=", 
  RowBox[{
   RowBox[{"GetBeta", "[", 
    RowBox[{
    "sBfWF", ",", "DfWF", ",", "G12generic", ",", "GE12generic", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarWF", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.704518473149928*^9, 3.704518477106106*^9}, {
  3.704518525281973*^9, 3.704518525614408*^9}, {3.705386390297328*^9, 
  3.70538639242488*^9}},ExpressionUUID->"4151a8a6-adfc-4826-b3f4-\
22a532c3f812"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["dself", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"eself", "+", 
         RowBox[{"2", " ", "ein", " ", "Qin"}], "+", 
         RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["din", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"ein", "+", "eself", "+", 
         RowBox[{"3", " ", "ein", " ", "Qin"}], "+", 
         RowBox[{"eself", " ", "Qin"}], "+", 
         RowBox[{"18", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"18", " ", "dout", " ", "dself", " ", 
       RowBox[{"(", 
        RowBox[{"eout", "+", 
         RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
         RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
         RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
         RowBox[{"eself", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"9", " ", 
       SuperscriptBox["dout", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "ein"}], "+", 
            RowBox[{"6", " ", "eout"}], "+", "eself"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", "Qin"}]}], ")"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "ein"}], "+", 
            RowBox[{"21", " ", "eout"}], "+", 
            RowBox[{"2", " ", "eself"}]}], ")"}], " ", "Qout"}]}], ")"}]}], 
      "+", 
      RowBox[{"4", " ", "din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", 
          RowBox[{"(", 
           RowBox[{"ein", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ein", "+", "eself"}], ")"}], " ", "Qin"}], "+", 
            RowBox[{"9", " ", "eout", " ", "Qout"}]}], ")"}]}], "+", 
         RowBox[{"9", " ", "dout", " ", 
          RowBox[{"(", 
           RowBox[{"eout", "+", 
            RowBox[{"2", " ", "eout", " ", "Qin"}], "+", 
            RowBox[{"2", " ", "ein", " ", "Qout"}], "+", 
            RowBox[{"6", " ", "eout", " ", "Qout"}], "+", 
            RowBox[{"eself", " ", "Qout"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{
  3.704518529446055*^9, 3.705386394172173*^9, 3.709990250496046*^9, 
   3.709990600623661*^9, {3.710048220351632*^9, 3.7100482284837847`*^9}, 
   3.710049708447452*^9, 3.710054337700239*^9, 3.710054545933804*^9, 
   3.710157005828615*^9, 3.713407408939728*^9, 
   3.714232079348612*^9},ExpressionUUID->"0a03af55-0487-4dd1-a5f6-\
91275fa7a74a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]WFexemple", "-", "\[Beta]WF"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.704518541723769*^9, 
  3.7045185466164417`*^9}},ExpressionUUID->"3f4bd7d5-c1f3-45a3-8305-\
0dd716ce030c"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.704518548079015*^9, 3.705386395290873*^9, 
  3.70999025086061*^9, 3.70999060071074*^9, 3.710048229113312*^9, 
  3.710049708497816*^9, 3.710054337735457*^9, 3.7100545460946293`*^9, 
  3.7101570060424633`*^9, 3.713407408981235*^9, 
  3.7142320795117064`*^9},ExpressionUUID->"c19fd090-b776-4952-97ef-\
9303ef447a22"]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 
  3.7100472277111177`*^9}},ExpressionUUID->"bf1f5836-8051-4440-b732-\
a2ae1c36da0b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equations \[Gamma]", "Subsubsection",
 CellChangeTimes->{{3.704518466305232*^9, 3.704518471077755*^9}, {
  3.704518565295594*^9, 
  3.7045185659244537`*^9}},ExpressionUUID->"2e8e7ab7-ef8c-462e-a212-\
448f74dd6d48"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Gamma]WFexemple", "=", 
  RowBox[{
   RowBox[{"GetGamma", "[", 
    RowBox[{
    "sBfWF", ",", "DfWF", ",", "G12generic", ",", "GE12generic", ",", 
     "Q12generic", ",", "12", ",", "1", ",", 
     RowBox[{"BstarWF", "/.", 
      RowBox[{"\[CapitalNu]", "\[Rule]", "12"}]}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.704518473149928*^9, 3.704518477106106*^9}, {
  3.704518525281973*^9, 3.704518525614408*^9}, {3.704518573841819*^9, 
  3.70451857849754*^9}, {3.7053863990730762`*^9, 
  3.705386401225338*^9}},ExpressionUUID->"39c80467-f1ff-4383-9a33-\
e30b0a268dc2"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["dself", "2"], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["din", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "Qin"}], ")"}]}], "+", 
      RowBox[{"4", " ", "din", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dself", " ", "Qin"}], "+", 
         RowBox[{"9", " ", "dout", " ", "Qout"}]}], ")"}]}], "+", 
      RowBox[{"9", " ", "dout", " ", 
       RowBox[{"(", 
        RowBox[{"dout", "+", 
         RowBox[{"2", " ", "dout", " ", "Qin"}], "+", 
         RowBox[{"6", " ", "dout", " ", "Qout"}], "+", 
         RowBox[{"2", " ", "dself", " ", "Qout"}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.704518529446055*^9, 3.704518586982461*^9, 
  3.70538640188498*^9, 3.709990252338045*^9, 3.709990600925812*^9, 
  3.7100482304906187`*^9, 3.7100497086671467`*^9, 3.71005433787577*^9, 
  3.710054546329961*^9, 3.7101570062810593`*^9, 3.713407409178536*^9, 
  3.714232079805571*^9},ExpressionUUID->"bfaf4f52-c634-4fcd-8808-\
36996e796cc2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Gamma]WFexemple", "-", "\[Gamma]WF"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "\[Rule]", "3"}], ",", 
     RowBox[{"d", "\[Rule]", "4"}]}], "}"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.704518541723769*^9, 3.7045185466164417`*^9}, {
  3.704518588888479*^9, 
  3.7045185931197243`*^9}},ExpressionUUID->"041678a8-17f0-423b-a670-\
67b9f08b8ef2"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.7045185935188313`*^9, 3.705386404107149*^9, 
  3.709990253340064*^9, 3.70999060098426*^9, 3.710048230938107*^9, 
  3.7100497087072163`*^9, 3.710054337911253*^9, 3.710054546363802*^9, 
  3.710157006309971*^9, 3.713407409201877*^9, 
  3.714232079899316*^9},ExpressionUUID->"825080fe-233f-4a84-9f9d-\
32c485978c92"]
}, Open  ]],

Cell["The difference is zero: we are fine!", "Text",
 CellChangeTimes->{{3.710047222294488*^9, 
  3.7100472277111177`*^9}},ExpressionUUID->"9d5f5030-4595-4bf4-b10a-\
4b2a64a4e7e5"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Expected frequencies of altruists in the population", "Section",
 CellChangeTimes->{{3.699793899806631*^9, 3.699793901911666*^9}, {
  3.710048355732325*^9, 
  3.710048363875052*^9}},ExpressionUUID->"32ee111d-5c75-452b-a84a-\
145161e169a5"],

Cell[CellGroupData[{

Cell["Moran BD", "Subsection",
 CellChangeTimes->{{3.7100483656347847`*^9, 
  3.7100483687841043`*^9}},ExpressionUUID->"00289745-ea23-4b73-8755-\
31a15e8be6d9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EXBD", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"p", "+", 
      RowBox[{"\[Delta]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Beta]BD", " ", "b"}], " ", "-", " ", 
         RowBox[{"\[Gamma]BD", " ", "c"}]}], ")"}]}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
       RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", "genericde"}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.699794103164796*^9, 3.699794182877057*^9}, {
   3.699847658278121*^9, 3.69984768206605*^9}, {3.6998478842384787`*^9, 
   3.69984789314879*^9}, 
   3.699847955062521*^9},ExpressionUUID->"fc286cf4-e206-40d2-a2d8-\
72f9ea487b72"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", "\[Mu]",
        " ", 
       RowBox[{"(", 
        RowBox[{"m", "-", "n", "+", 
         RowBox[{"Idself", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
         RowBox[{"m", " ", "\[Mu]"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["d", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "c"}], " ", "Idself", " ", "m", " ", "n", " ", 
          "\[Delta]"}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "\[Delta]"}], "+", 
         RowBox[{"c", " ", "Idself", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "\[Delta]"}], "+", 
         RowBox[{"c", " ", "m", " ", 
          SuperscriptBox["n", "2"], " ", "\[Delta]"}], "+", 
         RowBox[{
         "c", " ", "Idself", " ", "m", " ", "n", " ", "p", " ", "\[Delta]"}], 
         "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "p", " ", "\[Delta]"}], 
         "-", 
         RowBox[{"c", " ", "Idself", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "p", " ", "\[Delta]"}], 
         "-", 
         RowBox[{"c", " ", "m", " ", 
          SuperscriptBox["n", "2"], " ", "p", " ", "\[Delta]"}], "+", 
         RowBox[{"Idself", " ", "\[Mu]"}], "-", 
         RowBox[{"Idself", " ", "m", " ", "\[Mu]"}], "-", 
         RowBox[{"n", " ", "\[Mu]"}], "+", 
         RowBox[{"2", " ", "m", " ", "n", " ", "\[Mu]"}], "-", 
         RowBox[{"m", " ", 
          SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
         RowBox[{
         "2", " ", "c", " ", "Idself", " ", "\[Delta]", " ", "\[Mu]"}], "-", 
         RowBox[{
         "2", " ", "c", " ", "Idself", " ", "m", " ", "\[Delta]", " ", 
          "\[Mu]"}], "-", 
         RowBox[{"2", " ", "c", " ", "n", " ", "\[Delta]", " ", "\[Mu]"}], 
         "-", 
         RowBox[{
         "c", " ", "Idself", " ", "n", " ", "\[Delta]", " ", "\[Mu]"}], "+", 
         RowBox[{
         "2", " ", "c", " ", "m", " ", "n", " ", "\[Delta]", " ", "\[Mu]"}], 
         "+", 
         RowBox[{
         "2", " ", "c", " ", "Idself", " ", "m", " ", "n", " ", "\[Delta]", 
          " ", "\[Mu]"}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "\[Delta]", " ", "\[Mu]"}],
          "-", 
         RowBox[{"c", " ", "Idself", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "\[Delta]", " ", "\[Mu]"}],
          "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["n", "2"], " ", "\[Delta]", " ", "\[Mu]"}], "-", 
         RowBox[{"2", " ", "c", " ", "m", " ", 
          SuperscriptBox["n", "2"], " ", "\[Delta]", " ", "\[Mu]"}], "-", 
         RowBox[{
         "2", " ", "c", " ", "Idself", " ", "p", " ", "\[Delta]", " ", 
          "\[Mu]"}], "+", 
         RowBox[{
         "2", " ", "c", " ", "Idself", " ", "m", " ", "p", " ", "\[Delta]", 
          " ", "\[Mu]"}], "+", 
         RowBox[{
         "2", " ", "c", " ", "n", " ", "p", " ", "\[Delta]", " ", "\[Mu]"}], 
         "+", 
         RowBox[{
         "c", " ", "Idself", " ", "n", " ", "p", " ", "\[Delta]", " ", 
          "\[Mu]"}], "-", 
         RowBox[{
         "2", " ", "c", " ", "m", " ", "n", " ", "p", " ", "\[Delta]", " ", 
          "\[Mu]"}], "-", 
         RowBox[{
         "2", " ", "c", " ", "Idself", " ", "m", " ", "n", " ", "p", " ", 
          "\[Delta]", " ", "\[Mu]"}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "p", " ", "\[Delta]", " ", 
          "\[Mu]"}], "+", 
         RowBox[{"c", " ", "Idself", " ", 
          SuperscriptBox["m", "2"], " ", "n", " ", "p", " ", "\[Delta]", " ", 
          "\[Mu]"}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["n", "2"], " ", "p", " ", "\[Delta]", " ", "\[Mu]"}],
          "+", 
         RowBox[{"2", " ", "c", " ", "m", " ", 
          SuperscriptBox["n", "2"], " ", "p", " ", "\[Delta]", " ", "\[Mu]"}],
          "-", 
         RowBox[{"Idself", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"Idself", " ", "m", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"2", " ", "n", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"2", " ", "m", " ", "n", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["n", "2"], " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"m", " ", 
          SuperscriptBox["n", "2"], " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"c", " ", "Idself", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"c", " ", "Idself", " ", "m", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"2", " ", "c", " ", "n", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"2", " ", "c", " ", "m", " ", "n", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"c", " ", 
          SuperscriptBox["n", "2"], " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"c", " ", "m", " ", 
          SuperscriptBox["n", "2"], " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"c", " ", "Idself", " ", "p", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"c", " ", "Idself", " ", "m", " ", "p", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"2", " ", "c", " ", "n", " ", "p", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{
         "2", " ", "c", " ", "m", " ", "n", " ", "p", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"c", " ", 
          SuperscriptBox["n", "2"], " ", "p", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "-", 
         RowBox[{"c", " ", "m", " ", 
          SuperscriptBox["n", "2"], " ", "p", " ", "\[Delta]", " ", 
          SuperscriptBox["\[Mu]", "2"]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "Ieself"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", "\[Mu]"}],
               ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"m", "+", 
               RowBox[{"n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", "\[Mu]"}],
               ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", "n", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}], "+", 
            RowBox[{"Idself", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Ieself", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"m", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
                  "\[Mu]"}], ")"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "2"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]"}]}],
               ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"d", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["m", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"c", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]"}], "+", 
            
            RowBox[{"b", " ", 
             RowBox[{"(", 
              RowBox[{"\[Delta]", "-", 
               RowBox[{"p", " ", "\[Delta]"}]}], ")"}]}], "+", "\[Mu]"}], 
           ")"}]}], "+", 
         RowBox[{"\[Mu]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"c", "+", 
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", "Ieself"}]}], 
                 ")"}]}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
             "\[Mu]"}], "+", 
            RowBox[{"n", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"3", " ", "c", " ", "\[Delta]"}], "-", 
               RowBox[{"3", " ", "c", " ", "p", " ", "\[Delta]"}], "-", 
               RowBox[{"2", " ", "\[Mu]"}], "-", 
               RowBox[{"2", " ", "c", " ", "\[Delta]", " ", "\[Mu]"}], "+", 
               RowBox[{
               "2", " ", "c", " ", "p", " ", "\[Delta]", " ", "\[Mu]"}], "-", 
               
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", "Ieself", "+", 
                  RowBox[{"g", " ", 
                   RowBox[{"(", 
                    RowBox[{"2", "+", 
                    RowBox[{"Ieself", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
                    "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
                  RowBox[{"Ieself", " ", "\[Mu]"}]}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["n", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"\[Mu]", "+", 
               RowBox[{"c", " ", "\[Delta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "p", "+", "\[Mu]", "-", 
                  RowBox[{"p", " ", "\[Mu]"}]}], ")"}]}]}], ")"}]}]}], 
           ")"}]}], "+", 
         RowBox[{"m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"n", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Delta]", "-", 
                  RowBox[{"p", " ", "\[Delta]"}]}], ")"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"c", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", 
                   "\[Delta]"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
             "\[Mu]", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "c", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "-", "Ieself", "-", 
                  RowBox[{"2", " ", "\[Mu]"}], "+", 
                  RowBox[{"g", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "Ieself", "+", "\[Mu]"}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"Idself", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]"}], 
               "+", 
               RowBox[{"c", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Delta]", "-", 
                  RowBox[{"p", " ", "\[Delta]"}]}], ")"}]}], "-", "\[Mu]"}], 
              ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
            RowBox[{"\[Mu]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Mu]", "+", 
               RowBox[{"c", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "3"}], "+", "n", "+", 
                  RowBox[{"2", " ", "\[Mu]"}]}], ")"}]}], "+", 
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "p"}], ")"}], " ", "\[Delta]", " ", 
                RowBox[{"(", 
                 RowBox[{"3", "-", "Ieself", "-", 
                  RowBox[{"2", " ", "\[Mu]"}], "+", 
                  RowBox[{"g", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "Ieself", "+", "\[Mu]"}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"d", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["m", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "-", 
      RowBox[{"Idself", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
         RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
      "+", 
      RowBox[{"m", " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
        ")"}]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.699847950839044*^9, 3.699847957073048*^9}, 
   3.699850696950412*^9, 3.699853788663226*^9, 3.699955389774281*^9, 
   3.702201353655032*^9, 3.702218213982106*^9, 3.70228971785221*^9, 
   3.7041790172637997`*^9, 3.70451775497647*^9, 3.7053869313432703`*^9, 
   3.705387257551435*^9, 3.709990257453497*^9, 3.7099906025612917`*^9, 
   3.7100497104966097`*^9, 3.710054339658348*^9, 3.710054547929489*^9, 
   3.710157008043213*^9, 3.713407411466063*^9, 
   3.714232082429041*^9},ExpressionUUID->"dc487adb-2fc9-4ee6-9cf7-\
2e7afa81e728"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moran DB", "Subsection",
 CellChangeTimes->{{3.710048383474581*^9, 
  3.7100483857029552`*^9}},ExpressionUUID->"d566c12a-cec2-40b6-9bee-\
dd175cd3f340"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EXDB", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"p", "+", 
      RowBox[{"\[Delta]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Beta]DB", " ", "b"}], " ", "-", " ", 
         RowBox[{"\[Gamma]DB", " ", "c"}]}], ")"}]}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
       RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", "genericde"}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.699794103164796*^9, 3.699794182877057*^9}, {
   3.699847658278121*^9, 3.69984768206605*^9}, {3.6998478842384787`*^9, 
   3.6998479101499863`*^9}, {3.6998479617010317`*^9, 3.699847962342051*^9}, 
   3.7100483811403723`*^9},ExpressionUUID->"ce2359da-d69b-4dab-b90d-\
324ae540919b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"n", "-", 
          RowBox[{"d", " ", "n"}]}], ")"}], "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["m", "2"]}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
         RowBox[{"Idself", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
            RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]", 
          " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
           ")"}]}], "-", 
         RowBox[{"m", " ", "n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
           ")"}]}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
       SuperscriptBox["n", "3"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "p"}], ")"}], " ", "\[Delta]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m", " ", "n", " ", 
             RowBox[{"(", 
              RowBox[{"2", "+", 
               RowBox[{"d", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"n", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
                  RowBox[{"2", " ", "\[Mu]"}]}], ")"}]}]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "n", " ", 
             "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["m", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", 
               RowBox[{"d", " ", "n"}], "+", "\[Mu]"}], ")"}]}], "-", 
            RowBox[{
             SuperscriptBox["Idself", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"m", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
                  "\[Mu]"}], ")"}]}], "+", "\[Mu]"}], ")"}]}], "+", 
            RowBox[{"Idself", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", " ", 
                SuperscriptBox["m", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "\[Mu]"}], "+", 
               
               RowBox[{"m", " ", 
                RowBox[{"(", 
                 RowBox[{"2", "-", 
                  RowBox[{"2", " ", "d", " ", "\[Mu]"}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["m", "2"]}], "-", 
            RowBox[{"2", " ", "d", " ", 
             SuperscriptBox["m", "2"]}], "-", 
            RowBox[{"2", " ", "d", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "Ieself", " ", 
             SuperscriptBox["m", "2"]}], "+", 
            RowBox[{"2", " ", "d", " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"]}], "+", 
            RowBox[{"d", " ", "g", " ", 
             SuperscriptBox["m", "3"]}], "+", 
            RowBox[{"d", " ", "Ieself", " ", 
             SuperscriptBox["m", "3"]}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "Ieself", " ", 
             SuperscriptBox["m", "3"]}], "-", 
            RowBox[{"d", " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "3"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "3"]}], "-", 
            RowBox[{"2", " ", "m", " ", "n"}], "+", 
            RowBox[{"2", " ", "d", " ", "m", " ", "n"}], "+", 
            RowBox[{"2", " ", "d", " ", "Ieself", " ", "m", " ", "n"}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "Ieself", " ", "m", " ", "n"}], 
            "-", 
            RowBox[{
            "2", " ", "d", " ", "g", " ", "Ieself", " ", "m", " ", "n"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", "m", " ",
              "n"}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["m", "2"], " ", "n"}], "+", 
            RowBox[{"3", " ", "d", " ", 
             SuperscriptBox["m", "2"], " ", "n"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["m", "2"], " ", "n"}], "-", 
            RowBox[{"2", " ", "d", " ", "g", " ", 
             SuperscriptBox["m", "2"], " ", "n"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", 
             SuperscriptBox["m", "2"], " ", "n"}], "-", 
            RowBox[{"d", " ", 
             SuperscriptBox["m", "3"], " ", "n"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["m", "3"], " ", "n"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", 
             SuperscriptBox["m", "3"], " ", "n"}], "+", 
            RowBox[{"2", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "-", 
            RowBox[{"3", " ", "d", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{"d", " ", "g", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "-", 
            RowBox[{"d", " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{"d", " ", "g", " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{"d", " ", 
             SuperscriptBox["m", "2"], " ", 
             SuperscriptBox["n", "2"]}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["m", "2"], " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", 
             SuperscriptBox["m", "2"], " ", 
             SuperscriptBox["n", "2"]}], "+", 
            RowBox[{"2", " ", "g", " ", "m", " ", "\[Mu]"}], "-", 
            RowBox[{"2", " ", "d", " ", "g", " ", "m", " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", "Ieself", " ", "m", " ", "\[Mu]"}], "-", 
            RowBox[{"4", " ", "d", " ", "Ieself", " ", "m", " ", "\[Mu]"}], 
            "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "Ieself", " ", "m", " ", 
             "\[Mu]"}], "-", 
            RowBox[{"2", " ", "g", " ", "Ieself", " ", "m", " ", "\[Mu]"}], 
            "+", 
            RowBox[{
            "4", " ", "d", " ", "g", " ", "Ieself", " ", "m", " ", "\[Mu]"}], 
            "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", "m", " ",
              "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"d", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"g", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", "d", " ", "g", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"Ieself", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"4", " ", "d", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["d", "2"], " ", "Ieself", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"g", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"4", " ", "d", " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"3", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"d", " ", "g", " ", 
             SuperscriptBox["m", "3"], " ", "\[Mu]"}], "-", 
            RowBox[{"d", " ", "Ieself", " ", 
             SuperscriptBox["m", "3"], " ", "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "Ieself", " ", 
             SuperscriptBox["m", "3"], " ", "\[Mu]"}], "+", 
            RowBox[{"d", " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "3"], " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["m", "3"], " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{"4", " ", "d", " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{"2", " ", "g", " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"4", " ", "d", " ", "g", " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "n", " ", "\[Mu]"}], 
            "-", 
            RowBox[{"2", " ", "Ieself", " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"4", " ", "d", " ", "Ieself", " ", "n", " ", "\[Mu]"}], 
            "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "Ieself", " ", "n", " ", 
             "\[Mu]"}], "+", 
            RowBox[{"2", " ", "g", " ", "Ieself", " ", "n", " ", "\[Mu]"}], 
            "-", 
            RowBox[{
            "4", " ", "d", " ", "g", " ", "Ieself", " ", "n", " ", "\[Mu]"}], 
            "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", "n", " ",
              "\[Mu]"}], "-", 
            RowBox[{"2", " ", "m", " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"6", " ", "d", " ", "m", " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["d", "2"], " ", "m", " ", "n", " ", "\[Mu]"}], 
            "-", 
            RowBox[{
            "4", " ", "d", " ", "g", " ", "m", " ", "n", " ", "\[Mu]"}], "+", 
            
            RowBox[{"4", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "m", " ", "n", " ", 
             "\[Mu]"}], "-", 
            RowBox[{
            "2", " ", "d", " ", "Ieself", " ", "m", " ", "n", " ", "\[Mu]"}], 
            "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "Ieself", " ", "m", " ", "n", " ",
              "\[Mu]"}], "+", 
            RowBox[{
            "2", " ", "d", " ", "g", " ", "Ieself", " ", "m", " ", "n", " ", 
             "\[Mu]"}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", "m", " ",
              "n", " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["m", "2"], " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{"5", " ", "d", " ", 
             SuperscriptBox["m", "2"], " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"3", " ", 
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["m", "2"], " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", "d", " ", "g", " ", 
             SuperscriptBox["m", "2"], " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["d", "2"], " ", "g", " ", 
             SuperscriptBox["m", "2"], " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{"d", " ", 
             SuperscriptBox["m", "3"], " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["m", "3"], " ", "n", " ", "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", 
             SuperscriptBox["m", "3"], " ", "n", " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", "d", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"g", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"2", " ", "d", " ", "g", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"Ieself", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"2", " ", "d", " ", "Ieself", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "Ieself", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"g", " ", "Ieself", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"2", " ", "d", " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"d", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"d", " ", "g", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{"d", " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{"d", " ", "g", " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "+", 
            RowBox[{
             SuperscriptBox["d", "2"], " ", "g", " ", "Ieself", " ", "m", " ", 
             SuperscriptBox["n", "2"], " ", "\[Mu]"}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", 
             SuperscriptBox["Idself", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "Ieself"}], ")"}], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"m", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "-", 
                  "\[Mu]"}], ")"}]}], "+", "\[Mu]"}], ")"}]}], "+", 
            RowBox[{"Idself", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"d", " ", 
                SuperscriptBox["m", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "-", 
                  RowBox[{"2", " ", "g", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Ieself"}], ")"}]}], "+", 
                  RowBox[{"2", " ", "Ieself"}], "+", 
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "Ieself"}], "-", "n"}], ")"}]}], "-", 
                  "n"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "Ieself"}], ")"}], " ", "\[Mu]"}], 
               "-", 
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "m", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "n", "+", 
                  RowBox[{"g", " ", "\[Mu]"}], "+", 
                  RowBox[{"Ieself", " ", "\[Mu]"}], "-", 
                  RowBox[{"g", " ", "Ieself", " ", "\[Mu]"}], "-", 
                  RowBox[{"n", " ", "\[Mu]"}], "-", 
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"Ieself", "+", 
                    RowBox[{"n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]",
                     "-", 
                    RowBox[{"2", " ", "Ieself", " ", "\[Mu]"}]}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}], 
  "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"n", "-", 
       RowBox[{"d", " ", "n"}]}], ")"}], "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["m", "2"]}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], "+", 
      RowBox[{"Idself", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "m"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}]}], "+", "\[Mu]", "-", 
         RowBox[{"d", " ", "\[Mu]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n", " ", "\[Mu]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], ")"}]}], 
      "-", 
      RowBox[{"m", " ", "n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"d", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "\[Mu]"}]}], 
        ")"}]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.69984796692839*^9, 3.6998480003521223`*^9, 
  3.699850704564148*^9, 3.699853794552924*^9, 3.6999553946642847`*^9, 
  3.702201359294602*^9, 3.70228972401832*^9, 3.7041790259883947`*^9, 
  3.704517760316613*^9, 3.7053872631482477`*^9, 3.709990262320902*^9, 
  3.709990608073999*^9, 3.710049716465612*^9, 3.710054345134987*^9, 
  3.7100545532419252`*^9, 3.710157012991042*^9, 3.713407418498376*^9, 
  3.7142320899761143`*^9},ExpressionUUID->"6a269ae1-c0b5-4a7a-90a7-\
5e2a45a0dbcb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wright - Fisher", "Subsection",
 CellChangeTimes->{{3.7100483889694242`*^9, 
  3.7100483963311768`*^9}},ExpressionUUID->"5f5f34e6-45d9-46fa-9886-\
0c9c945da5a4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EXWF", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"p", "+", 
      RowBox[{"\[Delta]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Beta]WF", " ", "b"}], " ", "-", " ", 
         RowBox[{"\[Gamma]WF", " ", "c"}]}], ")"}]}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Qin", "\[Rule]", "QinWF"}], ",", 
       RowBox[{"Qout", "\[Rule]", "QoutWF"}]}], "}"}]}], "/.", "genericde"}], 
   "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.699794103164796*^9, 3.699794182877057*^9}, {
  3.699847658278121*^9, 3.69984768206605*^9}, {3.6998478842384787`*^9, 
  3.6998479101499863`*^9}, {3.6998479656376753`*^9, 
  3.699847966301961*^9}},ExpressionUUID->"29b11746-9714-42af-9716-\
6b74b2c2dbfa"],

Cell[BoxData[
 RowBox[{"p", "+", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}], " ", "p", " ", "\[Delta]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{
              SuperscriptBox["Idself", "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"]}], 
             SuperscriptBox["n", "2"]], "+", 
            FractionBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"Idself", "-", "n"}], ")"}], "2"]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
              SuperscriptBox["n", "2"]}]], "+", 
            FractionBox[
             SuperscriptBox["m", "2"], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n"}]], "-", 
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "+", 
                RowBox[{"d", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2"}], "+", "m"}], ")"}]}]}], ")"}], " ", "m",
               " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["1", 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                FractionBox["1", 
                 RowBox[{
                  RowBox[{"2", " ", "\[Mu]"}], "-", 
                  SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                FractionBox[
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "d"}], 
                 RowBox[{"1", "-", 
                  FractionBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                FractionBox[
                 RowBox[{"d", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                 RowBox[{"1", "-", 
                  FractionBox[
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                FractionBox["1", 
                 RowBox[{
                  RowBox[{"2", " ", "\[Mu]"}], "-", 
                  SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "Idself", " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"]}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
                  SuperscriptBox["Idself", "2"], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "n"}], "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "m", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "n"}], "+", 
                 RowBox[{
                  SuperscriptBox["m", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", "n"}]}], 
                   ")"}]}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                 FractionBox["d", 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                 FractionBox[
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}], "+", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Mu]"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"Ieself", "-", 
           RowBox[{"g", " ", "Ieself"}]}], "n"], "+", 
         FractionBox[
          RowBox[{"g", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", 
               RowBox[{"1", "-", 
                FractionBox[
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                  " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
             FractionBox["1", 
              RowBox[{
               RowBox[{"2", " ", "\[Mu]"}], "-", 
               SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"-", "1"}], "+", "d"}], 
            RowBox[{"1", "-", 
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
               " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
           FractionBox[
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
            RowBox[{"1", "-", 
             FractionBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
           FractionBox["1", 
            RowBox[{
             RowBox[{"2", " ", "\[Mu]"}], "-", 
             SuperscriptBox["\[Mu]", "2"]}]]}]], "-", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "g"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Ieself", "-", "n"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                 " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
             FractionBox["d", 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
             FractionBox["1", 
              RowBox[{
               RowBox[{"2", " ", "\[Mu]"}], "-", 
               SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
          RowBox[{"n", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                 " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
             FractionBox[
              RowBox[{"d", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
             FractionBox["1", 
              RowBox[{
               RowBox[{"2", " ", "\[Mu]"}], "-", 
               SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]], "-", 
         RowBox[{
          FractionBox["1", 
           SuperscriptBox["n", "2"]], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Idself", "-", 
              RowBox[{"Idself", " ", "m"}]}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"Ieself", "-", 
               RowBox[{"g", " ", "Ieself"}]}], "n"], "+", 
             FractionBox[
              RowBox[{"g", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["1", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "1"}], "+", "d"}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                   " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
               FractionBox[
                RowBox[{"d", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
               FractionBox["1", 
                RowBox[{
                 RowBox[{"2", " ", "\[Mu]"}], "-", 
                 SuperscriptBox["\[Mu]", "2"]}]]}]], "-", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "g"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"Ieself", "-", "n"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                 FractionBox["d", 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
              RowBox[{"n", " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                 FractionBox[
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]]}], ")"}]}]}], 
         "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"], " ", "n"}]], 
          RowBox[{
           SuperscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "-", 
                 RowBox[{"3", " ", "d"}], "+", 
                 SuperscriptBox["d", "2"], "+", "g"}], ")"}], " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["1", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "1"}], "+", "d"}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                   " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
               FractionBox[
                RowBox[{"d", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
               FractionBox["1", 
                RowBox[{
                 RowBox[{"2", " ", "\[Mu]"}], "-", 
                 SuperscriptBox["\[Mu]", "2"]}]]}]], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d", "-", "g"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                FractionBox[
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                    FractionBox["d", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                  FractionBox[
                   RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                  FractionBox["1", 
                   RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}]]}], ")"}]}]}], 
            ")"}]}]}], "-", 
         RowBox[{
          FractionBox["1", "n"], 
          RowBox[{"2", " ", "Idself", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "m"}], ")"}], " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "g"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["1", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "1"}], "+", "d"}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                   " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
               FractionBox[
                RowBox[{"d", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
               FractionBox["1", 
                RowBox[{
                 RowBox[{"2", " ", "\[Mu]"}], "-", 
                 SuperscriptBox["\[Mu]", "2"]}]]}]], "+", 
             RowBox[{
              FractionBox["1", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "d"}], ")"}], " ", "n"}]], 
              RowBox[{"g", " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "d"}], ")"}], " ", "n", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                   FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                   FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}]], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                    FractionBox["d", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                   FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                   FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}]]}], ")"}]}]}]}], 
            ")"}]}]}], "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
            SuperscriptBox["n", "2"]}]], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"Idself", "-", "n"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox[
              RowBox[{"Ieself", "-", 
               RowBox[{"g", " ", "Ieself"}]}], "n"], "+", 
             FractionBox[
              RowBox[{"g", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  FractionBox["1", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "1"}], "+", "d"}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                   " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
               FractionBox[
                RowBox[{"d", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
               FractionBox["1", 
                RowBox[{
                 RowBox[{"2", " ", "\[Mu]"}], "-", 
                 SuperscriptBox["\[Mu]", "2"]}]]}]], "+", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "g"}], ")"}], " ", "Ieself", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                 FractionBox["d", 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
              RowBox[{"n", " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "d"}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                 FractionBox[
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                  RowBox[{"1", "-", 
                   FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"2", " ", "\[Mu]"}], "-", 
                   SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]], "+", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "g"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"Ieself", "-", "n"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "2"}], "+", "n", "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"3", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", "n"}]}], 
                    ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                    FractionBox["d", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                   FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                   FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}]]}], ")"}]}], 
              RowBox[{"n", "-", 
               SuperscriptBox["n", "2"]}]]}], ")"}]}]}], "+", 
         RowBox[{
          FractionBox["1", "n"], 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "m"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Idself", "-", "n"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["1", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "d"}]], 
              RowBox[{"m", " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox["g", "n"], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d", "-", "g"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                   FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                   FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}]], "+", 
                 FractionBox[
                  RowBox[{"g", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                    FractionBox["d", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{"n", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                    FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]]}], ")"}]}]}], 
             "+", 
             RowBox[{
              FractionBox["1", "n"], 
              RowBox[{"Idself", " ", 
               RowBox[{"(", 
                RowBox[{"1", "-", "m"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "g"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"Ieself", "-", "n"}], ")"}]}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "n"}]], "+", 
                 FractionBox[
                  RowBox[{"g", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox["1", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]]}], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                   FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                   FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}]], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "g"}], ")"}], " ", "Ieself", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                    FractionBox["d", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{"n", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                    FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "g"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"Ieself", "-", "n"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "n"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "-", 
                    FractionBox["d", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"n", "-", 
                    SuperscriptBox["n", "2"]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}]}]}], ")"}], "2"], 
                    " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "d"}], ")"}], "2"]]}]], "+", 
                    FractionBox[
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}]}], 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "Idself"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "m"}], ")"}], "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"]}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"]]}]], "+", 
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Mu]"}], "-", 
                    SuperscriptBox["\[Mu]", "2"]}]]}], ")"}]}]]}], 
                ")"}]}]}]}], ")"}]}]}]}], ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.6998479732848587`*^9, 3.699848060824608*^9, 
  3.6998507474099894`*^9, 3.6998538313784227`*^9, 3.699955425644464*^9, 
  3.7022013904600773`*^9, 3.702289763161767*^9, 3.7041790863427*^9, 
  3.704517794173602*^9, 3.705387298191299*^9, 3.709990299963561*^9, 
  3.709990640396688*^9, 3.710049751502159*^9, 3.710054379436544*^9, 
  3.710054587014152*^9, 3.7101570439856453`*^9, 3.713407464767517*^9, 
  3.714232142150387*^9},ExpressionUUID->"460e906c-bca0-4e6a-b46e-\
e335bfe8e069"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export to R", "Section",
 CellChangeTimes->{{3.710054285978345*^9, 
  3.710054288785317*^9}},ExpressionUUID->"b42cf564-70d3-4896-9089-\
8cc7f0f82dd3"],

Cell[CellGroupData[{

Cell["Export the EX formulas to R", "Subsubsection",
 CellChangeTimes->{{3.702201500553801*^9, 3.702201503237453*^9}, {
  3.710048406724223*^9, 3.710048409155136*^9}, {3.7100542275051394`*^9, 
  3.710054227856474*^9}},ExpressionUUID->"d0d8954d-067b-41ce-9d52-\
a67afb15e96a"],

Cell["Rewrite the Greek letters", "Text",
 CellChangeTimes->{{3.702202576100587*^9, 
  3.702202585533182*^9}},ExpressionUUID->"9bba0139-8409-402f-abf1-\
6bafd167e541"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GreekTerms", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Delta]", "\[Rule]", "sel"}], ",", " ", 
    RowBox[{"\[Mu]", "\[Rule]", "mut"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.702201509383871*^9, 
  3.702201525212894*^9}},ExpressionUUID->"9281d696-3ed2-4d18-bdc6-\
b167cd67628f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Delta]", "\[Rule]", "sel"}], ",", 
   RowBox[{"\[Mu]", "\[Rule]", "mut"}]}], "}"}]], "Output",
 CellChangeTimes->{3.70220152616304*^9, 3.7022030131218777`*^9, 
  3.7022897635244837`*^9, 3.704179086467165*^9, 3.7045177944473457`*^9, 
  3.709990534196932*^9, 3.709990640508429*^9, 3.71004975160399*^9, 
  3.7100545872346973`*^9, 3.710157044181634*^9, 3.7134074649711103`*^9, 
  3.714232142419485*^9},ExpressionUUID->"f475ed57-a766-4772-95c9-\
b015715205a0"]
}, Open  ]],

Cell["Common parts to all functions", "Text",
 CellChangeTimes->{{3.7022025881711607`*^9, 
  3.7022025922143908`*^9}},ExpressionUUID->"ffbfb115-7ac8-419b-9b97-\
753fe9193ad1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "FunctionPartB", "=", 
   "\"\< <- function(b, c, p, sel, mut, m, g, n, d, Idself, Ieself){\n## \
Arguments:\n#  b   benefit of interaction\n#  c   cost of interaction\n#  p   \
mutation bias\n#  sel intensity of selection\n#  mut mutation probability\n#  \
m   emigration probability\n#  g   proportion of interactions out of the \
group (interaction equivalent of m)\n#  n   deme size\n#  d   number of demes\
\n#  Idself whether reproduction in site where the parent is\n#  Ieself \
whether interactions with oneself\nreturn(\n\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FunctionPartE", "=", "\"\<)\n}\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.702201586590098*^9, 3.702201660652206*^9}, {
  3.702202515399782*^9, 3.70220251599327*^9}, {3.702202562602117*^9, 
  3.702202562914797*^9}, {3.702202598064639*^9, 3.702202697296604*^9}, {
  3.702202988690043*^9, 
  3.702203007885222*^9}},ExpressionUUID->"cc8ad02e-e231-455b-aed4-\
acec80b8b100"],

Cell["Function to translate Mathematica to R", "Text",
 CellChangeTimes->{{3.702202703211164*^9, 
  3.702202713861825*^9}},ExpressionUUID->"7029bef5-f853-4985-87ec-\
9084b94ccf3f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToRForm", "[", "x_", "]"}], ":=", 
  RowBox[{"ToString", "[", 
   RowBox[{
    RowBox[{"x", "/.", "GreekTerms"}], "//", "CForm"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.702201842966589*^9, 
  3.702201859620515*^9}},ExpressionUUID->"7a10592b-c108-49eb-af3d-\
5ec5eac7a255"],

Cell["Do it for all life cycles", "Text",
 CellChangeTimes->{{3.70220271595133*^9, 
  3.70220272896882*^9}},ExpressionUUID->"c9fbba3f-4956-48fd-8656-\
20eda378e1f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RtxtBD", "=", 
   RowBox[{"\"\<pBD \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", "EXBD", "]"}], "<>", "FunctionPartE"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtDB", "=", 
   RowBox[{"\"\<pDB \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", "EXDB", "]"}], "<>", "FunctionPartE"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtWF", "=", 
   RowBox[{"\"\<pWF \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", "EXWF", "]"}], "<>", "FunctionPartE"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.702201679506662*^9, 3.702201723635545*^9}, {
  3.7022018328117237`*^9, 3.702201832929533*^9}, {3.702201871610055*^9, 
  3.702201903052576*^9}},ExpressionUUID->"3ca7511a-986c-409c-b756-\
d0fa37e30a09"],

Cell["Define Power function in R", "Text",
 CellChangeTimes->{{3.7022027318210173`*^9, 
  3.702202737612219*^9}},ExpressionUUID->"9111dadd-02ac-42cd-b250-\
617de2fbbad1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PowerDef", "=", "\"\<Power <- function(a,b) return(a^b)\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.702201909153489*^9, 3.7022019359137297`*^9}, {
  3.7022019780679827`*^9, 
  3.702201985090732*^9}},ExpressionUUID->"17c9762e-488f-492c-97f3-\
241385db0104"],

Cell["Combine all texts", "Text",
 CellChangeTimes->{{3.702202739839615*^9, 
  3.702202745125101*^9}},ExpressionUUID->"d93985bc-c7ab-4360-9679-\
8703b7f2d831"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rtxt", "=", 
   RowBox[{
   "PowerDef", "<>", "\"\<\n\n\>\"", "<>", "RtxtBD", "<>", "\"\<\n\n\>\"", "<>",
     "RtxtDB", "<>", "\"\<\n\n\>\"", "<>", "RtxtWF"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7022019405139227`*^9, 
  3.702201966147601*^9}},ExpressionUUID->"6428265a-80c9-43af-8cba-\
74e3ad4a034a"],

Cell["Export to txt file (Mathematica did not want R)", "Text",
 CellChangeTimes->{{3.702202748144455*^9, 
  3.70220275825738*^9}},ExpressionUUID->"282f3adc-49c5-45ad-ba4b-\
d9b0763ae2c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"pathtosave", "<>", "\"\<Mathematica/analytics.txt\>\""}], ",", 
    "Rtxt"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.702201967861699*^9, 3.702202007961507*^9}, {
   3.702202094017145*^9, 3.7022021946253023`*^9}, {3.705388016090308*^9, 
   3.705388027352977*^9}, 
   3.705388096352022*^9},ExpressionUUID->"0457a43d-2fa1-46a0-9133-\
52c5e2d257b1"],

Cell["Convert the file extension to R", "Text",
 CellChangeTimes->{{3.702202760522964*^9, 3.702202776867174*^9}, {
  3.709990758298483*^9, 
  3.7099907595872707`*^9}},ExpressionUUID->"17bef41e-837d-45b3-97cd-\
d987bd5b6c35"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cmd", "=", 
   RowBox[{
   "\"\<mv\>\"", "<>", "\"\< \>\"", "<>", " ", "pathtosave", "<>", 
    "\"\<Mathematica/analytics.txt \>\"", "<>", "pathtosave", "<>", 
    "\"\<Mathematica/analytics.R\>\""}]}], ";"}]], "Input",
 CellChangeTimes->{{3.709991369942276*^9, 3.709991373128109*^9}, 
   3.7099914070907507`*^9},ExpressionUUID->"d85ae384-97c5-47f4-933b-\
0c884a2f5e7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"\"\<!\>\"", "<>", "cmd"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.709991066140975*^9, 3.709991076975725*^9}, 
   3.7099911333551807`*^9, {3.70999138465051*^9, 
   3.7099913991181173`*^9}},ExpressionUUID->"7ef15e56-bf33-4296-8ca4-\
9af4680d2c2b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export to R the \[Beta] and \[Gamma] functions", "Subsubsection",
 CellChangeTimes->{{3.702201500553801*^9, 3.702201503237453*^9}, {
  3.704803404476313*^9, 
  3.7048034241860743`*^9}},ExpressionUUID->"5f5cec27-20ff-410c-aa27-\
4b278415cb7e"],

Cell["Rewrite the Greek letters", "Text",
 CellChangeTimes->{{3.702202576100587*^9, 
  3.702202585533182*^9}},ExpressionUUID->"6cd3c969-8615-4f5f-8877-\
138c71126169"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GreekTerms", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Omega]", "\[Rule]", "sel"}], ",", " ", 
    RowBox[{"\[Mu]", "\[Rule]", "mut"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.702201509383871*^9, 3.702201525212894*^9}, {
  3.704724390807227*^9, 
  3.70472439943757*^9}},ExpressionUUID->"b3b2ba98-8232-4433-8b38-\
e357fada9f0a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Omega]", "\[Rule]", "sel"}], ",", 
   RowBox[{"\[Mu]", "\[Rule]", "mut"}]}], "}"}]], "Output",
 CellChangeTimes->{3.70220152616304*^9, 3.7022030131218777`*^9, 
  3.7022897635244837`*^9, 3.704179086467165*^9, 3.7045177944473457`*^9, 
  3.704724393799959*^9, 3.7047246634923162`*^9, 3.704736510164259*^9, 
  3.704803775109002*^9, 3.7100545877607107`*^9, 3.7101570448356543`*^9, 
  3.7134074650996113`*^9, 
  3.714232143030241*^9},ExpressionUUID->"0135c033-15f6-498b-b04a-\
3343878ef52f"]
}, Open  ]],

Cell["Common parts to all functions", "Text",
 CellChangeTimes->{{3.7022025881711607`*^9, 
  3.7022025922143908`*^9}},ExpressionUUID->"3e197198-1276-4e54-879c-\
ec02d08d6156"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "FunctionPartB", "=", 
   "\"\< <- function(p, sel, mut, m, g, n, d, Idself, Ieself){\n## Arguments:\
\n#  p   mutation bias\n#  sel intensity of selection\n#  mut mutation \
probability\n#  m   emigration probability\n#  g   proportion of interactions \
out of the group (interaction equivalent of m)\n#  n   deme size\n#  d   \
number of demes\n#  Idself whether reproduction in site where the parent is\n\
#  Ieself whether interactions with oneself\nreturn(\n\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FunctionPartE", "=", "\"\<)\n}\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.702201586590098*^9, 3.702201660652206*^9}, {
  3.702202515399782*^9, 3.70220251599327*^9}, {3.702202562602117*^9, 
  3.702202562914797*^9}, {3.702202598064639*^9, 3.702202697296604*^9}, {
  3.702202988690043*^9, 3.702203007885222*^9}, {3.704724417045898*^9, 
  3.7047244695037813`*^9}},ExpressionUUID->"9accf0dd-2ec5-4419-9698-\
6f40f59ce1a7"],

Cell["Function to translate Mathematica to R", "Text",
 CellChangeTimes->{{3.702202703211164*^9, 
  3.702202713861825*^9}},ExpressionUUID->"5d158fd4-f397-4987-b976-\
bb683b156991"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToRForm", "[", "x_", "]"}], ":=", 
  RowBox[{"ToString", "[", 
   RowBox[{
    RowBox[{"x", "/.", "GreekTerms"}], "//", "CForm"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.702201842966589*^9, 
  3.702201859620515*^9}},ExpressionUUID->"5ebff7f8-9566-46eb-b8de-\
4dd67ee565f4"],

Cell["Do it for \[Beta] and \[Gamma]", "Text",
 CellChangeTimes->{{3.704724511134218*^9, 3.704724513442933*^9}, {
  3.704803452274454*^9, 
  3.704803455115556*^9}},ExpressionUUID->"ce43818a-cc2a-4ed0-879f-\
45e47529a021"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RtxtbBDD", "=", 
   RowBox[{"\"\<bBDD \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]BDD", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
    "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtbBDI", "=", 
   RowBox[{"\"\<bBDI \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]BDI", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
    "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtcBDD", "=", 
   RowBox[{"\"\<cBDD \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Gamma]BDD", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
    "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtcBDI", "=", 
   RowBox[{"\"\<cBDI \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Gamma]BDI", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
    "FunctionPartE"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.704724517750942*^9, 3.704724604063252*^9}, {
   3.704803463935075*^9, 3.704803684371352*^9}, 
   3.704803938490445*^9},ExpressionUUID->"e017fe17-5ca5-4c1c-9a55-\
d3e59df066c4"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"RtxtbDBD", "=", 
     RowBox[{"\"\<bDBD \>\"", "<>", "FunctionPartB", "<>", 
      RowBox[{"ToRForm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Beta]DBD", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
            RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
         "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
      "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RtxtbDBI", "=", 
     RowBox[{"\"\<bDBI \>\"", "<>", "FunctionPartB", "<>", 
      RowBox[{"ToRForm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Beta]DBI", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
            RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
         "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
      "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RtxtcDBD", "=", 
     RowBox[{"\"\<cDBD \>\"", "<>", "FunctionPartB", "<>", 
      RowBox[{"ToRForm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Gamma]DBD", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
            RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
         "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
      "FunctionPartE"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RtxtcDBI", "=", 
     RowBox[{"\"\<cDBI \>\"", "<>", "FunctionPartB", "<>", 
      RowBox[{"ToRForm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Gamma]DBI", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Qin", "\[Rule]", "QinM"}], ",", 
            RowBox[{"Qout", "\[Rule]", "QoutM"}]}], "}"}]}], "/.", 
         "genericde"}], "//", "FullSimplify"}], "]"}], "<>", 
      "FunctionPartE"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.704724517750942*^9, 3.704724604063252*^9}, {
  3.704803463935075*^9, 3.704803684371352*^9}, {3.704803938490445*^9, 
  3.7048039400125237`*^9}},ExpressionUUID->"94f3466b-c901-4e59-a1d3-\
f4b976cf8a1c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"RtxtbWFD", "=", 
   RowBox[{"\"\<bWFD \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]WFD", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinWF"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutWF"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "Simplify"}], "]"}], "<>", "FunctionPartE"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtbWFI", "=", 
   RowBox[{"\"\<bWFI \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Beta]WFI", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinWF"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutWF"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "Simplify"}], "]"}], "<>", "FunctionPartE"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RtxtcWFD", "=", 
   RowBox[{"\"\<cWFD \>\"", "<>", "FunctionPartB", "<>", 
    RowBox[{"ToRForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Gamma]WFD", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Qin", "\[Rule]", "QinWF"}], ",", 
          RowBox[{"Qout", "\[Rule]", "QoutWF"}]}], "}"}]}], "/.", 
       "genericde"}], "//", "Simplify"}], "]"}], "<>", "FunctionPartE"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.704724517750942*^9, 3.704724604063252*^9}, {
   3.704803463935075*^9, 3.704803684371352*^9}, {3.704803938490445*^9, 
   3.7048039400125237`*^9}, 3.7048042118459272`*^9, {3.704804392342845*^9, 
   3.70480439722366*^9}},ExpressionUUID->"0e3ad78f-d0aa-40d2-b308-\
2f06a585831c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RtxtcWFI", "=", 
    RowBox[{"\"\<cWFI \>\"", "<>", "FunctionPartB", "<>", 
     RowBox[{"ToRForm", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Gamma]WFI", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Qin", "\[Rule]", "QinWF"}], ",", 
           RowBox[{"Qout", "\[Rule]", "QoutWF"}]}], "}"}]}], "/.", 
        "genericde"}], "//", "Simplify"}], "]"}], "<>", "FunctionPartE"}]}], 
   ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.704724517750942*^9, 3.704724604063252*^9}, {
   3.704803463935075*^9, 3.704803684371352*^9}, {3.704803938490445*^9, 
   3.7048039400125237`*^9}, 3.7048042118459272`*^9, 
   3.7048043981410503`*^9},ExpressionUUID->"b04078fa-7bdf-48d3-b68b-\
521c12d32b91"],

Cell["Define Power function in R", "Text",
 CellChangeTimes->{{3.7022027318210173`*^9, 
  3.702202737612219*^9}},ExpressionUUID->"c8f5eed6-ccdc-4056-85df-\
e81493439159"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PowerDef", "=", "\"\<Power <- function(a,b) return(a^b)\>\""}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.702201909153489*^9, 3.7022019359137297`*^9}, {
  3.7022019780679827`*^9, 
  3.702201985090732*^9}},ExpressionUUID->"84857692-aaf9-42e2-8f67-\
82775288674d"],

Cell["Combine all texts", "Text",
 CellChangeTimes->{{3.702202739839615*^9, 
  3.702202745125101*^9}},ExpressionUUID->"9acd32e1-4bf1-4c8a-848e-\
4d41692d9d32"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rtxt", "=", 
   RowBox[{
   "PowerDef", "<>", "\"\<\n\n\>\"", "<>", "RtxtbBDD", "<>", "\"\<\n\n\>\"", "<>",
     "RtxtbBDI", "<>", "\"\<\n\n\>\"", "<>", "RtxtcBDD", "<>", "\"\<\n\n\>\"",
     "<>", "RtxtcBDI", "<>", "\"\<\n\n\>\"", "<>", "RtxtbDBD", "<>", 
    "\"\<\n\n\>\"", "<>", "RtxtbDBI", "<>", "\"\<\n\n\>\"", "<>", "RtxtcDBD", 
    "<>", "\"\<\n\n\>\"", "<>", "RtxtcDBI", "<>", "\"\<\n\n\>\"", "<>", 
    "RtxtbWFD", "<>", "\"\<\n\n\>\"", "<>", "RtxtbWFI", "<>", "\"\<\n\n\>\"", 
    "<>", "RtxtcWFD", "<>", "\"\<\n\n\>\"", "<>", "RtxtcWFI"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7022019405139227`*^9, 3.702201966147601*^9}, {
  3.7047246131819277`*^9, 3.704724637059588*^9}, {3.704803694719769*^9, 
  3.704803749843987*^9}},ExpressionUUID->"137b19c6-1952-4441-a505-\
19b5c3fa5a84"],

Cell["Export to txt file (Mathematica did not want R)", "Text",
 CellChangeTimes->{{3.702202748144455*^9, 
  3.70220275825738*^9}},ExpressionUUID->"345ebd33-ad8f-43df-bdf8-\
e834af9c3e8c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"pathtosave", "<>", "\"\<Mathematica/analyticsBC.txt\>\""}], ",", 
    "Rtxt"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.702201967861699*^9, 3.702202007961507*^9}, {
   3.702202094017145*^9, 3.7022021946253023`*^9}, 3.7047246446676083`*^9, {
   3.7048037577002163`*^9, 3.704803757783225*^9}, {3.710054369552413*^9, 
   3.7100543764643507`*^9}, 
   3.710054449473357*^9},ExpressionUUID->"ab04e6bb-69e0-48cc-a101-\
ee6f6c01a372"],

Cell["Convert the file extension to R", "Text",
 CellChangeTimes->{{3.702202760522964*^9, 
  3.702202776867174*^9}},ExpressionUUID->"a3aeb49a-7a46-4cc3-938b-\
016def1063d6"],

Cell[BoxData[
 RowBox[{"cmd", "=", 
  RowBox[{
  "\"\<mv \>\"", "<>", "pathtosave", "<>", 
   "\"\<Mathematica/analyticsBC.txt \>\"", "<>", "pathtosave", "<>", 
   "\"\<Mathematica/analyticsBC.R\>\""}]}]], "Input",
 CellChangeTimes->{{3.710054379829246*^9, 
  3.7100544084086437`*^9}},ExpressionUUID->"b7a24ea3-79c7-48f9-a142-\
588ead905ab7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"\"\<!\>\"", "<>", "cmd"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7022022612757597`*^9, 3.702202281727586*^9}, {
  3.7047246545885*^9, 3.7047246565359173`*^9}, {3.7048037640761023`*^9, 
  3.704803767929439*^9}, {3.710054411496415*^9, 
  3.7100544300801153`*^9}},ExpressionUUID->"b4bba712-396c-4fdd-bec3-\
4f1208a49d28"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{3394, 1395},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 387, 5, 35, "Text",ExpressionUUID->"4d122144-68f5-4dd6-89d3-e7a0d56980e8"],
Cell[948, 27, 2083, 36, 465, "Text",ExpressionUUID->"14ea3af3-d465-4f5c-af36-99619e21b63f"],
Cell[3034, 65, 1549, 29, 189, "Text",ExpressionUUID->"fb901ea2-6ef0-4b91-8646-6ed3770e796d"],
Cell[4586, 96, 234, 4, 35, "Text",ExpressionUUID->"46e8e511-d008-4ebf-9a4b-e730a4fefb52"],
Cell[4823, 102, 284, 8, 30, "Input",ExpressionUUID->"7dbdee60-53e4-496c-a4b9-7a1a2e990d3e"],
Cell[5110, 112, 292, 7, 35, "Text",ExpressionUUID->"b26eefa8-1f0f-479a-9750-39f651f214ab"],
Cell[5405, 121, 386, 7, 30, "Input",ExpressionUUID->"410807c3-190e-41db-9fb8-efa3cbdabd8f"],
Cell[CellGroupData[{
Cell[5816, 132, 272, 4, 98, "Title",ExpressionUUID->"4cf9ebfe-7fd7-4be0-9b24-f399073f702b"],
Cell[CellGroupData[{
Cell[6113, 140, 209, 4, 67, "Section",ExpressionUUID->"6470b1dc-c55e-42d2-a648-1b6ada46a445"],
Cell[6325, 146, 300, 7, 35, "Text",ExpressionUUID->"a35f7219-586c-4d81-b1a7-cf33223a07e0"],
Cell[6628, 155, 439, 13, 53, "Input",ExpressionUUID->"1b43948b-fd57-42ad-8edb-95e6d9a8c16a"],
Cell[7070, 170, 156, 3, 35, "Text",ExpressionUUID->"0408952b-d00d-4b27-abcb-5c8498f679b3"],
Cell[7229, 175, 256, 6, 30, "Input",ExpressionUUID->"b74b4fc2-ed1b-4e18-9c79-b5e67acc4d70"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7522, 186, 430, 6, 67, "Section",ExpressionUUID->"e54fbb92-27f1-474c-b9b0-1ab298eedac9"],
Cell[CellGroupData[{
Cell[7977, 196, 180, 3, 54, "Subsection",ExpressionUUID->"14b6fb56-e1e7-4517-9d94-ff8cefeee6d7"],
Cell[CellGroupData[{
Cell[8182, 203, 292, 4, 45, "Subsubsection",ExpressionUUID->"9fc285f0-c72c-4808-9fee-6f66b9ab8bb9"],
Cell[8477, 209, 229, 4, 35, "Text",ExpressionUUID->"686e6e0d-eb2c-4d12-ad4d-43fe233137e2"],
Cell[8709, 215, 1880, 36, 283, "Input",ExpressionUUID->"779b13f5-773e-45e1-a031-f79d73dbae3b"],
Cell[10592, 253, 225, 4, 35, "Text",ExpressionUUID->"b43962b9-e73f-4b71-bd3c-3a9353ca0424"],
Cell[10820, 259, 1121, 25, 191, "Input",ExpressionUUID->"a78b7931-6d27-4690-aef0-853d717cd5ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11978, 289, 288, 4, 45, "Subsubsection",ExpressionUUID->"fcd4e3a5-b587-4c5d-905c-2b18c24c35f6"],
Cell[12269, 295, 874, 21, 52, "Input",ExpressionUUID->"231e340c-941e-496e-9eb5-71f4b9ace8ed"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13180, 321, 222, 4, 45, "Subsubsection",ExpressionUUID->"92c404cf-8ac4-46d4-84a2-9e02b38995cf"],
Cell[13405, 327, 312, 7, 35, "Text",ExpressionUUID->"6d9b872d-6028-4ea1-b878-11c0d133571c"],
Cell[13720, 336, 1072, 32, 88, "Input",ExpressionUUID->"b0de730f-7b8e-470f-b642-885eaf843a40"],
Cell[14795, 370, 263, 6, 35, "Text",ExpressionUUID->"b1624d0e-7129-46c8-ad48-4efddc8744b9"],
Cell[15061, 378, 788, 22, 86, "Input",ExpressionUUID->"365ccce7-344a-4976-9a81-27b2e9b90b55"],
Cell[15852, 402, 241, 6, 35, "Text",ExpressionUUID->"2c95eb0b-ff6c-428c-8c7b-3548e2eb779e"],
Cell[16096, 410, 1034, 31, 88, "Input",ExpressionUUID->"533ba1b4-44c2-4bcf-9508-911a773a35eb"],
Cell[17133, 443, 314, 7, 35, "Text",ExpressionUUID->"6874b1e8-b3f4-437c-9ea0-c07db7b16f01"],
Cell[17450, 452, 1614, 49, 91, "Input",ExpressionUUID->"bc246c1e-3b7e-4232-9a07-94e266b7602b"],
Cell[19067, 503, 153, 3, 35, "Text",ExpressionUUID->"afbf62b9-1584-4c1b-bef3-3ff22a76e25e"],
Cell[CellGroupData[{
Cell[19245, 510, 772, 24, 52, "Input",ExpressionUUID->"9727f1a0-8aa5-400d-af11-6869472481f6"],
Cell[20020, 536, 512, 8, 34, "Output",ExpressionUUID->"c921c7b0-44df-4217-919d-9c9e948279d8"],
Cell[20535, 546, 513, 8, 34, "Output",ExpressionUUID->"4ed3488c-31fa-4493-9640-ebb28318bd72"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21109, 561, 193, 3, 54, "Subsection",ExpressionUUID->"c01e6cf6-7984-446a-b81a-7f67a14a0415"],
Cell[CellGroupData[{
Cell[21327, 568, 273, 6, 45, "Subsubsection",ExpressionUUID->"2d17cb7a-23a4-4189-976e-728a51c1cf34"],
Cell[21603, 576, 150, 3, 35, "Text",ExpressionUUID->"08409582-176d-4743-b821-2aa19df9425c"],
Cell[21756, 581, 1542, 30, 227, "Input",ExpressionUUID->"f41fff88-c1e7-48df-96e1-08e6d3e25f42"],
Cell[23301, 613, 150, 3, 35, "Text",ExpressionUUID->"7e88402e-fa3a-405b-8b40-dfa13475ded9"],
Cell[23454, 618, 1074, 24, 191, "Input",ExpressionUUID->"0a733bee-0359-4343-93aa-300f5980601a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[24601, 650, 317, 5, 98, "Title",ExpressionUUID->"cebf8764-d7a2-4d77-a8ba-6f878c03d40c"],
Cell[CellGroupData[{
Cell[24943, 659, 150, 3, 67, "Section",ExpressionUUID->"f96d3728-443f-43e8-9405-13cada515dc3"],
Cell[CellGroupData[{
Cell[25118, 666, 222, 4, 54, "Subsection",ExpressionUUID->"688f17ab-c723-421a-a95d-2d2de423de3c"],
Cell[25343, 672, 444, 9, 35, "Text",ExpressionUUID->"4184761c-67ff-45a5-b049-d974d4158e93"],
Cell[25790, 683, 1507, 47, 59, "Input",ExpressionUUID->"f55b96bf-181a-41e4-b2bc-1f16fb0d5513"],
Cell[27300, 732, 2623, 87, 114, "Input",ExpressionUUID->"4d2e9453-02ff-4c2f-9ccd-9753be189985"],
Cell[29926, 821, 175, 3, 35, "Text",ExpressionUUID->"afbedef6-1143-4b6e-82c5-fd91784f165c"],
Cell[CellGroupData[{
Cell[30126, 828, 445, 12, 30, "Input",ExpressionUUID->"04d10033-58d9-4896-a08a-5c6588314092"],
Cell[30574, 842, 2226, 60, 54, "Output",ExpressionUUID->"74f894e7-aa93-475b-8931-282b131097d5"]
}, Open  ]],
Cell[32815, 905, 193, 3, 35, "Text",ExpressionUUID->"0a7ce679-47e9-4524-a16d-834f0517ce6f"],
Cell[CellGroupData[{
Cell[33033, 912, 534, 14, 52, "Input",ExpressionUUID->"9948b7fc-71a4-4761-a3eb-961a77f350b4"],
Cell[33570, 928, 2337, 64, 54, "Output",ExpressionUUID->"3ca3f2d9-4648-4aa5-8926-727e2ab9b54a"],
Cell[35910, 994, 2099, 56, 54, "Output",ExpressionUUID->"abb28a5e-30ee-42d7-b289-f99869492f79"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[38058, 1056, 167, 3, 54, "Subsection",ExpressionUUID->"de96c862-0ce2-4c44-a157-66f36e147f16"],
Cell[38228, 1061, 351, 7, 35, "Text",ExpressionUUID->"1f2fe9da-5e6d-4a49-8db3-c9b33f2ba7b8"],
Cell[38582, 1070, 5873, 152, 496, "Input",ExpressionUUID->"9266974c-2cdf-46b5-8a0e-bdfe497dafe5"],
Cell[44458, 1224, 405, 8, 35, "Text",ExpressionUUID->"0ff33317-199a-435f-923e-21d83cbcfcfe"],
Cell[44866, 1234, 2229, 57, 178, "Input",ExpressionUUID->"833ab85a-1694-4664-ad79-a9c5086559e4"],
Cell[47098, 1293, 177, 3, 35, "Text",ExpressionUUID->"36732b6f-3678-4c17-9bd9-1b2febd5c86c"],
Cell[CellGroupData[{
Cell[47300, 1300, 891, 23, 52, "Input",ExpressionUUID->"97fee035-5c8d-4062-a6be-d2c40ac7f455"],
Cell[CellGroupData[{
Cell[48216, 1327, 1137, 25, 56, "Print",ExpressionUUID->"9ef99fc9-065c-4bea-9722-b967fb4fc295"],
Cell[49356, 1354, 1136, 25, 56, "Print",ExpressionUUID->"7e29c7d1-a9b8-46a0-bd27-6d2a3804aaf7"]
}, Open  ]]
}, Open  ]],
Cell[50519, 1383, 179, 3, 35, "Text",ExpressionUUID->"2cbe3a75-f82b-46d5-9906-5ce526438afe"],
Cell[CellGroupData[{
Cell[50723, 1390, 891, 23, 52, "Input",ExpressionUUID->"0ebb094d-2603-4e40-9907-8286f19fd2ec"],
Cell[CellGroupData[{
Cell[51639, 1417, 1113, 25, 56, "Print",ExpressionUUID->"95a9337c-2804-4d0d-9a63-4241bfa52c97"],
Cell[52755, 1444, 1112, 25, 56, "Print",ExpressionUUID->"b8a4bdc7-f8ac-4a8b-a2e8-8e69e1647339"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53928, 1476, 165, 3, 54, "Subsection",ExpressionUUID->"24d4d857-dff8-498e-b5d2-b2365c110474"],
Cell[CellGroupData[{
Cell[54118, 1483, 342, 5, 45, "Subsubsection",ExpressionUUID->"bb12b16f-d17e-4799-b1a4-7b2fbced10bd"],
Cell[CellGroupData[{
Cell[54485, 1492, 455, 12, 52, "Input",ExpressionUUID->"5d6b4bfe-a489-4b61-ace3-12928ef33758"],
Cell[54943, 1506, 1864, 51, 54, "Output",ExpressionUUID->"ce008850-232f-4d97-a0eb-e5f0355e1c99"],
Cell[56810, 1559, 1577, 42, 53, "Output",ExpressionUUID->"85523ebe-01da-4eab-a45f-45df7bc0a221"]
}, Open  ]],
Cell[58402, 1604, 364, 7, 35, "Text",ExpressionUUID->"523ef6d9-cca5-4b81-b192-6268a91cfe38"],
Cell[CellGroupData[{
Cell[58791, 1615, 1150, 36, 30, "Input",ExpressionUUID->"4e36d259-056d-4d0d-940d-1c772b6c8804"],
Cell[59944, 1653, 849, 13, 34, "Output",ExpressionUUID->"03e01d3a-1acb-4a79-9a1a-d163482e64f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60830, 1671, 919, 29, 30, "Input",ExpressionUUID->"4828fdf5-3b7e-40cd-a1b2-a446737f45de"],
Cell[61752, 1702, 795, 12, 34, "Output",ExpressionUUID->"f4f586e9-9978-44d2-a5b8-7d43947ab217"]
}, Open  ]],
Cell[62562, 1717, 212, 4, 35, "Text",ExpressionUUID->"8fadfc03-e7f1-4ab8-a02b-9ce325b12f93"],
Cell[62777, 1723, 248, 7, 81, "Text",ExpressionUUID->"89a409f1-9061-4b05-a402-52d33171b45e"],
Cell[CellGroupData[{
Cell[63050, 1734, 607, 17, 52, "Input",ExpressionUUID->"b6078900-99b4-405f-a04f-c3a0afc422da"],
Cell[63660, 1753, 845, 13, 34, "Output",ExpressionUUID->"09a950b1-1dc1-4f8f-81f6-dd7949a50711"],
Cell[64508, 1768, 845, 13, 34, "Output",ExpressionUUID->"04f0eb42-5216-41d6-9da4-c823166667ab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65390, 1786, 488, 12, 52, "Input",ExpressionUUID->"f2f8743c-acc1-40d6-8036-f02e946653a5"],
Cell[65881, 1800, 812, 21, 53, "Output",ExpressionUUID->"278f1b7a-f58e-412a-8c8e-02a2cdd6603f"],
Cell[66696, 1823, 583, 14, 52, "Output",ExpressionUUID->"675d03e8-4cd2-4181-99b3-e84f1674bb7a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67316, 1842, 484, 12, 52, "Input",ExpressionUUID->"933e2532-8291-4ba6-aac4-4fd7b0a19a07"],
Cell[67803, 1856, 877, 13, 34, "Output",ExpressionUUID->"7426e49e-2fab-4d86-aae7-049cf0499436"],
Cell[68683, 1871, 879, 13, 34, "Output",ExpressionUUID->"8afd94e1-98ca-4133-97f9-b6ffc00f95ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69599, 1889, 277, 7, 30, "Input",ExpressionUUID->"2ce9b3ea-5ac8-47ee-9c3f-8fbd912e8032"],
Cell[69879, 1898, 1157, 24, 34, "Output",ExpressionUUID->"ff79bf8e-fe06-4876-b393-ffc7a4cdab13"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[71085, 1928, 295, 4, 45, "Subsubsection",ExpressionUUID->"e631c25b-d551-4b5d-ba21-833e17cbadcd"],
Cell[CellGroupData[{
Cell[71405, 1936, 452, 12, 52, "Input",ExpressionUUID->"d87d31c7-932b-4d4a-bd18-e8106597c46c"],
Cell[71860, 1950, 2122, 62, 59, "Output",ExpressionUUID->"6bebd342-45b8-4377-9482-d71c25889724"],
Cell[73985, 2014, 1863, 53, 54, "Output",ExpressionUUID->"2ea9899a-3c7a-413c-9cd6-72894a078b89"]
}, Open  ]],
Cell[75863, 2070, 177, 3, 35, "Text",ExpressionUUID->"10b274e4-bfdc-4fd9-896d-0cdb0c88ad5a"],
Cell[CellGroupData[{
Cell[76065, 2077, 1607, 48, 33, "Input",ExpressionUUID->"08ad0c2a-7ee7-4bc1-93a5-8c7dc2931f5e"],
Cell[77675, 2127, 848, 13, 34, "Output",ExpressionUUID->"7f1d6789-fa0f-43fe-8b56-d5f51c6294ca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78560, 2145, 1329, 42, 33, "Input",ExpressionUUID->"40b4c263-cab8-4165-aa08-45b10681f5a4"],
Cell[79892, 2189, 819, 12, 34, "Output",ExpressionUUID->"b15ce35d-4db5-4a4c-87dd-a6878ae3e86a"]
}, Open  ]],
Cell[80726, 2204, 156, 3, 35, "Text",ExpressionUUID->"f5bce0a3-3c46-4232-b5c6-bce11ef0497c"],
Cell[CellGroupData[{
Cell[80907, 2211, 498, 14, 52, "Input",ExpressionUUID->"ab33bfc0-b503-40f7-9630-98682384510e"],
Cell[81408, 2227, 1275, 29, 53, "Output",ExpressionUUID->"8913644b-d45e-4eda-b892-243e6e3631ca"],
Cell[82686, 2258, 987, 19, 52, "Output",ExpressionUUID->"2eec4a2a-a9f1-4b10-9906-03a1e01fc51f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83710, 2282, 426, 10, 52, "Input",ExpressionUUID->"bb04212e-b715-45c1-9159-6c831c019ce9"],
Cell[84139, 2294, 778, 12, 34, "Output",ExpressionUUID->"7f97df8f-a011-4072-9ffd-2cc7a8c01c96"],
Cell[84920, 2308, 778, 12, 34, "Output",ExpressionUUID->"183c580c-01e8-41b5-8b3e-0378c8e9962b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[85771, 2328, 160, 3, 67, "Section",ExpressionUUID->"45cb321f-1f12-4fe0-8b4e-7c5bd227a874"],
Cell[85934, 2333, 254, 6, 35, "Text",ExpressionUUID->"43cad485-b08f-469d-96f5-2c4f647c6cba"],
Cell[CellGroupData[{
Cell[86213, 2343, 173, 3, 54, "Subsection",ExpressionUUID->"deb3106d-6256-41a9-bef5-7007af796eef"],
Cell[86389, 2348, 303, 6, 35, "Text",ExpressionUUID->"2a8b2f98-e230-49ac-84ee-ff25d9a506d4"],
Cell[86695, 2356, 3281, 106, 178, "Input",ExpressionUUID->"623e9932-1227-43ed-bb05-f96e18b6a1cf"],
Cell[89979, 2464, 173, 3, 35, "Text",ExpressionUUID->"9f9e80a1-2cf1-4d09-af3e-3795f57f37f0"],
Cell[CellGroupData[{
Cell[90177, 2471, 446, 10, 30, "Input",ExpressionUUID->"8a6bc569-74d9-4f30-89c5-f265f4b659a9"],
Cell[90626, 2483, 1912, 50, 77, "Output",ExpressionUUID->"7dafd0cc-9e23-460f-988b-e0382536f428"]
}, Open  ]],
Cell[92553, 2536, 176, 3, 35, "Text",ExpressionUUID->"6abd8736-161b-4eaa-ab36-fed661a76cca"],
Cell[CellGroupData[{
Cell[92754, 2543, 543, 13, 52, "Input",ExpressionUUID->"51151e49-a98d-4f8f-9bd4-f6cbb2da9ed4"],
Cell[93300, 2558, 2975, 89, 104, "Output",ExpressionUUID->"7f568f30-63fd-422c-ba96-f660d0f43279"],
Cell[96278, 2649, 2652, 77, 103, "Output",ExpressionUUID->"abd67fed-ae1b-477e-968f-c7601276c078"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[98979, 2732, 167, 3, 54, "Subsection",ExpressionUUID->"1993159a-eb46-485a-a246-9f33280bdef0"],
Cell[99149, 2737, 5728, 147, 501, "Input",ExpressionUUID->"3137111d-c1a0-443f-b244-270f8d06f6d1"],
Cell[104880, 2886, 2218, 57, 178, "Input",ExpressionUUID->"8f985415-98e0-459c-a217-e2567961fd1a"],
Cell[CellGroupData[{
Cell[107123, 2947, 1490, 40, 94, "Input",ExpressionUUID->"79e06577-18f7-4966-9436-c8d37da2e9c5"],
Cell[CellGroupData[{
Cell[108638, 2991, 1173, 26, 56, "Print",ExpressionUUID->"fadc17a0-d717-436c-902d-e18bcccbcc8b"],
Cell[109814, 3019, 1171, 26, 56, "Print",ExpressionUUID->"7aef8af9-a2f6-41ca-a96e-46d9d927550d"],
Cell[110988, 3047, 1168, 26, 56, "Print",ExpressionUUID->"bdadaa14-c6f4-4acb-9cbd-ffc6b8fbc2b5"],
Cell[112159, 3075, 1171, 26, 56, "Print",ExpressionUUID->"b081842e-1be4-41a9-ac6b-8f8cc5815423"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[113391, 3108, 165, 3, 54, "Subsection",ExpressionUUID->"f1f99cf2-d724-42f5-9ad9-be3f8d2f6166"],
Cell[CellGroupData[{
Cell[113581, 3115, 172, 3, 45, "Subsubsection",ExpressionUUID->"9fb96309-336f-41e9-83d9-888dcb0f7f11"],
Cell[CellGroupData[{
Cell[113778, 3122, 313, 7, 30, "Input",ExpressionUUID->"00e67089-4a4e-4e09-87d6-70babe3da5fe"],
Cell[114094, 3131, 2406, 69, 104, "Output",ExpressionUUID->"5b4ae1cb-d7bb-4489-9021-59fff99378bb"]
}, Open  ]],
Cell[116515, 3203, 172, 3, 35, "Text",ExpressionUUID->"6f34ef66-7cc1-412a-87c3-9957ac8b7d6b"],
Cell[CellGroupData[{
Cell[116712, 3210, 1458, 48, 198, "Input",ExpressionUUID->"e388a2c2-3f3a-41bc-9878-4b01b6a22bbb"],
Cell[118173, 3260, 386, 5, 34, "Output",ExpressionUUID->"d252a045-95a2-4a12-9fdc-2a76d555073a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118596, 3270, 312, 7, 30, "Input",ExpressionUUID->"81a1d3f1-d095-43ee-8e2d-3e2f20421e10"],
Cell[118911, 3279, 2326, 67, 103, "Output",ExpressionUUID->"d7c63554-cc84-44d9-a384-9a4bd0226066"]
}, Open  ]],
Cell[121252, 3349, 174, 3, 35, "Text",ExpressionUUID->"0c54020b-92ed-4004-af08-b5537cb70cb1"],
Cell[CellGroupData[{
Cell[121451, 3356, 627, 18, 80, "Input",ExpressionUUID->"211eab7c-7d5c-4af9-b003-c72f9dc4bd64"],
Cell[122081, 3376, 413, 6, 34, "Output",ExpressionUUID->"92e6ed3c-d9bf-4356-8d7c-8f96207d64e4"]
}, Open  ]],
Cell[122509, 3385, 155, 3, 35, "Text",ExpressionUUID->"85340289-a1f0-4358-97af-ae77b856c12d"],
Cell[CellGroupData[{
Cell[122689, 3392, 387, 8, 52, "Input",ExpressionUUID->"458152fe-88ff-4427-bbc2-e1457c4f78ab"],
Cell[123079, 3402, 479, 7, 34, "Output",ExpressionUUID->"4b47e257-5a46-451a-8460-85b3881dd25e"],
Cell[123561, 3411, 479, 7, 34, "Output",ExpressionUUID->"50580ec1-5517-4d23-9d4f-2037596eccbe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124077, 3423, 490, 12, 73, "Input",ExpressionUUID->"1c8f4b70-f338-4798-a731-0dd76552de16"],
Cell[124570, 3437, 1531, 45, 57, "Output",ExpressionUUID->"3290674a-9864-4265-8800-3ab83fff96f6"],
Cell[126104, 3484, 884, 22, 55, "Output",ExpressionUUID->"250936d2-1417-4379-bed1-997349375519"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127025, 3511, 312, 7, 30, "Input",ExpressionUUID->"ebee7663-1add-45dc-9488-b25d8588098a"],
Cell[127340, 3520, 514, 7, 34, "Output",ExpressionUUID->"31c52ec3-425c-4433-ad21-d6f62a4c90b3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[127903, 3533, 190, 3, 45, "Subsubsection",ExpressionUUID->"17a1e96f-0c49-43e3-8b40-20f2146bcf6b"],
Cell[128096, 3538, 240, 4, 35, "Text",ExpressionUUID->"c17936f0-cc33-4d23-8ac8-16ffd72608ef"],
Cell[128339, 3544, 680, 18, 73, "Input",ExpressionUUID->"5d50e4fd-1d83-43d4-b8a4-6ea8b4efc4ed"],
Cell[129022, 3564, 252, 6, 35, "Text",ExpressionUUID->"8074ec9f-70e2-4b45-bb27-77bfc204ecc7"],
Cell[CellGroupData[{
Cell[129299, 3574, 811, 20, 52, "Input",ExpressionUUID->"11729057-294c-407f-b749-00379078209e"],
Cell[130113, 3596, 2212, 69, 69, "Output",ExpressionUUID->"6b8f56ff-a2d7-4cf7-b2ad-926282159156"]
}, Open  ]],
Cell[132340, 3668, 200, 4, 35, "Text",ExpressionUUID->"588788b4-596d-4eec-a2df-11e2c7e3c585"],
Cell[CellGroupData[{
Cell[132565, 3676, 430, 9, 51, "Input",ExpressionUUID->"77e60307-bd99-4b8a-ad69-39c8d7d9f16b"],
Cell[132998, 3687, 2187, 66, 57, "Output",ExpressionUUID->"4871a55e-c4f8-456a-b1ed-c33af1a14756"]
}, Open  ]],
Cell[135200, 3756, 167, 3, 35, "Text",ExpressionUUID->"ecb610b1-3533-46df-8394-5bcc6536e051"],
Cell[CellGroupData[{
Cell[135392, 3763, 652, 17, 30, "Input",ExpressionUUID->"30cf17ab-a686-41d5-837e-0d22675a7ecf"],
Cell[136047, 3782, 459, 6, 34, "Output",ExpressionUUID->"f106e430-8c42-4403-8dc5-e595b777f0ed"]
}, Open  ]],
Cell[136521, 3791, 251, 5, 30, "Input",ExpressionUUID->"876b9afc-8637-433d-b0ff-a240fd3817f5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136809, 3801, 228, 4, 45, "Subsubsection",ExpressionUUID->"bd333452-9ffa-4235-b16f-bb879b9c1c29"],
Cell[CellGroupData[{
Cell[137062, 3809, 355, 7, 30, "Input",ExpressionUUID->"f96652eb-259b-4b43-a3a4-2606a75d9205"],
Cell[137420, 3818, 3299, 101, 104, "Output",ExpressionUUID->"35f59147-6d39-4c87-8910-5e50ef26a5a0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140756, 3924, 358, 7, 30, "Input",ExpressionUUID->"ae162f18-4950-4e9a-b6b4-06626975649c"],
Cell[141117, 3933, 2808, 83, 103, "Output",ExpressionUUID->"f269aa5d-3f70-4cdb-8af6-70e37ca37589"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[143998, 4024, 221, 4, 67, "Section",ExpressionUUID->"2419b6ef-5859-4e62-a316-552970e8b8fa"],
Cell[144222, 4030, 167, 3, 35, "Text",ExpressionUUID->"1a46bc1d-5ea8-4a08-bfaa-927567933449"],
Cell[CellGroupData[{
Cell[144414, 4037, 361, 9, 30, "Input",ExpressionUUID->"7b22121d-bd91-48fe-ab24-9624bc20326c"],
Cell[144778, 4048, 599, 11, 34, "Output",ExpressionUUID->"744b5edf-b93b-41e3-aa55-dc6888dc9392"]
}, Open  ]],
Cell[145392, 4062, 175, 3, 35, "Text",ExpressionUUID->"77554488-5c9e-459c-a3ad-19e1e76af0d5"],
Cell[145570, 4067, 987, 18, 325, "Input",ExpressionUUID->"578d1aaf-032c-4eaf-a833-c5d40d8a929c"],
Cell[146560, 4087, 180, 3, 35, "Text",ExpressionUUID->"abde4a1b-1b34-47ab-bdc5-e4d1cba82eba"],
Cell[146743, 4092, 310, 8, 30, "Input",ExpressionUUID->"6ff82ee8-98fa-428a-a808-c943fae7d07c"],
Cell[147056, 4102, 153, 3, 35, "Text",ExpressionUUID->"f1a54d6f-fb33-4a50-86a1-d3cd49272b92"],
Cell[147212, 4107, 1243, 31, 94, "Input",ExpressionUUID->"24e12d47-c59b-4b8b-9cfc-fe73ebee0f58"],
Cell[148458, 4140, 170, 3, 35, "Text",ExpressionUUID->"d8873f9d-2184-4f13-a453-22d2b5962ed3"],
Cell[148631, 4145, 297, 7, 30, "Input",ExpressionUUID->"998352f9-798d-41a9-a862-c6c9ea3bf521"],
Cell[148931, 4154, 159, 3, 35, "Text",ExpressionUUID->"a57f3910-60af-480d-8abc-98acb1a63f95"],
Cell[149093, 4159, 448, 10, 199, "Input",ExpressionUUID->"780c6311-297f-448c-9e45-56278bd0d61b"],
Cell[149544, 4171, 188, 3, 35, "Text",ExpressionUUID->"a161dcbd-f12a-452c-bd35-5c3774b3e640"],
Cell[149735, 4176, 454, 10, 30, "Input",ExpressionUUID->"5df196a7-34bd-49ad-b093-691768e8e714"],
Cell[150192, 4188, 173, 3, 35, "Text",ExpressionUUID->"88a2cd52-f1a6-4478-853b-7a8e64310f2f"],
Cell[150368, 4193, 362, 9, 30, "Input",ExpressionUUID->"e6085f07-8a79-4627-b46b-49f6073a43e9"],
Cell[150733, 4204, 266, 6, 30, "Input",ExpressionUUID->"39dd9515-c67b-40e1-b15c-b7d482d79193"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[151048, 4216, 214, 5, 98, "Title",ExpressionUUID->"592b4e25-b59b-4858-9036-e2ec7af7f2f0"],
Cell[CellGroupData[{
Cell[151287, 4225, 160, 3, 67, "Section",ExpressionUUID->"7c90027d-248b-4774-8149-63da68d82c10"],
Cell[151450, 4230, 170, 3, 35, "Text",ExpressionUUID->"7917c417-4607-40f8-995e-16da35fd65e0"],
Cell[151623, 4235, 677, 19, 30, "Input",ExpressionUUID->"71002c1f-acfc-4940-889a-b4091ab23474"],
Cell[152303, 4256, 286, 4, 35, "Text",ExpressionUUID->"7844af98-c423-4dbd-86a7-1018b9ebc14b"],
Cell[152592, 4262, 313, 8, 30, "Input",ExpressionUUID->"d400c920-68a1-4bd6-9517-b18b7dd04cde"],
Cell[CellGroupData[{
Cell[152930, 4274, 160, 3, 54, "Subsection",ExpressionUUID->"bc3e3b0e-480a-439f-9e9d-449c36e41991"],
Cell[CellGroupData[{
Cell[153115, 4281, 731, 22, 95, "Input",ExpressionUUID->"b2adbb80-a150-4481-8e95-6ac903496584"],
Cell[153849, 4305, 1066, 33, 54, "Output",ExpressionUUID->"08da20a9-7ae8-48f0-a1ee-48f108529cef"],
Cell[154918, 4340, 2200, 72, 57, "Output",ExpressionUUID->"9ffac5d2-747b-4f6c-baa2-8abe4dc3f2f4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[157167, 4418, 160, 3, 54, "Subsection",ExpressionUUID->"ad4c89ce-a17e-4417-a222-80a18fc14998"],
Cell[157330, 4423, 187, 3, 35, "Text",ExpressionUUID->"7d7ecf07-c50f-4dd2-a45d-baca9d34c308"],
Cell[157520, 4428, 495, 13, 30, "Input",ExpressionUUID->"a3aa224e-4c35-49ab-899f-b767f7ad357b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[158064, 4447, 197, 3, 67, "Section",ExpressionUUID->"bbaaca20-eaf2-411b-869b-8a4528f30340"],
Cell[CellGroupData[{
Cell[158286, 4454, 161, 3, 54, "Subsection",ExpressionUUID->"d040f1a4-bef6-4bc0-ba2e-ebd2b7f0ad68"],
Cell[158450, 4459, 336, 9, 58, "Text",ExpressionUUID->"5fac0855-caca-4a44-939d-7a865d69438e"],
Cell[158789, 4470, 308, 10, 30, "Input",ExpressionUUID->"46162b65-93a0-47b3-9f89-143d1da72c82"],
Cell[159100, 4482, 181, 3, 35, "Text",ExpressionUUID->"fa022214-cb38-4534-aedf-0f0097f29f38"],
Cell[159284, 4487, 690, 23, 69, "Input",ExpressionUUID->"9bf8ef32-5618-4104-a019-3f2e4a62fa50"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160011, 4515, 252, 6, 54, "Subsection",ExpressionUUID->"9b6e2ab4-a134-4a94-bae2-0fe68c5107fb"],
Cell[CellGroupData[{
Cell[160288, 4525, 219, 4, 45, "Subsubsection",ExpressionUUID->"7675be38-eb7d-4da5-b193-8bccce0e2792"],
Cell[160510, 4531, 1217, 42, 100, "Input",ExpressionUUID->"66fb6bf1-64e7-4794-8a15-81019a8ae83e"],
Cell[161730, 4575, 173, 3, 35, "Text",ExpressionUUID->"a715131e-85c3-4ce6-94c3-336c8b66aa05"],
Cell[161906, 4580, 1164, 36, 73, "Input",ExpressionUUID->"d0e50d3a-4eb8-489c-a3c3-adb6ebee82eb"],
Cell[163073, 4618, 855, 25, 49, "Input",ExpressionUUID->"6b492584-d728-44c9-a292-f5c66842501f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163965, 4648, 172, 3, 45, "Subsubsection",ExpressionUUID->"6ee41fb6-703b-4541-8376-21f8b62478f0"],
Cell[164140, 4653, 1488, 52, 98, "Input",ExpressionUUID->"b59d270c-7ad4-4a79-a08d-8c909c1a32de"],
Cell[165631, 4707, 157, 3, 35, "Text",ExpressionUUID->"6985a00b-42d4-43b3-bedf-b22919670e32"],
Cell[165791, 4712, 1576, 49, 93, "Input",ExpressionUUID->"f6b306ac-467e-4230-bf93-3f89b4e0fef5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167404, 4766, 166, 3, 45, "Subsubsection",ExpressionUUID->"68246624-98bb-4b4f-825e-05c01642c711"],
Cell[167573, 4771, 1060, 37, 100, "Input",ExpressionUUID->"f4d0081b-7283-4819-928a-b5c637f44472"],
Cell[168636, 4810, 157, 3, 35, "Text",ExpressionUUID->"45cbf12c-11ca-4ecd-99d4-5266e9ba091a"],
Cell[168796, 4815, 2023, 57, 114, "Input",ExpressionUUID->"db4b3944-1a05-46bd-8abe-4825cd18ac94"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[170880, 4879, 260, 4, 67, "Section",ExpressionUUID->"b4857930-fc01-477d-9e20-21d15f061e40"],
Cell[CellGroupData[{
Cell[171165, 4887, 271, 4, 54, "Subsection",ExpressionUUID->"12f3d572-1a0d-4231-bccd-19f5c6ff4426"],
Cell[CellGroupData[{
Cell[171461, 4895, 360, 8, 30, "Input",ExpressionUUID->"3f6707e4-c31f-42cd-a51b-49a36e6fc0fa"],
Cell[171824, 4905, 1700, 56, 77, "Output",ExpressionUUID->"893db0d9-43c5-44da-a9e7-216afe847326"]
}, Open  ]],
Cell[173539, 4964, 342, 11, 40, "Text",ExpressionUUID->"a60b9416-5a0b-4389-840d-365c761feaae"],
Cell[CellGroupData[{
Cell[173906, 4979, 265, 7, 30, "Input",ExpressionUUID->"e39a2e3d-7304-4aad-967c-0c21927d6f1b"],
Cell[174174, 4988, 230, 4, 34, "Output",ExpressionUUID->"9dc72559-5a34-4dd5-86b1-8ee534ba3073"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[174453, 4998, 166, 3, 54, "Subsection",ExpressionUUID->"fa8b5227-5b9a-4be4-b3c0-3f3ad5a74749"],
Cell[CellGroupData[{
Cell[174644, 5005, 274, 4, 45, "Subsubsection",ExpressionUUID->"d6e60353-b8c3-42d3-9dcf-a1387d04ec02"],
Cell[174921, 5011, 179, 3, 35, "Text",ExpressionUUID->"cc38ce0b-830f-433a-a5ca-e380b604da31"],
Cell[175103, 5016, 323, 10, 48, "Input",ExpressionUUID->"4349dc74-3025-4d7a-a6ac-4e553b376232"],
Cell[175429, 5028, 242, 4, 35, "Text",ExpressionUUID->"8e060817-3981-4dff-b7e8-3949ef927e7d"],
Cell[CellGroupData[{
Cell[175696, 5036, 283, 7, 30, "Input",ExpressionUUID->"2dec133d-dd32-4a3b-89f6-5ef577435ba3"],
Cell[175982, 5045, 247, 5, 50, "Output",ExpressionUUID->"cd76d905-215f-4fb9-a944-4c324ed1e73c"]
}, Open  ]],
Cell[176244, 5053, 185, 3, 35, "Text",ExpressionUUID->"66053a41-4390-4250-b177-5787ab89eafe"],
Cell[CellGroupData[{
Cell[176454, 5060, 238, 6, 30, "Input",ExpressionUUID->"1f3dd259-fee2-402c-b247-c73d9fdca764"],
Cell[176695, 5068, 317, 8, 52, "Output",ExpressionUUID->"5129f45c-b1ec-4e00-9cd0-7a383da59c96"]
}, Open  ]],
Cell[177027, 5079, 185, 3, 35, "Text",ExpressionUUID->"3e1b2a0a-21cb-42a1-8a77-6447d0cd8827"],
Cell[CellGroupData[{
Cell[177237, 5086, 334, 9, 49, "Input",ExpressionUUID->"c34a3d04-6b92-401a-a776-563ae4874a4a"],
Cell[177574, 5097, 387, 9, 51, "Output",ExpressionUUID->"f6fd03ac-a9e9-4ca4-8259-26217029296b"]
}, Open  ]],
Cell[177976, 5109, 325, 7, 58, "Text",ExpressionUUID->"71812d3d-f4ec-4c17-9988-856176bacfbc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178338, 5121, 231, 4, 45, "Subsubsection",ExpressionUUID->"aba5341f-98ce-422c-b11d-9cae83e67918"],
Cell[178572, 5127, 175, 3, 35, "Text",ExpressionUUID->"4be135c5-68eb-48d3-9f51-3be2e4afcb20"],
Cell[178750, 5132, 610, 20, 53, "Input",ExpressionUUID->"585e3ca9-70ae-4cc3-b299-230c9a529b36"],
Cell[179363, 5154, 255, 7, 58, "Text",ExpressionUUID->"6f01f1ff-6f95-4271-914e-50f8c1b95433"],
Cell[CellGroupData[{
Cell[179643, 5165, 265, 7, 30, "Input",ExpressionUUID->"64694bc2-64fc-4cfe-b377-ae02486b6c8d"],
Cell[179911, 5174, 619, 19, 53, "Output",ExpressionUUID->"d07a1093-d1f8-4818-a8fe-55bb3a5902c0"]
}, Open  ]],
Cell[180545, 5196, 189, 3, 35, "Text",ExpressionUUID->"5198fbdd-5059-45a1-96e0-480150331d1f"],
Cell[CellGroupData[{
Cell[180759, 5203, 244, 6, 30, "Input",ExpressionUUID->"71f1fcbe-a7ee-4240-a895-490695cf0cb6"],
Cell[181006, 5211, 345, 10, 52, "Output",ExpressionUUID->"53169122-99e7-49f6-9022-49183de4e213"]
}, Open  ]],
Cell[181366, 5224, 368, 8, 81, "Text",ExpressionUUID->"e0b1e252-49b1-4d81-93d2-26f163e3531a"],
Cell[CellGroupData[{
Cell[181759, 5236, 235, 6, 30, "Input",ExpressionUUID->"78c5a8c7-5e8a-43cb-9ef1-780cb0718b3b"],
Cell[181997, 5244, 444, 13, 53, "Output",ExpressionUUID->"af4faf4e-083a-4c7c-9979-979ae185d9a1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182478, 5262, 235, 6, 30, "Input",ExpressionUUID->"b2ae20d9-947c-49f8-b28f-4285f91f566d"],
Cell[182716, 5270, 298, 7, 50, "Output",ExpressionUUID->"324810f7-d4d4-4ace-847b-978f87759e92"]
}, Open  ]],
Cell[183029, 5280, 228, 5, 35, "Text",ExpressionUUID->"558ee762-dd05-4c02-b7f6-c76da1a4e453"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[183318, 5292, 161, 3, 67, "Section",ExpressionUUID->"f2472a75-fc4b-4cd8-83d6-bb6c62b40759"],
Cell[CellGroupData[{
Cell[183504, 5299, 163, 3, 54, "Subsection",ExpressionUUID->"9c7a1baf-09b4-4089-88cc-e0bbd683b1aa"],
Cell[183670, 5304, 174, 3, 35, "Text",ExpressionUUID->"23759817-8913-41ed-b6e0-a4d4d888e698"],
Cell[CellGroupData[{
Cell[183869, 5311, 336, 8, 30, "Input",ExpressionUUID->"8d239b19-30b0-4547-b4aa-ea6803c92a96"],
Cell[184208, 5321, 1726, 55, 57, "Output",ExpressionUUID->"c7359a20-89a1-49fd-9d6f-c74c641ac7c7"]
}, Open  ]],
Cell[185949, 5379, 186, 3, 35, "Text",ExpressionUUID->"3cc46718-1e42-4304-b9e9-c35b618ecf2e"],
Cell[CellGroupData[{
Cell[186160, 5386, 273, 8, 30, "Input",ExpressionUUID->"2be7ba42-acc0-4aa3-8938-49dc92602eff"],
Cell[186436, 5396, 188, 3, 34, "Output",ExpressionUUID->"037fe27f-aa5b-4f2c-a94c-7a0f192f6e5b"]
}, Open  ]],
Cell[186639, 5402, 246, 4, 35, "Text",ExpressionUUID->"2c0b0546-2864-4eb1-9d27-39b9bcd364c7"],
Cell[CellGroupData[{
Cell[186910, 5410, 371, 9, 30, "Input",ExpressionUUID->"d322ffed-71f4-4fcc-a8ae-824278a8e7f0"],
Cell[187284, 5421, 1467, 43, 60, "Output",ExpressionUUID->"47220b81-d057-4f8f-86d7-5d3525939e89"]
}, Open  ]],
Cell[188766, 5467, 176, 3, 35, "Text",ExpressionUUID->"17c0c616-df54-4511-a0ac-1c661b8422ff"],
Cell[188945, 5472, 496, 12, 30, "Input",ExpressionUUID->"eb5f717a-cd82-4c9c-8cd8-1b3d97665440"],
Cell[189444, 5486, 167, 3, 35, "Text",ExpressionUUID->"203c5b42-4b02-4208-8aed-5e680af9c9c5"],
Cell[CellGroupData[{
Cell[189636, 5493, 209, 5, 30, "Input",ExpressionUUID->"74346dda-d7a2-4f01-bcec-c6060d213d09"],
Cell[189848, 5500, 226, 4, 34, "Output",ExpressionUUID->"6826633f-5dd5-4981-a51a-2565acd72ad3"]
}, Open  ]],
Cell[190089, 5507, 264, 6, 35, "Text",ExpressionUUID->"903709db-28ea-43ba-9439-af746e18b339"],
Cell[190356, 5515, 214, 5, 35, "Text",ExpressionUUID->"723547b1-7688-445e-983b-e19bbc3e9367"],
Cell[CellGroupData[{
Cell[190595, 5524, 238, 6, 30, "Input",ExpressionUUID->"f277b570-dbfa-4efc-9583-406d7ebcc37f"],
Cell[190836, 5532, 829, 25, 78, "Output",ExpressionUUID->"d3221bac-c920-4195-8285-3169c73dabf5"]
}, Open  ]],
Cell[191680, 5560, 181, 3, 35, "Text",ExpressionUUID->"f3203433-d2a8-46ed-91ed-5ab62efe9af6"],
Cell[CellGroupData[{
Cell[191886, 5567, 569, 15, 52, "Input",ExpressionUUID->"93899444-9cf1-4d02-8b70-cf5da1d113c5"],
Cell[192458, 5584, 257, 7, 58, "Output",ExpressionUUID->"347d0d12-d668-4aea-a78b-bdc7b988d75f"],
Cell[192718, 5593, 196, 3, 34, "Output",ExpressionUUID->"78c048a1-b447-43bb-a032-a3d4a4e34e3c"]
}, Open  ]],
Cell[192929, 5599, 1303, 36, 182, "Text",ExpressionUUID->"2b40af41-08da-4cd3-929f-d54f7a0ef855"]
}, Open  ]],
Cell[CellGroupData[{
Cell[194269, 5640, 162, 3, 54, "Subsection",ExpressionUUID->"5ca726f4-8b2c-4416-b4f5-8a22ea2487a0"],
Cell[194434, 5645, 172, 3, 35, "Text",ExpressionUUID->"d201e9a9-463f-4f8a-b079-a9b6c3e7ecc4"],
Cell[CellGroupData[{
Cell[194631, 5652, 273, 7, 30, "Input",ExpressionUUID->"7198fac2-80b9-4679-aeb5-5c996eb22b43"],
Cell[194907, 5661, 4383, 131, 37, "Output",ExpressionUUID->"7bc4db14-c5d4-47ad-9db7-603d756dc0ef"]
}, Open  ]],
Cell[199305, 5795, 179, 3, 35, "Text",ExpressionUUID->"f847a1e9-bcd9-43df-8010-101ba32b908f"],
Cell[CellGroupData[{
Cell[199509, 5802, 370, 9, 30, "Input",ExpressionUUID->"3cd49b04-8bb3-4aea-a84b-05883a97357d"],
Cell[199882, 5813, 5515, 157, 64, "Output",ExpressionUUID->"3f32d0ac-dc5e-4d99-b8a0-5a22f3fb730c"]
}, Open  ]],
Cell[205412, 5973, 185, 3, 35, "Text",ExpressionUUID->"e8aeabc6-d161-4bb0-9272-c7c17b6f2d95"],
Cell[CellGroupData[{
Cell[205622, 5980, 274, 7, 30, "Input",ExpressionUUID->"da093bd9-b454-4059-855e-85e97d75f34c"],
Cell[205899, 5989, 2630, 78, 64, "Output",ExpressionUUID->"4568ba39-5e42-41f9-aad4-d581ab7071be"]
}, Open  ]],
Cell[208544, 6070, 335, 8, 58, "Text",ExpressionUUID->"cd0aac85-6f47-4813-9084-49ec71584fb4"],
Cell[CellGroupData[{
Cell[208904, 6082, 267, 7, 30, "Input",ExpressionUUID->"90e2538f-02c8-4d83-bfd6-f164fd2fcb38"],
Cell[209174, 6091, 1034, 35, 55, "Output",ExpressionUUID->"23c8b474-1f03-4a45-8959-258ea1d2ea7a"]
}, Open  ]],
Cell[210223, 6129, 173, 3, 35, "Text",ExpressionUUID->"1db69bc0-2191-46c1-a7e7-c3e1d9e70f8c"],
Cell[CellGroupData[{
Cell[210421, 6136, 271, 7, 30, "Input",ExpressionUUID->"c67c6d37-e58b-4784-9047-3a2c5b377850"],
Cell[210695, 6145, 2028, 63, 59, "Output",ExpressionUUID->"6b35a13e-0b7e-42d7-8971-a56a5ecb5d0c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212760, 6213, 435, 13, 52, "Input",ExpressionUUID->"2092722e-9e59-41ec-b443-574b15fc72c5"],
Cell[213198, 6228, 610, 16, 34, "Output",ExpressionUUID->"56bb83ae-1368-478d-a714-3a6f1544ba62"],
Cell[213811, 6246, 715, 21, 53, "Output",ExpressionUUID->"4e5b8938-792c-42f4-9023-445afa9dfa77"]
}, Open  ]],
Cell[214541, 6270, 3729, 105, 225, "Text",ExpressionUUID->"6d3b3b94-d03e-4b0f-8fdb-1130bd797756"]
}, Open  ]],
Cell[CellGroupData[{
Cell[218307, 6380, 163, 3, 54, "Subsection",ExpressionUUID->"5bb86e7e-52e9-4cbd-b644-dc33661653a3"],
Cell[218473, 6385, 170, 3, 35, "Text",ExpressionUUID->"6e7e468a-4e91-4549-a046-55d750879c1a"],
Cell[CellGroupData[{
Cell[218668, 6392, 273, 7, 30, "Input",ExpressionUUID->"c808bcc6-f8e8-42a1-9e6d-ec091fb56c50"],
Cell[218944, 6401, 2696, 90, 60, "Output",ExpressionUUID->"28f88710-8ef3-4e44-b6af-a362710b9bcc"]
}, Open  ]],
Cell[221655, 6494, 214, 5, 35, "Text",ExpressionUUID->"18aae9ae-0db5-4b37-80dc-dab47d83b02f"],
Cell[CellGroupData[{
Cell[221894, 6503, 275, 8, 30, "Input",ExpressionUUID->"45dde43a-a790-4cf1-aea1-1a9a60aba4f1"],
Cell[222172, 6513, 351, 10, 52, "Output",ExpressionUUID->"81d91ad0-d51a-429c-adb1-68030159ece1"]
}, Open  ]],
Cell[222538, 6526, 250, 6, 35, "Text",ExpressionUUID->"a46bee81-2318-4a82-8587-a7473de0f195"],
Cell[CellGroupData[{
Cell[222813, 6536, 267, 7, 30, "Input",ExpressionUUID->"a177d3ac-4ff7-4e94-98cf-870c73bba29a"],
Cell[223083, 6545, 971, 32, 55, "Output",ExpressionUUID->"9a3a22c0-9121-48d2-ba79-56b371d56c6b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[224091, 6582, 274, 7, 30, "Input",ExpressionUUID->"51d469c0-31ca-4835-b768-0dfde86ec104"],
Cell[224368, 6591, 285, 8, 58, "Output",ExpressionUUID->"3cf8aaa9-3721-4711-ac9e-52efa02d2409"]
}, Open  ]],
Cell[224668, 6602, 496, 12, 95, "Text",ExpressionUUID->"b0787682-f3fd-4b68-9369-6ba11c61924f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[225213, 6620, 205, 3, 67, "Section",ExpressionUUID->"3f6dda12-77af-4907-9699-1934c95e4251"],
Cell[225421, 6625, 176, 3, 35, "Text",ExpressionUUID->"08ec9b10-6603-4fac-81bb-89179e5f20c9"],
Cell[CellGroupData[{
Cell[225622, 6632, 232, 6, 47, "Input",ExpressionUUID->"25d31bd7-39fb-49c0-a345-e6a9e81a9818"],
Cell[225857, 6640, 1610, 54, 62, "Output",ExpressionUUID->"a43dcf20-a985-4846-a37c-8f3f8444f70c"]
}, Open  ]],
Cell[227482, 6697, 264, 7, 58, "Text",ExpressionUUID->"15762942-345c-494b-95ae-9846b0c7936d"],
Cell[CellGroupData[{
Cell[227771, 6708, 387, 11, 52, "Input",ExpressionUUID->"c9667df5-e5e2-4172-92a0-2c074711555c"],
Cell[228161, 6721, 378, 11, 53, "Output",ExpressionUUID->"01ac13ab-8025-42be-bcc6-69207e5603a3"],
Cell[228542, 6734, 205, 4, 34, "Output",ExpressionUUID->"2bbf6615-0540-41af-8e93-4fc696d8dd8c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[228784, 6743, 271, 7, 30, "Input",ExpressionUUID->"f8705b4b-f679-4d99-932f-cfb8a1f1f693"],
Cell[229058, 6752, 175, 3, 34, "Output",ExpressionUUID->"eedbd30a-ef32-4306-a80e-ea1dae78113c"]
}, Open  ]],
Cell[229248, 6758, 165, 3, 35, "Text",ExpressionUUID->"3593d24c-71f5-4b1b-8016-f33ded27ca6c"],
Cell[CellGroupData[{
Cell[229438, 6765, 318, 9, 30, "Input",ExpressionUUID->"b8b059f6-576a-4a2b-8cc1-364838a8ba23"],
Cell[229759, 6776, 204, 4, 34, "Output",ExpressionUUID->"e0114aab-3f55-4687-bdd5-53514a9b6638"]
}, Open  ]],
Cell[CellGroupData[{
Cell[230000, 6785, 323, 9, 30, "Input",ExpressionUUID->"12503a3f-c394-44d1-a4ba-39df2037de68"],
Cell[230326, 6796, 578, 19, 53, "Output",ExpressionUUID->"4fbdb6e3-37a6-4154-8464-e17ce5750547"]
}, Open  ]],
Cell[230919, 6818, 178, 2, 35, "Text",ExpressionUUID->"58563d71-3eb2-4109-8829-89a6c17fd886"],
Cell[CellGroupData[{
Cell[231122, 6824, 448, 13, 30, "Input",ExpressionUUID->"06e16674-fa4c-4864-976d-3cd3eb8e3b8a"],
Cell[231573, 6839, 3686, 116, 61, "Output",ExpressionUUID->"5ce8e32c-fc8f-4eff-85e0-60994e3a6277"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[235320, 6962, 286, 4, 98, "Title",ExpressionUUID->"81b6647a-00b9-434a-9672-d915328af4e9"],
Cell[235609, 6968, 685, 13, 104, "Text",ExpressionUUID->"c0276da3-feb2-403f-9c3f-fb3fca231e5a"],
Cell[CellGroupData[{
Cell[236319, 6985, 232, 4, 67, "Section",ExpressionUUID->"21cfa1c4-9993-4429-b9bf-5f6afb97b4d9"],
Cell[236554, 6991, 805, 14, 81, "Text",ExpressionUUID->"19dca6e4-5ce9-47c6-a6fa-9e683901c72f"],
Cell[CellGroupData[{
Cell[237384, 7009, 217, 4, 54, "Subsection",ExpressionUUID->"180a86f3-c6df-46c4-a9c3-bac030ec42bf"],
Cell[CellGroupData[{
Cell[237626, 7017, 158, 3, 45, "Subsubsection",ExpressionUUID->"4d21c859-34af-4db7-97e6-fd0626c0fa21"],
Cell[237787, 7022, 624, 19, 30, "Input",ExpressionUUID->"e1e8db83-65a1-4c54-9255-1626bb0713aa"],
Cell[238414, 7043, 2506, 78, 108, "Input",ExpressionUUID->"ffab36e3-0f70-4fe7-bb56-3e9ac5e10f88"],
Cell[240923, 7123, 324, 9, 49, "Input",ExpressionUUID->"35e25afa-aef9-4729-bdd3-6ab10fc80539"],
Cell[241250, 7134, 296, 8, 30, "Input",ExpressionUUID->"f5f6a596-2d9e-4dc7-8721-b188b8eaa27f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[241583, 7147, 159, 3, 45, "Subsubsection",ExpressionUUID->"48d4c8d2-e2a0-4cb3-b9b2-6140cc7dab8c"],
Cell[241745, 7152, 231, 6, 30, "Input",ExpressionUUID->"3f0718a1-10b1-4fc4-acc7-74ef8e304a71"],
Cell[241979, 7160, 800, 26, 45, "Input",ExpressionUUID->"b3c7195d-c300-4592-bb9d-21db7aa07ce9"],
Cell[CellGroupData[{
Cell[242804, 7190, 320, 9, 30, "Input",ExpressionUUID->"fc951c6f-d049-4ea4-9ab1-7921b8729470"],
Cell[243127, 7201, 1539, 40, 54, "Output",ExpressionUUID->"ed6cbe26-df80-459e-b6b7-6a6eaf74103d"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[244727, 7248, 168, 3, 54, "Subsection",ExpressionUUID->"fcececbd-cd5d-4f25-a5f2-21ce4e1799a4"],
Cell[CellGroupData[{
Cell[244920, 7255, 159, 3, 45, "Subsubsection",ExpressionUUID->"f0d3227b-e177-42b2-a4cc-284c4bae927d"],
Cell[CellGroupData[{
Cell[245104, 7262, 193, 4, 30, "Input",ExpressionUUID->"09cbd0d1-cccc-4e71-9131-4bd9f2d67314"],
Cell[245300, 7268, 991, 23, 34, "Output",ExpressionUUID->"bcc8c9a1-b5fc-4a39-a3ef-3890edf132ee"]
}, Open  ]],
Cell[246306, 7294, 18142, 499, 1270, "Input",ExpressionUUID->"07838e35-63cc-4bab-a076-d9741eb1c393"],
Cell[CellGroupData[{
Cell[264473, 7797, 189, 4, 30, "Input",ExpressionUUID->"5b1b9cbb-c199-4d3c-9f47-cc96e2d546d1"],
Cell[264665, 7803, 734, 14, 53, "Output",ExpressionUUID->"100b8271-bf2e-410b-9954-bef2d54ff30c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[265436, 7822, 372, 10, 30, "Input",ExpressionUUID->"2faf86c6-28be-4405-a46c-b3c2bd158df8"],
Cell[265811, 7834, 6444, 190, 77, "Output",ExpressionUUID->"581638d4-6339-4fb6-ad13-92d704c97d49"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[272304, 8030, 209, 4, 45, "Subsubsection",ExpressionUUID->"742c7448-0bb1-48cd-9745-b4411ddfeb90"],
Cell[CellGroupData[{
Cell[272538, 8038, 195, 4, 30, "Input",ExpressionUUID->"3f678307-136a-4e35-827e-14d0efcf9819"],
Cell[272736, 8044, 626, 10, 34, "Output",ExpressionUUID->"684317b0-a361-4796-b6f6-8275bc8eb0bf"]
}, Open  ]],
Cell[273377, 8057, 2016, 58, 77, "Input",ExpressionUUID->"9f0674ba-3fca-4084-92ee-d8b1f14becf1"],
Cell[CellGroupData[{
Cell[275418, 8119, 276, 7, 30, "Input",ExpressionUUID->"103be1a4-9e6d-47c4-8afd-d27891fc6669"],
Cell[275697, 8128, 2683, 74, 53, "Output",ExpressionUUID->"d437f87d-a621-4de5-a0e6-248ddaa2b548"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[278441, 8209, 164, 3, 54, "Subsection",ExpressionUUID->"3b7d36e1-b552-4ffb-b337-945cf572a1df"],
Cell[278608, 8214, 268, 6, 35, "Text",ExpressionUUID->"721f8cd6-5c5b-47ce-8a22-9a687cf20b65"],
Cell[CellGroupData[{
Cell[278901, 8224, 158, 3, 45, "Subsubsection",ExpressionUUID->"b3152777-685d-4475-ad40-cd1faa3298cf"],
Cell[279062, 8229, 438, 10, 73, "Input",ExpressionUUID->"2189b01b-67d9-4800-aefb-df02983bfadd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[279537, 8244, 159, 3, 45, "Subsubsection",ExpressionUUID->"efe07bbd-5403-4303-82ea-49b5c7871c4a"],
Cell[279699, 8249, 438, 10, 73, "Input",ExpressionUUID->"d336fffd-5364-4540-9224-05a09cb158b3"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[280198, 8266, 267, 4, 67, "Section",ExpressionUUID->"07f39d37-7f7b-4289-97ee-3d7185370697"],
Cell[280468, 8272, 375, 7, 35, "Text",ExpressionUUID->"3ffbe9e2-a964-4d12-868d-bb7743e1baad"],
Cell[CellGroupData[{
Cell[280868, 8283, 255, 4, 54, "Subsection",ExpressionUUID->"9f08f38e-9d86-41d5-b7cc-d99f6a7f8149"],
Cell[281126, 8289, 481, 9, 58, "Text",ExpressionUUID->"7ccc2502-03ab-4bab-97b5-a3e7ef17994e"],
Cell[281610, 8300, 3904, 99, 246, "Input",ExpressionUUID->"bf322ff7-b7a6-4963-87cc-7a17382b9920"]
}, Open  ]],
Cell[CellGroupData[{
Cell[285551, 8404, 301, 5, 54, "Subsection",ExpressionUUID->"984cb3fd-e0aa-4a4d-93a3-d2300cd8e760"],
Cell[CellGroupData[{
Cell[285877, 8413, 181, 3, 45, "Subsubsection",ExpressionUUID->"efaf43d2-fe07-45a5-9bb4-f33cdd1a47c4"],
Cell[286061, 8418, 220, 3, 35, "Text",ExpressionUUID->"f2db820c-2aef-4532-abeb-cc493d5fb29b"],
Cell[286284, 8423, 1735, 45, 91, "Input",ExpressionUUID->"3041058c-f609-490c-bf01-08af71a187e2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[288056, 8473, 210, 4, 45, "Subsubsection",ExpressionUUID->"1c6237a6-9688-45a5-9b49-1c653f0754f4"],
Cell[288269, 8479, 192, 3, 35, "Text",ExpressionUUID->"142428db-ef0d-4f37-956d-1e94ce50e811"],
Cell[CellGroupData[{
Cell[288486, 8486, 719, 15, 30, "Input",ExpressionUUID->"0f0177e1-d58d-4080-903a-ecc1af12ae44"],
Cell[289208, 8503, 3445, 85, 53, "Output",ExpressionUUID->"78340c26-9a59-4489-b711-6093a9ac020a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[292690, 8593, 425, 12, 30, "Input",ExpressionUUID->"05465984-b1a6-4566-a6da-8b8a3732a426"],
Cell[293118, 8607, 766, 12, 34, "Output",ExpressionUUID->"96b2927c-a7f8-401f-a669-1fcec127b33f"]
}, Open  ]],
Cell[293899, 8622, 180, 3, 35, "Text",ExpressionUUID->"f516da83-107c-48fe-8e64-734362115ce4"],
Cell[294082, 8627, 192, 3, 35, "Text",ExpressionUUID->"3a3e42d7-0a75-4191-b0e5-53dd161a3c14"],
Cell[CellGroupData[{
Cell[294299, 8634, 479, 12, 30, "Input",ExpressionUUID->"d1ae865e-9cf6-481a-838a-e238dcc8b52d"],
Cell[294781, 8648, 2927, 75, 53, "Output",ExpressionUUID->"a4d2e4c6-d7ef-470a-a049-bac3335d3797"]
}, Open  ]],
Cell[CellGroupData[{
Cell[297745, 8728, 375, 11, 30, "Input",ExpressionUUID->"e6e168e8-83d7-425e-908d-b535e203501b"],
Cell[298123, 8741, 653, 10, 34, "Output",ExpressionUUID->"f1651a92-ce44-4d27-ba48-d9cbfafb6d29"]
}, Open  ]],
Cell[298791, 8754, 180, 3, 35, "Text",ExpressionUUID->"ac78b8b1-e666-46ec-9283-e830e6420ce2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[299008, 8762, 211, 4, 45, "Subsubsection",ExpressionUUID->"6d2e929b-7f57-4b9b-8d71-776da5e4fb10"],
Cell[299222, 8768, 243, 4, 35, "Text",ExpressionUUID->"b2213e5a-99c9-4a94-baac-8e679ca7b2d8"],
Cell[CellGroupData[{
Cell[299490, 8776, 770, 16, 30, "Input",ExpressionUUID->"03958438-468a-43b6-9df8-e19eb37619b7"],
Cell[300263, 8794, 1833, 42, 53, "Output",ExpressionUUID->"53d0825f-bc4c-4c43-bf7d-9f297527035c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[302133, 8841, 429, 12, 30, "Input",ExpressionUUID->"4106d92e-9b41-4e5f-85d0-66690587c8b1"],
Cell[302565, 8855, 723, 11, 34, "Output",ExpressionUUID->"fe918f99-1fef-4f9b-b0ed-020434ccb6db"]
}, Open  ]],
Cell[303303, 8869, 180, 3, 35, "Text",ExpressionUUID->"bdf5acc7-683a-47b5-8e4b-e43c86ad2d64"],
Cell[303486, 8874, 192, 3, 35, "Text",ExpressionUUID->"fc9c00a3-bce5-46c7-88d6-0fe4b29c41bd"],
Cell[CellGroupData[{
Cell[303703, 8881, 582, 13, 30, "Input",ExpressionUUID->"d5d27ecd-2d76-40be-be5f-caa4bb8d74d8"],
Cell[304288, 8896, 1584, 39, 58, "Output",ExpressionUUID->"7a0ffd8f-c9ca-480f-85d9-c7ce50a22456"]
}, Open  ]],
Cell[CellGroupData[{
Cell[305909, 8940, 426, 12, 30, "Input",ExpressionUUID->"cfd33bf7-9f64-41ac-bd34-bafc298ef354"],
Cell[306338, 8954, 699, 11, 34, "Output",ExpressionUUID->"9a877f25-5743-45f4-8adb-cb5178205850"]
}, Open  ]],
Cell[307052, 8968, 180, 3, 35, "Text",ExpressionUUID->"63b1c5f5-75a3-47ae-b51e-41066850d331"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[307281, 8977, 324, 5, 54, "Subsection",ExpressionUUID->"7d850f60-ed15-43ea-8198-0cef8117ee37"],
Cell[307608, 8984, 226, 5, 35, "Text",ExpressionUUID->"71763304-5a12-4863-bb1e-7379ce79f9f3"],
Cell[CellGroupData[{
Cell[307859, 8993, 181, 3, 45, "Subsubsection",ExpressionUUID->"6fb3442f-5eae-4ef5-929a-a7d8836669d5"],
Cell[308043, 8998, 1580, 38, 132, "Input",ExpressionUUID->"23a2fb8e-3797-4847-8f6f-8a7669061f1c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[309660, 9041, 218, 4, 45, "Subsubsection",ExpressionUUID->"45c978b1-982a-4eda-b57b-4b7200d7e611"],
Cell[CellGroupData[{
Cell[309903, 9049, 851, 17, 30, "Input",ExpressionUUID->"be3a88fd-e48e-4c4e-bd91-32acfb5ef538"],
Cell[310757, 9068, 2706, 68, 53, "Output",ExpressionUUID->"abe122fe-0907-4936-82a0-fa90b7be32e7"]
}, Open  ]],
Cell[313478, 9139, 187, 3, 35, "Text",ExpressionUUID->"dc95e1ea-8fa0-415b-a851-507063527d44"],
Cell[CellGroupData[{
Cell[313690, 9146, 1527, 37, 49, "Input",ExpressionUUID->"146fffe3-aa9d-4539-8fef-a4450221c4a0"],
Cell[315220, 9185, 1575, 40, 50, "Output",ExpressionUUID->"20cda14b-ba32-4f77-80c1-e4e4c9aafcf0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[316832, 9230, 446, 12, 30, "Input",ExpressionUUID->"7da5e941-5242-4509-b6ea-bc7318946d9d"],
Cell[317281, 9244, 747, 11, 34, "Output",ExpressionUUID->"ad4f0c80-6417-40b1-9618-819624c7cc9c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[318065, 9260, 1193, 29, 47, "Input",ExpressionUUID->"0bb690e7-87f8-4355-81d9-f87049dc66e7"],
Cell[319261, 9291, 847, 18, 34, "Output",ExpressionUUID->"a1c16f8f-a2dc-4105-9edf-1a93b5868616"]
}, Open  ]],
Cell[CellGroupData[{
Cell[320145, 9314, 372, 11, 30, "Input",ExpressionUUID->"868fe710-6504-4e2c-a237-0a87192866c9"],
Cell[320520, 9327, 600, 9, 34, "Output",ExpressionUUID->"9c06078b-601e-4c90-b18b-243a5bb301c7"]
}, Open  ]],
Cell[321135, 9339, 579, 16, 49, "Input",ExpressionUUID->"dc8f5c7c-9d24-498f-b19c-37f4e6bd4410"],
Cell[321717, 9357, 261, 6, 35, "Text",ExpressionUUID->"aa60792a-cf23-42e0-a2db-d482d1e19f83"],
Cell[CellGroupData[{
Cell[322003, 9367, 470, 12, 30, "Input",ExpressionUUID->"49acbdd1-68a6-4107-92ff-e48c1e4945c4"],
Cell[322476, 9381, 675, 10, 34, "Output",ExpressionUUID->"53d0a1c7-6b4c-40f5-bcd7-7dc20da482d3"]
}, Open  ]],
Cell[323166, 9394, 180, 3, 35, "Text",ExpressionUUID->"10413593-8879-492f-a11e-3a5208855ac9"],
Cell[CellGroupData[{
Cell[323371, 9401, 373, 11, 30, "Input",ExpressionUUID->"a2b06b7e-4d02-45a6-8150-4b45270cadd7"],
Cell[323747, 9414, 625, 10, 34, "Output",ExpressionUUID->"5389c077-dde5-4cb2-ab4a-37433e6b122f"]
}, Open  ]],
Cell[324387, 9427, 180, 3, 35, "Text",ExpressionUUID->"b07323a4-ef47-4f81-9209-400a85d07d35"],
Cell[CellGroupData[{
Cell[324592, 9434, 375, 11, 30, "Input",ExpressionUUID->"be36772c-9503-43c3-b1d9-36c82e715c96"],
Cell[324970, 9447, 629, 10, 34, "Output",ExpressionUUID->"d794707d-255d-4e4a-ac4d-d20173d4a8de"]
}, Open  ]],
Cell[325614, 9460, 180, 3, 35, "Text",ExpressionUUID->"4890b1cc-d2b5-4c28-9fa0-c48ab9eb47fc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[325831, 9468, 219, 4, 45, "Subsubsection",ExpressionUUID->"be20d383-8e61-44f0-9a57-56dea43d76c6"],
Cell[CellGroupData[{
Cell[326075, 9476, 903, 18, 30, "Input",ExpressionUUID->"938087f0-796f-4420-8474-b7f38fede2e9"],
Cell[326981, 9496, 1422, 32, 54, "Output",ExpressionUUID->"c8551086-59a2-475d-91ab-d9cadd05ec99"]
}, Open  ]],
Cell[CellGroupData[{
Cell[328440, 9533, 371, 10, 30, "Input",ExpressionUUID->"f2bb2427-cd97-46f3-a125-2813178d4fb2"],
Cell[328814, 9545, 635, 10, 34, "Output",ExpressionUUID->"ffb86f97-8dd5-4d77-be46-ef69a039cfc7"]
}, Open  ]],
Cell[329464, 9558, 180, 3, 35, "Text",ExpressionUUID->"00f0c07c-0fa5-42af-8563-2028512c40dd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[329693, 9567, 329, 5, 54, "Subsection",ExpressionUUID->"91f9c5e6-ef04-4984-bebf-613aa6f49c50"],
Cell[330025, 9574, 226, 5, 35, "Text",ExpressionUUID->"872378a9-34a3-4c1f-9050-e3162a3fb146"],
Cell[CellGroupData[{
Cell[330276, 9583, 181, 3, 45, "Subsubsection",ExpressionUUID->"b8299969-0e84-4554-af62-575f10c178ce"],
Cell[330460, 9588, 1777, 43, 96, "Input",ExpressionUUID->"435c95c5-dcbe-4435-a8eb-c8028435224e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[332274, 9636, 168, 3, 45, "Subsubsection",ExpressionUUID->"40bfa83a-c17a-48e6-87d9-5463b588cc1b"],
Cell[CellGroupData[{
Cell[332467, 9643, 568, 13, 30, "Input",ExpressionUUID->"4151a8a6-adfc-4826-b3f4-22a532c3f812"],
Cell[333038, 9658, 2966, 79, 53, "Output",ExpressionUUID->"0a03af55-0487-4dd1-a5f6-91275fa7a74a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[336041, 9742, 369, 10, 30, "Input",ExpressionUUID->"3f4bd7d5-c1f3-45a3-8305-0dd716ce030c"],
Cell[336413, 9754, 363, 6, 34, "Output",ExpressionUUID->"c19fd090-b776-4952-97ef-9303ef447a22"]
}, Open  ]],
Cell[336791, 9763, 180, 3, 35, "Text",ExpressionUUID->"bf1f5836-8051-4440-b732-a2ae1c36da0b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[337008, 9771, 220, 4, 45, "Subsubsection",ExpressionUUID->"2e8e7ab7-ef8c-462e-a212-448f74dd6d48"],
Cell[CellGroupData[{
Cell[337253, 9779, 621, 14, 30, "Input",ExpressionUUID->"39c80467-f1ff-4383-9a33-e30b0a268dc2"],
Cell[337877, 9795, 1338, 35, 53, "Output",ExpressionUUID->"bfaf4f52-c634-4fcd-8808-36996e796cc2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[339252, 9835, 422, 11, 30, "Input",ExpressionUUID->"041678a8-17f0-423b-a670-67b9f08b8ef2"],
Cell[339677, 9848, 362, 6, 34, "Output",ExpressionUUID->"825080fe-233f-4a84-9f9d-32c485978c92"]
}, Open  ]],
Cell[340054, 9857, 180, 3, 35, "Text",ExpressionUUID->"9d5f5030-4595-4bf4-b10a-4b2a64a4e7e5"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[340295, 9867, 245, 4, 67, "Section",ExpressionUUID->"32ee111d-5c75-452b-a84a-145161e169a5"],
Cell[CellGroupData[{
Cell[340565, 9875, 160, 3, 54, "Subsection",ExpressionUUID->"00289745-ea23-4b73-8755-31a15e8be6d9"],
Cell[CellGroupData[{
Cell[340750, 9882, 727, 20, 30, "Input",ExpressionUUID->"fc286cf4-e206-40d2-a2d8-72f9ea487b72"],
Cell[341480, 9904, 16673, 420, 106, "Output",ExpressionUUID->"dc487adb-2fc9-4ee6-9cf7-2e7afa81e728"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[358202, 10330, 158, 3, 54, "Subsection",ExpressionUUID->"d566c12a-cec2-40b6-9bee-dd175cd3f340"],
Cell[CellGroupData[{
Cell[358385, 10337, 780, 20, 30, "Input",ExpressionUUID->"ce2359da-d69b-4dab-b90d-324ae540919b"],
Cell[359168, 10359, 23120, 552, 146, "Output",ExpressionUUID->"6a269ae1-c0b5-4a7a-90a7-5e2a45a0dbcb"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[382337, 10917, 167, 3, 54, "Subsection",ExpressionUUID->"5f5f34e6-45d9-46fa-9886-0c9c945da5a4"],
Cell[CellGroupData[{
Cell[382529, 10924, 755, 20, 30, "Input",ExpressionUUID->"29b11746-9714-42af-9716-6b74b2c2dbfa"],
Cell[383287, 10946, 80039, 2041, 1167, "Output",ExpressionUUID->"460e906c-bca0-4e6a-b46e-e335bfe8e069"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[463387, 12994, 156, 3, 67, "Section",ExpressionUUID->"b42cf564-70d3-4896-9089-8cc7f0f82dd3"],
Cell[CellGroupData[{
Cell[463568, 13001, 275, 4, 45, "Subsubsection",ExpressionUUID->"d0d8954d-067b-41ce-9d52-a67afb15e96a"],
Cell[463846, 13007, 167, 3, 35, "Text",ExpressionUUID->"9bba0139-8409-402f-abf1-6bafd167e541"],
Cell[CellGroupData[{
Cell[464038, 13014, 313, 8, 30, "Input",ExpressionUUID->"9281d696-3ed2-4d18-bdc6-b167cd67628f"],
Cell[464354, 13024, 509, 10, 34, "Output",ExpressionUUID->"f475ed57-a766-4772-95c9-b015715205a0"]
}, Open  ]],
Cell[464878, 13037, 175, 3, 35, "Text",ExpressionUUID->"ffbfb115-7ac8-419b-9b97-753fe9193ad1"],
Cell[465056, 13042, 1006, 19, 367, "Input",ExpressionUUID->"cc8ad02e-e231-455b-aed4-acec80b8b100"],
Cell[466065, 13063, 180, 3, 35, "Text",ExpressionUUID->"7029bef5-f853-4985-87ec-9084b94ccf3f"],
Cell[466248, 13068, 310, 8, 30, "Input",ExpressionUUID->"7a10592b-c108-49eb-af3d-5ec5eac7a255"],
Cell[466561, 13078, 165, 3, 35, "Text",ExpressionUUID->"c9fbba3f-4956-48fd-8656-20eda378e1f5"],
Cell[466729, 13083, 815, 19, 73, "Input",ExpressionUUID->"3ca7511a-986c-409c-b756-d0fa37e30a09"],
Cell[467547, 13104, 170, 3, 35, "Text",ExpressionUUID->"9111dadd-02ac-42cd-b250-617de2fbbad1"],
Cell[467720, 13109, 297, 7, 30, "Input",ExpressionUUID->"17c9762e-488f-492c-97f3-241385db0104"],
Cell[468020, 13118, 159, 3, 35, "Text",ExpressionUUID->"d93985bc-c7ab-4360-9679-8703b7f2d831"],
Cell[468182, 13123, 342, 8, 157, "Input",ExpressionUUID->"6428265a-80c9-43af-8cba-74e3ad4a034a"],
Cell[468527, 13133, 188, 3, 35, "Text",ExpressionUUID->"282f3adc-49c5-45ad-ba4b-d9b0763ae2c0"],
Cell[468718, 13138, 427, 10, 30, "Input",ExpressionUUID->"0457a43d-2fa1-46a0-9133-52c5e2d257b1"],
Cell[469148, 13150, 224, 4, 35, "Text",ExpressionUUID->"17bef41e-837d-45b3-97cd-d987bd5b6c35"],
Cell[469375, 13156, 406, 9, 30, "Input",ExpressionUUID->"d85ae384-97c5-47f4-933b-0c884a2f5e7c"],
Cell[469784, 13167, 311, 7, 30, "Input",ExpressionUUID->"7ef15e56-bf33-4296-8ca4-9af4680d2c2b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[470132, 13179, 248, 4, 45, "Subsubsection",ExpressionUUID->"5f5cec27-20ff-410c-aa27-4b278415cb7e"],
Cell[470383, 13185, 167, 3, 35, "Text",ExpressionUUID->"6cd3c969-8615-4f5f-8877-138c71126169"],
Cell[CellGroupData[{
Cell[470575, 13192, 361, 9, 30, "Input",ExpressionUUID->"b3b2ba98-8232-4433-8b38-e357fada9f0a"],
Cell[470939, 13203, 539, 11, 34, "Output",ExpressionUUID->"0135c033-15f6-498b-b04a-3343878ef52f"]
}, Open  ]],
Cell[471493, 13217, 175, 3, 35, "Text",ExpressionUUID->"3e197198-1276-4e54-879c-ec02d08d6156"],
Cell[471671, 13222, 987, 18, 325, "Input",ExpressionUUID->"9accf0dd-2ec5-4419-9698-6f40f59ce1a7"],
Cell[472661, 13242, 180, 3, 35, "Text",ExpressionUUID->"5d158fd4-f397-4987-b976-bb683b156991"],
Cell[472844, 13247, 310, 8, 30, "Input",ExpressionUUID->"5ebff7f8-9566-46eb-b8de-4dd67ee565f4"],
Cell[473157, 13257, 221, 4, 35, "Text",ExpressionUUID->"ce43818a-cc2a-4ed0-879f-45e47529a021"],
Cell[473381, 13263, 2058, 56, 94, "Input",ExpressionUUID->"e017fe17-5ca5-4c1c-9a55-d3e59df066c4"],
Cell[475442, 13321, 2232, 58, 115, "Input",ExpressionUUID->"94f3466b-c901-4e59-a1d3-f4b976cf8a1c"],
Cell[477677, 13381, 1680, 44, 73, "Input",ExpressionUUID->"0e3ad78f-d0aa-40d2-b308-2f06a585831c"],
Cell[479360, 13427, 785, 19, 52, "Input",ExpressionUUID->"b04078fa-7bdf-48d3-b68b-521c12d32b91"],
Cell[480148, 13448, 170, 3, 35, "Text",ExpressionUUID->"c8f5eed6-ccdc-4056-85df-e81493439159"],
Cell[480321, 13453, 297, 7, 30, "Input",ExpressionUUID->"84857692-aaf9-42e2-8f67-82775288674d"],
Cell[480621, 13462, 159, 3, 35, "Text",ExpressionUUID->"9acd32e1-4bf1-4c8a-848e-4d41692d9d32"],
Cell[480783, 13467, 833, 15, 535, "Input",ExpressionUUID->"137b19c6-1952-4441-a505-19b5c3fa5a84"],
Cell[481619, 13484, 188, 3, 35, "Text",ExpressionUUID->"345ebd33-ad8f-43df-bdf8-e834af9c3e8c"],
Cell[481810, 13489, 507, 11, 30, "Input",ExpressionUUID->"ab04e6bb-69e0-48cc-a101-ee6f6c01a372"],
Cell[482320, 13502, 173, 3, 35, "Text",ExpressionUUID->"a3aeb49a-7a46-4cc3-938b-016def1063d6"],
Cell[482496, 13507, 342, 8, 30, "Input",ExpressionUUID->"b7a24ea3-79c7-48f9-a142-588ead905ab7"],
Cell[482841, 13517, 385, 8, 30, "Input",ExpressionUUID->"b4bba712-396c-4fdd-bec3-4f1208a49d28"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

