\documentclass[aspectratio=169]{beamer}

\input{styleESEB.tex}

\begin{document}


\begin{frame}{Genealogy, Identity by descent and Identity in state}
\begin{center}
\begin{tikzpicture}
\def \nlines {5}
\def \ncols {10}
\def \dx {0.7cm}
\def \dy {0.9cm}
\tikzstyle{indivbase}=[circle, inner sep=0pt, text width=0.5cm, fill=bgcol, draw=none]
\tikzstyle{genlink}=[draw=fgcol, line width=1.2pt]
\foreach \i in {1,...,\nlines}{
\foreach \j in {1,...,\ncols}{
	\node[indivbase] at(\dx*\j, -\dy*\i) (c\i\j) {};
}}

\uncover<1->{
\foreach \i in {1,...,\nlines}{
\foreach \j in {1,...,\ncols}{
	\node[indivbase, draw=fgcol] at(c\i\j) {};
}}
}

\draw[->, >=angle 45] (-0.5*\dx, 0)--(-0.5*\dx, -\nlines*\dy-\dy){} node [above, anchor=north east] {Time};

\tikzstyle{iA}=[indivbase, fill=col2]
\tikzstyle{iB}=[indivbase, fill=col1]

% Genealogy
\tikzstyle{mut}=[color=maincol, font=\small]
\newcommand{\symbmut}{$\bigstar$}

\uncover<2->{
\draw[genlink] (c11)--(c21);
\draw[genlink] (c11)--(c22);
\draw[genlink] (c11)--(c23);
\draw[genlink] (c13)--(c24);
\draw[genlink] (c15)--(c25);
\draw[genlink] (c17)--(c26);
\draw[genlink] (c17)--(c27);
\draw[genlink] (c17)--(c28);
\draw[genlink] (c110)--(c29);
\draw[genlink] (c110)--(c210);

\draw[genlink] (c21)--(c31);
\draw[genlink] (c21)--(c32);
\draw[genlink] (c24)--(c33);
\draw[genlink] (c25)--(c34);
\draw[genlink] (c25)--(c35);
\draw[genlink] (c26)--(c36);
\draw[genlink] (c27)--(c37);
\draw[genlink] (c28)--(c38);
\draw[genlink] (c29)--(c39);
\draw[genlink] (c29)--(c310);

\draw[genlink] (c32)--(c41);
\draw[genlink] (c32)--(c42);
\draw[genlink] (c32)--(c43);
\draw[genlink] (c35)--(c44);
\draw[genlink] (c36)--(c45);
\draw[genlink] (c36)--(c46);
\draw[genlink] (c38)--(c47);
\draw[genlink] (c38)--(c48);
\draw[genlink] (c39)--(c49);
\draw[genlink] (c310)--(c410);

\draw[genlink] (c42)--(c51);
\draw[genlink] (c42)--(c52);
\draw[genlink] (c43)--(c53);
\draw[genlink] (c45)--(c54);
\draw[genlink] (c45)--(c55);
\draw[genlink] (c46)--(c56);
\draw[genlink] (c47)--(c57);
\draw[genlink] (c47)--(c58);
\draw[genlink] (c48)--(c59);
\draw[genlink] (c48)--(c510);
}

\uncover<3->{
\node[iA] at (c11){};
\node[iA] at (c12){};
\node[iA] at (c13){};
\node[iA] at (c14){};
\node[iA] at (c15){};
\node[iA] at (c16){};
\node[iB] at (c17){};
\node[iA] at (c18){};
\node[iA] at (c19){};
\node[iA] at (c110){};
}

\uncover<4->{
\node[iA] at (c21){};
\node[iA] at (c22){};
\node[iA] at (c23){};
\node[iA] at (c24){};
\node[iA] at (c25){};
\node[iB] at (c26){};
\node[iB] at (c27){};
\node[iB] at (c28){};
\node[iA] at (c29){};
\node[iA] at (c210){};

\node[iA] at (c31){};
\node[iA] at (c32){};
\node[iA] at (c33){};
\node[iA] at (c34){};
\node[iA] at (c35){};
\node[iB] at (c36){};
\node[iB] at (c37){};
\node[iB] at (c38){};
\node[iA] at (c39){};
\node[iA] at (c310){};

\node[iA] at (c41){};
\node[iA] at (c42){};
\node[iA] at (c43){};
\node[iA] at (c44){};
\node[iB] at (c45){};
\node[iB] at (c46){};
\node[iB] at (c47){};
\node[iB] at (c48){};
\node[iA] at (c49){};
\node[iA] at (c410){};

\node[iA] at (c51){};
\node[iA] at (c52){};
\node[iA] at (c53){};
\node[iB] at (c54){};
\node[iB] at (c55){};
\node[iB] at (c56){};
\node[iB] at (c57){};
\node[iB] at (c58){};
\node[iB] at (c59){};
\node[iB] at (c510){};

}

\uncover<5->{
\path(c11)--(c21) node[midway, mut]{\symbmut};
\node[iB] at (c21){};
\node[iB] at (c31){};
\node[iB] at (c32){};
\node[iB] at (c41){};
\node[iB] at (c42){};
\node[iB] at (c43){};
\node[iB] at (c51){};
\node[iB] at (c52){};

\path(c26)--(c36) node[midway, mut]{\symbmut};
\node[iA] at (c36){};
\node[iA] at (c46){};
\node[iA] at (c45){};
\node[iA] at (c54){};
\node[iA] at (c55){};
\node[iA] at (c56){};

\path(c43)--(c53) node[midway, mut]{\symbmut};
}

\tikzstyle{pairexamples}=[rectangle, rounded corners, draw=maincol, inner sep=2pt, line width=1pt]
\uncover<6>{
\node[fit=(c53)(c54), pairexamples]{};
}
\uncover<7>{
\node[fit=(c53)(c52), pairexamples]{};
}
\uncover<8>{
\node[fit=(c54)(c55), pairexamples]{};
}

\end{tikzpicture}
\end{center}

\end{frame}

\end{document}
